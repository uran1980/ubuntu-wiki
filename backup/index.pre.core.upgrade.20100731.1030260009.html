<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<script id="versionArea" type="text/javascript">
//<![CDATA[
var version = {title: "TiddlyWiki", major: 2, minor: 5, revision: 2, date: new Date("June 24, 2009"), extensions: {}};
//]]>
</script>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="copyright" content="
TiddlyWiki created by Jeremy Ruston, (jeremy [at] osmosoft [dot] com)

Copyright (c) UnaMesa Association 2004-2009

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

Redistributions of source code must retain the above copyright notice, this
list of conditions and the following disclaimer.

Redistributions in binary form must reproduce the above copyright notice, this
list of conditions and the following disclaimer in the documentation and/or other
materials provided with the distribution.

Neither the name of the UnaMesa Association nor the names of its contributors may be
used to endorse or promote products derived from this software without specific
prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS' AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.
" />
<!--PRE-HEAD-START-->
<!--{{{-->
<link rel='alternate' type='application/rss+xml' title='RSS' href='index.xml' />
<!--}}}-->
<!--{{{-->
<style type="text/css">#contentWrapper {display:none;}</style>
<div id="SplashScreen" style="border: 3px solid #ccc; display: block; text-align: center; width: 320px; margin: 100px auto; padding: 50px; color:#000; font-size: 20px; font-family:Tahoma; background-color:#eee;"> загрузка<blink> ...</blink>
<br /><br />
<span style="font-size: 14px; color:red;">Для работы нужна поддержка Javascript.</span>
</div>
<!--}}}-->
<!--PRE-HEAD-END-->
<title> Ubuntu - :: wiki-manual .: </title>
<style id="styleArea" type="text/css">
#saveTest {display:none;}
#messageArea {display:none;}
#copyright {display:none;}
#storeArea {display:none;}
#storeArea div {padding:0.5em; margin:1em 0em 0em 0em; border-color:#fff #666 #444 #ddd; border-style:solid; border-width:2px; overflow:auto;}
#shadowArea {display:none;}
#javascriptWarning {width:100%; text-align:center; font-weight:bold; background-color:#dd1100; color:#fff; padding:1em 0em;}
</style>
<!--POST-HEAD-START-->
<!--{{{-->
<!--[if lte IE 7]>
<style type="text/css">
.tiddler { margin-left: auto; margin-right: auto; word-wrap: break-word; width: 80%; }
div#mainContent, div#displayArea, .tiddler { overflow: hidden; }

  /**
   * (en) Workaround for 'collapsing margin at #col3 (#mainContent)' when using CSS-property clear
   *      Left margin of #col3 (#mainContent) collapses when using clear:both in 1-3-2 (or 2-3-1) 
   *      layout and right column is the longest and left column is the shortest one.
   *      For IE6 and IE7 a special workaround was developed in YAML.
   *
   * @workaround
   * @affected   IE 5.x/Win, IE6, IE7
   * @css-for    IE 5.x/Win, IE6, IE7
   * @valid      no
   */

  html #ie_clearing {
    /* (en) Only a small help for debugging */
    position:static;

    /* (en) Make container visible in IE */
    display:block;

    /* (en) No fix possible in IE5.x, normal clearing used instead */
    clear:both;

    /* (en) forcing clearing-like behavior with a simple oversized container in IE6 & IE7*/
    width: 100%;
    font-size:0px;
    margin: -2px 0 -1em 1px;
  }



</style>
<![endif]-->
<!--}}}-->
<!--POST-HEAD-END-->
</head>
<body onload="main();" onunload="if(window.unload) unload();">
<!--PRE-BODY-START-->

<!--PRE-BODY-END-->
<div id="copyright">
Welcome to TiddlyWiki created by Jeremy Ruston, Copyright &copy; 2007 UnaMesa Association
</div>
<noscript>
<div id="javascriptWarning">
This page requires JavaScript to function properly.<br /><br />If you are using Microsoft Internet Explorer you may need to click on the yellow bar above and select 'Allow Blocked Content'. You must then click 'Yes' on the following security warning.
</div>
</noscript>
<div id="saveTest"></div>
<div id="backstageCloak"></div>
<div id="backstageButton"></div>
<div id="backstageArea"><div id="backstageToolbar"></div></div>
<div id="backstage">
	<div id="backstagePanel"></div>
</div>
<div id="contentWrapper"></div>
<div id="contentStash"></div>
<div id="shadowArea">
<div title="MarkupPreHead">
<pre>&lt;!--{{{--&gt;
&lt;link rel='alternate' type='application/rss+xml' title='RSS' href='index.xml' /&gt;
&lt;!--}}}--&gt;
</pre>
</div>
<div title="ColorPalette">
<pre>Background: #fff
Foreground: #000
PrimaryPale: #8cf
PrimaryLight: #18f
PrimaryMid: #04b
PrimaryDark: #014
SecondaryPale: #ffc
SecondaryLight: #fe8
SecondaryMid: #db4
SecondaryDark: #841
TertiaryPale: #eee
TertiaryLight: #ccc
TertiaryMid: #999
TertiaryDark: #666
Error: #f88
</pre>
</div>
<div title="StyleSheetColors">
<pre>/*{{{*/
body {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];}

a {color:[[ColorPalette::PrimaryMid]];}
a:hover {background-color:[[ColorPalette::PrimaryMid]]; color:[[ColorPalette::Background]];}
a img {border:0;}

h1,h2,h3,h4,h5,h6 {color:[[ColorPalette::SecondaryDark]]; background:transparent;}
h1 {border-bottom:2px solid [[ColorPalette::TertiaryLight]];}
h2,h3 {border-bottom:1px solid [[ColorPalette::TertiaryLight]];}

.button {color:[[ColorPalette::PrimaryDark]]; border:1px solid [[ColorPalette::Background]];}
.button:hover {color:[[ColorPalette::PrimaryDark]]; background:[[ColorPalette::SecondaryLight]]; border-color:[[ColorPalette::SecondaryMid]];}
.button:active {color:[[ColorPalette::Background]]; background:[[ColorPalette::SecondaryMid]]; border:1px solid [[ColorPalette::SecondaryDark]];}

.header {background:[[ColorPalette::PrimaryMid]];}
.headerShadow {color:[[ColorPalette::Foreground]];}
.headerShadow a {font-weight:normal; color:[[ColorPalette::Foreground]];}
.headerForeground {color:[[ColorPalette::Background]];}
.headerForeground a {font-weight:normal; color:[[ColorPalette::PrimaryPale]];}

.tabSelected{color:[[ColorPalette::PrimaryDark]];
	background:[[ColorPalette::TertiaryPale]];
	border-left:1px solid [[ColorPalette::TertiaryLight]];
	border-top:1px solid [[ColorPalette::TertiaryLight]];
	border-right:1px solid [[ColorPalette::TertiaryLight]];
}
.tabUnselected {color:[[ColorPalette::Background]]; background:[[ColorPalette::TertiaryMid]];}
.tabContents {color:[[ColorPalette::PrimaryDark]]; background:[[ColorPalette::TertiaryPale]]; border:1px solid [[ColorPalette::TertiaryLight]];}
.tabContents .button {border:0;}

#sidebar {}
#sidebarOptions input {border:1px solid [[ColorPalette::PrimaryMid]];}
#sidebarOptions .sliderPanel {background:[[ColorPalette::PrimaryPale]];}
#sidebarOptions .sliderPanel a {border:none;color:[[ColorPalette::PrimaryMid]];}
#sidebarOptions .sliderPanel a:hover {color:[[ColorPalette::Background]]; background:[[ColorPalette::PrimaryMid]];}
#sidebarOptions .sliderPanel a:active {color:[[ColorPalette::PrimaryMid]]; background:[[ColorPalette::Background]];}

.wizard {background:[[ColorPalette::PrimaryPale]]; border:1px solid [[ColorPalette::PrimaryMid]];}
.wizard h1 {color:[[ColorPalette::PrimaryDark]]; border:none;}
.wizard h2 {color:[[ColorPalette::Foreground]]; border:none;}
.wizardStep {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];
	border:1px solid [[ColorPalette::PrimaryMid]];}
.wizardStep.wizardStepDone {background:[[ColorPalette::TertiaryLight]];}
.wizardFooter {background:[[ColorPalette::PrimaryPale]];}
.wizardFooter .status {background:[[ColorPalette::PrimaryDark]]; color:[[ColorPalette::Background]];}
.wizard .button {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::SecondaryLight]]; border: 1px solid;
	border-color:[[ColorPalette::SecondaryPale]] [[ColorPalette::SecondaryDark]] [[ColorPalette::SecondaryDark]] [[ColorPalette::SecondaryPale]];}
.wizard .button:hover {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::Background]];}
.wizard .button:active {color:[[ColorPalette::Background]]; background:[[ColorPalette::Foreground]]; border: 1px solid;
	border-color:[[ColorPalette::PrimaryDark]] [[ColorPalette::PrimaryPale]] [[ColorPalette::PrimaryPale]] [[ColorPalette::PrimaryDark]];}

.wizard .notChanged {background:transparent;}
.wizard .changedLocally {background:#80ff80;}
.wizard .changedServer {background:#8080ff;}
.wizard .changedBoth {background:#ff8080;}
.wizard .notFound {background:#ffff80;}
.wizard .putToServer {background:#ff80ff;}
.wizard .gotFromServer {background:#80ffff;}

#messageArea {border:1px solid [[ColorPalette::SecondaryMid]]; background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]];}
#messageArea .button {color:[[ColorPalette::PrimaryMid]]; background:[[ColorPalette::SecondaryPale]]; border:none;}

.popupTiddler {background:[[ColorPalette::TertiaryPale]]; border:2px solid [[ColorPalette::TertiaryMid]];}

.popup {background:[[ColorPalette::TertiaryPale]]; color:[[ColorPalette::TertiaryDark]]; border-left:1px solid [[ColorPalette::TertiaryMid]]; border-top:1px solid [[ColorPalette::TertiaryMid]]; border-right:2px solid [[ColorPalette::TertiaryDark]]; border-bottom:2px solid [[ColorPalette::TertiaryDark]];}
.popup hr {color:[[ColorPalette::PrimaryDark]]; background:[[ColorPalette::PrimaryDark]]; border-bottom:1px;}
.popup li.disabled {color:[[ColorPalette::TertiaryMid]];}
.popup li a, .popup li a:visited {color:[[ColorPalette::Foreground]]; border: none;}
.popup li a:hover {background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]]; border: none;}
.popup li a:active {background:[[ColorPalette::SecondaryPale]]; color:[[ColorPalette::Foreground]]; border: none;}
.popupHighlight {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];}
.listBreak div {border-bottom:1px solid [[ColorPalette::TertiaryDark]];}

.tiddler .defaultCommand {font-weight:bold;}

.shadow .title {color:[[ColorPalette::TertiaryDark]];}

.title {color:[[ColorPalette::SecondaryDark]];}
.subtitle {color:[[ColorPalette::TertiaryDark]];}

.toolbar {color:[[ColorPalette::PrimaryMid]];}
.toolbar a {color:[[ColorPalette::TertiaryLight]];}
.selected .toolbar a {color:[[ColorPalette::TertiaryMid]];}
.selected .toolbar a:hover {color:[[ColorPalette::Foreground]];}

.tagging, .tagged {border:1px solid [[ColorPalette::TertiaryPale]]; background-color:[[ColorPalette::TertiaryPale]];}
.selected .tagging, .selected .tagged {background-color:[[ColorPalette::TertiaryLight]]; border:1px solid [[ColorPalette::TertiaryMid]];}
.tagging .listTitle, .tagged .listTitle {color:[[ColorPalette::PrimaryDark]];}
.tagging .button, .tagged .button {border:none;}

.footer {color:[[ColorPalette::TertiaryLight]];}
.selected .footer {color:[[ColorPalette::TertiaryMid]];}

.sparkline {background:[[ColorPalette::PrimaryPale]]; border:0;}
.sparktick {background:[[ColorPalette::PrimaryDark]];}

.error, .errorButton {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::Error]];}
.warning {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::SecondaryPale]];}
.lowlight {background:[[ColorPalette::TertiaryLight]];}

.zoomer {background:none; color:[[ColorPalette::TertiaryMid]]; border:3px solid [[ColorPalette::TertiaryMid]];}

.imageLink, #displayArea .imageLink {background:transparent;}

.annotation {background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]]; border:2px solid [[ColorPalette::SecondaryMid]];}

.viewer .listTitle {list-style-type:none; margin-left:-2em;}
.viewer .button {border:1px solid [[ColorPalette::SecondaryMid]];}
.viewer blockquote {border-left:3px solid [[ColorPalette::TertiaryDark]];}

.viewer table, table.twtable {border:2px solid [[ColorPalette::TertiaryDark]];}
.viewer th, .viewer thead td, .twtable th, .twtable thead td {background:[[ColorPalette::SecondaryMid]]; border:1px solid [[ColorPalette::TertiaryDark]]; color:[[ColorPalette::Background]];}
.viewer td, .viewer tr, .twtable td, .twtable tr {border:1px solid [[ColorPalette::TertiaryDark]];}

.viewer pre {border:1px solid [[ColorPalette::SecondaryLight]]; background:[[ColorPalette::SecondaryPale]];}
.viewer code {color:[[ColorPalette::SecondaryDark]];}
.viewer hr {border:0; border-top:dashed 1px [[ColorPalette::TertiaryDark]]; color:[[ColorPalette::TertiaryDark]];}

.highlight, .marked {background:[[ColorPalette::SecondaryLight]];}

.editor input {border:1px solid [[ColorPalette::PrimaryMid]];}
.editor textarea {border:1px solid [[ColorPalette::PrimaryMid]]; width:100%;}
.editorFooter {color:[[ColorPalette::TertiaryMid]];}

#backstageArea {background:[[ColorPalette::Foreground]]; color:[[ColorPalette::TertiaryMid]];}
#backstageArea a {background:[[ColorPalette::Foreground]]; color:[[ColorPalette::Background]]; border:none;}
#backstageArea a:hover {background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]]; }
#backstageArea a.backstageSelTab {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];}
#backstageButton a {background:none; color:[[ColorPalette::Background]]; border:none;}
#backstageButton a:hover {background:[[ColorPalette::Foreground]]; color:[[ColorPalette::Background]]; border:none;}
#backstagePanel {background:[[ColorPalette::Background]]; border-color: [[ColorPalette::Background]] [[ColorPalette::TertiaryDark]] [[ColorPalette::TertiaryDark]] [[ColorPalette::TertiaryDark]];}
.backstagePanelFooter .button {border:none; color:[[ColorPalette::Background]];}
.backstagePanelFooter .button:hover {color:[[ColorPalette::Foreground]];}
#backstageCloak {background:[[ColorPalette::Foreground]]; opacity:0.6; filter:'alpha(opacity=60)';}
/*}}}*/</pre>
</div>
<div title="StyleSheetLayout">
<pre>/*{{{*/
* html .tiddler {height:1%;}

body {font-size:.75em; font-family:arial,helvetica; margin:0; padding:0;}

h1,h2,h3,h4,h5,h6 {font-weight:bold; text-decoration:none;}
h1,h2,h3 {padding-bottom:1px; margin-top:1.2em;margin-bottom:0.3em;}
h4,h5,h6 {margin-top:1em;}
h1 {font-size:1.35em;}
h2 {font-size:1.25em;}
h3 {font-size:1.1em;}
h4 {font-size:1em;}
h5 {font-size:.9em;}

hr {height:1px;}

a {text-decoration:none;}

dt {font-weight:bold;}

ol {list-style-type:decimal;}
ol ol {list-style-type:lower-alpha;}
ol ol ol {list-style-type:lower-roman;}
ol ol ol ol {list-style-type:decimal;}
ol ol ol ol ol {list-style-type:lower-alpha;}
ol ol ol ol ol ol {list-style-type:lower-roman;}
ol ol ol ol ol ol ol {list-style-type:decimal;}

.txtOptionInput {width:11em;}

#contentWrapper .chkOptionInput {border:0;}

.externalLink {text-decoration:underline;}

.indent {margin-left:3em;}
.outdent {margin-left:3em; text-indent:-3em;}
code.escaped {white-space:nowrap;}

.tiddlyLinkExisting {font-weight:bold;}
.tiddlyLinkNonExisting {font-style:italic;}

/* the 'a' is required for IE, otherwise it renders the whole tiddler in bold */
a.tiddlyLinkNonExisting.shadow {font-weight:bold;}

#mainMenu .tiddlyLinkExisting,
	#mainMenu .tiddlyLinkNonExisting,
	#sidebarTabs .tiddlyLinkNonExisting {font-weight:normal; font-style:normal;}
#sidebarTabs .tiddlyLinkExisting {font-weight:bold; font-style:normal;}

.header {position:relative;}
.header a:hover {background:transparent;}
.headerShadow {position:relative; padding:4.5em 0 1em 1em; left:-1px; top:-1px;}
.headerForeground {position:absolute; padding:4.5em 0 1em 1em; left:0px; top:0px;}

.siteTitle {font-size:3em;}
.siteSubtitle {font-size:1.2em;}

#mainMenu {position:absolute; left:0; width:10em; text-align:right; line-height:1.6em; padding:1.5em 0.5em 0.5em 0.5em; font-size:1.1em;}

#sidebar {position:absolute; right:3px; width:16em; font-size:.9em;}
#sidebarOptions {padding-top:0.3em;}
#sidebarOptions a {margin:0 0.2em; padding:0.2em 0.3em; display:block;}
#sidebarOptions input {margin:0.4em 0.5em;}
#sidebarOptions .sliderPanel {margin-left:1em; padding:0.5em; font-size:.85em;}
#sidebarOptions .sliderPanel a {font-weight:bold; display:inline; padding:0;}
#sidebarOptions .sliderPanel input {margin:0 0 0.3em 0;}
#sidebarTabs .tabContents {width:15em; overflow:hidden;}

.wizard {padding:0.1em 1em 0 2em;}
.wizard h1 {font-size:2em; font-weight:bold; background:none; padding:0; margin:0.4em 0 0.2em;}
.wizard h2 {font-size:1.2em; font-weight:bold; background:none; padding:0; margin:0.4em 0 0.2em;}
.wizardStep {padding:1em 1em 1em 1em;}
.wizard .button {margin:0.5em 0 0; font-size:1.2em;}
.wizardFooter {padding:0.8em 0.4em 0.8em 0;}
.wizardFooter .status {padding:0 0.4em; margin-left:1em;}
.wizard .button {padding:0.1em 0.2em;}

#messageArea {position:fixed; top:2em; right:0; margin:0.5em; padding:0.5em; z-index:2000; _position:absolute;}
.messageToolbar {display:block; text-align:right; padding:0.2em;}
#messageArea a {text-decoration:underline;}

.tiddlerPopupButton {padding:0.2em;}
.popupTiddler {position: absolute; z-index:300; padding:1em; margin:0;}

.popup {position:absolute; z-index:300; font-size:.9em; padding:0; list-style:none; margin:0;}
.popup .popupMessage {padding:0.4em;}
.popup hr {display:block; height:1px; width:auto; padding:0; margin:0.2em 0;}
.popup li.disabled {padding:0.4em;}
.popup li a {display:block; padding:0.4em; font-weight:normal; cursor:pointer;}
.listBreak {font-size:1px; line-height:1px;}
.listBreak div {margin:2px 0;}

.tabset {padding:1em 0 0 0.5em;}
.tab {margin:0 0 0 0.25em; padding:2px;}
.tabContents {padding:0.5em;}
.tabContents ul, .tabContents ol {margin:0; padding:0;}
.txtMainTab .tabContents li {list-style:none;}
.tabContents li.listLink { margin-left:.75em;}

#contentWrapper {display:block;}
#splashScreen {display:none;}

#displayArea {margin:1em 17em 0 14em;}

.toolbar {text-align:right; font-size:.9em;}

.tiddler {padding:1em 1em 0;}

.missing .viewer,.missing .title {font-style:italic;}

.title {font-size:1.6em; font-weight:bold;}

.missing .subtitle {display:none;}
.subtitle {font-size:1.1em;}

.tiddler .button {padding:0.2em 0.4em;}

.tagging {margin:0.5em 0.5em 0.5em 0; float:left; display:none;}
.isTag .tagging {display:block;}
.tagged {margin:0.5em; float:right;}
.tagging, .tagged {font-size:0.9em; padding:0.25em;}
.tagging ul, .tagged ul {list-style:none; margin:0.25em; padding:0;}
.tagClear {clear:both;}

.footer {font-size:.9em;}
.footer li {display:inline;}

.annotation {padding:0.5em; margin:0.5em;}

* html .viewer pre {width:99%; padding:0 0 1em 0;}
.viewer {line-height:1.4em; padding-top:0.5em;}
.viewer .button {margin:0 0.25em; padding:0 0.25em;}
.viewer blockquote {line-height:1.5em; padding-left:0.8em;margin-left:2.5em;}
.viewer ul, .viewer ol {margin-left:0.5em; padding-left:1.5em;}

.viewer table, table.twtable {border-collapse:collapse; margin:0.8em 1.0em;}
.viewer th, .viewer td, .viewer tr,.viewer caption,.twtable th, .twtable td, .twtable tr,.twtable caption {padding:3px;}
table.listView {font-size:0.85em; margin:0.8em 1.0em;}
table.listView th, table.listView td, table.listView tr {padding:0px 3px 0px 3px;}

.viewer pre {padding:0.5em; margin-left:0.5em; font-size:1.2em; line-height:1.4em; overflow:auto;}
.viewer code {font-size:1.2em; line-height:1.4em;}

.editor {font-size:1.1em;}
.editor input, .editor textarea {display:block; width:100%; font:inherit;}
.editorFooter {padding:0.25em 0; font-size:.9em;}
.editorFooter .button {padding-top:0px; padding-bottom:0px;}

.fieldsetFix {border:0; padding:0; margin:1px 0px;}

.sparkline {line-height:1em;}
.sparktick {outline:0;}

.zoomer {font-size:1.1em; position:absolute; overflow:hidden;}
.zoomer div {padding:1em;}

* html #backstage {width:99%;}
* html #backstageArea {width:99%;}
#backstageArea {display:none; position:relative; overflow: hidden; z-index:150; padding:0.3em 0.5em;}
#backstageToolbar {position:relative;}
#backstageArea a {font-weight:bold; margin-left:0.5em; padding:0.3em 0.5em;}
#backstageButton {display:none; position:absolute; z-index:175; top:0; right:0;}
#backstageButton a {padding:0.1em 0.4em; margin:0.1em;}
#backstage {position:relative; width:100%; z-index:50;}
#backstagePanel {display:none; z-index:100; position:absolute; width:90%; margin-left:3em; padding:1em;}
.backstagePanelFooter {padding-top:0.2em; float:right;}
.backstagePanelFooter a {padding:0.2em 0.4em;}
#backstageCloak {display:none; z-index:20; position:absolute; width:100%; height:100px;}

.whenBackstage {display:none;}
.backstageVisible .whenBackstage {display:block;}
/*}}}*/
</pre>
</div>
<div title="StyleSheetLocale">
<pre>/***
StyleSheet for use when a translation requires any css style changes.
This StyleSheet can be used directly by languages such as Chinese, Japanese and Korean which need larger font sizes.
***/
/*{{{*/
body {font-size:0.8em;}
#sidebarOptions {font-size:1.05em;}
#sidebarOptions a {font-style:normal;}
#sidebarOptions .sliderPanel {font-size:0.95em;}
.subtitle {font-size:0.8em;}
.viewer table.listView {font-size:0.95em;}
/*}}}*/</pre>
</div>
<div title="StyleSheetPrint">
<pre>/*{{{*/
@media print {
#mainMenu, #sidebar, #messageArea, .toolbar, #backstageButton, #backstageArea {display: none !important;}
#displayArea {margin: 1em 1em 0em;}
noscript {display:none;} /* Fixes a feature in Firefox 1.5.0.2 where print preview displays the noscript content */
}
/*}}}*/</pre>
</div>
<div title="PageTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='header' macro='gradient vert [[ColorPalette::PrimaryLight]] [[ColorPalette::PrimaryMid]]'&gt;
&lt;div class='headerShadow'&gt;
&lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;
&lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;div class='headerForeground'&gt;
&lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;
&lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id='mainMenu' refresh='content' tiddler='MainMenu'&gt;&lt;/div&gt;
&lt;div id='sidebar'&gt;
&lt;div id='sidebarOptions' refresh='content' tiddler='SideBarOptions'&gt;&lt;/div&gt;
&lt;div id='sidebarTabs' refresh='content' force='true' tiddler='SideBarTabs'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div id='displayArea'&gt;
&lt;div id='messageArea'&gt;&lt;/div&gt;
&lt;div id='tiddlerDisplay'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="ViewTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar' macro='toolbar [[ToolbarCommands::ViewToolbar]]'&gt;&lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='subtitle'&gt;&lt;span macro='view modifier link'&gt;&lt;/span&gt;, &lt;span macro='view modified date'&gt;&lt;/span&gt; (&lt;span macro='message views.wikified.createdPrompt'&gt;&lt;/span&gt; &lt;span macro='view created date'&gt;&lt;/span&gt;)&lt;/div&gt;
&lt;div class='tagging' macro='tagging'&gt;&lt;/div&gt;
&lt;div class='tagged' macro='tags'&gt;&lt;/div&gt;
&lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;
&lt;div class='tagClear'&gt;&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="EditTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar' macro='toolbar [[ToolbarCommands::EditToolbar]]'&gt;&lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit title'&gt;&lt;/div&gt;
&lt;div macro='annotations'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit text'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit tags'&gt;&lt;/div&gt;&lt;div class='editorFooter'&gt;&lt;span macro='message views.editor.tagPrompt'&gt;&lt;/span&gt;&lt;span macro='tagChooser excludeLists'&gt;&lt;/span&gt;&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="GettingStarted">
<pre>To get started with this blank [[TiddlyWiki]], you'll need to modify the following tiddlers:
* [[SiteTitle]] &amp; [[SiteSubtitle]]: The title and subtitle of the site, as shown above (after saving, they will also appear in the browser title bar)
* [[MainMenu]]: The menu (usually on the left)
* [[DefaultTiddlers]]: Contains the names of the tiddlers that you want to appear when the TiddlyWiki is opened
You'll also need to enter your username for signing your edits: &lt;&lt;option txtUserName&gt;&gt;</pre>
</div>
<div title="OptionsPanel">
<pre>These [[InterfaceOptions]] for customising [[TiddlyWiki]] are saved in your browser

Your username for signing your edits. Write it as a [[WikiWord]] (eg [[JoeBloggs]])

&lt;&lt;option txtUserName&gt;&gt;
&lt;&lt;option chkSaveBackups&gt;&gt; [[SaveBackups]]
&lt;&lt;option chkAutoSave&gt;&gt; [[AutoSave]]
&lt;&lt;option chkRegExpSearch&gt;&gt; [[RegExpSearch]]
&lt;&lt;option chkCaseSensitiveSearch&gt;&gt; [[CaseSensitiveSearch]]
&lt;&lt;option chkAnimate&gt;&gt; [[EnableAnimations]]

----
Also see [[AdvancedOptions]]</pre>
</div>
<div title="ImportTiddlers">
<pre>&lt;&lt;importTiddlers&gt;&gt;</pre>
</div>
</div>
<!--POST-SHADOWAREA-->
<div id="storeArea">
<div title=".deb = setup.exe" modifier="Яковлев Иван" created="200906032342" modified="200906040918" tags="[[Установка ПО в Ubuntu]]" changecount="6">
<pre>В Windows, чтобы установить программу, необходимо скачать некий файл, наподобие setup.exe, который сам все установит. В Ubuntu используется похожая система, только вместо setup.exe используются файлы с расширением {{{.deb}}}

Это пакет-установщик. В разных линукс-системах установщики могут быть разные. Например, в системе ~RedHat Linux для установки используются пакеты с расширением {{{.rpm}}}

Зачем это нужно знать? Когда вы ищите ПО в интернете (если его нету в репозитариях) - обычно на странице загрузки предоставляются различные пакеты. Вам нужен deb! Даже когда вы устанавливаете что-либо из репозитария, невидимо от вас программа скачивает deb-файл (или несколько файлов, если имеются зависимости) и потом устанавливает его.

!См. далее
*[[Synaptic]]


</pre>
</div>
<div title="/etc/fstab - статическая информация о файловых системах" modifier="Яковлев Иван" created="200906211322" modified="200906302352" tags="[[Конфигурационные файлы]] TODO" changecount="4">
<pre>!Описание
Содержит список устройств и ассоциированных с ними точек монтирования файловых систем. Чтобы автоматически добалялись при загрузке CDROM или раздел DOS, или флопи дисковод нужно редактировать этот файл.

!!Пример
{{terminal{
{{{
# /etc/fstab: static file system information.
#
# Use 'vol_id --uuid' to print the universally unique identifier for a
# device; this may be used with UUID= as a more robust way to name devices
# that works even if disks are added and removed. See fstab(5).
#
# &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;
proc            /proc           proc    defaults        0       0
# / was on /dev/sda1 during installation
UUID=02bdc80f-b7ab-4cdb-812e-c907a4f1e16a /               ext3    relatime,errors=remount-ro 0       1
# swap was on /dev/sda5 during installation
UUID=2725f70b-97e6-4844-b4d6-487598c29de7 none            swap    sw              0       0
/dev/scd0       /media/cdrom0   udf,iso9660 user,noauto,exec,utf8 0       0
/dev/fd0        /media/floppy0  auto    rw,user,noauto,exec,utf8 0       0
}}}
}}}

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=fstab&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=fstab&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="/etc/group - список групп" modifier="Яковлев Иван" created="200906211317" modified="200906302354" tags="[[Конфигурационные файлы]]" changecount="2">
<pre>!Описание
Содержит список групп пользователей.

!!Пример
{{terminal{
{{{
root:x:0:
daemon:x:1:
bin:x:2:
sys:x:3:
adm:x:4:uran
tty:x:5:
disk:x:6:
lp:x:7:
mail:x:8:
news:x:9:
uucp:x:10:
man:x:12:
proxy:x:13:
kmem:x:15:
dialout:x:20:uran
fax:x:21:
voice:x:22:
cdrom:x:24:uran
floppy:x:25:
tape:x:26:
sudo:x:27:
audio:x:29:pulse
dip:x:30:
www-data:x:33:uran
backup:x:34:
operator:x:37:
list:x:38:
irc:x:39:
src:x:40:
gnats:x:41:
shadow:x:42:
utmp:x:43:
video:x:44:
sasl:x:45:
plugdev:x:46:uran
staff:x:50:
games:x:60:
users:x:100:
nogroup:x:1003:
libuuid:x:101:
syslog:x:102:
klog:x:103:
fuse:x:104:
ssl-cert:x:105:
lpadmin:x:106:uran
crontab:x:107:
mlocate:x:108:
ssh:x:109:uran
avahi-autoipd:x:110:
gdm:x:111:
netdev:x:112:
saned:x:113:
pulse:x:114:
pulse-access:x:115:
pulse-rt:x:116:
messagebus:x:117:
polkituser:x:118:
avahi:x:119:
haldaemon:x:120:
admin:x:121:uran
uran:x:1000:
sambashare:x:122:uran
winbindd_priv:x:123:
ais:x:124:
kvm:x:125:
libvirtd:x:126:
mysql:x:127:
svn:x:1001:uran,www-data
postfix:x:128:
postdrop:x:129:
}}}
}}}

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=group&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=group&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="/etc/hostname - содержит имя компьютера" modifier="Яковлев Иван" created="200906211301" modified="200906302347" tags="[[Конфигурационные файлы]]" changecount="6">
<pre>!Описание
Cодержит полное имя компьютера, например:
{{{
computer-name
}}}
В данном случае имя компьютера &quot;''computer-name''&quot;.

!Ссылки
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=hostname&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="/etc/hosts - список хостов" modifier="Яковлев Иван" created="200906211307" modified="200906302356" tags="[[Конфигурационные файлы]]" changecount="3">
<pre>!Описание
Содержит список соответствий ip-адресов именам соответствующих хостов
!!Пример:
{{terminal{
{{{
127.0.0.1       uran-ubuntu-nginx-apache        localhost.localdomain   localhost
127.0.1.1       uran-ubuntu-nginx-apache

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts
}}}
}}}

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=hosts&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=hosts&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="/etc/motd - сообщение дня" modifier="Яковлев Иван" created="200906302349" modified="200906302350" tags="[[Конфигурационные файлы]]" changecount="2">
<pre>!Описание
Содержимое файла {{{/etc/motd}}} отображается программой [[login(1)|http://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=login&amp;category=1]] после того как осуществлен успешный вход в систему, перед запуском командного интерпретатора.

Сокращение &quot;motd&quot; расшифровывается как &quot;message of the day&quot; (сообщение дня) и данный файл традиционно использовался именно для этой цели (он требует гораздо меньше дискового пространства, чем почтовое сообщение каждому пользователю).

!!Пример сообщения
{{terminal{
{{{
Linux uran-ubuntu-nginx-apache 2.6.28-13-generic #44-Ubuntu SMP Tue Jun 2 07:57:31 UTC 2009 i686

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

To access official Ubuntu documentation, please visit:
http://help.ubuntu.com/

10 packages can be updated.
0 updates are security updates.

}}}
}}}  

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=motd&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=motd&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="/etc/passwd - файл паролей" modifier="Яковлев Иван" created="200906031726" modified="200906302357" tags="[[Конфигурационные файлы]]" changecount="6">
<pre>!Описание
''Passwd'' является текстовым файлом, который содержит список учётных записей в системе, где каждая учётная запись содержит некоторую полезную информацию, такую как идентификатор пользователя ({{{UID}}}), идентификатор группы ({{{GID}}}), домашний каталог, командный интерпретатор и т.д. Часто, в этом же файле для каждой учётной записи содержатся также и зашифрованные пароли. Файл должен быть доступен для чтения всем (многие утилиты, такие как [[ls(1)|ls - список файлов в текущей директории]] используют его, чтобы отражать идентифкаторы пользователей на их имена), но доступ на запись должен предоставляться только суперпользователю.

В старые добрые времена, не существовало большой проблемы, связанной с доступностью этого файла на чтение для всех. Любой мог прочитать зашифрованные пароли, но мощности компьютеров не хватало для подбора грамотно выбранных паролей, а кроме того, основным принципом работы было дружественное сообщество пользователей. В наши дни, многие пользователи стали использовать механизм &quot;теневых&quot; паролей, где файл {{{/etc/passwd}}} содержит * вместо зашифрованных паролей, а зашифрованные пароли хранятся в файле {{{/etc/shadow}}} , который доступен на чтение только суперпользователю.

Вне зависимости от того применяется ли механизм теневых паролей или нет, многие системные администраторы ставят звёздочку в поле зашифрованного пароля, чтобы быть уверенными, что данный пользователь не пройдёт авторизацию, используя какой-либо пароль. (Но смотри секцию Замечение ниже.)

Если вы создаёте новую учётную запись, сперва в поле пароля помещается звёздочка, а затем с помощью команды [[passwd(1)|passwd - изменение пароля пользователя]] вы можете задать пароль.

Каждая строка файла содержит только одну учётную запись в формате:
{{{
    account:password:UID:GID:GECOS:directory:shell 
}}}
Вот описание этих полей:
;{{{account}}}
:имя пользователя в системе. Оно не должно содержать денежных символов. (Вообще сегодня в Linux имя пользователя может содержать только латинские буквы в нижнем регистре и ряд служебных символов -- прим.пер.) 
;{{{password}}}
:зашифрованный пароль пользователя или звёздочка. (В случае использования теневых паролей, если пароль задан, то в поле пароля ставится символ `{{{x}}}', а не звёздночка -- прим.пер.) 
;{{{UID}}}
:числовой идентификатор пользователя ({{{UID}}}). 
;{{{GID}}}
:числовой идентификатор первичной группы ({{{GID}}}) для этого пользователя. 
;{{{GECOS}}}
:Данное поле является необязательным и используется только для информационных целей. Обычно, оно содержит полное имя пользователя. GECOS это аббревиатура от General Electric Comprehensive Operating System, которая был переименована в GCOS, когда подразделение больших систем компании GE было продано компании Honeywell. Денис Ритчи писал: &quot;Иногда мы направляем вывод печати или пачку заданий на GCOS машину. Поле gcos в файле паролей было местом, где хранилась информация для {{{$IDENTcard}}}. Не элегантно.&quot; 
;{{{directory}}}
:домашний каталог пользователя {{{$HOME}}}. 
;{{{shell}}}
:это программа, которая запускается после входа в систему (если это поле пустое, то используется /bin/sh). Если в поле указан не существующий файл, то пользователь не сможет войти в систему с помощью [[login(1)|TODO]].

!!Пример
{{terminal{
{{{
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
sync:x:4:1003:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/bin/sh
man:x:6:12:man:/var/cache/man:/bin/sh
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh
uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:x:13:13:proxy:/bin:/bin/sh
www-data:x:33:33:www-data:/var/www:/bin/sh
backup:x:34:34:backup:/var/backups:/bin/sh
list:x:38:38:Mailing List Manager:/var/list:/bin/sh
irc:x:39:39:ircd:/var/run/ircd:/bin/sh
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
nobody:x:65534:1003:nobody:/nonexistent:/bin/sh
libuuid:x:100:101::/var/lib/libuuid:/bin/sh
syslog:x:101:102::/home/syslog:/bin/false
klog:x:102:103::/home/klog:/bin/false
hplip:x:103:7:HPLIP system user,,,:/var/run/hplip:/bin/false
avahi-autoipd:x:104:110:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/bin/false
gdm:x:105:111:Gnome Display Manager:/var/lib/gdm:/bin/false
saned:x:106:113::/home/saned:/bin/false
pulse:x:107:114:PulseAudio daemon,,,:/var/run/pulse:/bin/false
messagebus:x:108:117::/var/run/dbus:/bin/false
polkituser:x:109:118:PolicyKit,,,:/var/run/PolicyKit:/bin/false
avahi:x:110:119:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
haldaemon:x:111:120:Hardware abstraction layer,,,:/var/run/hald:/bin/false
uran:x:1000:1000:uran,,,:/home/uran:/bin/bash
ais:x:112:124::/home/ais:/bin/false
mysql:x:113:127:MySQL Server,,,:/var/lib/mysql:/bin/false
postfix:x:114:128::/var/spool/postfix:/bin/false
sshd:x:115:1003::/var/run/sshd:/usr/sbin/nologin
ftp:x:116:1003::/home/ftp:/bin/false
vsftpd:x:1001:1003:vsftpd,,,,:/home/vsftpd:/bin/false
}}}
}}}

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/manpages/jaunty/en/man5/passwd.5.html]]
*[[Описание на Opennet.ru|http://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=passwd&amp;category=5]]


</pre>
</div>
<div title="/etc/resolv.conf - ip-адреса DNS серверов" modifier="Яковлев Иван" created="200906211337" modified="200906302358" tags="[[Конфигурационные файлы]]" changecount="2">
<pre>!Описание
Задает список ip-адресов доступных DNS серверов

!!Пример
{{terminal{
{{{
# Generated by NetworkManager
domain localdomain
search localdomain
nameserver 192.168.221.2
}}}
}}}

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=resolv.conf&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=resolv.conf&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="5 простых способов “ускорения” сайта" modifier="Яковлев Иван" created="200906052325" tags="Статьи Оптимизация TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/5-prostyx-sposobov-“uskoreniya”-sajta.html#more-58]]



</pre>
</div>
<div title="Alien" modifier="Яковлев Иван" created="200906032341" modified="200906040937" tags="[[Установка ПО в Ubuntu]]" changecount="3">
<pre>Иногда бывают ситуации, когда есть только .rpm пакет (другой вид установщика, из других Linux-систем), но установить программу необходимо. Например в таком формате можно найти установщик vmware tools, если вы пробуете Ubuntu на виртуальной машине. В этом случае можно конвертировать .rpm пакет в .deb пакет, хотя это и не рекомендуется. Поможет в этом программа ''alien''. Чтобы установить ее:
{{{
sudo apt-get install alien
}}}
Или через Synaptic. После того как он установлен, перейдите в консоли в директорию, где находится .rpm пакет и выполните команду:
{{{
alien имя_файла.rpm
}}}
Через некоторое время (это может быть долго) будет создан .deb пакет, который уже можно использовать обычным образом.

!См. далее
*[[Заключение]]


</pre>
</div>
<div title="AppArmor" modifier="Яковлев Иван" created="200906051317" modified="200906052219" tags="Безопасность TODO [[TODO - нужен перевод статьи]]" changecount="5">
<pre>!Описание
''~AppArmor'' is a Linux Security Module implementation of name-based mandatory access controls. ~AppArmor confines individual programs to a set of listed files and posix 1003.1e draft capabilities. 

~AppArmor is installed and loaded by default. It uses profiles of an application to determine what files and permissions the application requires. Some packages will install their own profiles, and additional profiles can be found in the ''apparmor-profiles package''. 

To install the apparmor-profiles package from a terminal prompt:
{{{
sudo apt-get install apparmor-profiles
}}}
~AppArmor profiles have two modes of execution: 
*Complaining/Learning: profile violations are permitted and logged. Useful for testing and developing new profiles. 
*Enforced/Confined: enforces profile policy as well as logging the violation.

!Использование
TODO

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/apparmor.html]]


</pre>
</div>
<div title="Apt-Get" modifier="Яковлев Иван" created="200906042312" modified="200906042313" tags="[[Настройка Ubuntu]] TODO" changecount="2">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Описание на ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/apt-get.html]]



</pre>
</div>
<div title="Aptitude" modifier="Яковлев Иван" created="200906042314" modified="200906231625" tags="[[Настройка Ubuntu]] TODO" changecount="2">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Описание на ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/aptitude.html]]
*https://help.ubuntu.com/community/AptitudeSurvivalGuide



</pre>
</div>
<div title="Avant Window Navigator" modifier="Яковлев Иван" created="200906052330" tags="Статьи Приложения TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/avant-window-navigator.html#more-79]]



</pre>
</div>
<div title="CodeSnippets" modifier="Яковлев Иван" created="200906022149" modified="200907251420" tags="CodeSnippets" changecount="11">
<pre>/%!Таблицы
|!заголовок левой колонки|!заголовок правой колонки|
|&gt;| объединение ячеек по горизонтали |
| объединение ячеек по вертикали |левое выравнивание|
|~| правое выравнивание|
|bgcolor(#a0ffa0):цветовыделение| центрирование |
|bgcolor(#eee):цветовыделение| центрирование |
|Таблица|c

!Исходный код
{{{
|!заголовок левой колонки|!заголовок правой колонки|
|&gt;| объединение ячеек по горизонтали |
| объединение ячеек по вертикали |левое выравнивание|
|~| правое выравнивание|
|bgcolor(#a0ffa0):цветовыделение| центрирование |
|bgcolor(#eee):цветовыделение| центрирование |
|Таблица|c
}}}
%/
!Вставка изображений
!!Исходный код
{{{
{{textAlignCenter{
[img[images/articles/books/book-cover-php-objects-patterns-practice.jpg]]}}}
}}}

2 Вариант
{{{
{{textAlignCenter{
&lt;html&gt;&lt;a class=&quot;imgLink&quot; href=&quot;images/articles/backup1.PNG&quot; target=&quot;_blank&quot; title=&quot;&quot;&gt;&lt;img src=&quot;images/articles/backup1.PNG&quot; width=&quot;550&quot; alt=&quot;backup1.PNG&quot; /&gt;&lt;/a&gt;&lt;/html&gt;}}}
}}}

!Создание слайдеров
!!Исходный код
{{{
&lt;&lt;slider &quot;chk-cd&quot; [[cd]] &quot;cd&quot; &quot;Показать/Скрыть описание команды cd&quot;&gt;&gt;
}}}

!!Пример работы
&lt;&lt;slider &quot;chk-cd&quot; [[cd]] &quot;cd&quot; &quot;Показать/Скрыть описание команды cd&quot;&gt;&gt;

!Создание вкладок
!!Исходный код
{{{
&lt;&lt;tabs tabcookie
    &quot;Заголовок1&quot; &quot;Описание заголовка1&quot; [[Специальные символы bash]]
    &quot;Заголовок2&quot; &quot;Описание заголовка2&quot; [[/etc/group - список групп]]
&gt;&gt;
}}}

!Создание кнопки &quot;Наверх&quot; и &quot;Скрыть/Отобразить боковую панель&quot;
!!Исходный код
{{{
{{textAlignRight toolbar{
&lt;html&gt;&lt;span class='toolbar' macro='top'&gt;&lt;/span&gt;&lt;span class='toolbar' macro='toggleSideBar &quot;&quot; &quot;Скрыть/Отобразить боковую панель&quot;'&gt;&lt;/span&gt;&lt;/html&gt;}}}
}}}

!!Пример работы
{{textAlignRight toolbar{
&lt;html&gt;&lt;span class='toolbar' macro='top'&gt;&lt;/span&gt;&lt;span class='toolbar' macro='toggleSideBar &quot;&quot; &quot;Скрыть/Отобразить боковую панель&quot;'&gt;&lt;/span&gt;&lt;/html&gt;}}}

!Создание заметок
!!Исходный код
{{{
{{note{
@@color:red;font-weight:bold;ЗАМЕЧАНИЕ:@@
Пример отображения заметки...}}}
}}}

!!Пример работы
{{note{
@@color:red;font-weight:bold;ЗАМЕЧАНИЕ:@@
Пример отображения заметки...}}}


</pre>
</div>
<div title="DefaultTiddlers" modifier="Яковлев Иван" created="200906030040" modified="200911261106" changecount="4">
<pre>[[Что такое Ubuntu]]</pre>
</div>
<div title="EditTemplate" modifier="Яковлев Иван" created="200904061406" changecount="1">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar' macro='toolbar [[ToolbarCommands::EditToolbar]]'&gt;&lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit title'&gt;&lt;/div&gt;
&lt;div macro='annotations'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit text'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit tags'&gt;&lt;/div&gt;&lt;div class='editorFooter'&gt;&lt;span macro='message views.editor.tagPrompt'&gt;&lt;/span&gt;&lt;span macro='tagChooser excludeLists'&gt;&lt;/span&gt;&lt;/div&gt;
&lt;br /&gt;
&lt;div class='toolbar' macro='toolbar [[ToolbarCommands::EditToolbar]]'&gt;&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="FooterContent" modifier="Яковлев Иван" created="200904061422" modified="200911271741" tags="FooterContent" changecount="11">
<pre>{{footerMessage{
Powered By ''//~TiddlyWiki-&lt;&lt;version&gt;&gt;//'' 2009 (С) 
}}}
{{copyright{
поддержка: [[Яковлев Иван|http://www.uran1980.com]]
}}}

&lt;html&gt;
&lt;!-- google analistic --&gt;
&lt;script type=&quot;text/javascript&quot;&gt;//&lt;![CDATA[//&gt;&lt;!--
    var gaJsHost = ((&quot;https:&quot; == document.location.protocol) ? &quot;https://ssl.&quot; : &quot;http://www.&quot;);
    document.write(unescape(&quot;%3Cscript src='&quot; + gaJsHost + &quot;google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E&quot;));

    try {
        var pageTracker = _gat._getTracker(&quot;UA-10612031-1&quot;);
        pageTracker._setDomainName(&quot;.uran1980.com&quot;);
        pageTracker._trackPageview();
    } catch(err) {}
//--&gt;&lt;!]]&gt;&lt;/script&gt;
&lt;!-- end google analistic --&gt;
&lt;/html&gt;</pre>
</div>
<div title="IP телефония в Ubuntu или Debian на базе Asterisk за 15 минут" modifier="Яковлев Иван" created="200906052356" tags="[[Установка/настройка сервера]] [[IP телефония]] Статьи TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/ip-telefoniya-v-ubuntu-ili-debian-na-baze-asterisk-za-15-minut.html#more-162]]



</pre>
</div>
<div title="JumpMacro" modifier="Яковлев Иван" created="200904061403" tags="systemConfig [[TiddlyWikiDev-Plugins - Плагины]]" changecount="1">
<pre>/***
|Name|JumpMacro|
|Created by|SaqImtiaz|
|Location|http://tw.lewcid.org/#JumpMacro|
|Version|1.0|
|Requires|~TW2.x|
!Description:
Macro version of the core jump command, that also provides an optional 'jump to top' button.

!Demo:
click the 'j' button in the hoverMenu on the right.

!Installation:
Copy the contents of this tiddler to your TW, tag with systemConfig, save and reload your TW.

!Usage
{{{&lt;&lt;jump&gt;&gt;}}}&lt;&lt;jump&gt;&gt;
{{{&lt;&lt;jump customlabel customtooltip top&gt;&gt;}}} &lt;&lt;jump customlabel customtooltip top&gt;&gt;
Note: passing the third parameter as top, enables the 'top' button in the dropdown.

!History:
27-07-06, ver1.0

!Code
***/

//{{{
config.macros.jump= {};
config.macros.jump.handler = function (place,macroName,params,wikifier,paramString,tiddler)
{
        var label = (params[0] &amp;&amp; params[0]!=&quot;.&quot;)? params[0]: 'перейти';
        var tooltip = (params[1] &amp;&amp; params[1]!=&quot;.&quot;)? params[1]: 'Перейти к одной из открытых статей';
        var top = (params[2] &amp;&amp; params[2]=='top') ? true: false;        

        var btn =createTiddlyButton(place,label,tooltip,this.onclick);
        if (top==true)
              btn.setAttribute(&quot;top&quot;,&quot;true&quot;)
}

config.macros.jump.onclick = function(e)
{
        if (!e) var e = window.event;
        var theTarget = resolveTarget(e);
        var top = theTarget.getAttribute(&quot;top&quot;);
	var popup = Popup.create(this);
	if(popup)
		{
                 if(top==&quot;true&quot;)
                                {createTiddlyButton(createTiddlyElement(popup,&quot;li&quot;),'Наверх ↑','Перейти в начало страницы',config.macros.jump.top);
                                 createTiddlyElement(popup,&quot;hr&quot;);}
		
		story.forEachTiddler(function(title,element) {
			createTiddlyLink(createTiddlyElement(popup,&quot;li&quot;),title,true);
			});
                }
	Popup.show(popup,false);
	e.cancelBubble = true;
	if (e.stopPropagation) e.stopPropagation();
	return false;
}

config.macros.jump.top = function()
{
       window.scrollTo(0,0);
}
//}}}</pre>
</div>
<div title="JumpToTopMacro" modifier="Яковлев Иван" created="200904061403" tags="systemConfig [[TiddlyWikiDev-Plugins - Плагины]]" changecount="1">
<pre>/***
|Name|JumpToTopMacro|
|Created by|SaqImtiaz|
|Location|http://tw.lewcid.org/#JumpToTopMacro|
|Version|1.0|
|Requires|~TW2.x|
!Description:
Provides a toolbar command and a macro, that create a button for quickly jumping to the top of your TW.
Handy to place in the tiddler toolbar (edit the ViewTemplate)

Note: You can add an extra toolbar to the bottom of tiddlers as well with buttons of your choice, to allow easy access to the buttons/commands in it.

!Demo:
{{{&lt;&lt;top&gt;&gt;}}}&lt;&lt;top&gt;&gt;

!Installation:
Copy the contents of this tiddler to your TW, tag with systemConfig, save and reload your TW.

!History:
*23-07-06: ver 1.0

!Code
***/
//{{{
config.macros.top={};
config.macros.top.handler=function(place,macroName)
{
               createTiddlyButton(place,&quot;↑ Наверх&quot;,&quot;Перейти в начало страницы&quot;,this.onclick);
}
config.macros.top.onclick=function()
{
               window.scrollTo(0,0);
};

config.commands.top =
{
               text:&quot; ↑Наверх &quot;,
               tooltip:&quot;Наверх&quot;
};

config.commands.top.handler = function(event,src,title)
{
               window.scrollTo(0,0);
}
//}}}</pre>
</div>
<div title="LVM" modifier="Яковлев Иван" created="200906122007" modified="200906191934" tags="slider [[Дополнительные материалы]] Статьи" changecount="18">
<pre>#[[КонцепцияЛогическихТомов|Концепция логических томов]]
#[[СозданиеФизическихТомов|Создание физических томов]]
#[[СозданиеГруппТомов|Создание групп томов]]
#[[СозданиеЛогическихТомов|Создание логических томов]]
#[[АктивацияЛогическихТомов|Активация логических томов]]
#[[Конфигурация в &quot;/etc/fstab&quot;|Конфигурация логических томов в файле /etc/fstab]]
#[[Ссылки|Ссылки по LVM]]</pre>
</div>
<div title="Linux в роли WI-FI точки доступа" modifier="Яковлев Иван" created="200906052335" tags="Статьи Wi-Fi TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/linux-v-roli-wi-fi-tochki-dostupa.html]]



</pre>
</div>
<div title="MainMenu" modifier="Яковлев Иван" created="200904061418" modified="200906211739" changecount="90">
<pre>''СОДЕРЖАНИЕ''
----
''Важно''
*&lt;&lt;slider &quot;chk-services&quot; [[Сервисы]] &quot;Запуск/Остановка сервисов&quot; &quot;Показать/Скрыть раздел Запуск/Остановка сервисов&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-cheat-sheets&quot; [[Шпоргалки по Unix-like]] &quot;Шпоргалки по Unix-like&quot; &quot;Показать/Скрыть раздел Шпоргалки по Unix-like&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-mc&quot; [[MidnightCommander]] &quot;Шпоргалки по MidnightCommander&quot; &quot;Показать/Скрыть раздел MidnightCommander&quot;&gt;&gt;
*[[Права доступа к сист. файлам|Рекомендуемые права доступа к важным системным файлам/каталогам]]
----
''Описания''
*[[Описание файловой системы|hier - описание иерархии файловой системы (The Filesystem Hierarchy Standard)]]
*&lt;&lt;slider &quot;chk-conf&quot; [[Конфигурационные файлы]] &quot;Конфигурационные файлы&quot; &quot;Показать/Скрыть раздел Конфигурационные файлы&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-config-file-exemples&quot; [[Примеры конфигурационных файлов]] &quot;Примеры конф. файлов&quot; &quot;Показать/Скрыть раздел Примеры конфигурационных файлов&quot;&gt;&gt;
----
''Командная оболочка bash''
*[[Горячие клавиши bash]]
*[[Переменные окружения|Переменные окружения командной оболочки bash]]
*[[Специальные символы bash]]
*[[Шпоргалака по bash|Шпоргалка по продвинутому использованию оболочки bash]]
----
''Основные Команды''
*&lt;&lt;slider &quot;chk-unix-cmd&quot; [[Команды Unix]] &quot;Команды Unix&quot; &quot;Показать/Скрыть раздел Команды Unix&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-windows-cmd&quot; [[Команды Windows]] &quot;Команды Windows&quot; &quot;Показать/Скрыть раздел Команды Windows&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-apache2-cmd&quot; [[Команды сервера Apache2]] &quot;Команды сервера Apache2&quot; &quot;Показать/Скрыть раздел Команды сервера Apache2&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-mysql-cmd&quot; [[Команды MySQL]] &quot;Команды MySQL&quot; &quot;Показать/Скрыть раздел Команды MySQL&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-svn-cmd&quot; [[Команды SVN]] &quot;Команды SVN&quot; &quot;Показать/Скрыть раздел Команды SVN&quot;&gt;&gt;
----
''Настройка/Администрирование''
*&lt;&lt;slider &quot;chk-ubuntu-config&quot; [[Настройка Ubuntu]] &quot;Настройка Ubuntu&quot; &quot;Показать/Скрыть раздел Настройка Ubuntu&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-server-config&quot; [[Установка/настройка сервера]] &quot;Настройка сервера&quot; &quot;Показать/Скрыть раздел Установка/настройка сервера&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-web-server-config&quot; [[Установка/настройка Web-сервера]] &quot;Настройка Web-сервера&quot; &quot;Показать/Скрыть раздел Установка/настройка Web-сервера&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-vps-server&quot; [[Выделенный VPS сервер]] &quot;Выделенный VPS сервер&quot; &quot;Показать/Скрыть раздел Настройка выделенного VPS сервера&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-server-config&quot; [[Администрирование сервера]] &quot;Администрирование сервера&quot; &quot;Показать/Скрыть раздел Администрирование сервера&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-connect&quot; [[Удаленное подключение]] &quot;Удаленное подключение&quot; &quot;Показать/Скрыть раздел Удаленное подключение к серверу&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-dyndns&quot; [[Настройка DynDNS сервиса]] &quot;Настройка DynDNS сервиса&quot; &quot;Показать/Скрыть раздел Настройка DynDNS сервиса&quot;&gt;&gt;
----
''Безопасность''
*&lt;&lt;slider &quot;chk-server-sec&quot; [[Безопасность]] &quot;Безопасность сервера&quot; &quot;Показать/Скрыть раздел Безопасность сервера&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-ssl-cert&quot; [[SSL и сертификаты]] &quot;SSL и сертификаты&quot; &quot;Показать/Скрыть раздел SSL и сертификаты&quot;&gt;&gt;
*[[Защита от DoS-атак в nginx|Защита от DoS атак в nginx]]
----
''Остальное''
*&lt;&lt;slider &quot;chk-addons&quot; [[Дополнительные материалы]] &quot;Дополнительные материалы&quot; &quot;Показать/Скрыть раздел Дополнительные материалы&quot;&gt;&gt;
----
[[CodeSnippets]]
[[Шаблон - См. также]]
[[slider]]
[[HTML-entities|Условные сиволы в HTML (HTML entities)]]</pre>
</div>
<div title="Man и получение помощи" modifier="Яковлев Иван" created="200906022313" modified="200906031936" tags="[[Команды Unix]]" changecount="5">
<pre>{{{имя_команды --help}}} и {{{man имя_команды}}} - два наиболее важных инструмента командной строки.

Практически все команды понимают параметр {{{-h}}} (или {{{--help}}}) который выдает краткую справку по команде и её опциям и затем возвращается в командную строку. Введите 
{{{
man -h
}}}
или 
{{{
man --help
}}}
чтобы посмотреть как это работает.

Все команды и практически все программы в Linux имеют файл {{{man}}} (manual - руководство), Проще всего его найти, введя команду: {{{man имя_команды}}}. К примеру, команда 
{{{
man mv
}}}
покажет руководство по команде {{{mv}}} (перемещение).

Для перемещения по файлу справки пользуйтесь клавишами управления курсором, а для выхода и возвращения в командную строку — клавишу q.
{{{
man man
}}}
вывод справки по команде {{{man}}} - лучшее решение для начинающих пользователей.

Команда 
{{{
man intro
}}}
особенно полезна: она отображает &quot;Введение в пользовательские команды&quot; - отлично написанное краткое руководство по основам командной строки Linux.

Также существует команда {{{info}}}, отображающая обычно больше, чем {{{man}}}. Попробуйте 
{{{
info info
}}}
чтобы прочитать введение в страницы {{{info}}}.

Если вы не уверены, какую команду или приложение следует использовать, можете попытаться поискать по всем страницам man.
{{{man -k foo}}}, будет осуществлять поиск файлов справки для foo. Попробуйте набрать 
{{{
man -k nautilus
}}}
чтобы увидеть, как это работает. 
{{note{
Это то же самое, что и команда {{{apropos}}}.
}}}
{{{man -f foo}}}, ищет лишь названия системных файлов справки. Например, попробуйте 
{{{
man -f gnome
}}}
{{note{
Это то же самое, что и команда {{{whatis}}}.
}}}



</pre>
</div>
<div title="MarkupPostHead" modifier="Яковлев Иван" created="200904061406" modified="200907111903" changecount="2">
<pre>&lt;!--{{{--&gt;
&lt;!--[if lte IE 7]&gt;
&lt;style type=&quot;text/css&quot;&gt;
.tiddler { margin-left: auto; margin-right: auto; word-wrap: break-word; width: 80%; }
div#mainContent, div#displayArea, .tiddler { overflow: hidden; }

  /**
   * (en) Workaround for 'collapsing margin at #col3 (#mainContent)' when using CSS-property clear
   *      Left margin of #col3 (#mainContent) collapses when using clear:both in 1-3-2 (or 2-3-1) 
   *      layout and right column is the longest and left column is the shortest one.
   *      For IE6 and IE7 a special workaround was developed in YAML.
   *
   * @workaround
   * @affected   IE 5.x/Win, IE6, IE7
   * @css-for    IE 5.x/Win, IE6, IE7
   * @valid      no
   */

  html #ie_clearing {
    /* (en) Only a small help for debugging */
    position:static;

    /* (en) Make container visible in IE */
    display:block;

    /* (en) No fix possible in IE5.x, normal clearing used instead */
    clear:both;

    /* (en) forcing clearing-like behavior with a simple oversized container in IE6 &amp; IE7*/
    width: 100%;
    font-size:0px;
    margin: -2px 0 -1em 1px;
  }



&lt;/style&gt;
&lt;![endif]--&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="MarkupPreHead" modifier="Яковлев Иван" created="200904061406" modified="200906031305" changecount="2">
<pre>&lt;!--{{{--&gt;
&lt;link rel='alternate' type='application/rss+xml' title='RSS' href='index.xml' /&gt;
&lt;!--}}}--&gt;
&lt;!--{{{--&gt;
&lt;style type=&quot;text/css&quot;&gt;#contentWrapper {display:none;}&lt;/style&gt;
&lt;div id=&quot;SplashScreen&quot; style=&quot;border: 3px solid #ccc; display: block; text-align: center; width: 320px; margin: 100px auto; padding: 50px; color:#000; font-size: 20px; font-family:Tahoma; background-color:#eee;&quot;&gt; загрузка&lt;blink&gt; ...&lt;/blink&gt;
&lt;br /&gt;&lt;br /&gt;
&lt;span style=&quot;font-size: 14px; color:red;&quot;&gt;Для работы нужна поддержка Javascript.&lt;/span&gt;
&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="MidnightCommander" modifier="Яковлев Иван" created="200906211725" modified="200906211751" tags="Важное MainMenu slider" changecount="5">
<pre>*[[Установка МС на Debian/Ubuntu|Установка Midnight Commander в Debian/Ubuntu]]
*[[Горячие клавиши MC]]
*[[Оф. документация по MC (рус.)|http://www.midnight-commander.org/wiki/ru/doc]]</pre>
</div>
<div title="Nginx + Apache" modifier="Яковлев Иван" created="200906181725" modified="200906200041" tags="[[Установка/настройка Web-сервера]] slider" changecount="16">
<pre>#[[Nginx+Apache+mod_praf|Установка и настройка Nginx. Nginx frontend + Apache backend. Установка mod_rpaf]]
#[[ИспользованиеNginx...|Использование Nginx Как Reverse-Proxy Сервера На Загруженных Сайтах]]
#[[КонтролируемаяЗакачка|Использование X-Accel-Redirect с Nginx для реализации контролируемых скачиваний (с примерами для rails и php)]]
#[[СтримингFlashVideo|Стриминг Flash Video при помощи Nginx]]
#[[Настройка ssl в nginx|Настройка ssl (https) в nginx]]
#[[Разгоняем веб-сервер|Разгоняем веб-сервер ngnix + Apache + mod_praf]]
#[[Nginx+PHP5(FCGI)+XCa...|Установка Nginx-PHP5-FastCGI-XCache-MySQL на Ubuntu]]
#[[Защита от DoS-атак в nginx|Защита от DoS атак в nginx]]</pre>
</div>
<div title="Nginx and Memcached, a 400proc boost" modifier="Яковлев Иван" created="200906212254" modified="200906212257" tags="[[Настройка Nginx]] Nginx+Memcached [[TODO - нужен перевод статьи]] TODO" changecount="2">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://www.igvita.com/2008/02/11/nginx-and-memcached-a-400-boost/]]


</pre>
</div>
<div title="OpenSSH - настройка, полезные приемы, секреты и советы по использованию" modifier="Яковлев Иван" created="200906062112" modified="200906062117" tags="SSH Статьи TODO [[OpenSSH сервер]]" changecount="4">
<pre>!Описание
TODO

!См. также
*[[OpenSSH сервер]]

!Ссылки
*[[Оригинал статьи|http://sudouser.com/openssh-nastrojka-poleznye-priemy-sekrety-i-sovety-po-ispolzovaniyu.html]]


</pre>
</div>
<div title="OpenSSH сервер" modifier="Яковлев Иван" created="200906041836" modified="200907221227" tags="[[Удаленное подключение]] [[TODO - нужен перевод статьи]] SSH" changecount="25">
<pre>!Описание
This section of the Ubuntu Server Guide introduces a powerful collection of tools for the remote control of networked computers and transfer of data between networked computers, called ~OpenSSH. You will also learn about some of the configuration settings possible with the ~OpenSSH server application and how to change them on your Ubuntu system. 

~OpenSSH is a freely available version of the Secure Shell (SSH) protocol family of tools for remotely controlling a computer or transferring files between computers. Traditional tools used to accomplish these functions, such as telnet or rcp, are insecure and transmit the user's password in cleartext when used. ~OpenSSH provides a server daemon and client tools to facilitate secure, encrypted remote control and file transfer operations, effectively replacing the legacy tools. 

The ~OpenSSH server component, sshd, listens continuously for client connections from any of the client tools. When a connection request occurs, sshd sets up the correct connection depending on the type of client tool connecting. For example, if the remote computer is connecting with the ssh client application, the ~OpenSSH server sets up a remote control session after authentication. If a remote user connects to an ~OpenSSH server with scp, the ~OpenSSH server daemon initiates a secure copy of files between the server and client after authentication. ~OpenSSH can use many authentication methods, including plain password, public key, and Kerberos tickets.

!Установка
nstallation of the ~OpenSSH client and server applications is simple. To install the ~OpenSSH client applications on your Ubuntu system, use this command at a terminal prompt:
{{{
sudo apt-get install openssh-client
}}}
To install the ~OpenSSH server application, and related support files, use this command at a terminal prompt: 
{{{
sudo apt-get install openssh-server
}}}
The openssh-server package can also be selected to install during the Server Edition installation process.

!Настройка
You may configure the default behavior of the ~OpenSSH server application, sshd, by editing the file {{{/etc/ssh/sshd_config}}}. For information about the configuration directives used in this file, you may view the appropriate manual page with the following command, issued at a terminal prompt: 
{{{
man sshd_config
}}}
There are many directives in the sshd configuration file controlling such things as communication settings and authentication modes. The following are examples of configuration directives that can be changed by editing the {{{/etc/ssh/sshd_config}}} file.
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
Prior to editing the configuration file, you should make a copy of the original file and protect it from writing so you will have the original settings as a reference and to reuse as necessary. 

Copy the {{{/etc/ssh/sshd_config}}} file and protect it from writing with the following commands, issued at a terminal prompt:
{{{
sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.original
sudo chmod a-w /etc/ssh/sshd_config.original
}}}
}}}
The following are examples of configuration directives you may change: 
*To set your ~OpenSSH to listen on TCP port 2222 instead of the default TCP port 22, change the Port directive as such: 
*Port 2222 
*To have sshd allow public key-based login credentials, simply add or modify the line: 
*~PubkeyAuthentication yes 
*In the {{{/etc/ssh/sshd_config}}} file, or if already present, ensure the line is not commented out. 
*To make your ~OpenSSH server display the contents of the {{{/etc/issue.net}}} file as a pre-login banner, simply add or modify the line: 
{{{
Banner /etc/issue.net 
}}}
In the {{{/etc/ssh/sshd_config}}} file. 

After making changes to the {{{/etc/ssh/sshd_config}}} file, save the file, and restart the sshd server application to effect the changes using the following command at a terminal prompt:
{{{
sudo /etc/init.d/ssh restart
}}}
{{note{
@@color: red;font-weight: bold;ВНИМАНИЕ:@@
Many other configuration directives for sshd are available for changing the server application's behavior to fit your needs. Be advised, however, if your only method of access to a server is ssh, and you make a mistake in configuring sshd via the {{{/etc/ssh/sshd_config}}} file, you may find you are locked out of the server upon restarting it, or that the sshd server refuses to start due to an incorrect configuration directive, so be extra careful when editing this file on a remote server.
}}}

!SSH Ключи
SSH keys allow authentication between two hosts without the need of a password. SSH key authentication uses two keys a private key and a public key. 

To generate the keys, from a terminal prompt enter: 
{{{
ssh-keygen -t dsa
}}}
This will generate the keys using a DSA authentication identity of the user. During the process you will be prompted for a password. Simply hit Enter when prompted to create the key. 

By default the public key is saved in the file {{{~/.ssh/id_dsa.pub}}}, while {{{~/.ssh/id_dsa}}} is the private key. Now copy the {{{id_dsa.pub}}} file to the remote host and append it to {{{~/.ssh/authorized_keys}}} by entering: 
{{{
ssh-copy-id username@remotehost
}}}
Finally, double check the permissions on the authorized_keys file, only the authenticated user should have read and write permissions. If the permissions are not correct change them by:
{{{ 
chmod 644 .ssh/authorized_keys
}}}
You should now be able to SSH to the host without being prompted for a password.

!См. также
*[[OpenSSH - настройка, полезные приемы, секреты и советы по использованию]]
*[[Установка и настройка SSHD в среде chroot при помощи makejail]]

!Ссылки
*[[Описание на manpages.ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/openssh-server.html]]
*http://www.openssh.org/ -- официальный сайт
*http://ru.wikipedia.org/wiki/OpenSSH -- описание на Википедии
*http://www.openssh.com/ru/index.html -- документация на русском
*http://sshwindows.sourceforge.net/ -- openSSH для Windows
*http://www.openssh.com/portable.html -- portable openSSH



</pre>
</div>
<div title="PageTemplate" modifier="Яковлев Иван" created="200904061407" changecount="1">
<pre>&lt;!--{{{--&gt;
&lt;!-- &lt;div class='header' macro='gradient vert [[ColorPalette::PrimaryLight]] [[ColorPalette::PrimaryMid]]'&gt; --&gt;
&lt;div class='header'&gt;
   &lt;div class='headerShadow'&gt;
      &lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;
      &lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;
      &lt;span class='date'&gt;Cегодня: &lt;span macro='today 0DD.0MM.YYYY'&gt;&lt;/span&gt; г.&lt;/span&gt;
   &lt;/div&gt;
   &lt;div class='headerForeground'&gt;
      &lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;
      &lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;
      &lt;span class='date'&gt;Cегодня: &lt;span macro='today 0DD.0MM.YYYY'&gt;&lt;/span&gt; г.&lt;/span&gt;
   &lt;/div&gt;
&lt;/div&gt;
&lt;div id=&quot;nav&quot; refresh='content' tiddler='navbar'&gt;&lt;/div&gt;
&lt;div id='main'&gt;
  &lt;div id='mainMenu' refresh='content' tiddler='MainMenu'&gt;&lt;/div&gt;
  &lt;div id='sidebar'&gt;
     &lt;div id='sidebarOptions' refresh='content' tiddler='SideBarOptions'&gt;&lt;/div&gt;
     &lt;div id='sidebarTabs' refresh='content' force='true' tiddler='SideBarTabs'&gt;&lt;/div&gt;
  &lt;/div&gt;
  &lt;div id='mainContent'&gt;
    &lt;div id='displayArea'&gt;
      &lt;div id='messageArea'&gt;&lt;/div&gt;
      &lt;div id='tiddlerDisplay'&gt;&lt;/div&gt;
    &lt;/div&gt;
    &lt;div class='clearfix'&gt;&amp;nbsp;&lt;/div&gt;
    &lt;!-- IE Column Clearing --&gt;
    &lt;div id=&quot;ie_clearing&quot;&gt; &amp;#160; &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;div id='footer' refresh='content' tiddler='FooterContent'&gt;&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="Postfix antispam при помощи RBL (DNSBL) и штатных средств" modifier="Яковлев Иван" created="200906052351" tags="Postfix Статьи TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/postfix-antispam-pri-pomoshhi-rbl-dnsbl-i-shtatnyx-sredstv.html#more-135]]



</pre>
</div>
<div title="RuStyle - русский перевод интерфейса" modifier="Яковлев Иван" created="200904061404" modified="200906031307" tags="systemConfig [[TiddlyWikiDev-Plugins - Плагины]]" changecount="2">
<pre>/***
!Основной способ
''Установить ~TiddlyWiki''
# Cкачать файл ~TiddlyWiki с [[официального сайта|http://www.tiddlywiki.com/ ]] (обратите внимание -- чтобы все работало, нужно скачивать файл, щелкнув правой клавишей мыши по ссылка (на Маке -- Ctrl+мышь) и выбрать из появившегося меню &quot;save target as&quot;
# Открыть файл в совместимом браузере (Explorer я не пробовал, и вам не советую. Firefox, Opera, Safari (последние выпуски), Camino)
# Убедится, что все работает, изменения сохраняются и пр.
''Собственно, русифицировать''
# Нажать ссылку &quot;options&quot; в правом меню.
# В выехавшей панели нажать ~ImportTiddlers
# В панели импорта ввести в верхнее поле адрес http://glebsite.ru/tw/
# Нажать ''fetch''
# Через какое-то время вы увидите список всех записей моей инсталляции. Выбитайте из списка RuStyle, поставив напротив нее галку, жмите кнопку, дождитесь сообщения об удачной загрузке.
# Сохраните изменения и перезагрузите wiki (Shift+reload)
# Интерфейс русифицировался!
# Теперь можно импортировать записи из вашего старого файла, если он у вас был.

! Альтернативный способ
(предполагаю, что ~TiddlyWiki вы уже скачали, и прочли про [[основной способ|Как руссифицировать интерфейс]])
# Выделите и скопируйте в буфер обмена весь текст приведенный ниже в желтом поле
# Создайте новую запись (new Tiddler) в //своей инсталляции ~TiddlyWiki//
#  Перейдите в режим редактирования, и вставьте в нее ранее скопированное.
# Назовите запись ~RuStyle, добавьте метку (tag) systemConfig
# Сохраните запись, сохраните изменения, перезагрузите ~TiddlyWiki
Все!!! Теперь ваш интерфейс руссифицирован.

|''Name:''|RuStyle|
|''Description:''|TW russianization|
|''Version:''|0.6.0|
|''Date:''|2006|
|''Source:''|http://www.glebsite.ru|
|''Author:''|Глеб Тржемецкий (Gleb Trzhemetski)|
|''License:''|BSD open source license|
|''CoreVersion:''|2.1.0|
|''Browser:''|Firefox 1.0.4+; Firefox 1.5; InternetExplorer 6.0|
***/

/*{{{*/
merge(config.messages,{
	customConfigError: &quot;Возникли проблемы при загрузке плагинов. См. PluginManager &quot;,
	pluginError: &quot;Ошибка: %0&quot;,
	pluginDisabled: &quot;Не задействован, так как помечен 'systemConfigDisable' &quot;,
	pluginForced: &quot;Задействован, так как помечен 'systemConfigForce' &quot;,
	pluginVersionError: &quot;Не задействован из-за несоответствия версий&quot;,
	nothingSelected: &quot;Ничего не выбрано.&quot;,
	savedSnapshotError: &quot;Похоже, эта wiki была неправильно сохранена. См. http://www.tiddlywiki.com/#DownloadSoftware &quot;,
	subtitleUnknown: &quot;(неизвестно)&quot;,
	undefinedTiddlerToolTip: &quot;Записи '%0' не существует&quot;,
	shadowedTiddlerToolTip: &quot;Запись '%0' заполнена по умолчанию.&quot;,
	tiddlerLinkTooltip: &quot;%0 - %1, %2&quot;,
	externalLinkTooltip: &quot;Ссылка: %0&quot;,
	noTags: &quot;Нет помеченных записей&quot;,
	notFileUrlError: &quot;Сохраните TiddlyWiki в файл, чтобы иметь возможность сохранять изменения &quot;,
	cantSaveError: &quot;Сохранение невозможно. Либо ваш браузер не подерживает эту функцию (используйте по возможности FireFox), либо путь к файлу содержит недопустимые символы&quot;,
	invalidFileError: &quot;Файл '%0' не похож на файл TiddlyWiki&quot;,
	backupSaved: &quot;Резервная копия сохранена&quot;,
	backupFailed: &quot;Не получилось сохранить резервную копию&quot;,
	rssSaved: &quot;RSS сохранен&quot;,
	rssFailed: &quot;Не получилось сохранить RSS&quot;,
	emptySaved: &quot;Пустой шаблон сохранен&quot;,
	emptyFailed: &quot;Не получилось сохранить пустой шаблон&quot;,
	mainSaved: &quot;Файл TiddlyWiki сохранен&quot;,
	mainFailed: &quot;Не получилось сохранить файл TiddlyWiki. Изменения не сохранены&quot;,
	macroError: &quot;Ошибка в сценарии &lt;&lt;%0&gt;&gt;&quot;,
	macroErrorDetails: &quot;Ошибка при выполнении сценария  &lt;&lt;%0&gt;&gt;:\n%1&quot;,
	missingMacro: &quot;Нет такого сценария&quot;,
	overwriteWarning: &quot;Запись '%0' уже есть. Нажмите OK, чтобы перезаписать&quot;,
	unsavedChangesWarning: &quot;ВНИМАНИЕ! Есть несохраненные изменения! \n\nНажмите OK, чтобы сохранить\nНажмите CANCEL чтобы не сохранять&quot;,
	confirmExit: &quot;--------------------------------\n\nИзменения в TiddlyWiki не сохранены. Если вы продолжите, они потеряются.\n\n--------------------------------&quot;,
	saveInstructions: &quot;SaveChanges&quot;,
	unsupportedTWFormat: &quot;Неподдерживаемый TiddlyWiki формат '%0'&quot;,
	tiddlerSaveError: &quot;Ошибка при сохранении записи '%0'&quot;,
	tiddlerLoadError: &quot;Ошибка при открытии записи '%0'&quot;,
	wrongSaveFormat: &quot;Не получается сохранить в формате '%0'. Сохранено в стандартном формате.&quot;,
	invalidFieldName: &quot;Недопустимое имя поля %0&quot;,
	fieldCannotBeChanged: &quot;Поле '%0' нельзя изменять&quot;});

merge(config.messages.messageClose,{
	text: &quot;×&quot;,
	tooltip: &quot;скрыть сообщение&quot;});

config.messages.dates.months = [&quot;января&quot;, &quot;февраля&quot;, &quot;марта&quot;, &quot;апреля&quot;, &quot;мая&quot;, &quot;июня&quot;, &quot;июля&quot;, &quot;августа&quot;, &quot;сентября&quot;, &quot;октября&quot;, &quot;ноября&quot;,&quot;декабря&quot;];
config.messages.dates.days = [&quot;Воскресенье&quot;, &quot;Понедельник&quot;, &quot;Вторник&quot;, &quot;Среда&quot;, &quot;Четверг&quot;, &quot;Пятница&quot;, &quot;Суббота&quot;];
config.messages.dates.shortMonths = [&quot;Января&quot;, &quot;Февраля&quot;, &quot;Марта&quot;, &quot;Апреля&quot;, &quot;Мая&quot;, &quot;Июня&quot;, &quot;Июля&quot;, &quot;Августа&quot;, &quot;Сентября&quot;, &quot;Октября&quot;, &quot;Ноября&quot;, &quot;Декабря&quot;];
config.messages.dates.shortDays = [&quot;Вс.&quot;, &quot;Пн.&quot;, &quot;Вт.&quot;, &quot;Ср.&quot;, &quot;Чт.&quot;, &quot;Пт.&quot;, &quot;Сб.&quot;];

merge(config.views.wikified.tag,{
	labelNoTags: &quot;меток нет&quot;,
	labelTags: &quot;категории (метки): &quot;,
	openTag: &quot;Открыть метку '%0'&quot;,
	tooltip: &quot;Показать записи, помеченные как '%0'&quot;,
	openAllText: &quot;Открыть все&quot;,
	openAllTooltip: &quot;Открыть все эти записи&quot;,
	popupNone: &quot;Нет других записей с меткой '%0'&quot;});

merge(config.views.wikified,{
	defaultText: &quot;Записи '%0' не существует. Создайте ее двойным щелчком.&quot;,
	defaultModifier: &quot;(?)&quot;,
	shadowModifier: &quot;(системная запись)&quot;,
	createdPrompt: &quot;создана: &quot;});

merge(config.views.editor,{
	tagPrompt: &quot;Введите метки, разделенные пробелами, [[используйте квадратные скобки]] если нужно, или выберите метки из списка.&quot;,
	defaultText: &quot;Здесь мог бы быть осмысленный текст на тему '%0'&quot;});

merge(config.views.editor.tagChooser,{
	text: &quot;метки&quot;,
	tooltip: &quot;Выберите метки из списка&quot;,
	popupNone: &quot;Меток пока нет&quot;,
	tagTooltip: &quot;Добавить метку '%0'&quot;});

merge(config.macros.search,{
	label: &quot;поиск&quot;,
	prompt: &quot;Поиск по всем записям&quot;,
	accessKey: &quot;F&quot;,
	successMsg: &quot;%0 записей, соответствующих критерию: %1&quot;,
	failureMsg: &quot;Не найдено записей по запросу: %0&quot;});

merge(config.macros.tagging,{
	label: &quot;связанные с этой записи: &quot;,
	labelNotTag: &quot;нету&quot;,
	tooltip: &quot;Список записей, помеченных: '%0'&quot;});

merge(config.macros.timeline,{
	dateFormat: &quot;DD.mmm.YYYY&quot;});

merge(config.macros.allTags,{
	tooltip: &quot;Показать записи, помеченные '%0'&quot;,
	noTags: &quot;Нет таких записей&quot;});

config.macros.list.all.prompt = &quot;Все записи по алфавиту&quot;;
config.macros.list.missing.prompt = &quot;Ненаписанные&quot;;
config.macros.list.orphans.prompt = &quot;Записи, на которые нет ссылок&quot;;
config.macros.list.shadowed.prompt = &quot;Системные записи&quot;;

merge(config.macros.closeAll,{
	label: &quot;закрыть все&quot;,
	prompt: &quot;Закрыть все записи \(кроме редактируемых\)&quot;});

merge(config.macros.permaview,{
	label: &quot;ссылка&quot;,
	prompt: &quot;Постоянная ссылка&quot;});

merge(config.macros.saveChanges,{
	label: &quot;сохранить изменения&quot;,
	prompt: &quot;Сохранить всё&quot;,
	accessKey: &quot;S&quot;});

merge(config.macros.newTiddler,{
	label: &quot;новая запись&quot;,
	prompt: &quot;Создать новую запись&quot;,
	title: &quot;Новая запись&quot;,
	accessKey: &quot;N&quot;});

merge(config.macros.newJournal,{
	label: &quot;новая датированная запись&quot;,
	prompt: &quot;Создать запись, с названием, соответствующим текущей дате&quot;,
	accessKey: &quot;J&quot;});

merge(config.macros.plugins,{
	skippedText: &quot;(Этот плагин не запущен, так как был добавлен после запуска)&quot;,
	noPluginText: &quot;Плагинов нет&quot;,
	confirmDeleteText: &quot;Вы действительно хотите удалить записи:\n\n%0&quot;,
/******************************************************** МОЕ ДОПОЛНЕНИЕ К ПЕРЕВОДУ **************************************************/
        wizardTitle: &quot;Управление дополнениями&quot;,
	step1Title: &quot;Загруженные дополнения&quot;,
	removeLabel: &quot;удалить системную метку&quot;,
	removePrompt: &quot;Удалить системную метку&quot;,
	deleteLabel: &quot;удалить&quot;,
	deletePrompt: &quot;Удалить эти записи окончательно&quot;,
/******************************************************************************************************************************************************/
	listViewTemplate : {
		columns: [
			{name: 'Selected', field: 'Selected', rowName: 'title', type: 'Selector'},
			{name: 'Title', field: 'title', tiddlerLink: 'title', title: &quot;Заголовок&quot;, type: 'TiddlerLink'},
			{name: 'Forced', field: 'forced', title: &quot;Принудительно&quot;, tag: 'systemConfigForce', type: 'TagCheckbox'},
			{name: 'Disabled', field: 'disabled', title: &quot;Отключено&quot;, tag: 'systemConfigDisable', type: 'TagCheckbox'},
			{name: 'Executed', field: 'executed', title: &quot;Загружено&quot;, type: 'Boolean', trueText: &quot;Да&quot;, falseText: &quot;Нет&quot;},
			{name: 'Error', field: 'error', title: &quot;Статус&quot;, type: 'Boolean', trueText: &quot;Ошибка&quot;, falseText: &quot;OK&quot;},
			{name: 'Log', field: 'log', title: &quot;Лог&quot;, type: 'StringList'}
			],
		rowClasses: [
			{className: 'error', field: 'error'},
			{className: 'warning', field: 'warning'}
			],
		actions: [
			{caption: &quot;Действия...&quot;, name: ''},
			{caption: &quot;Сделать не системной записью&quot;, name: 'remove'},
			{caption: &quot;Удалить из wiki&quot;, name: 'delete'}
			]}
	});

merge(config.macros.refreshDisplay,{
	label: &quot;обновить&quot;,
	prompt: &quot;Обновить отображение&quot;
	});

merge(config.macros.importTiddlers,{
	defaultPath: &quot;http://www.tiddlywiki.com/index.html&quot;,
	fetchLabel: &quot;загрузить&quot;,
	fetchPrompt: &quot;Загрузить файл TiddlyWiki&quot;,
	fetchError: &quot;Ошибка при загрузке файла&quot;,
	confirmOverwriteText: &quot;Вы уверены, что хотите перезаписать следующие записи:\n\n%0&quot;,
	wizardTitle: &quot;Импорт записей из файла TiddlyWiki&quot;,
	step1: &quot;Шаг 1: Введите путь к файлу&quot;,
	step1prompt: &quot;Введите URL или путь к локальному файлу: &quot;,
	step1promptFile: &quot;...или выберите тут: &quot;,
	step1promptFeeds: &quot;...или из предустановленных: &quot;,
	step1feedPrompt: &quot;Выберите...&quot;,
	step2: &quot;Шаг 2: Загрузка файла&quot;,
	step2Text: &quot;Дождитесь окончания загрузки: %0&quot;,
	step3: &quot;Шаг 3: Выберите записи для импорта:&quot;,
	step4: &quot;%0 записей импортировано&quot;,
	step5: &quot;Готово!&quot;,
	listViewTemplate: {
		columns: [
			{name: 'Selected', field: 'Selected', rowName: 'title', type: 'Selector'},
			{name: 'Title', field: 'title', title: &quot;Title&quot;, type: 'String'},
			{name: 'Snippet', field: 'text', title: &quot;Snippet&quot;, type: 'String'},
			{name: 'Tags', field: 'tags', title: &quot;Tags&quot;, type: 'Tags'}
			],
		rowClasses: [
			],
		actions: [
			{caption: &quot;Действия...&quot;, name: ''},
			{caption: &quot;Импортировать&quot;, name: 'import'}
			]}
	});

merge(config.commands.closeTiddler,{
	text: &quot;закрыть&quot;,
	tooltip: &quot;Закрыть эту статью&quot;});

merge(config.commands.closeOthers,{
	text: &quot;закрыть остальные&quot;,
	tooltip: &quot;Закрыть все записи, кроме этой&quot;});

merge(config.commands.editTiddler,{
	text: &quot;редактировать&quot;,
	tooltip: &quot;Редактировать запись&quot;,
	readOnlyText: &quot;исходный код&quot;,
	readOnlyTooltip: &quot;Просмотреть исходный код записи&quot;});

merge(config.commands.saveTiddler,{
	text: &quot;готово&quot;,
	tooltip: &quot;Сохранить изменения&quot;});

merge(config.commands.cancelTiddler,{
	text: &quot;отменить&quot;,
	tooltip: &quot;Отменить изменения&quot;,
	warning: &quot;Вы уверены, что не хотите сохранить запись '%0'?&quot;,
	readOnlyText: &quot;обычный вид&quot;,
	readOnlyTooltip: &quot;Вернуться к обычному просмотру&quot;});

merge(config.commands.deleteTiddler,{
	text: &quot;удалить&quot;,
	tooltip: &quot;Удалить запись&quot;,
	warning: &quot;Вы действительно хотите удалить '%0'?&quot;});

merge(config.commands.permalink,{
	text: &quot;ссылка&quot;,
	tooltip: &quot;Постоянная ссылка на эту запись&quot;});

merge(config.commands.references,{
	text: &quot;ссылки сюда&quot;,
	tooltip: &quot;Показать записи, ссылающиеся на эту&quot;,
	popupNone: &quot;Ссылок нет&quot;});

merge(config.commands.jump,{
	text: &quot;перейти к ...&quot;,
	tooltip: &quot;Перейти к другим открытым статьям&quot;});

merge(config.shadowTiddlers,{
	DefaultTiddlers: &quot;GettingStarted&quot;,
	MainMenu: &quot;GettingStarted&quot;,
	SiteTitle: &quot;~TiddlyWiki(ru)&quot;,
	SiteSubtitle: &quot;нелинейный гипертекстовый органайзер&quot;,
	SiteUrl: &quot;http://www.tiddlywiki.com/&quot;,
	GettingStarted: &quot;Для того, чтобы начать работать с TiddlyWiki, вы можете поменять следующие записи:\n* SiteTitle &amp; SiteSubtitle: Заголовок и подзаголовок сайта (после сохранения вы увидите их в заголовке окна)\n* MainMenu: Меню (оно обычно слева)\n* DefaultTiddlers: Список записей, которые будут открыты при запуске wiki.\nИмя, которым будут подписаны ваши записи, можете ввести тут: &lt;&lt;option txtUserName&gt;&gt;&quot;,
	SideBarOptions: &quot;&lt;&lt;search&gt;&gt;&lt;&lt;closeAll&gt;&gt;&lt;&lt;permaview&gt;&gt;&lt;&lt;newTiddler&gt;&gt;&lt;&lt;newJournal 'DD MMM YYYY г.'&gt;&gt;&lt;&lt;saveChanges&gt;&gt;&lt;&lt;slider chkSliderOptionsPanel OptionsPanel 'установки »' 'Различные опции TidlyWiki'&gt;&gt;&quot;,
	OptionsPanel: &quot;Эти установки сохраняются в&amp;nbsp\;Вашем браузере\n\nВаше имя для подписывания заметок. Лучше, если вы напишете его WotTak\n\n&lt;&lt;option txtUserName&gt;&gt;\n&lt;&lt;option chkSaveBackups&gt;&gt; Сохранять резервные копии\n&lt;&lt;option chkAutoSave&gt;&gt; Автосохранение\n&lt;&lt;option chkRegExpSearch&gt;&gt; Поиск с&amp;nbsp\;регулярными выражениями\n&lt;&lt;option chkCaseSensitiveSearch&gt;&gt; Поиск чувствителен к&amp;nbsp\;регистру?\n&lt;&lt;option chkAnimate&gt;&gt; Анимация\n\n----\n[[Дополнительно|AdvancedOptions]]\n[[Плагины|PluginManager]]\n[[Импорт записей|ImportTiddlers]]&quot;,
	AdvancedOptions: &quot;&lt;&lt;option chkGenerateAnRssFeed&gt;&gt; Публиковать RSS\n&lt;&lt;option chkOpenInNewWindow&gt;&gt;  Ссылки в новом окне\n&lt;&lt;option chkSaveEmptyTemplate&gt;&gt; Сохранять пустой шаблон\n&lt;&lt;option chkToggleLinks&gt;&gt; Щелчок по ссылке на открытую заметку закрывает ее\n^^(с Ctrl или другой функциональной клавишей не&amp;nbsp\;будет срабатывать)^^\n&lt;&lt;option chkHttpReadOnly&gt;&gt; Не показывать инструменты редактирования через HTTP\n&lt;&lt;option chkForceMinorUpdate&gt;&gt; Не менять дату заметки при редактировании\n^^(для изменеия - жмите Shift при сохранеии, либо сохраняйте, нажимая Ctrl-Shift-Enter^^\n&lt;&lt;option chkConfirmDelete&gt;&gt; Подтверждать удаление\nМаксимум строк в&amp;nbsp\;поле редактирования: &lt;&lt;option txtMaxEditRows&gt;&gt;\nСохранять бэкапы в&amp;nbsp\;папке: &lt;&lt;option txtBackupFolder&gt;&gt;\n&lt;&lt;option chkInsertTabs&gt;&gt; При нажатии Tab вводить знак табуляции, а&amp;nbsp\;не&amp;nbsp\;переходить к&amp;nbsp\;следующему элементу формы&quot;,
	SideBarTabs: &quot;&lt;&lt;tabs txtMainTab История История TabTimeline Все 'Все заметки' TabAll Метки 'Все метки' TabTags Ещё... 'Остальные списки' TabMore&gt;&gt;&quot;,
	TabTimeline: &quot;&lt;&lt;timeline&gt;&gt;&quot;,
	TabAll: &quot;&lt;&lt;list all&gt;&gt;&quot;,
	TabTags: &quot;&lt;&lt;allTags&gt;&gt;&quot;,
	TabMore: &quot;&lt;&lt;tabs txtMoreTab ЕщеНет 'Ненаписанные заметки' TabMoreMissing НетСсылок 'Забытые заметки' TabMoreOrphans Сист. 'Системные записи' TabMoreShadowed&gt;&gt;&quot;,
	TabMoreMissing: &quot;&lt;&lt;list missing&gt;&gt;&quot;,
	TabMoreOrphans: &quot;&lt;&lt;list orphans&gt;&gt;&quot;,
	TabMoreShadowed: &quot;&lt;&lt;list shadowed&gt;&gt;&quot;,
	PluginManager: &quot;&lt;&lt;plugins&gt;&gt;&quot;,
	ImportTiddlers: &quot;&lt;&lt;importTiddlers&gt;&gt;&quot;});
/*}}}*/

/***
!Мои дополнения к переводу для версии ~TiddlyWiki 2.4.3
|Author: |Yakovlev Ivan Yak1980@list(dot)ru|
|Date:|2009-02-20|
***/
/*{{{*/
merge(config.macros.toolbar,{
	moreLabel: &quot;далее...&quot;,
	morePrompt: &quot;Раскрыть дополнительные команды&quot;
});

merge(config.commands.fields,{
	text: &quot;поля&quot;,
	tooltip: &quot;Показать дополнительные поля для этой записи&quot;,
	emptyText: &quot;Нет дополнительных полей для этой записи&quot;,
	listViewTemplate: {
		columns: [
			{name: 'Field', field: 'field', title: &quot;Field&quot;, type: 'String'},
			{name: 'Value', field: 'value', title: &quot;Value&quot;, type: 'String'}
			],
		rowClasses: [
			],
		buttons: [
]}});

merge(config.commands.syncing,{
	text: &quot;синхр.&quot;,
	tooltip: &quot;Контроль синхронизации этой записи с сервером или внешним файлом&quot;,
	currentlySyncing: &quot;&lt;div&gt;Текущая синхронизация через &lt;span class='popupHighlight'&gt;'%0'&lt;/span&gt; to:&lt;/&quot;+&quot;div&gt;&lt;div&gt;host: &lt;span class='popupHighlight'&gt;%1&lt;/span&gt;&lt;/&quot;+&quot;div&gt;&lt;div&gt;workspace: &lt;span class='popupHighlight'&gt;%2&lt;/span&gt;&lt;/&quot;+&quot;div&gt;&quot;, // Note escaping of closing &lt;div&gt; tag
	notCurrentlySyncing: &quot;Синхронизация пока не задана&quot;,
	captionUnSync: &quot;Остановить синхронизацию этой записи&quot;,
	chooseServer: &quot;Синхронизовать эту запись с другим сервером:&quot;,
	currServerMarker: &quot;\u25cf &quot;,
	notCurrServerMarker: &quot;  &quot;});

config.messages.backstage = {
	open: {text: &quot;доп. настр.&quot;, tooltip: &quot;Открыть панель дополнительных настроек&quot;},
	close: {text: &quot;закрыть&quot;, tooltip: &quot;Закрыть панель дополнительных настроек&quot;},
	prompt: &quot;доп. настройки: &quot;,
	decal: {
		edit: {text: &quot;редактировать&quot;, tooltip: &quot;Редактировать запись '%0'&quot;}
	}
};

merge(config.tasks,{
	save: {text: &quot;сохранить&quot;, tooltip: &quot;Сохранить изменения&quot;, action: saveChanges},
	sync: {text: &quot;синхр.&quot;, tooltip: &quot;Синхронизовать изменения с другими файломи и серверами&quot;, content: '&lt;&lt;sync&gt;&gt;'},
	importTask: {text: &quot;импорт&quot;, tooltip: &quot;Импортировать записи из других файлов или серверов&quot;, content: '&lt;&lt;importTiddlers&gt;&gt;'},
	tweak: {text: &quot;настройка&quot;, tooltip: &quot;Настройка оформления и поведения движка&quot;, content: '&lt;&lt;options&gt;&gt;'},
	upgrade: {text: &quot;обновить&quot;, tooltip: &quot;Обновить ядро движка&quot;, content: '&lt;&lt;upgrade&gt;&gt;'},
	plugins: {text: &quot;дополнения&quot;, tooltip: &quot;Управление установленными дополнениями&quot;, content: '&lt;&lt;plugins&gt;&gt;'}
});

merge(config.macros.options,{
	wizardTitle: &quot;Дополнительная настройка&quot;,
	step1Title: &quot;Эти настройки сохраняются в файлах cookies вашего браузера&quot;,
	step1Html: &quot;&lt;input type='hidden' name='markList'&gt;&lt;/input&gt;&lt;br /&gt;&lt;input type='checkbox' checked='false' name='chkUnknown'&gt;Show unknown options&lt;/input&gt;&quot;,
	unknownDescription: &quot;//(unknown)//&quot;,
	listViewTemplate: {
		columns: [
			{name: 'Option', field: 'option', title: &quot;Option&quot;, type: 'String'},
			{name: 'Description', field: 'description', title: &quot;Description&quot;, type: 'WikiText'},
			{name: 'Name', field: 'name', title: &quot;Name&quot;, type: 'String'}
			],
		rowClasses: [
			{className: 'lowlight', field: 'lowlight'}
			]}
});

merge(config.macros.upgrade,{
	wizardTitle: &quot;Обновление ядра&quot;,
	step1Title: &quot;Обновление или исправление ядра движка до последней версии&quot;,
	step1Html: &quot;Вы пытаетесь обновить ядро движка до последней версии (с сайта &lt;a href='%0' class='externalLink' target='_blank'&gt;%1&lt;/a&gt;). Все ваши данные будут сохранены в процессе обновления.&lt;br /&gt;&lt;br /&gt;Помните, что новая версия ядра может конфликтовать с установленными устаревшими дополнениями. Если после обновления у вас возникнут проблемы, обратитесь за помощью по адресу: &lt;a href='http://www.tiddlywiki.org/wiki/CoreUpgrades' class='externalLink' target='_blank'&gt;http://www.tiddlywiki.org/wiki/CoreUpgrades&lt;/a&gt;&quot;,
	errorCantUpgrade: &quot;Не возможно обновить ядро движка.Вы можете осуществлять обновления только на установленном локально файле&quot;,
	errorNotSaved: &quot;Вы должны сохранить изменения перед началом обновлениея&quot;,
	step2Title: &quot;Подтверждение деталей обновления&quot;,
	step2Html_downgrade: &quot;Вы пытаетесь откатится до версии %0 с версии %1.&lt;br /&gt;&lt;br /&gt;Откат до более поздних версий не рекомендуется&quot;,
	step2Html_restore: &quot;Обновление не требуется. У вас и так новая версия (%0).&lt;br /&gt;&lt;br /&gt;Вы можете продолжить обновление, чтобы быть уверенным, что ядро не повреждено&quot;,
	step2Html_upgrade: &quot;Вы пытаетесь обновится до версии %0 с версии %1&quot;,
	upgradeLabel: &quot;обновить&quot;,
	upgradePrompt: &quot;Подготовка к процессу обновления...&quot;,
	statusPreparingBackup: &quot;Подготовка архивной копии...&quot;,
	statusSavingBackup: &quot;Сохранить архивную копию&quot;,
	errorSavingBackup: &quot;Возникли проблемы при сохранении архивной копии&quot;,
	statusLoadingCore: &quot;Загрузка ядра...&quot;,
	errorLoadingCore: &quot;Ошибка загрузки ядра&quot;,
	errorCoreFormat: &quot;Произошла ошибка с новым ядром движка&quot;,
	statusSavingCore: &quot;Сохранить новое ядро&quot;,
	statusReloadingCore: &quot;Перезагрузить новое ядро&quot;,
	startLabel: &quot;старт&quot;,
	startPrompt: &quot;Начать процесс обновления&quot;,
	cancelLabel: &quot;отмена&quot;,
	cancelPrompt: &quot;Отменить процесс обновления&quot;,
	step3Title: &quot;Обновление отменено&quot;,
	step3Html: &quot;Вы отменили процесс обновления&quot;
});

merge(config.macros.options,{
	wizardTitle: &quot;Дополнительные настройки&quot;,
	step1Title: &quot;Эти настройки сохраняются в файлах cookies вашего браузера. Если вы удалите эти файлы, то настройки будут сброшены&quot;,
	step1Html: &quot;&lt;input type='hidden' name='markList'&gt;&lt;/input&gt;&lt;br /&gt;&lt;input type='checkbox' checked='false' name='chkUnknown'&gt;Показать неизвестные настройки&lt;/input&gt;&quot;,
	unknownDescription: &quot;//(не известно)//&quot;,
	listViewTemplate: {
		columns: [
			{name: 'Option', field: 'option', title: &quot;Настройки&quot;, type: 'String'},
			{name: 'Description', field: 'description', title: &quot;Описание&quot;, type: 'WikiText'},
			{name: 'Name', field: 'name', title: &quot;Имя&quot;, type: 'String'}
			],
		rowClasses: [
			{className: 'lowlight', field: 'lowlight'}
			]}
});

// Options that can be set in the options panel and/or cookies
merge(config.optionsDesc,{
	txtUserName: &quot;Имя пользователя для подписи к вашим записям&quot;,
	chkRegExpSearch: &quot;Разрешить регулярные выражения для поиска&quot;,
	chkCaseSensitiveSearch: &quot;Чувствительный к регистру поиск&quot;,
	chkIncrementalSearch: &quot;Инкрементный поиск шаг-за-шагом&quot;,
	chkAnimate: &quot;Разрешить анимацию&quot;,
	chkSaveBackups: &quot;Сохранять бэкап-файл при сохранении&quot;,
	chkAutoSave: &quot;Автосохранения&quot;,
	chkGenerateAnRssFeed: &quot;Генерировать ленту RSS при сохранении изменений&quot;,
	chkSaveEmptyTemplate: &quot;Генерировать пустой шаблон при сохранении изменений&quot;,
	chkOpenInNewWindow: &quot;Открывать внешние ссылки в новом окне&quot;,
	chkToggleLinks: &quot;Щелчек по ссылке на открытую запись приводит к ее закрытию&quot;,
	chkHttpReadOnly: &quot;Скрывать возможности редактирования при просмотре через протокол HTTP&quot;,
	chkForceMinorUpdate: &quot;Не обновлять имя пользователя и дату при редактировании записи&quot;,
	chkConfirmDelete: &quot;Требовать подтверждения при удалении записи&quot;,
	chkInsertTabs: &quot;Использовать клавишу Tab, чтобы вставить символ табуляции, а не переключаться на следующее поле&quot;,
	txtBackupFolder: &quot;Имя папки где хранятся резервные копии&quot;,
	txtMaxEditRows: &quot;Максимальное количество строк в поле редактирования&quot;,
	txtFileSystemCharSet: &quot;Кодировка по умолчанию для сохраняемых изменений (только для Firefox/Mozilla)&quot;});

merge(config.macros.importTiddlers,{
	readOnlyWarning: &quot;Вы не можете импортировать в помеченный только для чтения файл. Попробуйте открыть его через file:// URL&quot;,
	wizardTitle: &quot;Импорт записей из файла или сервера&quot;,
	step1Title: &quot;Шаг 1: Укажите путь к файлу или серверу&quot;,
	step1Html: &quot;Тип сервера: &lt;select name='selTypes'&gt;&lt;option value=''&gt;Выбор...&lt;/option&gt;&lt;/select&gt;&lt;br /&gt;Введите в поле ввода адрес URL или путь к файлу: &lt;input type='text' size=50 name='txtPath'&gt;&lt;br /&gt;...или используйте: &lt;input type='file' size=50 name='txtBrowse'&gt;&lt;br /&gt;&lt;hr&gt;...или выберите заданный поток: &lt;select name='selFeeds'&gt;&lt;option value=''&gt;Выбор...&lt;/option&gt;&lt;/select&gt;&quot;,
	openLabel: &quot;открыть&quot;,
	openPrompt: &quot;Открыть соединение с файлом или сервером&quot;,
	openError: &quot;Возникли проблемы при получении файла&quot;,
	statusOpenHost: &quot;Открытие хоста&quot;,
	statusGetWorkspaceList: &quot;Получение списка доступных рабочих областей&quot;,
	step2Title: &quot;Шаг 2: Выберите рабочую область&quot;,
	step2Html: &quot;Введите имя рабочей области: &lt;input type='text' size=50 name='txtWorkspace'&gt;&lt;br /&gt;...или выберите рабочую область: &lt;select name='selWorkspace'&gt;&lt;option value=''&gt;Выбор...&lt;/option&gt;&lt;/select&gt;&quot;,
	cancelLabel: &quot;отмена&quot;,
	cancelPrompt: &quot;Отменит импорт&quot;,
	statusOpenWorkspace: &quot;Открытие рабочей области&quot;,
	statusGetTiddlerList: &quot;Получение списка доступных записей&quot;,
	errorGettingTiddlerList: &quot;Ошибка при получении списка записей, нажмите Отмена для повтора&quot;,
	step3Title: &quot;Шаг 3: Выберите записи для импорта&quot;,
	step3Html: &quot;&lt;input type='hidden' name='markList'&gt;&lt;/input&gt;&lt;br /&gt;&lt;input type='checkbox' checked='true' name='chkSync'&gt;Связать эти записи с сервером для автоматической синхронизации изменений&lt;/input&gt;&lt;br /&gt;&lt;input type='checkbox' name='chkSave'&gt;Сохранить детали сервера в системной записи 'systemServer' :&lt;/input&gt; &lt;input type='text' size=25 name='txtSaveTiddler'&gt;&quot;,
	importLabel: &quot;импорт&quot;,
	importPrompt: &quot;Импорт выбранных записей&quot;,
	confirmOverwriteText: &quot;Вы уверены, что хотите перезаписать следующие записи:\n\n%0&quot;,
	step4Title: &quot;Шаг 4: Ипорт %0 &quot;,
	step4Html: &quot;&lt;input type='hidden' name='markReport'&gt;&lt;/input&gt;&quot;, // DO NOT TRANSLATE
	doneLabel: &quot;завершить&quot;,
	donePrompt: &quot;Закрыть это окно&quot;,
	statusDoingImport: &quot;Импорт записей...&quot;,
	statusDoneImport: &quot;Все записи импортированы&quot;,
	systemServerNamePattern: &quot;%2 on %1&quot;,
	systemServerNamePatternNoWorkspace: &quot;%1&quot;,
	confirmOverwriteSaveTiddler: &quot;Запись '%0' уже существует. Нажмите 'OK' для перезаписи, или 'Cancel' для отмены&quot;,
	serverSaveTemplate: &quot;|''Type:''|%0|\n|''URL:''|%1|\n|''Workspace:''|%2|\n\nЭта запись была создана автоматически для записи настроек сервера&quot;,
	serverSaveModifier: &quot;(System)&quot;,
	listViewTemplate: {
		columns: [
			{name: 'Selected', field: 'Selected', rowName: 'title', type: 'Selector'},
			{name: 'Tiddler', field: 'tiddler', title: &quot;Название&quot;, type: 'Tiddler'},
			{name: 'Size', field: 'size', tiddlerLink: 'size', title: &quot;Размер&quot;, type: 'Size'},
			{name: 'Tags', field: 'tags', title: &quot;Метки&quot;, type: 'Tags'}
			],
		rowClasses: [
			]}
});

merge(config.macros.sync,{
	listViewTemplate: {
		columns: [
			{name: 'Selected', field: 'selected', rowName: 'title', type: 'Selector'},
			{name: 'Tiddler', field: 'tiddler', title: &quot;Название&quot;, type: 'Tiddler'},
			{name: 'Server Type', field: 'serverType', title: &quot;Тип сервера&quot;, type: 'String'},
			{name: 'Server Host', field: 'serverHost', title: &quot;Хост сервера&quot;, type: 'String'},
			{name: 'Server Workspace', field: 'serverWorkspace', title: &quot;Рабочая область сервера&quot;, type: 'String'},
			{name: 'Status', field: 'status', title: &quot;Статус синхр.&quot;, type: 'String'},
			{name: 'Server URL', field: 'serverUrl', title: &quot;URL сервера&quot;, text: &quot;View&quot;, type: 'Link'}
			],
		rowClasses: [
			],
		buttons: [
			{caption: &quot;Синхронизовать эти записи&quot;, name: 'sync'}
			]},
	wizardTitle: &quot;Синхронизация с внешним сервером или файлом&quot;,
	step1Title: &quot;Выберите записи, которые нужно синхронизовать&quot;,
	step1Html: &quot;&lt;input type='hidden' name='markList'&gt;&lt;/input&gt;&quot;, // DO NOT TRANSLATE
	syncLabel: &quot;синхр.&quot;,
	syncPrompt: &quot;Синхронизация этих записей&quot;,
	hasChanged: &quot;Изменены с момента отключения&quot;,
	hasNotChanged: &quot;Не изменены с момента отключения&quot;,
	syncStatusList: {
		none: {text: &quot;...&quot;, display:null, className:'notChanged'},
		changedServer: {text: &quot;Changed on server&quot;, display:null, className:'changedServer'},
		changedLocally: {text: &quot;Changed while unplugged&quot;, display:null, className:'changedLocally'},
		changedBoth: {text: &quot;Changed while unplugged and on server&quot;, display:null, className:'changedBoth'},
		notFound: {text: &quot;Not found on server&quot;, display:null, className:'notFound'},
		putToServer: {text: &quot;Saved update on server&quot;, display:null, className:'putToServer'},
		gotFromServer: {text: &quot;Retrieved update from server&quot;, display:null, className:'gotFromServer'}
		}
});

/*}}}*/


</pre>
</div>
<div title="SSH - работа с PuTTY" modifier="Яковлев Иван" created="200906061115" modified="200906151042" tags="[[Удаленное подключение]] SSH PuTTY" changecount="9">
<pre>!Описание
Данное руководство описывает, как сгенерировать и использовать пару ключей (открытый/закрытый) для ~SSH-подключения к удалённой системе с помощью Putty. Putty - это SSH клиент, доступны версии для Windows и Linux (хотя более распространена версия для Windows систем). Применяя основанную на ключах SSH процедуру соединения, Вы можете отключить обычную процедуру (использующую имя/пароль), это будет означать, что только люди, обладающие правильной парой ключей, смогут осуществить соединение. Таким образом, система становится более надёжной, благодаря невозможности проведения успешной атаки с помощью прямого перебора паролей.

В этом описании используется компьютер с установленной Windows для подключения к SSH серверу Linux.

!Установка ~PuTTY, ~PuTTYgen и Pageant в системе Windows
Прежде всего мы должны установить ~PuTTY, ~PuTTYgen и Pageant в нашей системе Windows. Всё, что мы должны сделать, это скачать установочный файл (''.exe'') со страницы загрузки ~PuTTY и запустить его. В качестве папки, куда будет установлена программа, можно указать, например, &quot;{{{C:\putty}}}&quot;. Чтобы запустить инсталлированные приложения, их достаточно дважды кликнуть.

{{textAlignCenter{
[img[images/articles/putty01.png]]
}}}

!Создание профиля с настройками для нашего удалённого сервера
В ~PuTTY Вы можете создавать профили для различных SSH серверов, так что Вам не придётся вбивать настройки для конкретного сервера, когда Вы захотите к нему очередной раз подсоединиться.
Давайте создадим профиль для нашего сервера. Запустите ~PuTTY двойным щелчком на исполняемом файле. Сейчас Вы находитесь в категории Sessions (см. дерево слева на скриншоте). Введите 81.195.XXX.XXX в строку Host Name (or IP adress) (имя хоста или IP адрес) (здесь и далее часть IP скрыта по этическим причинам), введите Port (номер порта) 22 и выберите Protocol (протокол) SSH:

{{textAlignCenter{
[img[images/articles/putty02.png]]
}}}
Затем идите в категорию Connection -&gt; Data и укажите в ~Auto-login username имя пользователя, под которым Вы хотите подключаться к SSH серверу. В этой статье используется имя vasily:

{{textAlignCenter{
[img[images/articles/putty03.png]]
}}}
Затем снова идите в категорию Sessions. Под надписью Saved Sessions (сохранённые сессии) введите имя профиля, например, session1 или любую другую запись, которая поможет Вам вспомнить, к какому серверу относится этот профиль. Кликните на Save:

{{textAlignCenter{
[img[images/articles/putty04.png]]
}}}
В следующий раз, когда Вы запустите ~PuTTY, просто выберите подходящий профиль из Saved Sessions, кликните Load и Open.

!Соединение с сервером SSH
Теперь мы можем подсоединиться к нашему SSH серверу, просто кликнув Open.

{{textAlignCenter{
[img[images/articles/putty05.png]]
}}}
Если Вы соединяетесь с сервером в первый раз, всплывёт предупреждение об угрозе безопасности. Это происходит потому, что ~PuTTY ещё не известен ключ хоста сервера, можно смело кликать Yes. (Если это происходит позже снова, это может означать, что другой сервер запущен с тем же IP адресом, или что кто-то взломал сервер и изменил ключ).


{{textAlignCenter{
[img[images/articles/putty06.png]]
}}}
Мы сохранили имя, под которым соединяемся, в настройках профиля, поэтому нам не нужно вбивать его снова, мы только укажем пароль пользователя:


{{textAlignCenter{
[img[images/articles/putty07.png]]
}}}
Итак, это был &quot;обычный&quot; способ соединения, то есть, с парольной идентификацией. Если кто-нибудь узнает имя и пароль, он тоже сможет соединиться. Поэтому если у Вас простой пароль и/или Вы стали жертвой атаки с прямым перебором, могут быть проблемы. Давайте сейчас исправим это.

!Изготовление пары закрытого и открытого ключей
Мы можем использовать ~PuTTYgen для изготовления пары закрытого и открытого ключей. Запустите генератор двойным кликом на исполняемом файле. Убедитесь, что Вы выбрали ''~SSH-2 DSA'' под Type of key to generate: (Тип генерируемого ключа) и ввели 2048 в Number of bits in a generated key (Число бит в генерируемом ключе). (Автор статьи-оригинала рекомендует использовать ''~SSH-2 RSA'' и 1024). Затем кликните на Generate:

{{textAlignCenter{
[img[images/articles/putty08.png]]
}}}
Пожалуйста, подвигайте указатель мыши над незанятой областью окна во время генерации ключа для введения в процесс элемента случайности.

{{textAlignCenter{
[img[images/articles/putty09.png]]
}}}
Теперь пара закрытого и открытого ключей сгенерирована. Под Key comment: Вы можете ввести комментарий (обычно здесь пишут свой e-mail адрес). Затем вписывают Key passphrase (парольная фраза) и повторяют её под Confirm passphrase:. Вам понадобится эта парольная фраза для подсоединения к SSH с Вашим новым ключём. Затем кликните Save public key (Сохранить открытый ключ) и сохраните его в безопасном месте на Вашем компьютере. Вы вольны выбрать любое имя и расширение, но оно должно быть таким, чтобы вы помнили, к какой системе этот ключ.

{{textAlignCenter{
[img[images/articles/putty10.png]]
}}}
{{textAlignCenter{
[img[images/articles/putty11.png]]
}}}
Затем кликните на Save private key (Сохранить закрытый ключ). Вы можете сохранить его там же, где и открытый ключ, только Вы должны иметь к нему доступ, позаботьтесь о его сохранности! (Если вы утеряете ключи и отмените подключение по способу имя/пароль, Вы будете более неспособны подключиться!). Вы так же свободны в выборе имени файла, но на этот раз расширение будет ''.ppk''.

{{textAlignCenter{
[img[images/articles/putty12.png]]
}}}
{{textAlignCenter{
[img[images/articles/putty13.png]]
}}}
Затем скопируйте открытый ключ из окна ~PuTTYgen:

{{textAlignCenter{
[img[images/articles/putty14.png]]
}}}

!Сохранение открытого ключа на сервере
Соединитесь с Вашим SSH сервером (если вы уже закрыли предыдущую сессию SSH), пока ещё с помощью имени и пароля, и вставьте открытый ключ в файл {{{~/.ssh/authorized_keys2}}} (в одну линию!) примерно так:
{{{
 mkdir ~/.ssh
 chmod 700 ~/.ssh
 vi ~/.ssh/authorized_keys2
ssh-dss AAAAB3NzaC1kc3MAAAE [. . .] Huw2FekFNM7pMgEQi57k= dsa-key-20061205
}}}
Данный файл должен читаться/правиться только данным пользователем, поэтому мы запускаем:
{{{
chmod 600 ~/.ssh/authorized_keys2
}}}

!Прикрепление закрытого ключа к профилю ~PuTTY
Теперь снова запустите ~PuTTY и загрузите профиль Вашего SSH сервера (session1).

{{textAlignCenter{
[img[images/articles/putty15.png]]
}}}
Затем идите в категорию SSH, далее Auth и кликайте Browse:

{{textAlignCenter{
[img[images/articles/putty16.png]]
}}}
Найдите в вашей системе и выберите созданный ранее закрытый ключ:

{{textAlignCenter{
[img[images/articles/putty17.png]]
}}}
{{textAlignCenter{
[img[images/articles/putty18.png]]
}}}
Затем снова идите в категорию Session и кликайте на Save:

{{textAlignCenter{
[img[images/articles/putty19.png]]
}}}
Теперь наш закрытый ключ присоединён к профилю ~PuTTY session1.

!Наше первое подключение, основанное на ключе
Теперь всё готово для первого подключения к SSH серверу с помощью ключа. Кликните на Open:

{{textAlignCenter{
[img[images/articles/putty20.png]]
}}}
Как Вы видите, открытый ключ теперь используется для идентификации, и у Вас запрашивается парольная фраза (та, которая была создана в пункте 5):

{{textAlignCenter{
[img[images/articles/putty21.png]]
}}}

!Отключение парольной идентификации
Теперь можно подсоединиться к серверу, используя пару ключей (открытый/закрытый), и всё ещё есть возможность соединения с помощью имени и пароля, поэтому, если не прикрепить закрытый ключ к своей сессии ~PuTTY, будет предложено ввести имя и пароль. Поэтому, для достижения большей защищённости, мы должны отключить возможность соединения имя/пароль. (Вы должны сделать это только когда полностью уверены, что подключение с помощью ключа работает, в противном случае у Вас будут проблемы...)

Для отключения возможности соединения через имя/пароль, мы должны внести изменения в конфигурационный файл sshd. В системах Debian/Ubuntu это {{{/etc/ssh/sshd_config}}}. Вы должны выбрать Protokol 2 (1 ненадёжен и не должен использоваться!), ~PasswordAuthentication установить в {{{no}}}', и для ~UsePAM также выбрать {{{no}}} (или закомментировать строку ~UsePAM), например, так:
{{{
vi /etc/ssh/sshd_config
 [...]
 Protocol 2
 PasswordAuthentication no
 UsePAM no
 [...]
}}}
Затем перезапустите sshd: 
{{{
/etc/init.d/ssh restart
}}}
Теперь, если Вы откроете сессию ~PuTTY без присоединённого закрытого ключа, Вы больше не способны будете соединиться.

!Запоминание парольной фразы с помощью Pageant
Теперь, всякий раз, когда Вы используете подключение с помощью ключа, Вам требуется вписывать Вашу парольную фразу. Это может раздражать, если Вы соединяетесь с SSH сервером много раз за день. К счастью, Вы можете сообщить парольную фразу программе Pageant, который будет подставлять её всякий раз, когда Вы соединяетесь с SSH сервером. 
Запустите Pageant двойным кликом на исполняемом файле, после этого Вы увидите запущенный Pageant в таскбаре.
Двойной клик по иконке Pageant в таскбаре открывает окно, приведённое ниже. Кликните клавишу Add Key (Добавить ключ):

{{textAlignCenter{
[img[images/articles/putty24.png]]
}}}
Найдите в вашей файловой системе закрытый ключ и выберите его:

{{textAlignCenter{
[img[images/articles/putty25.png]]
}}}
Введите парольную фразу для закрытого ключа:

{{textAlignCenter{
[img[images/articles/putty26.png]]
}}}
Теперь ключ внесён в список ключей Pageant. Кликнете на Close (Закрыть):

{{textAlignCenter{
[img[images/articles/putty27.png]]
}}}
Пока Pageant запущен, Вы можете соединяться с SSH сервером без ввода парольной фразы, это делает Pageant:

{{textAlignCenter{
[img[images/articles/putty28.png]]
}}}
Когда Вы остановите Pageant, он забудет все ключи, поэтому, в следующий раз, при запуске Pageant Вам придётся снова добавить ключи. Это так же может раздражать, но можно создать на Рабочем столе ярлык к исполняемому файлу Pageant.

Теперь найдите созданный ярлык. Кликните правой кнопкой на нём и выберите Properties (Свойства).

Под надписью Target (Объект) Вы найдёте путь к ''pageant.exe'', например &quot;{{{C:\putty\pageant.exe}}}&quot; (если в пути нет пробелов, в кавычках нет необходимости). Теперь Вы можете просто добавить путь к Вашему закрытому ключу в эту строку. Например, если Ваш ключ {{{C:\putty\my_keys\private_session1.ppk}}}, то строка должна выглядеть так:
{{{
C:\putty\pageant.exe C:\putty\my_keys\private_session1.ppk
}}}
(если в пути к закрытому ключу есть пробелы, Вы должны заключит его в кавычки, например, так:
{{{
&quot;C:\putty files\pageant.exe&quot; &quot;C:\putty files\my_keys\private_session1.ppk&quot;
}}}
Затем нажмитена OK.

{{textAlignCenter{
[img[images/articles/putty31.png]]
}}}
Теперь, когда вы дважды кликаете ярлык Pageant, Pageant будет автоматически загружать Ваш закрытый ключ и спрашивать парольную фразу. Введите её, и на этом всё.

!См. также
*[[OpenSSH сервер]]
*[[Удаленное подключение к рабочему столу Linux из Windows с помощью Xming и SSH]]

!Ссылки
*[[Оригинал статьи|http://www.ossg.ru/wiki/Admin/SSH%20-%20работа%20с%20PuTTY]]



</pre>
</div>
<div title="SSL и сертификаты" modifier="Яковлев Иван" created="200906191234" modified="200906191419" tags="Безопасность slider MainMenu" changecount="2">
<pre>#[[СозданиеSSLсертификатов|Создание SSL сертификатов для связки Apache и mod_ssl]]
#[[Сертификаты безопасности]]
#[[Настройка ssl в nginx|Настройка ssl (https) в nginx]]</pre>
</div>
<div title="SideBarOptions" modifier="Яковлев Иван" created="200904061407" changecount="1">
<pre>&lt;&lt;search&gt;&gt;&lt;&lt;closeAll&gt;&gt;&lt;&lt;permaview&gt;&gt;&lt;&lt;newTiddler text:{{store.getTiddlerText(&quot;Шаблон новой записи&quot;)}}&gt;&gt;&lt;&lt;newJournal 'DD MMM YYYY г.'&gt;&gt;&lt;&lt;saveChanges&gt;&gt;&lt;&lt;slider chkSliderOptionsPanel OptionsPanel 'установки »' 'Различные опции TidlyWiki'&gt;&gt;</pre>
</div>
<div title="SiteSubtitle" modifier="Яковлев Иван" created="200904061414" modified="200906022132" changecount="6">
<pre>'':: wiki-manual .:''</pre>
</div>
<div title="SiteTitle" modifier="Яковлев Иван" created="200904061414" modified="200906022132" changecount="4">
<pre>Ubuntu</pre>
</div>
<div title="SplashScreenPlugin" modifier="Яковлев Иван" created="200904061404" modified="200906031308" tags="[[TiddlyWikiDev-Plugins - Плагины]] systemConfig [[TODO - нужен перевод статьи]]" changecount="2">
<pre>/***

''Inspired by [[TiddlyPom|http://www.warwick.ac.uk/~tuspam/tiddlypom.html]]''

|Name|SplashScreenPlugin|
|Created by|SaqImtiaz|
|Location|http://tw.lewcid.org/#SplashScreenPlugin|
|Version|0.21 |
|Requires|~TW2.08+|
!Description:
Provides a simple splash screen that is visible while the TW is loading.

!Installation
Copy the source text of this tiddler to your TW in a new tiddler, tag it with systemConfig and save and reload. The SplashScreen will now be installed and will be visible the next time you reload your TW.

!Customizing
Once the SplashScreen has been installed and you have reloaded your TW, the splash screen html will be present in the MarkupPreHead tiddler. You can edit it and customize to your needs.

!History
* 20-07-06 : version 0.21, modified to hide contentWrapper while SplashScreen is displayed.
* 26-06-06 : version 0.2, first release

!Code
***/
//{{{
var old_lewcid_splash_restart=restart;

restart = function()
{   if (document.getElementById(&quot;SplashScreen&quot;))
        document.getElementById(&quot;SplashScreen&quot;).style.display = &quot;none&quot;;
      if (document.getElementById(&quot;contentWrapper&quot;))
        document.getElementById(&quot;contentWrapper&quot;).style.display = &quot;block&quot;;
    
    old_lewcid_splash_restart();
   
    if (splashScreenInstall)
       {if(config.options.chkAutoSave)
			{saveChanges();}
        displayMessage(&quot;TW SplashScreen has been installed, please save and refresh your TW.&quot;);
        }
}


var oldText = store.getTiddlerText(&quot;MarkupPreHead&quot;);
if (oldText.indexOf(&quot;SplashScreen&quot;)==-1)
   {var siteTitle = store.getTiddlerText(&quot;SiteTitle&quot;);
   var splasher='\n\n&lt;style type=&quot;text/css&quot;&gt;#contentWrapper {display:none;}&lt;/style&gt;&lt;div id=&quot;SplashScreen&quot; style=&quot;border: 1px solid #ccc; display: block; text-align: center; width: 320px; margin: 100px auto; padding: 50px; color:#000; font-size: 28px; font-family:Tahoma; background-color:#f1f2f4;&quot;&gt;&lt;b&gt;'+siteTitle +'&lt;/b&gt; is loading&lt;blink&gt; ...&lt;/blink&gt;&lt;br /&gt;&lt;br /&gt;&lt;span style=&quot;font-size: 14px; color:#798093;&quot;&gt;Requires Javascript.&lt;/span&gt;&lt;/div&gt;';
   if (! store.tiddlerExists(&quot;MarkupPreHead&quot;))
       {var myTiddler = store.createTiddler(&quot;MarkupPreHead&quot;);}
   else
      {var myTiddler = store.getTiddler(&quot;MarkupPreHead&quot;);}
      myTiddler.set(myTiddler.title,oldText+splasher,config.options.txtUserName,null,null);
      store.setDirty(true);
      var splashScreenInstall = true;
}
//}}}</pre>
</div>
<div title="StyleSheet" modifier="Яковлев Иван" created="200904061407" modified="200911261105" changecount="79">
<pre>/***
Пользовательский ~CSS-стиль оформления странички.
Все стилевое оформление заданное здесь будет перекрывать стили по умолчанию. Тем самым пользователь может настроить оформление вида странички на свое усмотрение.

!1. Custom ~StyleSheetColors - цветовое оформление
***/
/*{{{*/
/*body { background: #efefef; color: #444; }*/
body { background: #fff; color: #444; }
#contentWrapper  { background: #fff url(images/system/bg.jpg) repeat-x top left; }
a {color:#5e6677;}
div.tiddler a.tiddlyLink {color:#555;}
a:hover, div.tiddler a.tiddlyLink:hover {background-color:#ee7d00; color:[[ColorPalette::Background]];}
/*}}}*/

/***
!!1.1 Цвет текста заголовка сайта (пока не задействован)
***/
/*{{{*/
/*span.siteTitle em a.tiddlyLink { color: #fbd252; }*/
/*}}}*/

/***
!!1.2 Цветовое оформление заголовков
***/
/*{{{*/
/*h1,h2,h3,h4,h5,h6 {color:#999; background:transparent;}*/
/*h1,h2,h3,h4,h5,h6 {color:#5e6677; background:transparent;}*/
h1,h2,h3,h4,h5,h6 {color:#798194; background:transparent;}
/*}}}*/

/***
!!1.3 Другие настройки
***/
/*{{{*/
#sidebarOptions input {border:1px solid [[ColorPalette::PrimaryMid]];}

.title {color:#9caa3b;}

.tagging, .tagged {border:1px solid [[ColorPalette::TertiaryPale]]; background-color:#f8f8f8;}
.selected .tagging, .selected .tagged {background-color:#f1f2f4; border:1px solid [[ColorPalette::TertiaryMid]];}

#backstageArea {background:#404040; color:[[ColorPalette::TertiaryMid]];}
/*}}}*/

/***
!!1.4 ~IE-Clearing
Используется только в Internet Explorer, включается в iehacks.css
***/
/*{{{*/
#ie_clearing { display: none; }
/*}}}*/

/***
!2. Castom ~StyleSheetLayout - оформление слоев странички

!!2.1 Общие настройки
***/
/*{{{*/
.header, #nav, #main, #footer { clear: both; }
/*}}}*/
/***
{{note{
@@color:red;font-weight:bold;ВНИМАНИЕ:@@
Задание параметра {{{clear: both;}}} позволяет исключить схлопывание футера на верх, если на экран не выведено ни одной записи.
Футер постоянно будет располагаться сразу же за одной из колонок mainMenu или sidebar, смотря какая из них будет длиннее.
В конечном итоге футер все время будет там где ему положено быть, т.е. внизу.
}}}
***/
/*{{{*/
.clearfix { clear: both; }
/*}}}*/
/***
{{note{
@@color:red;font-weight:bold;ВНИМАНИЕ:@@
Задание параметра {{{clear: both;}}} позволяет исключить схлопывание контейнера mainContent, в результате которого изчезает граница-разделитель главного меню (mainMenu) и основного контента (mainContent).
}}}
***/
/*{{{*/
.tagClear { clear: none; }
/*}}}*/
{{note{
@@color:red;font-weight:bold;ВНИМАНИЕ:@@
Сброс параметра {{{none}}} (до этого было {{{both}}}) позволяет выводить несколько записей сразу же друг под другом.
Если не задать {{{.tagClear { clear: none; } }}}, то интервал между первой небольшой по высоте записью и последующей будет очень велик.
}}}

/***
!!2.2 Настройка contentWrapper'а - стакана для всего остального
***/
/*{{{*/
#contentWrapper { position: relative; }
/*}}}*/

/***
!!2.3 Настройки Header'а для KLD 
***/
/*{{{*/
.header {
    background: #5e6677 url(images/system/header_bg.jpg) repeat-x top left; height: 50px;
    border: 1px solid #000;
    border-bottom: none;
}
span.siteSubtitle { font-size: 1.8em; }
.headerForeground { right: 1px; }
span.date {
  color: #e2eaef;
  font-family: Arial,Verdana,Geneva,Helvetica,sans-serif;
  font-size: 11px;
  font-weight: bold;
  position: absolute;
  top: 25px;
  right: 260px;
  right: 20px;
}
div.headerShadow, div.headerForeground { padding: 0 0 0 70px; }
div.headerShadow { height: 50px; background: transparent url(images/system/icons/ubuntu-logo.png) no-repeat 10px 0px; top: 0; }
/*}}}*/

/***
!!2.4 Оформление навигационной панели (nav)

!!!2.4.1 ~YAML-Core
***/
/*{{{*/
.hlist {
    /* (en) containing floats in IE */
    width: 100%;
    overflow: hidden;
    /* (en) containing floats in all other browsers */
    float: left;
    display: inline;
    /* (en) Bugfix: IE - collapsing horizontal margins */
    position:relative;
    /* (en) Repeat the main color from the image */
    background: #c0c0c0 url(&quot;images/shiny_buttons/background.png&quot;) repeat-x center right;
    border-top: 1px #333 solid;
    border-bottom: 1px #333 solid;
    line-height: 0;
}

.hlist ul {
    /* (en) Bugfix: IE - Doubled Float Margin Bug */
    display: inline;
    float: left; /* LTR */
    /* (en) Left margin of the first button  */
    margin: 0 0 0 50px; /* LTR */
    padding: 0;
    border-left: 1px #aaa solid;
    border-right: 1px #fff solid;
}

.hlist ul li {
    border-left: 1px #fff solid;
    border-right: 1px #aaa solid;
    /* (en) Bugfix: IE - Doubled Float Margin Bug */
    display: inline;
    float: left; /* LTR */
    font-size: 1.0em;
    line-height: 1em;
    list-style-type: none;
    margin: 0;
    padding: 0;
}

.hlist ul li a,
.hlist ul li strong {
    background: transparent;
    color: #000;
    display: block;
    font-size: 1em;
    font-weight: bold;
    margin: 0;
    padding: 0.5em 0.8em 0.5em 0.8em;
    text-decoration: none;
    width: auto;
}

.hlist ul li a:focus,
.hlist ul li a:hover,
.hlist ul li a:active  { background: #eee; color: #333; text-decoration: none; }

.hlist ul li.active {
    /* (en) Repeat the main color from the image */
    background: #272727 url(&quot;images/shiny_buttons/background_active.png&quot;) repeat-x center right;
    border-left: 1px #444 solid;
    border-right: 1px #888 solid;
}

.hlist ul li.active strong,
.hlist ul li.active a:focus,
.hlist ul li.active a:hover,
.hlist ul li.active a:active { background: transparent; color: #fff; text-decoration: none; }
/*}}}*/

/***
!!!2.4.2 Дополнительные настройки 
***/
/*{{{*/
div#nav {
  background: #edeef0 url(images/system/navbar-bg.jpg) repeat-x scroll left bottom;
  border: 1px solid #000;
  height: 26px;
  height: 30px;
  overflow:hidden;
  position: relative;
}

div.hlist { background: transparent; border: none; }
div.hlist ul { border-left: none; }

/* (en) navigation: horizontal adjustment  */
#nav ul { margin-left: 0; }

div.hlist ul li { border: none; }
div.hlist ul li a, div.hlist ul li a:link, div.hlist ul li a:active, div.hlist ul li a:visited {
  background:  #edeef0 url(images/system/nav-button-bg.jpg) repeat-x;
  border-top: 1px solid #eeeff1;
  border-right: 1px solid #aaa;
  border-bottom: 1px solid #81889a;
  border-left: 1px solid #fff;
  color: #444;
  font-family: Arial, Verdana, Geneva, Helvetica, sans-serif;
  font-size: 14px;
  font-weight: normal;
  padding-top: 8px;
  padding-bottom: 8px; 
}
div.hlist ul li a:hover {
  background: #ee7d00 url(images/system/nav-button-bg-hover.jpg) repeat-x;
  border: 1px solid black;
  color: #000;
}
div.hlist ul li.active {
  background: #4a505e;
  border: 1px solid #4a505e;
  cursor: default;
  font-family: Arial, Verdana, Geneva, Helvetica, sans-serif;
}
div.hlist ul li span {
  background: transparent;
  color: #fff;
  display: block;
  font-size: 14px;
  font-weight: normal;
  margin: 0;
  padding: 0.5em 0.8em 0.5em 0.8em;
  text-decoration: none;
  width: auto;
}
/*}}}*/

/***
!!2.5 Оформление слоя main
Слой main является каркасом (стаканом) для слоев mainMenu, displayArea и sidebar.
***/
/*{{{*/
div#main {
  background: transparent url(images/system/shadow210.jpg) no-repeat 50px 0;
  position: relative;
}
/*}}}*/

/***
!!!2.5.1 Главное меню (mainMenu)
***/
/*{{{*/
#mainMenu {
  background: transparent;  
  float: left;
  font-size:1.1em;
  line-height:1.6em; 
  padding: 5px;
  position: relative; 
  text-align:left; 
  width: 200px;
  width: 250px;
}
#mainMenu ul { padding-left: 15px; margin: 0; }
#mainMenu ol { padding-left: 20px; margin: 0; }
#mainMenu hr { color: #eee; }
/*}}}*/

/***
!!!2.5.2 Область видимости (displayArea )
***/
/*{{{*/
#mainContent {
  border-left: 1px solid #ccc;
  margin: 0 180px 0 210px;
  margin: 0 180px 0 260px;
  position: relative;
  width: auto;
}
#displayArea { margin: 0; position: relative; width: auto; }
#tiddlerDisplay { position: relative; }
/*}}}*/
/***
Настраиваем метки и связанные записи:
***/
/*{{{*/
.tagging, .tagged { float: none; margin: 1.5em 0.5em; }
.tagged li { display:inline; }
/*}}}*/


/***
!!!2.5.3 Боковая панель (sidebar)
***/
/*{{{*/
div#sidebar { position: relative; float: right; width: 175px; }
/*}}}*/

/***
!!!2.5.4 Футер странички (footer)
***/
/*{{{*/
div#footer {
    background: #d1d7de url(images/system/footer_bg.jpg) repeat-x bottom left;
    border: none;
    border-top: 5px #efefef solid;
    border-bottom: 1px solid #000;
    color: #5e6677;
    height: 150px;
    padding: 10px 20px;
    position: relative;
  }
/*}}}*/

/***
!!2.6 Оформление мини панельки управления
{{note{
Пока не используется из-за наличия мелких недостатков в работе.
}}}
***/
/*{{{*/
#hoverMenu {
  /*position: fixed; */
  right: 3px;
  top: 150px;
  width: 20px;
}
#hoverMenu a.button {
  background:  #f1f2f4;
  border: 1px solid #81889A;
  color: #5e6677;
  font-size: 15px;
  margin: -1px 0 0 0;
  padding: 1px;
}
#hoverMenu a.button:hover {
  background: #ee7d00 url(images/system/nav-button-bg-hover.jpg) repeat-x;
  border: 1px solid #000;
  color: #000;
  margin: 0;
  margin: -1px 0 0 0;
  padding: 1px;
}
.viewer .button:hover { background: #ee7d00; }
/*}}}*/

/***
!3. Оформление контента

!!3.1 Настройки заголовков
***/
/*{{{*/
h1 {font-size:2.8em;}
h2 {font-size:2.2em;}
h3 {font-size:1.6em;}
h4 {font-size:1.3em;}
h5 {font-size:1.1em;}
h1,h2,h3,h4,h5,h6 {font-weight: normal; line-height: normal;}
h1,h2,h3 {margin-top: 10px;}
/*}}}*/

/***
!!Ссылки
***/
/*{{{*/
a img { border: none;}
a.imgLink:hover { background: none; }
a.imgLink:hover img { border: 1px solid #ee7d00; }
a.tiddlyLinkNonExisting.shadow { font-weight:bold; }
div.tiddler a, div.viewer a { text-decoration: none; }
div.viewer a, div.viewer a.tiddlyLink { color: #0473b5; }
div.viewer a:hover { color: #fff; }
div.viewer a.tiddlyLink, div.viewer a.externalLink { font-weight: bold; }
/*div.viewer a.tiddlyLink { color: #79B1D4; }*/
div.viewer .toolbar a,
div.viewer .toolbar a:link,
div.viewer .toolbar a:active,
div.viewer .toolbar a:visited { color: #ccc; font-weight: normal; }
div.viewer .toolbar a:hover { color: #333; }
div.toolbar a.button, div.viewer a .batton {border: 1px solid #ccc; margin-left: -1px;  text-decoration: none; }
form.wizard a.button,
h1 a.tiddlyLink,
h2 a.tiddlyLink,
h3 a.tiddlyLink,
h4 a.tiddlyLink,
h5 a.tiddlyLink,
h6 a.tiddlyLink,
h1 a.externalLink,
h2 a.externalLink,
h3 a.externalLink,
h4 a.externalLink,
h5 a.externalLink,
h6 a.externalLink,
div.tagging a,
blockquote a.tiddlyLink { text-decoration: none; }
/*}}}*/

/***
!!!Размер шрифта текста записей в блоке {{{class='viewer'}}}
***/
/*{{{*/
h1 { font-size: 2.4em; }
h2 { font-size: 1.9em; }
h3 { font-size: 1.4em; }
h4 { font-size: 1.3em; }
h5 { font-size: 1.13em; }
h6 { font-size: 0.9em; }
.viewer { font-size: 1.25em; line-height: normal; }
.viewer pre {
    background: #f0eee6;
    border: 1px dashed #c18496;
    font-size: 1.2em;
    overflow: visible;
}
.viewer div.note pre { font-size: 1em; }
.viewer code { font-size: 1.3em; font-weight: bold; }
.viewer .button { border: none; font-weight: bold; }
.viewer dl {margin: 0; }
/*}}}*/

/***
!!Сообщение о сохранении изменений
***/
/*{{{*/
div#messageArea { top: 50px; }
/*}}}*/

/***
!!Оформление цитат
***/
/*{{{*/
.viewer blockquote {
    color: #798194;
    border-left: 3px solid #798194;
    position: relative;
}
.viewer div.descr blockquote {
    height: 220px;
    padding-left: 260px;
}
.viewer blockquote img {
    height: 200px;
    width: 200px;
    position: absolute;
    top: 0;
    left: 20px;
}
/*}}}*/

/***
!!Оформление вкладок
***/
/*{{{*/
.viewer .tabSelected
{
    background: #ebebeb;
    border-left: 2px solid #333;
    border-right: 2px solid #333;
    border-top: 2px solid #333;
    color: #333;
    padding: 5px 10px;
}
.viewer a.tabSelected:hover
{
    color: #333;
    cursor: default;
}
.viewer .tabUnselected
{
    background: #5f5f5f;
    color: #fff;
    padding: 7px 10px 2px 10px;
}
.viewer a.tabUnselected:hover
{
	background: #ee7d00;
}
.viewer .tabContents
{
    background: #fff url(data:image/jpeg;base64,/9j/4AAQSkZJRgABAgAAZABkAAD/7AARRHVja3kAAQAEAAAAUAAA/+4AJkFkb2JlAGTAAAAAAQMAFQQDBgoNAAABoAAAAcIAAAH5AAACHP/bAIQAAgICAgICAgICAgMCAgIDBAMCAgMEBQQEBAQEBQYFBQUFBQUGBgcHCAcHBgkJCgoJCQwMDAwMDAwMDAwMDAwMDAEDAwMFBAUJBgYJDQsJCw0PDg4ODg8PDAwMDAwPDwwMDAwMDA8MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwM/8IAEQgALQABAwERAAIRAQMRAf/EAH4AAQADAAAAAAAAAAAAAAAAAAQBAwgBAQAAAAAAAAAAAAAAAAAAAAAQAAIDAQAAAAAAAAAAAAAAAAARECACEhEAAwAAAAAAAAAAAAAAAAAAIAEyEgEAAAAAAAAAAAAAAAAAAAAgEwACAgMAAAAAAAAAAAAAAAAQIAARASHx/9oADAMBAAIRAxEAAAHbZAoUJLD/2gAIAQEAAQUC62IUKP/aAAgBAgABBQK3/9oACAEDAAEFArf/2gAIAQICBj8CX//aAAgBAwIGPwJf/9oACAEBAQY/AqZf/9oACAEBAwE/Ie3mWGg1P//aAAgBAgMBPyFv/9oACAEDAwE/IW//2gAMAwEAAhEDEQAAEBAAP//aAAgBAQMBPxAE1kn/2gAIAQIDAT8Qb//aAAgBAwMBPxBv/9k=) repeat-x left top;
    border-top: 2px solid #333;
    padding-top: 20px;
}
/*}}}*/

/***
!!Оформление контента боковой панели
***/
/*{{{*/
#sidebarOptions .sliderPanel {
  background: #fff url(images/system/tooltip_bg.jpg) repeat-x center top;
  border: 1px solid #9ca2b0;
}
#sidebarOptions input {  border: 1px solid #9ca2b0; }
/*}}}*/

/***
!!Настройки для оформления заметок

!!!Оформление для режима просмотра записи
***/
/*{{{*/
.title {font-size:3.5em; font-weight:normal;}
.viewer { padding-top: 15px; position: relative; }
.viewer h2,
.viewer h3,
.viewer h4,
.viewer h5,
.viewer h6 { border: none;  }
.viewer img[align='left'] { margin-right: 20px; }
.viewer img[align='right'] { margin-left: 20px; }
.viewer img[align='center'] { margin-left: 20px; margin-right: 20px; }
.viewer ul { margin: 0 0 0 0.5em; }
div.tiddler { padding: 20px 1em; }
div.tiddler img {background-color: #fff; padding: 5px; margin: 5px; border: 1px solid #9ca2b0; }

.borderNone, div.tiddler .borderNone img, .borderNone * { border: none; }

.textAlignCenter { margin-left: auto; margin-right: auto; text-align: center; }
.textAlignRight { text-align: right; }
.textAlignLeft { text-align: left; }
.displayInline { display: inline; }
.note { background-color: #f9f9f9; border: 1px dashed #2f6fab; margin: 10px 10px 10px 40px; padding: 10px; }
.terminal { background-color: black; border: 1px solid black; margin: 10px; padding: 0; overflow: visible; }
.terminal pre { background: black; border: 1px solid #c0c0c0; color: #afafaf; margin: 1px; overflow: visible; }

.listTitle {color:#e64117; font-weight: bold; }
.tagging ul li.listTitle, .tagged ul li.listTitle { color: #798093; font-size: 1.8em; font-weight: normal; }

.toolbar { margin: 1.5em 0 0 0; }
span.toolbar { font-size: 1em; }
/*}}}*/
/***
Cкрытие панели у не выделенного тайдлера и отображение панели у выделенного тайдлера (пока не используется) нужно еще дорабатывать, т.к. замечены мелкие недостатки. TODO
***/
/*{{{*/
/*
.tiddler .toolbar { visibility: hidden; }
.selected .toolbar { visibility: visible; }
*/
/*}}}*/
/***
!!!Оформление для режима редактирования записи
***/
/*{{{*/
.editor textarea { height: 470px; }
/*}}}*/


/***
!!Стиль для оформления таблиц
***/
/*{{{*/
.viewer table, table.twtable {
  border: 1px solid #9ca2b0;
  border-collapse: collapse;
  
  /*marging-left: auto;
  marin-right: auto;*/
}
.viewer th, .viewer thead td, .twtable th, .twtable thead td {
  background: #edeef0 url(images/system/navbar-bg.jpg) repeat-x bottom center;
  border: 1px solid #9ca2b0;
  color: #333;
}
.viewer td, .viewer tr, .twtable td, .twtable tr {
  border:1px solid #9ca2b0;
}
/*}}}*/

/***
!!Оформление вида разделительной линии в окне вида и редактирования записи
***/
/*{{{*/
div.tiddler { border-bottom: 1px dashed #ccc; }
/*}}}*/
/***
!!Оформление контента футера
***/
/*{{{*/
.copyright { position: absolute; bottom: 10px; right: 10px; }
.footerMessage { margin: 50px auto 0 auto; text-align: center; }
/*}}}*/

/***
!4. Castom ~BackstageLayout
***/
/*{{{*/
form.wizard {
  background: #fff url(images/system/tooltip_bg.jpg) repeat-x center top;
  border: 1px solid #9ca2b0;
}
div.wizardStep { border: 1px solid #9ca2b0; }
div.wizardFooter { background-color: #fff; }
/*}}}*/

/***
!!4.1 Кнопка 
***/
/*{{{*/
form.wizard a.button {
  background: #eee url(images/system/nav-button-bg.jpg) repeat-x center top;
  border:1px solid #9ca2b0;
  color: #333;
  padding: 4px 15px;
}
form.wizard a.button:hover {
  background: #eee url(images/system/nav-button-bg-hover.jpg) repeat-x center top;
  border: 1px solid black;
color: #000;
}
/*}}}*/


</pre>
</div>
<div title="StyleSheetPrint" modifier="Яковлев Иван" created="200904061408" modified="200907261719" changecount="3">
<pre>/*{{{*/
@media print {
.header, #nav, #footer, #mainMenu, #sidebar, #messageArea, .toolbar, #backstageButton, #backstageArea {display: none ! important;}
#mainContent {border: none; margin: 1em 1em 0em 1em;}

/**
 * Задаем ширину области печати документа
 */
.viewer { width: 650px; }

/**
 * Отсекаем не нужные для печати области
 */
.tagged, .tabset{ display: none; }

/**
 * Настраиваем вид контента для печати
 */
.terminal { background: transparent; border: none; margin: 10px; padding: 0; }
.terminal pre { background: #f0eee6; border: 1px dashed #c18496; color: black; margin: 1px; }

.tabContents { border: none; border-top: none; padding: 0; }

/**
 * Fixes a feature in Firefox 1.5.0.2 where print preview displays the noscript content\
 */
noscript {display:none;}
}
/*}}}*/</pre>
</div>
<div title="Synaptic" modifier="Яковлев Иван" created="200906032342" modified="200906040918" tags="[[Установка ПО в Ubuntu]]" changecount="5">
<pre>Заходим в меню Система - Администрирование - Менеджер пакетов Synaptic

{{textAlignCenter{
[img[images/articles/menu-synaptic.png]]
}}}
Перед нами Synaptic. С помощью него можно установить и удалить любое приложение из подключенных у вас репозитариев.

{{textAlignCenter{
[img[images/articles/synaptic-screen-overview.png]]
}}}
Слева вверху вы можете видеть кнопку &quot;Обновить&quot;. Напомню еще раз о репозитариях: ПО хранится в интернете на специальных серверах. Репозитарии регулярно обновляются новыми версиями приложений и дополняются новыми программами, и поэтому, чтобы быть в курсе о том, что находится в репозитариях прямо сейчас - необходимо регулярно обновлять эти сведения. Если у вас стоит автоматическое обновление ПО, вы можете вообще не нажимать эту кнопку, Ubuntu делает это регулярно сам (ему ведь надо знать, когда ПО можно обновить).

Слева вы можете видеть категории ПО и также фильтрацию. Например, можно отфильтровать и показать все установленные программы. Не уверен что категории ПО вам сильно помогут, гораздо проще воспользоваться поиском. Чаще всего вы будете пользоваться именно этим. Нажмем на поиск.

{{textAlignCenter{
[img[images/articles/synaptic-find.png]]
}}}
Давайте попробуем найти что-нибудь и установить. Для примера я установлю файловый менеджер Krusader, аналог Total Commander в Windows. Обратите внимание на то, что ключевое слово будет искаться не только в названии пакета, но и в его описании. Иногда описание программы и название пакета не совпадают, так что в большинстве случаев пользуйтесь именно таким поиском.

{{textAlignCenter{
[img[images/articles/synaptic-found-krusader.png]]
}}}
В результате поиска может быть найдено несколько пакетов. Например если вы будете искать mc (консольный файловый менеджер) по названию и описанию, вы получите очень большое количество результатов, т.к. сочетание &quot;mc&quot; может встречаться в описании пакетов очень часто. У нас в результате на выбор два пакета. Если по названию пакетов не понятно какой именно ставить - прочитайте описание. В моем случае Synaptic нашел еще krusader-dbg, что по идее означает debug и предназначается для программирования. Мне нужен первый пакет. Чтобы отметить ПО для установки - кликните дважды на чекбоксе.

{{textAlignCenter{
[img[images/articles/synaptic-krusader-depends.png]]
}}}
Перед нами появилось окно, предупреждающее о том, что для установки Krusader необходимо поставить много зависимостей.

Таким образом можно отметить для установки (и удаления) сколько угодно приложений. Когда вы закончите с выбором - нажмите применить в главном окне Synaptic.

{{textAlignCenter{
[img[images/articles/apply-all-changes.png]]
}}}
Попробуем установить пока только Krusader. Нажимаем на кнопку &quot;Применить&quot;.

{{textAlignCenter{
[img[images/articles/synaptic-apply.png]]
}}}
Вот то, о чем я говорил ранее в этой статье: мы ставим одно приложение, а в итоге программа со всеми зависимостями тянет на 25.4 МБ. После установки размер нового установленного ПО будет занимать 82.5 МБ. Жмем &quot;Применить&quot; чтобы начать установку.

Для начала скачиваются все необходимые .deb пакеты.

{{textAlignCenter{
[img[images/articles/synaptic-dowloading-packages.png]]
}}}
Затем начинается непосредственная установка.

{{textAlignCenter{
[img[images/articles/synaptic-installing.png]]
}}}
После того как установка закончится - нажимайте &quot;Закрыть&quot; или предварительно выделите галочку, чтобы по окончании установки окно закрывалось само. Ну вот и все, мы установили Krusader. Установленное ПО можно будет найти в меню, если оно конечно не консольное.

{{textAlignCenter{
[img[images/articles/menu-krusader-installed.png]]
}}}
Точно также можно установить любое другое ПО, которое вам нужно. Например, если вы хотите найти приложение для того, чтобы слушать радио, запустите Synaptic и в поиске напишите Radio. Среди полученных результатов поищите то, что вам нужно.

!См. далее
*[[Просмотр свойств установленного пакета с помощью Synaptic]]


</pre>
</div>
<div title="ToggleSideBarMacro - скрытие боковой панели" modifier="Яковлев Иван" created="200904061405" tags="[[TiddlyWikiDev-Plugins - Плагины]] systemConfig" changecount="1">
<pre>/***

|Name|ToggleSideBarMacro|
|Created by|SaqImtiaz|
|Location|http://tw.lewcid.org/#ToggleSideBarMacro|
|Version|1.0|
|Requires|~TW2.x|
!Description:
Provides a button for toggling visibility of the SideBar. You can choose whether the SideBar should initially be hidden or displayed.

!Demo
&lt;&lt;toggleSideBar &quot;Toggle Sidebar&quot;&gt;&gt;

!Usage:
{{{&lt;&lt;toggleSideBar&gt;&gt;}}} &lt;&lt;toggleSideBar&gt;&gt;
additional options:
{{{&lt;&lt;toggleSideBar label tooltip show/hide&gt;&gt;}}} where:
label = custom label for the button,
tooltip = custom tooltip for the button,
show/hide = use one or the other, determines whether the sidebar is shown at first or not.
(default is to show the sidebar)

You can add it to your tiddler toolbar, your MainMenu, or where you like really.
If you are using a horizontal MainMenu and want the button to be right aligned, put the following in your StyleSheet:
{{{ .HideSideBarButton {float:right;} }}}

!History
*23-07-06: version 1.0: completely rewritten, now works with custom stylesheets too, and easier to customize start behaviour. 
*20-07-06: version 0.11
*27-04-06: version 0.1: working.

!Code
***/
//{{{
config.macros.toggleSideBar={};

config.macros.toggleSideBar.settings={
         styleHide :  &quot;#sidebar { display: none;}\n&quot;+&quot;#contentWrapper #main #mainContent { margin-right: 1em;}\n&quot;+&quot;&quot;,
         styleShow : &quot; &quot;,
         arrow1: &quot;←|&quot;,
         arrow2: &quot;|→&quot;
};

config.macros.toggleSideBar.handler=function (place,macroName,params,wikifier,paramString,tiddler)
{
          var tooltip= params[1]||'toggle sidebar';
          var mode = (params[2] &amp;&amp; params[2]==&quot;hide&quot;)? &quot;hide&quot;:&quot;show&quot;;
          var arrow = (mode == &quot;hide&quot;)? this.settings.arrow1:this.settings.arrow2;
          var label= (params[0]&amp;&amp;params[0]!='.')?params[0]+&quot; &quot;+arrow:arrow;
          var theBtn = createTiddlyButton(place,label,tooltip,this.onToggleSideBar,&quot;button HideSideBarButton&quot;);
          if (mode == &quot;hide&quot;)
             { 
             (document.getElementById(&quot;sidebar&quot;)).setAttribute(&quot;toggle&quot;,&quot;hide&quot;);
              setStylesheet(this.settings.styleHide,&quot;ToggleSideBarStyles&quot;);
             }
};

config.macros.toggleSideBar.onToggleSideBar = function(){
          var sidebar = document.getElementById(&quot;sidebar&quot;);
          var settings = config.macros.toggleSideBar.settings;
          if (sidebar.getAttribute(&quot;toggle&quot;)=='hide')
             {
              setStylesheet(settings.styleShow,&quot;ToggleSideBarStyles&quot;);
              sidebar.setAttribute(&quot;toggle&quot;,&quot;show&quot;);
              this.firstChild.data= (this.firstChild.data).replace(settings.arrow1,settings.arrow2);
              }
          else
              {    
               setStylesheet(settings.styleHide,&quot;ToggleSideBarStyles&quot;);
               sidebar.setAttribute(&quot;toggle&quot;,&quot;hide&quot;);
               this.firstChild.data= (this.firstChild.data).replace(settings.arrow2,settings.arrow1);
              }

     return false;
}

setStylesheet(&quot;.HideSideBarButton .button {font-weight:bold; padding: 0 5px;}\n&quot;,&quot;ToggleSideBarButtonStyles&quot;);

//}}}</pre>
</div>
<div title="ToolbarCommands" modifier="Яковлев Иван" created="200904061408" changecount="1">
<pre>|~ViewToolbar|closeTiddler closeOthers +editTiddler jump &gt; fields syncing permalink references|
|~EditToolbar|+saveTiddler -cancelTiddler deleteTiddler|</pre>
</div>
<div title="ViewTemplate" modifier="Яковлев Иван" created="200904061408" changecount="1">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar' macro='toolbar [[ToolbarCommands::ViewToolbar]]'&gt;&lt;/div&gt;
&lt;div class='toolbar'&gt;
&lt;span class='toolbar' macro='saveChanges сохранить'&gt;&lt;/span&gt;&lt;span class='toolbar' macro='closeAll'&gt;&lt;/span&gt;&lt;span class='toolbar' macro='newTiddler text:{{store.getTiddlerText(&quot;Шаблон новой записи&quot;)}}'&gt;&lt;/span&gt;&lt;span class='toolbar' macro='top'&gt;&lt;/span&gt;&lt;span class='toolbar' macro='toggleSideBar &quot;&quot; &quot;Скрыть/Отобразить боковую панель&quot;'&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='subtitle'&gt;&lt;span macro='view modifier link'&gt;&lt;/span&gt;, &lt;span macro='message views.wikified.createdPrompt'&gt;&lt;/span&gt; &lt;span macro='view created date'&gt;&lt;/span&gt;&amp;nbsp;г.&amp;nbsp;(ред.: &lt;span macro='view modified date'&gt;&lt;/span&gt;&amp;nbsp;г.)&lt;/div&gt;
&lt;div class='tagging' macro='tagging'&gt;&lt;/div&gt;
&lt;div class='tagged' macro='tags'&gt;&lt;/div&gt;
&lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;
&lt;!-- &lt;div class='tagged' macro='tags'&gt;&lt;/div&gt; --&gt;
&lt;div class='tagClear'&gt;&lt;/div&gt;
&lt;div class='toolbar' macro='toolbar [[ToolbarCommands::ViewToolbar]]'&gt;&lt;/div&gt;
&lt;div class='toolbar'&gt;
&lt;span class='toolbar' macro='saveChanges сохранить'&gt;&lt;/span&gt;&lt;span class='toolbar' macro='closeAll'&gt;&lt;/span&gt;&lt;span class='toolbar' macro='newTiddler text:{{store.getTiddlerText(&quot;Шаблон новой записи&quot;)}}'&gt;&lt;/span&gt;&lt;span class='toolbar' macro='top'&gt;&lt;/span&gt;&lt;span class='toolbar' macro='toggleSideBar &quot;&quot; &quot;Скрыть/Отобразить боковую панель&quot;'&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;!--}}}--&gt;
</pre>
</div>
<div title="Wi-Fi. Linux. Краткий курс" modifier="Яковлев Иван" created="200906052345" tags="Статьи Wi-Fi TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/wi-fi-linux-kratkij-kurs.html#more-118]]



</pre>
</div>
<div title="WinSCP - бесплатный графический клиент SFTP и SCP для Windows" modifier="Яковлев Иван" created="200906301221" modified="200906301304" tags="[[Удаленное подключение]]" changecount="17">
<pre>!Описание
~WinSCP бесплатный (open source) SFTP и FTP клиент для Windows. Программа также поддерживает протокол SCP. Основной задачей данного графического клиента является безопасное копирование файлов по сети между локальным и удаленным компьютерами. 

!!Основные фитчи
*Графический интерфейс
*Доступен перевод графического интерфейса на разные языки
*Интеграция с операционной системой Windows (поддержка drag&amp;drop, URL, ярлыков)
*Поддержка [[U3|http://winscp.net/eng/docs/u/]] -- возможность использования портативной версии программы
*Поддерживает все основные операции с файлами
*Имеется поддержка протоколов SFTP и SCP поверх ~SSH-1 и ~SSH-2, а также поддержка старичка FTP протокола
*Имеется возможность пакетной обработки большого количества файлов
*Поддержка работы через командную строку
*Поддержка синхронизации каталогов в полу и автоматическом режиме
*Интегрированный текстовый редактор (также есть возможность подключения внешнего текстового редактора, например Notepad++)
*Поддержка паролей, публичных ключей для SSH, и аутентификацию через протокол [[Kerberos (GSS)|http://ru.wikipedia.org/wiki/Kerberos]]
*Интеграция с популярным агентом ~PuTTY для полной поддержки аутентификации на основе публичного ключа через SSH
*Explorer и Commander интерфейсы работы с файлами и каталогами
*Хранение сессионной информации (опционально)
*Поддержка портативной работы с использованием конфигурационного ini файла заменяющего реестр Windows (для работы с USB флешек).

!!Внешний вид программы
{{textAlignCenter{
[img[images/articles/win-scp-window.jpg]]
}}}

!См. также
*[[SFTP (SSH File Transfer Protocol) - протокол безопасной передачи файлов по сети через SSH|http://ru.wikipedia.org/wiki/SFTP]]
*[[SCP (Secure Copy Protocol) - протокол безопасного копирования файлов|http://ru.wikipedia.org/wiki/SCP]]

*[[rsync - более быстрая и гибкая замена rcp]]

*[[SSH - работа с PuTTY]]
*[[OpenSSH сервер]]

!Ссылки
*[[Домашняя страничка программы|http://winscp.net/]]
*[[Раздел на Википедии|http://ru.wikipedia.org/wiki/WinSCP]]
*[[Документация|http://winscp.net/eng/docs/]]


</pre>
</div>
<div title="addgroup - создание новой группы" modifier="Яковлев Иван" created="200906022258" modified="200906151719" tags="[[Команды для работы с группами и пользователями]] TODO" changecount="12">
<pre>!Описание
Команда {{{addgroup}}} используется для создания в системе новой группы. Чтобы создать новую группу, напечатайте: 
{{{
addgroup newgroup
}}}
Эта команда создаст новую группу с именем ''newgroup''.

!Файлы
;{{{/etc/adduser.conf}}}
:конфигурационный файл связанный с работой команд [[adduser|adduser - создание нового пользователя]] и [[addgroup|addgroup - создание новой группы]].

!См. также
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=addgroup&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на manpages.ubuntu.com (groupadd)|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=groupadd&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=addgroup&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]
*[[Описание на Opennet.ru (groupadd)|http://www.opennet.ru/man.shtml?topic=groupadd&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]





</pre>
</div>
<div title="adduser - создание нового пользователя" modifier="Яковлев Иван" created="200906022302" modified="200906151720" tags="[[Команды для работы с группами и пользователями]] TODO" changecount="7">
<pre>!Описание
Команда {{{adduser}}} используется для создания нового пользователя в системе. Чтобы создать нового пользователя, наберите: 
{{{
sudo adduser newuser
}}}
Эта команда создаст нового пользователя с именем ''newuser''.

Чтобы назначить пароль для нового пользователя, используйте команду [[passwd|passwd - изменение пароля пользователя]]: 
{{{
sudo passwd newuser
}}}
Наконец, чтобы добавить нового пользователя в новую группу, наберите: 
{{{
sudo adduser newuser newgroup
}}}

!См. также
*[[adduser - Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=adduser&amp;titles=Title&amp;lr=lang_en]]
*[[adduser - Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=adduser&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]
*[[passwd - Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=passwd&amp;titles=Title&amp;lr=lang_en]]
*[[passwd - Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=passwd&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]</pre>
</div>
<div title="apt-cache - команда для работы с локальным кешем базы данных пакетов" modifier="Яковлев Иван" created="200906151752" modified="200906151758" tags="[[Команды установки пакетов]] TODO" changecount="9">
<pre>!Описание
apt-cache выполняет ряд операций над кэшем пакетов APT. apt-cache названа так просто для того, чтобы отделить те операции, которые она выполняет от тех, которые выполняют другие утилиты apt.

Команда может принимать одно из следующих значений:
*''add файл1 [файл2] [...]''
*''gencaches''
*''showpkg пакет1 [пакет2] [...]''
*''stats'' -- отображает некоторую статистику касательно кэша.
*''dump''
*''dumpavail''
*''unmet''
*''check''
*''search'' -- Осуществляет поиск заданного пакета (можно использовать регулярные выражения).
*''show''
*''showpkg'' -- Выводит информацию о заданном пакете.
*''depends'' -- Показывает зависимости указанного пакета.
*''pkgnames'' 
*''dotty'' 

!Файлы
*{{{/etc/apt/sources.list}}} -- источники для получения пакетов 
*{{{/var/lib/apt/lists/}}} -- область хранения информации о состоянии каждого ресурса пакетов, заданного в списке источников 
*{{{/var/lib/apt/lists/partial/}}} -- временная область хранения информации в процессе скачивания 

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=apt-cache&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=apt-cache&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="apt-get - утилита управления APT (интерфейс командной строки)" modifier="Яковлев Иван" created="200906151743" modified="200906200034" tags="[[Команды установки пакетов]]" changecount="4">
<pre>!Описание
apt-get это многофункциональный инструмент командной строки для установки, удаления и администрирования установленных пакетов на основе APT базы данных.

!Синтаксис
{{{
apt-get [опции] [команда] [пакет ...]
}}}

!Команды
;update
:используется для повторной синхронизации файлов описаний пакетов с их источником. Описания доступных пакетов будут получены из источников, указанных в {{{/etc/apt/sources.list}}}. Например, при использовании архива Debian, эта команда разыскивает и просматривает файлы Packages.gz, таким образом становится доступной информация о новых и обновлённых пакетах.
{{note{
@@font-weight: bold;color: red;ВНИМАНИЕ:@@
Перед ''upgrade'' и ''dist-upgrade'' всегда должно выполняться update. Пожалуйста помните, что индикатор прогресса показывает не точную информацию, поскольку размер файлов пакетов заранее не известен.
}}}
;upgrade
:используется для установки новейших версий всех установленных пакетов системы из источников, указанных в {{{/etc/apt/sources.list}}}. Будут разысканы новейшие версии установленных в настоящий момент пакетов и произведено обновление; ни в коем случае не будет удалено ни одного установленного пакета или установлено нового пакета, не имеющего уже установленной в системе предыдущей версии. Текущие версии установленных в настоящий момент пакетов, если они не могут быть обновлены новыми версиями без изменения статуса других пакетов, будут оставлены в неизменном виде. Для того, чтобы ''apt-get'' узнал о существовании доступных новых версиях пакетов, данной команде должна предшествовать команда ''update''. 

;dselect-upgrade
:используется совместно с традиционным инструментом управления пакетов в Debian GNU/Linux - ''dselect(8)''. ''dselect-upgrade'' следует изменениям, которые делает ''dselect'' с полем Status доступных пакетов и выполняет действие, необходимое для реализации этого состояния (например, удаление старых и установка новых пакетов). 

;dist-upgrade
:''dist-upgrade'', в дополнение выполняет функцию ''upgrade'', а также разумно управляет изменением зависимостей с новыми версиями пакетов; ''apt-get'' имеет &quot;умную&quot; систему разрешения конфликтов и она будет в случае необходимости пытаться произвести обновление наиболее важных пакетов за счет менее важных. Файл {{{/etc/apt/sources.list}}} содержит список источников для получения пакетов, из которых будут получены файлы пакетов. 

;install
:устанавливает один или более пакетов отмеченных к установке. Каждый пакет - это имя пакета, а не полное имя файла, содержащее этот пакет (например, в системе Debian GNU/Linux, в качестве пакета может быть указано имя ldso, а не ldso_1.9.6-2.deb). Все пакеты, требуемые заданным пакетом (пакетами) отмеченными к установке, также будут получены и установлены. Файл {{{/etc/apt/sources.list}}} используется для определения местонахождения нужных пакетов. Если к имени пакета добавляется символ переноса (без разделяющего пробела), то заданный пакет будет удален, если он установлен. Эта особенность может быть использована для перекрытия решения, сделанного системой разрешения конфликтов apt-get.
:Если нет пакетов, совпадающих с заданным выражением и выражение содержит один из символов '{{{.}}}', '{{{?}}}' или '{{{*}}}', то оно рассматривается как шаблон для регулярных выражений POSIX и уже этот шаблон применяется ко всем именам пакетов в базе данных. Любые совпадающие с шаблоном пакеты будут затем установлены (или удалены). Заметим, что к примеру, подстрока '{{{lo*}}}' совпадает с '{{{how-lo}}}' и '{{{lowest}}}'. Если это нежелательно, предваряйте их символом '{{{^}}}'. 

;remove
:идентична ''install'' за исключением того, что пакеты вместо установки удаляются. Если к имени пакета добавляется знак плюс (без разделяющего пробела), то указанные пакеты будут установлены. 

;source
:принуждает получать пакеты с исходными текстами. APT проверит доступные пакеты на предмет получения их исходных текстов. Затем он ищет и копирует в текущий каталог новейшую доступную версию этих исходных текстов. Пакеты исходных текстов обслуживаются отдельно от бинарных через ввод строк deb-src или rpm-src в файл {{{/etc/apt/sources.list}}}. Предполагается, что для получения исходных текстов, вы будете использовать источник, отличный от того, из которого вы получаете готовые пакеты. Если задана опция --compile, то пакет с исходными текстами будет скомпилирован в бинарный deb-пакет с помощью утилиты dpkg-buildpackage или, на системах использующих RPM, при помощи rpm -ba будет собран бинарный пакет. Если задана опция --download-only, то пакет с исходными текстами не будет распакован. 
:Заметим, что пакеты с исходными текстами не отслеживаются как бинарные пакеты, они существуют только в текущем каталоге, что очень похоже на простое выкачивание архивов исходных текстов .ta r.gz. 

;check
:это диагностический инструмент; он обновляет кэш пакетов и проверяет пакеты, которые недо-установлены в силу каких-либо причин. 

;clean
:clean очищает локальное хранилище полученных файлов пакетов. Команда удаляет все, но оставляет файлы из {{{/var/cache/apt/archives/}}} и {{{/var/cache/apt/archives/partial/}}}. Когда APT используется как один из методов ''dselect(8)'', clean запускается автоматически. Те, кто не пользуется dselect, для освобождения места на диске могут время от времени использовать {{{apt-get clean}}}. 

;autoclean
:Как и ''clean'', ''autoclean'' очищает локальное хранилище полученных файлов пакетов. Отличие состоит в том, что эта команда удаляет только те файлы пакетов, которые больше не могут быть получены и использованы. Это позволяет обслуживать кэш в течении длительного периода без потери контроля над ним. 

!Файлы
*/etc/apt/sources.list источники для получения пакетов 
*/var/cache/apt/archives/ область хранения полученных файлов 
*/var/cache/apt/archives/partial/ область хранения получаемых файлов 
*/var/state/apt/lists/ область хранения информации о состоянии каждого ресурса пакетов, заданного в списке источников 
*/var/state/apt/lists/partial/ временная область хранения информации в процессе скачивания 

!См. также
*[[Apt-Get]]

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/manpages/jaunty/en/man8/apt-get.8.html]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=apt-get&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="aptitude - высокоуровневый командный интерфейс к менеджеру пакетов" modifier="Яковлев Иван" created="200906151801" modified="200906201758" tags="[[Команды установки пакетов]] [[TODO - нужен перевод статьи]]" changecount="9">
<pre>!Описание
''aptitude'' is a text-based interface to the Debian GNU/Linux package system.

It allows the user to view the list of packages and to perform package management tasks such as installing, upgrading, and removing packages. Actions may be performed from an &quot;interactive mode&quot; or from the command-line. 

!Синтаксис
{{{
aptitude [ -S fname ] [ -u | -i ]

aptitude [ options ] [ update | upgrade | forget-new | clean | autoclean ]

aptitude [ options ] [ remove | hold | purge | markauto | unmarkauto | dist-upgrade ] packages...

aptitude [ options ] search patterns...

aptitude [ options ] download packages...   
}}}

!Примеры использования
Очиста диска от устаревших пакетов:
{{{
sudo aptitude autoclean
}}}
Удаляет все устаревшие .deb файлы из каталога {{{/var/cache/apt/archives}}}

Установка указанного пакета:
{{{
sudo aptitude install &lt;package&gt;
}}}
{{note{
''ЗАМЕЧАНИЕ:''
Для выбора нужного пакета доступно несколько дополнительных опций. См. далее
}}}
Удаление установленного пакета:
{{{
sudo aptitude remove &lt;package&gt;
}}}

Обновление всех установленных пакетов до новых версий:
{{{
sudo aptitude dist-upgrade
}}}
Интеллектуально удалее не нужные пакеты и устанавливает новые если это требуется.

Вывод списка доступных для приложения модулей:
{{{
sudo aptitude search php5-
}}}
Выдаст список пакетов, которые будут запускаться с php5 и список доступных модулей.

Вывод списка зависимосте для устанавливаемого пакета
{{{
aptitude show nginx
...
Depends: libc6 (&gt;= 2.4), libpcre3 (&gt;= 7.4), libssl0.9.8 (&gt;= 0.9.8f-5), zlib1g
         (&gt;= 1:1.1.4), lsb-base (&gt;= 3.2-14)
...
}}}

!Доступные Команды
;install
:Install one or more packages. The packages should be listed after the &quot;install&quot; command; if a package name contains a '{{{~}}}', it will be treated as a search pattern and every package matching the pattern will be installed. (see &quot;SEARCHING, etc&quot; in {{{/usr/share/doc/aptitude/README}}})
:Appending &quot;{{{-}}}&quot;, &quot;{{{+}}}&quot;, &quot;{{{_}}}&quot;, or &quot;{{{=}}}&quot; to the name of a package will cause the package to be removed, installed, purged, or held respectively. This can be used, for instance, to perform multiple actions from one command line.
:As a special case, &quot;install&quot; with no arguments will act on any stored/pending actions.
{{note{
''ЗАМЕЧАНИЕ:''
The &quot;install&quot; command will modify aptitude's stored information about what actions to perform. Therefore, if you issue the command &quot;aptitude install foo bar&quot; and then abort the installation, you will need to (eg) run &quot;{{{aptitude remove foo bar}}}&quot; to cancel that order.
}}}

;remove, purge, hold
:These commands are the same as &quot;install&quot;, but apply the named action to all packages unless specified otherwise.
:(for instance, &quot;{{{aptitude remove '~ndeity'}}}&quot; will remove all packages whose name contains &quot;deity&quot;)

;markauto, unmarkauto
:Mark packages as automatically installed or manually installed, respectively. You may specify packages using the same syntax as before, including specifying actions to be performed. For instance, &quot;{{{aptitude markauto '~slibs'}}}&quot; will mark all packages in the &quot;libs&quot; section as automatically installed.

;update
:Update the list of available packages from the master servers. (this is equivalent to &quot;{{{apt-get update}}}&quot;)

;upgrade
:Upgrades installed packages to their most recent version. Installed packages will not be removed unless they are unused; packages which are not currently installed will not be installed.
:If a package cannot be upgraded without violating these constraints, it will be kept back.

;forget-new
:Forgets which packages are &quot;new&quot; (equivalent to pressing &quot;{{{f}}}&quot; in interactive mode)

;search
:Searches for packages matching one or more expressions. The expressions should be listed after the &quot;search&quot; command. All packages matching the given expressions will be displayed. As usual, this may be a full search expression; for instance, &quot;aptitude search '{{{~N}}}'&quot; will list all &quot;new&quot; packages. Search expressions are explained in detail in {{{/usr/share/doc/aptitude/README}}}.

;clean
:Removes all downloaded and cached packages.

;autoclean
:Removes any cached packages which are no longer downloadable.

;download
:Downloads the .deb file for the most recent version of the given package to the current directory.
:The following hyphened arguments function as actions for the interactive mode of the program; however, they are only used internally. Generally, you shouldn't need to set these yourself.

;-S fname
:Loads the extended state information from fname. 

;-u
:Begins updating the package lists when the program starts. You cannot use this option and {{{-i}}} at the same time. 

;-i
:Displays a download screen when the program starts (equivalent to starting the program and then pressing '{{{g}}}') You cannot use this option and {{{-u}}} at the same time. 

!См. также
*[[Aptitude]]

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=aptitude&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=aptitude&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="awk - язык поиска и обработки шаблонов" modifier="Яковлев Иван" created="200906121437" tags="[[Команды обработки содержимого файла]] [[TODO - нужен перевод статьи]]" changecount="1">
<pre>!Описание
The ''awk'' command, named for its developers (Aho, Weinberger, and Kernighan), is more of a database manipulation utility. It can identify lines with a key word and read out the text from a specified column in that line. Again, using the {{{/etc/passwd}}} file, for example, the following command will read out the username of every user with Mike in the comment column:
{{{
$ awk '/Mike/ {print $1}' /etc/passwd
}}}

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=awk&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=awk&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="cat - объединяет файлы и направляет их на стандартный вывод" modifier="Яковлев Иван" created="200906100017" modified="200906231955" tags="[[Команды для работы с файлами и каталогами]]" changecount="6">
<pre>!Описание
Выводит на экран содержимое текстового файла или объединяет содержимое двух файлов и выводит его на экран.

!Синтаксис
{{{
cat имя_файла
}}}

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=cat&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=cat&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="cd - сменить текущую дирректорию" modifier="Яковлев Иван" created="200906022201" modified="200906152018" tags="[[Навигация по каталогам]]" changecount="11">
<pre>!Описание
Команда {{{cd}}} используется для смены директории. При открытии терминала вы окажетесь в домашней директории. Для перемещения по файловой системе используйте команду {{{cd}}}.
Чтобы перейти в корневой каталог наберите 
{{{
cd /
}}}

Для перехода в ваш домашний каталог наберите 
{{{
cd
}}}
или
{{{
cd ~
}}}
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
Команда ~ символьное представление текущей пользовательской домашней директории. Как показано выше, {{{cd ~}}} ~ является аналогом {{{cd /home/username/}}}. Однако, запуская команду от имени суперпользователя {{{root}}} (например с помощью [[sudo|http://manpages.ubuntu.com/manpages/jaunty/en/man8/sudo.8.html]]), ~ будет указывать на {{{/root}}}. При запуске команды совместно с {{{sudo}}}, необходимо указывать полный путь к вашей домашней директории.
}}}

Для перехода в каталог уровнем выше в иерархии введите 
{{{
cd ..
}}}

Переход в предыдущий каталог (назад) делается с помощью 
{{{
cd -
}}}

Для перехода через несколько уровней каталогов одной командой укажите полный путь к каталогу назначения. Например, введите 
{{{
cd /var/www
}}}
для перехода в подкаталог {{{/www}}} каталога {{{/var/}}}. Другой пример, введите 
{{{
cd ~/Desktop
}}}
для перехода в подкаталог {{{Desktop}}} внутри вашего домашнего каталога.

!См. также
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=cd&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=cd&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]




</pre>
</div>
<div title="chattr - смена атрибутов файла" modifier="Яковлев Иван" created="200906121910" modified="200906121919" tags="[[Команды для работы с файлами и каталогами]]" changecount="4">
<pre>!Описание
Files and directories in Linux file systems all have read, write and execute permissions associated with user, group, and others. However, there are also other attributes that can be attached to files and directories that are specific to certain file system types.

Files on ext2 and ext3 file systems have special attributes that you may choose to use. You can list these attributes with the lsattr command. Most attributes are obscure and not turned on by default. Here’s an example of using lsattr to see some files’ attributes:
{{{
lsattr /etc/host*
}}}
Выдаст:

{{{------------- /etc/host.conf}}}
{{{------------- /etc/hosts}}}
{{{------------- /etc/host.allow}}}
{{{------------- /etc/host.deny}}}

{{{
lsattr -aR /tmp/ | less         
}}}
Recursively list all {{{/tmp}}} attributes

The dashes represent 13 ext2/ext3 attributes that can be set. None are on by default. Those attributes are the following:
*{{{a}}} -- append only,
*{{{c}}} -- compressed,
*{{{d}}} -- no dump,
*{{{i}}} -- immutable,
*{{{j}}} -- data journalling,
*{{{s}}} -- secure deletion,
*{{{t}}} -- no tail-merging,
*{{{u}}} -- undeletable,
*{{{A}}} -- no atime updates,
*{{{D}}} -- synchronous directory updates,
*{{{S}}} -- synchronous updates, and
*{{{T}}} -- top of directory hierarchy.
You can change these attributes using the chattr command. Here are some examples:
{{{
sudo chattr +i whatever.iso
sudo chattr +A -R /home/francois/images/*
sudo chattr +d ubuntu-7.04-desktop.i386.iso
lsattr whatever.iso /home/francois/images/* ubuntu-7.04-desktop.i386.iso
}}}
Выдаст:

{{{----i-------- whatever.iso}}}
{{{-------A----- /home/francois/images/einstein.jpg}}}
{{{-------A----- /home/francois/images/goth.jpg}}}
{{{------d------ ubuntu-7.04-desktop.i386.iso}}}

As shown in the preceding example, with the {{{+i}}} option set, the whatever.iso file becomes immutable, meaning that it can’t be deleted, renamed, or changed, or have a link created to it. Here, this prevents any arbitrary changes to the file. (Not even the root user can change the file until the {{{i}}} attribute is gone.) You can use this to help protect system files.

The {{{-R}}} option in the example recursively sets the {{{+A}}} option, so all files in the images directory and below can’t have access times (atime record) modified. Setting A attributes can save some disk I/O on laptops or flash drives. If you use the dump command to back up your ext2/ext3 file systems, the {{{+d}}} option can prevent selected files from being backed up. In this case, we chose to not have a large ISO image backed up.

To remove an attribute with chatter, use the minus sign ({{{-}}}). For example:
{{{
sudo chattr -i whatever.iso
}}}
{{note{
''ЗАМЕЧАНИЕ:''
Crackers who successfully break into a machine will often replace some system binaries (such as {{{ls}}} or {{{ps}}}) with corrupt versions and make them immutable. It’s a good idea to occasionally check the attributes set for your executables (in {{{/bin}}}, {{{/usr/bin}}}, {{{/sbin}}}, and {{{/usr/sbin}}}, for example).
}}}


!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=chattr&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=chattr&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="chgrp - смена группы файлов" modifier="Яковлев Иван" created="200906152003" modified="200906152009" tags="[[Команды для работы с файлами и каталогами]] TODO" changecount="3">
<pre>!Описание
chgrp изменяет группу каждого заданного файла на группу, которая может быть представлена как именем группы, так и ее числовым идентификатором (GID).

!Синтаксис
{{{
chgrp -R группа имя_каталога
}}}
{{{-R}}} -- рекурсивно; смена во всех подкаталогах указанного каталога

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=chgrp&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=chgrp&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="chmod - изменение прав доступа к файлам и папкам" modifier="Яковлев Иван" created="200906061719" modified="200906061732" tags="[[Команды для работы с файлами и каталогами]]" changecount="11">
<pre>!Описание
''chmod'' — изменение прав доступа к файлам и папкам. Название происходит от программы ОС Unix chmod, которая, собственно, изменяет права доступа к файлам, каталогам и символическим ссылкам.

Права записываются сразу для трёх типов пользователей: владельца файла, группы, в которую он входит и для прочих пользователей. chmod может быть записан в двух форматах: в числовом и в символьном.

Для понимания сути задания прав в Unix-like системах, нужно знать представление чисел в восьмеричной и двоичной системах счисления
{{{
юзер  группа остальные

  7      5      5
 111    101    101
 rwx    r-x    r-x
  u      g      o
}}}
Пример символьной записи 'rwxr-xr-x'.

Примером числовой записи может служить '''755''', которая эквивалентна записанной выше строковой записи: каждое право имеет числовой код и может быть задано вручную:
*400 -- владелец имеет право на чтение;
*200 -- владелец имеет право на запись;
*100 -- владелец имеет право на выполнение;
*40 -- группа имеет право на чтение;
*20 -- группа имеет право на запись;
*10 -- группа имеет право на выполнение;
*4 -- остальные имеют право на чтение;
*2 -- остальные имеют право на запись;
*1 -- остальные имеют право на выполнение.

Суммировав эти коды можно получить символьную запись. Например, ''chmod 444 {имяфайла}'': 400+40+4=444 — все имеют право только на чтение.

Помимо стандартных &quot;''rwx''&quot; значений команда CHMOD осуществляет ещё управление битами SGID , SUID и T. Установленные атрибуты SUID или SGID позволяют запускать файл на выполнение с правами владельца файла или группы соответственно.
{{{
Для SUID - вес 4000, а для SGID - 2000.
}}}
Пример ''chmod 4444 {имяфайла}'' - все имеют право только на чтение, но запускаться файл на исполнение будет с правами владельца. Для папки: установка SGID приведет к установке принадлежности каждого нового создаваемого файла к той же группе, к которой принадлежит сам каталог, а не к основной группе владельца, как это происходит по умолчанию. SUID для каталога не имеет смысла.

t-бит используется с каталогами. Когда t-бит для каталога не установлен, файл в данном каталоге может удалить любой пользователь, имеющий доступ на запись к данному файлу. Устанавливая t-бит на каталог мы меняем это правило таким образом, что удалить файл или изменить может только владелец этого файла. Следуя приведенной выше кодировке
{{{
t-бит имеет вес 1000.
}}}
Например, выполнив ''chmod 1564 {имяпапки}'' для папки, можно создать общую сетевую папку, где для всех членов группы файлы будут доступны для чтения, но удалить и изменить можно будет только свои (владельца) файлы

!Примеры
''{{{chmod octal file}}}'' – сменить права file на octal, раздельно для пользователя, группы и для всех добавлением: 
*4 – чтение (''r'')
*2 – запись (''w'')
*1 – исполнение (''x'')

;Примеры:
:''{{{chmod 777}}}'' -- чтение, запись, исполнение для всех
:''{{{chmod 755}}}'' -- ''rwx'' для владельца, ''rx'' для группы и остальных.
:{{{chmod 000 www/file.html}}} -- изменить режим доступа к файлу ''file.html'' в каталоге ''www'' на 000. При таком режиме доступа его никто не сможет открыть. Так можно быстро запретить доступ через веб к какому-то файлу.

!См. также
*[[chroot|chroot - выполнение команды или оболочки shell с особым корневым каталогом]]

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=chmod&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=chmod&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="chmod - изменяет права доступа к файлу/каталогу" modifier="Яковлев Иван" created="200906151950" modified="200906151953" tags="[[Команды для работы с файлами и каталогами]] TODO" changecount="4">
<pre>!Описание
Изменяет права даступа к файлу/каталогу (где a=all, u=user, g=group, r=read w=write, x=executable). 
Также доступны опции:
;{{{-R}}}
:рекурсивно назначает привилегии проходя по всем подкаталогам указанного каталога;

;{{{--reference=/путь/к/файлу/имя_файла}}}
:копировать привилегии из указанного файла. 

Например, чтобы изменить права на файл с именем myfile и позволить все читать и записывать файл наберите следующую команду:
{{{
chmod a+rw myfile
}}}

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=chmod&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=chmod+&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="chown - смена владельца и группы для файла или каталога" modifier="Яковлев Иван" created="200906151957" modified="200906302204" tags="[[Команды для работы с файлами и каталогами]] TODO" changecount="6">
<pre>!Описание
''chown'' изменяет владельца и/или группу для каждого заданного файла.

!Синтаксис
{{{
chown [опции] пользователь[:группа] имя_файла
}}}
В качестве имени владельца/группы берется первый аргумент, не являющийся опцией. Если задано только имя пользователя (или числовой идентификатор пользователя), то данный пользователь становится владельцем каждого из указанных файлов, а группа этих файлов не изменяется. Если за именем пользователя через двоеточие следует имя группы (или числовой идентификатор группы), без пробелов между ними, то изменяется также и группа файла.

!Пример использования
Задаем рекурсивно (опция {{{-R}}}) владельца и группу для каталога {{{/var/www/myproject}}} и всех файлов и подкаталогов в данном каталоге:
{{{
sudo chown -R user:www-data /var/www/myproject
}}}

!Подробности GNU
Версия GNU позволяет использовать в качестве разделителя пользователя и группы точку вместо двоеточия (как в BSD). [Это не разрешается в стандарте POSIX, так как точка является допустимым символом в имени пользователя.] Если двоеточие или точка следует за именем пользователя, но группа не задана, то данный пользователь становится владельцем указанных файлов, а группа указанных файлов изменяется на основную группу пользователя. Если опущено имя пользователя, а двоеточие или точка вместе с группой заданы, то будет изменена только группа указанных файлов; в этом случае ''chown'' выполняет ту же функцию, что и ''chgrp''.

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=chown&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=chown&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="chroot - выполнение команды или оболочки shell с особым корневым каталогом" modifier="Яковлев Иван" created="200906052135" modified="200906061719" tags="[[Команды для работы с группами и пользователями]] TODO" changecount="7">
<pre>!Описание
''chroot'' в Unix-подобных операционных системах -- это операция изменения корневого каталога. Программа, запущенная с изменённым корневым каталогом, будет иметь доступ только к файлам, содержащимся в данном каталоге. Поэтому, если нужно обеспечить программе доступ к другим каталогам или файловым системам (например, {{{/proc}}}), нужно заранее примонтировать в целевом каталоге необходимые каталоги или устройства.

Изменение корневого каталога производится при помощи системного вызова [[chroot(2)|http://www.opennet.ru/man.shtml?topic=chroot&amp;category=2&amp;russian=0]]. Изменение корневого каталога затрагивает только текущий процесс (то есть процесс, сделавший системный вызов chroot(2)) и всех его потомков. Если требуется запустить некоторую программу с изменённым корневым каталогом, но в данной программе не предусмотрено выполнение вызова chroot(2), используют программу [[chroot(8)|http://www.opennet.ru/man.shtml?topic=chroot&amp;category=8&amp;russian=2]]. Эта программа принимает в качестве параметров новый корневой каталог и путь к программе. Она сначала сама выполняет вызов chroot(2) для изменения собственного корневого каталога на указанный, а затем запускает программу по заданному пути. Так как изменённый корневой каталог наследуется потомками процессов, программа запускается с изменённым корневым каталогом.

Сам по себе термин chroot может относиться или к концепции изменений корневого каталога, или к системному вызову chroot(2), или к программе chroot(8), что обычно понятно из контекста.

Программа, корень которой был перенесён в другой каталог, не может обращаться к файлам вне этого каталога. Это обеспечивает удобный способ помещения в «''sandbox''» («''песочницу''») тестовой, ненадёжной или любой другой потенциально опасной программы. Это также простой способ механизма «''jail''» («''тюрьмы''»). Но наиболее часто chroot используется для сборки дистрибутивов или отдельных программ как бы в «чистой» среде.

!См. также
*[[chmod|chmod - изменение прав доступа к файлам и папкам]]

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=chroot&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=chroot&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="cp - копировать файл или каталог" modifier="Яковлев Иван" created="200906022215" modified="200906100018" tags="[[Команды для работы с файлами и каталогами]]" changecount="7">
<pre>!Описание
Команда {{{cp}}} создает копию файла. Например команда 
{{{
cp foo bar
}}}
сделает точную копию {{{foo}}} с именем {{{bar}}}. {{{foo}}} останется не изменённым.

!См. также
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=cp&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=cp&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="date - выводит или устанавливает системные дату и время" modifier="Яковлев Иван" created="200906161119" modified="200906161123" tags="[[Информационные команды]] TODO" changecount="3">
<pre>!Синтаксис
{{{
date [ОПЦИЯ]... [+ФОРМАТ]
date [-u|--utc|--universal] [MMDDhhmm[[CC]YY][.ss]]  
}}}

!Описание
Выводит текущее время в заданном ФОРМАТЕ, или устанавливает системное время.

;{{{-d, --date=СТРОКА}}}
:показать не текущее время, а время, описанное заданной СТРОКОЙ

;{{{-f, --file=ФАЙЛ}}}
    соответствует применению {{{--date}}} для каждой строки ФАЙЛА

;{{{-r, --reference=ФАЙЛ}}}
:показать время последнего изменения ФАЙЛА 

;{{{-R, --rfc-2822}}}
:выводить дату и время в формате RFC 2822 

;{{{--rfc-3339=СПЕЦ}}}
:выводить дату и время в формате RFC 3339 {{{СПЕЦ=`date'}}}, {{{`seconds'}}} или {{{`ns'}}} для получения даты и времени с указанной точностью. 

;{{{-s, --set=СТРОКА}}}
:установить время, описанное СТРОКОЙ 

;{{{-u, --utc, --universal}}}
:показать или установить универсальное координированное время 

;{{{--help}}}
:показать справку и выйти 

;{{{--version}}}
:показать информацию о версии и выйти 

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=date&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=date&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="df - информация об использовании дискового пространства" modifier="Яковлев Иван" created="200906022244" modified="200906161111" tags="[[Информационные команды]]" changecount="4">
<pre>!Описание
{{{df}}} выводит информацию об использовании дискового пространства файловой системой для всех разделов жёсткого диска. 
{{{
df -h
}}}
представит информацию с использованием мегабайт (M) и гигабайт (G) вместо размера в блоках ({{{-h}}} от английского &quot;human-readable&quot;, то есть «понятно для человека»).

!См. также
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=df&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=df&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]



</pre>
</div>
<div title="dig - поиск IP-адреса указанного домена" modifier="Яковлев Иван" created="200906161132" modified="200907121222" tags="[[Команды для диагностики сети]] [[TODO - нужен перевод статьи]]" changecount="7">
<pre>!Описание
Подобно команде ''nslookup'' в Windows, выполняет &quot;поиск имени узла&quot; в Интернете.

The dig utility (domain information groper) is a flexible tool for interrogating DNS name servers. It performs DNS lookups and displays the answers that are returned from the name server(s) that were queried. Most DNS administrators use ''dig'' to troubleshoot DNS problems because of its flexibility, ease of use and clarity of output. Other lookup tools tend to have less functionality than dig.

Although dig is normally used with command-line arguments, it also has a batch mode of operation for reading lookup requests from a file. A brief summary of its command-line arguments and options is printed when the -h option is specified. Unlike earlier versions, the ~BIND9 implementation of dig allows multiple lookups to be issued from the command line.

Unless it is told to query a specific name server, dig tries each of the servers listed in {{{/etc/resolv.conf}}}. When no command line arguments or options are given, dig performs an NS query for &quot;{{{.}}}&quot; (the root).

It is possible to set per user defaults for dig with {{{${HOME}/.digrc}}}. This file is read and any options in it are applied before the command line arguments.

The following is a typical invocation of dig:
{{{
dig server name type 
}}}
;server
:The name or IP address of the name server to query. This can be an ~IPv4 address in dotted-decimal notation or an ~IPv6 address in colon-delimited notation. When the supplied server argument is a hostname, dig resolves that name before querying that name server. If no server argument is provided, dig consults {{{/etc/resolv.conf}}} and queries the name servers listed there. The reply from the name server that responds is displayed. 

;name
:The name of the resource record that is to be looked up. 

;type
:Indicates what type of query is required (ANY, A, MX, SIG, among others.) type can be any valid query type. If no type argument is supplied, dig performs a lookup for an A record. 

!Пример использования
{{{
dig baltnet.ru
}}}
Выдаст на экран:
{{terminal{
{{{
; &lt;&lt;&gt;&gt; DiG 9.5.1-P2 &lt;&lt;&gt;&gt; baltnet.ru
;; global options:  printcmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 653
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 3, ADDITIONAL: 3

;; QUESTION SECTION:
;baltnet.ru.                    IN      A

;; ANSWER SECTION:
baltnet.ru.             5       IN      A       217.168.64.59

;; AUTHORITY SECTION:
baltnet.ru.             5       IN      NS      ns.baltnet.ru.
baltnet.ru.             5       IN      NS      ns4.nic.ru.
baltnet.ru.             5       IN      NS      ns8.nic.ru.

;; ADDITIONAL SECTION:
ns.baltnet.ru.          5       IN      A       217.168.64.2
ns4.nic.ru.             5       IN      A       194.226.96.8
ns8.nic.ru.             5       IN      A       193.232.130.14

;; Query time: 21 msec
;; SERVER: 192.168.221.2#53(192.168.221.2)
;; WHEN: Tue Jun 16 14:34:21 2009
;; MSG SIZE  rcvd: 149
}}}
}}}

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/manpages/jaunty/en/man1/dig.1.html]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=dig&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="dmesg - выводит сообщения ядра при начальной загрузке Linux или настраивает их буфер" modifier="Яковлев Иван" created="200906161149" tags="[[Информационные команды]]" changecount="1">
<pre>!Синтаксис
{{{
dmesg [ -c ] [ -n уровень ] [ -s размбуфера ]  
}}}

!Описание
dmesg используется для просмотра и настройки уровня выходных сообщений, которые появляются в процессе начальной загрузки ядра Linux и хранятся в кольцевом буфере. Это полезная команда может помочь пользователю увидеть, как Linux распознавал устройства во время начальной загрузки и получить диагностическую информацию, которую выводили драйвера. Эту информацию можно использовать для устранения проблем в работе некоторых устройств. В данном случае вместо копирования с экрана сообщений в ручную, пользователю нужно всего лишь вызвать команду:
{{{
    dmesg &gt; boot.messages 
}}}
и отправить по электронной почте получившийся файл ''boot.messages'' тому, кто сможет разобраться и решить возникшую проблему (например, в тематический форум или список рассылки).

!Опции
;{{{-c}}}
:Очистить содержимое буфера сообщений ядра после вывода. 

;{{{-s размбуфера}}}
:Использовать для буфера сообщений ядра, буфер размером размбуфера. По умолчанию его размер 16392 байт. (Изначально стандартный буфер системного журнала (syslog) был 4096 байт, затем, начиная с ядра 1.3.54 - 8192 байт, а с ядра 2.1.113 - 16384 байт.) Если вы установили больший размер буфера сообщений ядра, чем определённый по умолчанию, то эту опцию можно использовать для просмотра всего буфера. 

;{{{-n уровень}}}
:Установить уровень, на котором сообщения системного журнала будут выводиться на консоль. Например, {{{-n 1}}} предотвращает вывод на консоль всех сообщений, за исключением явно тревожных. Несмотря на это, сообщения всех уровней будут записываться в {{{/proc/kmsg}}}, так что, сервисом ''syslogd(8)'' всё ещё можно будет контролировать источник появления сообщения ядра. Когда используется опция -n, dmesg не будет выводить или очищать кольцевой буфер сообщений ядра. При использовании обоих опций, только последняя опция командной строки будет иметь эффект. 

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=dmesg&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=dmesg&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="dpkg - менеджер пакетов Debian" modifier="Яковлев Иван" created="200906151853" modified="200906151900" tags="[[Команды установки пакетов]] TODO [[TODO - нужен перевод статьи]]" changecount="5">
<pre>!Описание
''dpkg'' это средство для установки, построения, удаления и управления пакетами Debian. The primary and more user-friendly front-end for dpkg is ''dselect(1)''. dpkg itself is controlled entirely via command line parameters, which consist of exactly one action and zero or more options. The action-parameter tells dpkg what to do and options control the behavior of the action in some way.

!Синтаксис
{{{
dpkg [параметры] действие  
}}}

!Основные действия
;{{{-i}}}
:устанвовить пакет.

;{{{-r}}}
:удалить пакет

;{{{-I}}}
:показать информацию о пакете

;{{{-- ignor-depends=имя_пакета.deb}}}
:игнорировать зависимости пи установке пакета (настоятельно не рекомендуется этого делать).

!Примеры использования
Показать список пакетов связанных с редактором ''vi(1)'':
{{{
dpkg -l aq*vi*aq
}}}
Чтобы просмотреть записи в {{{/var/lib/dpkg/available}}} для двух пакетов:
{{{
dpkg --print-avail elvis vim | less
}}}
Вручную просмотреть список пакетов:
{{{
less /var/lib/dpkg/available
}}}
Удалить установленный пакет elvis:
{{{
dpkg -r elvis
}}}
Чтобы установить пакет, сначала нужно найти его в архиве или на CDROM. Файл &quot;available&quot; показывает, что пакет vim находится в секции &quot;editors&quot; (&quot;редакторы&quot;):
{{{
cd /cdrom/hamm/hamm/binary/editors
dpkg -i vim_4.5-3.deb
}}}
Получить локальную копию состояний выбранных пакетов:
{{{
dpkg --get-selections &gt;myselections
}}}
Вы можете перенести этот файл на другой компьютер и установить его там с помощью:
{{{
dpkg --clear-selections
dpkg --set-selections &lt;myselections
}}}
Заметим, что при этом ничего не будет ни установлено, ни удалено, просто будут заданы состояния запрошенных пакетов. Для того, чтобы на самом деле скачать и установить запрошенные пакеты, вам понадобится другая программа. Например, запустите ''dselect'' и выберите &quot;Установить&quot;.

Обычно ''dselect(8)'' предоставляет более удобный способ изменить состояния выбранных пакетов. 

!Файлы
*{{{/etc/dpkg/dpkg.cfg}}} -- Файл конфигурации с параметрами по умолчанию. 
*{{{/var/log/dpkg.log}}} -- Файл журнала по умолчанию (смотрите {{{/etc/dpkg/dpkg.cfg(5)}}} и параметр {{{--log}}}). Остальные файлы перечислены с указанием их каталогов по умолчанию, смотрите параметр {{{admindir}}}, чтобы узнать, как изменить местоположение этих файлов. 
*{{{/var/lib/dpkg/available}}} -- Список доступных пакетов. 
*{{{/var/lib/dpkg/status}}} -- Состояния доступных пакетов. Этот файл содержит информацию о том, помечен ли пакет для удаления или нет, установлен он или нет, и т.д. Смотрите раздел ИНФОРМАЦИЯ О ПАКЕТАХ, где приведена подробная информация. 

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=dpkg&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=dpkg&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="dpkg-reconfigure - перенастраивает заново уже установленный пакет" modifier="Яковлев Иван" created="200906151905" tags="[[Команды установки пакетов]] TODO" changecount="1">
<pre>!Описание
''dpkg-reconfigure'' перенастраивает уже установленные пакеты. В качестве параметров указываются одно и более названий пакетов, которые нужно перенастроить. Будут заданы вопросы о конфигурации, их будет больше чем при начальной установке пакета.

!Синтаксис
{{{
dpkg-reconfigure [параметры] пакеты
}}}

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=dpkg-reconfigure&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=dpkg-reconfigure&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="file - идентификация типа файла" modifier="Яковлев Иван" created="200906111538" modified="200906111539" changecount="2">
<pre>!Описание
As there are no standard file extensions in Linux, it can be difficult to determine if a file is a text file, a compressed archive, an executable binary, or something else. The file command can address this problem. For example, the {{{file *}}} command, run in a home directory, tells me more about each of the files in that directory, as shown:

{{textAlignCenter{
[img[images/articles/file-cmd.jpg]]
}}}
If you want to use the file command to identify hidden files as well, run the {{{file `ls -a`}}} command. It takes a list of the names of all files, including hidden files, and uses it as input to the file command.

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|TODO]]
*[[Описание на Opennet.ru|TODO]]


</pre>
</div>
<div title="find - поиск файлов по каталогам" modifier="Яковлев Иван" created="200906111531" tags="[[Команды для работы с файлами и каталогами]] [[TODO - нужен перевод статьи]] TODO" changecount="1">
<pre>!Описание
The find command searches through directories and subdirectories for a desired file. For example, to find the full path to the Samba configuration file, smb.conf, you could use the following command, which would start the search in the top-level root directory ({{{/}}}):
{{{
$ sudo find / -name smb.conf
}}}
When I ran this command, it found additional examples of Samba configuration files, useful for my research. But this kind of search can take time on older or heavily loaded systems. If you know that the file is located in the {{{/etc}}} subdirectory tree, you could start in that directory with the following command:
{{{
$ sudo find /etc -name smb.conf
}}}
But that may not be desirable, as that would deprive you of the locations of the other example Samba configuration files.

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|TODO]]
*[[Описание на Opennet.ru|TODO]]


</pre>
</div>
<div title="free - информация о доступной и занятой оперативной памяти системы" modifier="Яковлев Иван" created="200906022247" modified="200906161110" tags="[[Информационные команды]]" changecount="5">
<pre>!Описание
Команда free предоставляет информацию о доступной и занятой оперативной памяти системы. 
{{{
free -m
}}}
производить вывод информации в мегабайтах, скорее всего это наиболее адекватно современным компьютерам.

Можно сделать алиас для данной команды:
{{{
alias free=&quot;free -m&quot;
}}}
теперь если вы наберете команду {{{free}}}, то в результате фактически будет выполнена команда {{{free -m}}}

!См. также
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=free&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=free&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]



</pre>
</div>
<div title="fuser - идентифицирует процессы, которые используют указанные файлы или сокеты" modifier="Яковлев Иван" created="200906161200" modified="200906161256" tags="[[Информационные команды]]" changecount="5">
<pre>!Синтаксис
{{{
fuser [-a|-s|-c] [-4|-6] [-n  space ] [-k [-i] [-signal ] ] [-muvf] name ...
fuser -l
fuser -V
}}}

!Описание
fuser отображает идентификаторы процессов (~PIDs), которые используют в данный момент указанные файлы или файловые системы, заданные аргументом name. По умолчанию во время вывода информации после имени каждого файла следует буква, показывающая вид доступа:
;c
:текущий каталог. 

;e
:запущенный исполняемый файл. 

;f
:открытый файл. По умолчанию в режиме вывода информации буква f может отсутствовать. 

;F
:открытый для записи файл. По умолчанию в режиме вывода информации буква F может отсутствовать. 

;r
:корневой каталог. 
 
;m
:отображаемый файл или разделяемая (совместно используемая) библиотека.

!Примеры использования
Детальный вывод информации о процессах использующих указанный файл:
{{{
fuser -v myfile
}}}
Уничтожает все процессы, использующие каким-либо образом файловую систему {{{/home}}}:
{{{
fuser -km /home 
}}}
Вызывает выполнение something, если никакой другой процесс не использует {{{/dev/ttyS1}}}:
{{{
if
    fuser -s /dev/ttyS1;
    then :;
    else something;
fi 
}}}
 показывает все процессы (локальные) на порте TELNET:
{{{
fuser telnet/tcp
}}}

!Параметры
;{{{-a}}}
:Показывает информацию для всех файлов, которые указаны в командной строке. По умолчанию выводятся имена только тех файлов, которые используются хотя бы одним процессом. 

;{{{-c}}}
:Подобно параметру -m и применяется для совместимости с POSIX. 

;{{{-f}}}
:Игнорируется без предупреждения. Применяется для совместимости с POSIX. 

;{{{-k}}}
:Уничтожает (завершает) процессы, которые используют указанный файл. Посылаемый сигнал завершения SIGKILL можно заменить с помощью параметра {{{-signal}}}. Процесс ''fuser'' никогда не уничтожит себя сам, однако может завершить работу других процессов fuser. Перед попыткой уничтожить выполняющийся процесс, команда fuser устанавливает эффективный идентификатор пользователя ID этого процесса в идентификатор собственного пользователя. 

;{{{-i}}}
:Перед завершением процесса потребует подтверждения от пользователя. Если не задан параметр {{{-k}}}, этот параметр игнорируется без предупреждения. 

;{{{-l}}}
:Выводит список всех существующих названий сигналов. 

;{{{-m}}}
:В качестве name указывается файл на смонтированной файловой системе или смонтированное специальное блочное устройство. Выводится список всех процессов, которые используют файлы на этой файловой системе. Если указанный файл является каталогом, тогда к его имени автоматически добавляется {{{name/}}}. и рассматривается любая файловая система, которая может быть смонтирована на этот каталог. 

;{{{-n space}}}
:Выбирает различные множества имён. Поддерживаются такие множество имён как file (по умолчанию это имена файлов), udp (локальные порты UDP) и tcp (локальные порты TCP). Для портов может быть указан либо номер порта, либо его символьное название. Можно использовать сокращенную запись цифрами name/Ispace (например, 80/tcp ), если она однозначно характеризует объект. 

;{{{-s}}}
:Выполняет операции без вывода сообщений. Параметры -u и -v игнорируются в этом режиме. Параметр {{{-a}}} не должен использоваться с параметром {{{-s}}}. 

;{{{-signal}}}
:Посылает процессу указанный сигнал завершения работы вместо обычного SIGKILL. Сигналы могут быть заданы по названию (например, {{{-HUP}}}) или по номеру (например, {{{-1}}}). Этот параметр без предупреждения игнорируется, если не используется параметр {{{-k}}}. 

;{{{-u}}}
:Добавляет к каждому PID имя владельца процесса. 

;{{{-v}}}
:Режим подробного информирования. Процессы показываются в стиле вывода команды ps.
:Поля PID, USER и COMMAND подобны выводу команды ''ps''. Поле ACCESS показывает процесс, который использует файл. Если объект используется ядром (например, в случае точек монтирования, swap файла и др.), вместо PID отображается строка kernel. 

;{{{-V}}}
:Выводит информацию о версии программы. 

;{{{-4}}}
:Выполняется поиск только для сокета ~IPv4. Этот параметр не должен использоваться с параметром {{{-6}}} и работает только с названиями space tcp и udp. 

;{{{-6}}}
:Выполняется поиск только для сокета ~IPv6. Этот параметр не должен использоваться с параметром {{{-4}}} и работает только с названиями space tcp и udp. 

;{{{-}}}
:Сбрасывает все параметры и устанавливает сигнал уничтожения процессов в SIGKILL. 

!Файлы
{{{/proc}}} -- месторасположение файловой системы proc

!См. также
kill(1), killall(1), lsof(8), ps(1), kill(2). 

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=fuser&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=fuser&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="grep и egrep - поиск образцов в файле" modifier="Яковлев Иван" created="200906121428" tags="[[Команды обработки содержимого файла]] [[TODO - нужен перевод статьи]]" changecount="1">
<pre>!Описание
!!grep
The grep command uses a search term to look through a file. It returns the full line that contains the search term. For example:
{{{
grep ‘Michael Jang’ /etc/passwd
}}}
looks for my name in the {{{/etc/passwd}}} file.

!!egrep
The egrep command is more forgiving; it allows you to use some unusual characters in a search, including {{{+}}}, {{{?}}}, {{{|}}}, {{{(}}} и {{{)}}}. While it’s possible to set up grep to search for these characters with the help of the backslash, the command can be awkward to use. The locate command described earlier is basically essentially a specialized version of the grep command, that uses the updatedb command–based database of files on the local system.

!Ссылки
*[[Описание grep на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=grep&amp;titles=Title&amp;lr=lang_en]]
*[[Описание grep на manpages.ubuntu.com|http://www.opennet.ru/man.shtml?topic=grep&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]
*[[Описание egrep на Opennet.ru|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=egrep&amp;titles=Title&amp;lr=lang_en]]
*[[Описание egrep на Opennet.ru|http://www.opennet.ru/man.shtml?topic=egrep&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="groupdel - удаление определения группы из системы" modifier="Яковлев Иван" created="200906151646" modified="200906151646" tags="[[Команды для работы с группами и пользователями]] TODO" changecount="2">
<pre>!Описание
Команда ''groupdel'' удаляет определение группы из системы путем удаления записи о соответствующей группе из файла {{{/etc/group}}}. Она, однако, не удаляет идентификатор группы (GID) из файла паролей; удаленный GID действует для всех файлов и каталогов, которые его имели.
{{{
groupdel имя_группы
}}}

!Файлы
{{{/etc/group}}}

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/manpages/jaunty/en/man8/groupdel.8.html]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=groupdel&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="groupmod - изменение определения группы в системе" modifier="Яковлев Иван" created="200906151711" modified="200906151713" tags="[[Команды для работы с группами и пользователями]]" changecount="3">
<pre>!Синтаксис
{{{
groupmod [-g идентификатор [-o]] [-n имя] группа
}}}

!Описание
Команда groupmod изменяет определение указанной группы путем изменения соответствующей записи в файле {{{/etc/group}}}.

Поддерживаются следующие опции:
;-g идентификатор
:Идентификатор новой группы. Этот идентификатор группы должен быть неотрицательным десятеричным целым числом, не превышающим значения MAXUID, определенного в заголовочном файле param.h. По умолчанию выделяется уникальный идентификатор группы в допустимом диапазоне. Идентификаторы групп в диапазоне 0-99 зарезервированы.

;-o
:Эта опция позволяет задавать дублирующийся (не уникальный) идентификатор группы.

;-n имя
:Строка печатных символов, задающая новое имя для группы. Она не должна содержать двоеточия (:) или переводы строк (\n).

;группа
:Текущее имя изменяемой группы.

Если перед группой стоит символ {{{+}}}, (например, {{{+student}}}), определение группы администрируется сетевой информационной службой (Network Information Service - NIS). В этом случае, значение идентификатора группы берется из базы данных NIS. Для таких групп использование опций -g или -o вызовет выдачу сообщения о синтаксической ошибке. Более детальную информацию можно найти на странице справочного руководства group(4).

!Файлы
{{{
/etc/group
}}}

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=groupmod&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=groupmod&amp;category=1]]


</pre>
</div>
<div title="groups - выдает группы, в которые входит пользователь" modifier="Яковлев Иван" created="200906151706" modified="200906151706" tags="[[Команды для работы с группами и пользователями]] TODO" changecount="2">
<pre>!Описание
выдает группы, в которые входит пользователь. Пример использования:
{{{
groups имя_пользователя
}}}

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/manpages/jaunty/en/man1/groups.1.html]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=groups&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="head - просмотр первых 10 строк и tail - просмотр последних 10 (tail) строк файла" modifier="Яковлев Иван" created="200906111554" tags="[[Команды для работы с файлами и каталогами]] [[TODO - нужен перевод статьи]] TODO" changecount="1">
<pre>!Описание
While the head and tail commands are related, they are separate commands that work in opposite ways. By default, the head filename command looks at the first 10 lines of a file, and the tail filename command looks at the last 10 lines of a file. You can specify a different number of lines with the {{{-nxy}}} switch. For example:
{{{
tail -n15 /etc/passwd
}}}
This command lists the last 15 lines of the {{{/etc/passwd}}} file. The tail -f logfile command is commonly used as a way to monitor log messages as they appear. It’s often used with files in the {{{/var/log}}} directory.

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|TODO]]
*[[Описание на manpages.ubuntu.com|TODO]]
*[[Описание на Opennet.ru|TODO]]
*[[Описание на Opennet.ru|TODO]]


</pre>
</div>
<div title="hier - описание иерархии файловой системы (The Filesystem Hierarchy Standard)" modifier="Яковлев Иван" created="200906031324" modified="200906122254" changecount="11">
<pre>!Описание
Типичная система Linux имеет, кроме прочих, следующие каталоги:
;{{{/}}}
:Корневой каталог. С него начинается все дерево каталогов.

;{{{/bin}}}
:Каталог, содержащий исполняемые программы, необходимые для работы в однопользовательском режиме и для запуска или ремонта системы. 

;{{{/boot}}}
:Содержит статические файлы для загрузчика системы. Файлы этого каталога необходимы при загрузке системы. Инсталлятор карты и конфигурационные файлы должны находится не здесь, а в {{{/sbin}}} и {{{/etc}}}. 

;{{{/dev}}}
:Специальные файлы и файлы устройств, ссылающиеся на физические устройства. См. [[mknod(1)|http://www.opennet.ru/man.shtml?topic=mknod&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]. 

;{{{/dos}}}
:Если на компьютере запускаются и Linux, и ~MS-DOS, то обычно файловая система DOS подключается к этому каталогу. 

;{{{/etc}}}
:Содержит конфигурационные файлы машины. Hекоторые большие программные пакеты, такие, как X11, могут иметь свои собственные подкаталоги в {{{/etc}}}. Конфигурационные общедоступные файлы могут помещаться либо в этот каталог, либо в {{{/usr/etc}}}. Тем не менее, программы всегда должны искать эти файлы в {{{/etc}}}. Вы можете иметь ссылки на эти файлы в {{{/usr/etc}}}. 

;{{{/etc/opt}}}
:Файлы настроек для дополнительных приложений в {{{/opt}}}. 

;{{{/etc/sgml}}}
:Этот каталог содержит файлы настроек для SGML и XML (дополн.). 

;{{{/etc/skel}}}
:При создании новой учетной записи пользователя файлы из этого каталога, как правило, копируются в домашний каталог пользователя. 

;{{{/etc/X11}}}
:Конфигурационные файлы оконной системы X11. 

;{{{/home}}}
:В машинах с домашними каталогами пользователей эти каталоги обычно прямо или косвенно содержатся в этом каталоге. Его структура зависит от администратора системы. 

;{{{/lib}}}
:Этот каталог должен содержать разделяемые библиотеки, необходимые для загрузки системы и запуска команд, содержащихся в корневой файловой системе. 

;{{{/mnt}}}
:Этот каталог является точкой подключения временно запускаемых файловых систем. 

;{{{/opt}}}
:Этот каталог седержит дополнительные пакеты с файлами собранными статически. 

;{{{/proc}}}
:Точка подключения файловой системы proc, предоставляющей пользователю доступ к информации о запущенных процессах и ядре. Это псевдофайловая система, более подробно описанная в [[proc(5)|http://www.opennet.ru/man.shtml?topic=proc&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]. 

;{{{/root}}}
:Этот каталог является домашним для пользователя ''root''. 

;{{{/sbin}}}
:Как и {{{/bin}}}, содержит команды, необходимые для запуска системы, но, как правило, не запускаемые обычными пользователями. 

;{{{/tmp}}}
:Этот каталог содержит временные файлы, которые можно удалить без всяких проблем в любое время, например, при загрузке системы. 

;{{{/usr}}}
:К этому каталогу обычно подключается отдельный раздел. В нем должны содержаться разделяемые, предназначенные только для чтения данные, так что он может быть запущен различными машинами, работающими в Linux. 

;{{{/usr/X11R6}}}
:Система ~X-Window, версия #11, выпуск #6 (дополн.). 

;{{{/usr/X11R6/bin}}}
:Исполняемые файлы, принадлежащие системе ~X-Windows. Часто на него имеется символьная ссылка в более традиционном каталоге {{{/usr/bin/X11}}}. 

;{{{/usr/X11R6/lib}}}
:Файлы данных, связанные с системой ~X-Windows. 

;{{{/usr/X11R6/lib/X11}}}
:Содержит различные файлы, необходимые для запуска X Window System. В каталоге {{{/usr/lib/X11}}} часто имеется символьная ссылка на вышеуказанный каталог. 

;{{{/usr/X11R6/include/X11}}}
:Содержит файлы заголовков для компиляции программ, использующих систему X11. Часто имеется символьная ссылка на этот каталог в каталоге {{{/usr/inlcude/X11}}}. 

;{{{/usr/bin}}}
:Это основной каталог для исполняемых программ. Большая часть программ, не требующихся для загрузки или для ремонта системы, не устанавливаемых локально и запускаемых обычными пользователями, должна быть помещена в этот каталог. 

;{{{/usr/bin/X11}}}
:Традиционное место поиска исполняемых файлов X11; в Linux это обычно символьная ссылка на {{{/usr/X11R6/bin}}}. 

;{{{/usr/dict}}}
:Заменен на /usr/share/dict. 

;{{{/usr/doc}}}
:Заменен на /usr/share/doc. 

;{{{/usr/etc}}}
:В этом каталоге возможно хранить общедоступные конфигурационные файлы, которые могут использоваться несколькими машинами одновременно. Hесмотря на это, команды, ссылающиеся на них, должны находиться в каталоге {{{/etc}}}. Ссылки из каталога {{{/etc}}} должны указывать на соответствующие файлы в {{{/usr/etc}}}. 

;{{{/usr/games}}}
:Программы для обучения и игры (дополн.). 

;{{{/usr/include}}}
:Файлы заголовков для компилятора C. 

;{{{/usr/include/X11}}}
:Файлы заголовков для компилятора C и системы ~X-Windows. Как правило, это символьная ссылка на {{{/usr/X11R6/include/X11}}}. 

;{{{/usr/include/asm}}}
:Файлы заголовков, определяющие некоторые ассемблерные функции. Это символьная ссылка на {{{/usr/src/linux/include/asm}}}. 

;{{{/usr/include/linux}}}
:Содержит информацию, которая может меняться от выпуска к выпуску. Это символьная ссылка на {{{/usr/src/linux/include/linux}}} для получения информации, предназначенной только для данной системы. 
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
(Обратите внимание, что необходимо иметь файлы заголовоков, корректно работающие с текущей glibc и в пространстве пользователя. Hесмотря на это, исходные версии ядра не рассчитаны на работу в пользовательской программе и не знакомы с libc, которую Вы запустили. Весьма вероятно, что появятся ошибки, если /usr/include/asm и /usr/include/linux будут указывать на произвольное дерево ядра. Системы Debian не делают этого, а используют файлы заголовков тех версий ядра, которые себя хорошо зарекомендовали. Они поставляются в пакете libc*-dev package.
}}}

;{{{/usr/include/g++}}}
:Файлы заголовков, используемые с компилятором GNU C++. 

;{{{/usr/lib}}}
:Объектные библиотеки, в том числе и динамические, а также некоторые программы, обычно не запускаемые непосредственно. Более сложные программы могут иметь в этом каталоге свои подкаталоги. 

;{{{/usr/lib/X11}}}
:Стандартная область для файлов данных, связанных с программами X Window System, а также для конфигурационных файлов самой системы X Window System. В Linux это обычно символьная ссылка на {{{/usr/X11R6/lib/X11}}}. 

;{{{/usr/lib/gcc-lib}}}
:содержит исполняемые файлы и файлы заголовков для компилятора GNU C, имя которого [[gcc(1)|http://www.opennet.ru/man.shtml?topic=gcc&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]. 

;{{{/usr/lib/groff}}}
:Файлы для системы форматирования документов GNU groff. 

;{{{/usr/lib/uucp}}}
:Файлы для [[uucp(1)|http://www.opennet.ru/man.shtml?topic=uucp&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]. 

;{{{/usr/local}}}
:В этот каталог обычно помещаются локальные программы. 

;{{{/usr/local/bin}}}
:Локальные исполняемые файлы. 

;{{{/usr/local/doc}}}
:Локальная документация. 

;{{{/usr/local/etc}}}
:Файлы настройки локальных программ. 

;{{{/usr/local/games}}}
:Программы установленных игр. 

;{{{/usr/local/lib}}}
:Файлы, связанные с локальными программами. 

;{{{/usr/local/include}}}
:Файлы заголовков для компилятора C. 

;{{{/usr/local/info}}}
:Страницы info, связанные с локальными программами. 

;{{{/usr/local/man}}}
:Страницы man, связанные с локальными программами. 

;{{{/usr/local/sbin}}}
:Локальные программы для системного администрирования. 

;{{{/usr/local/share}}}
:Локальные данные приложений, которые могут быть разделены различными архитектурами одной ОС. 

;{{{/usr/local/src}}}
:Исходный код локального программного обеспечения. 

;{{{/usr/man}}}
:Заменен на /usr/share/man. 

;{{{/usr/sbin}}}
:Каталог, содержащий исполняемые программы для системного администрирования, не относящиеся к процессу загрузки, запуску {{{/usr}}} или ремонту системы. 

;{{{/usr/share}}}
:Каталог, где подкаталоги содержат данные, которые могут быть использованы в различных архитектурах одной и той же ОС. В нем содержатся данные из {{{/usr/doc}}}, {{{/usr/lib}}} или из {{{/usr/man}}}. 

;{{{/usr/share/dict}}}
:Содержит словарь для проверки орфографии. 

;{{{/usr/share/doc}}}
:Документация на установленные программы. 

;{{{/usr/share/games}}}
:Статические данные для игр из {{{/usr/games}}}. 

;{{{/usr/share/info}}}
:Информационные странички (вид документации). 

;{{{/usr/share/locale}}}
:Информация о локали. 

;{{{/usr/share/man}}}
:Странички руководства. 

;{{{/usr/share/man/&lt;locale&gt;/man[1-9]}}}
:Эти каталоги содержат разделы со страницами руководств в исходниках. 

;{{{/usr/share/misc}}}
:Различные данные которые могут быть разделяемыми. 

;{{{/usr/share/nls}}}
:Каталог с сообщениями на родном языке. 

;{{{/usr/share/sgml}}}
:Файлы для SGML и XML. 

;{{{/usr/share/terminfo}}}
:База данных для terminfo. 

;{{{/usr/share/tmac}}}
:Макросы Тroff не распространяемые вместе с groff. 

;{{{/usr/share/zoneinfo}}}
:Файлы информации о временном поясе. 

;{{{/usr/src}}}
:Исходные файлы тех частей системы, которые входят в состав различных пакетов. Hе используйте этот каталог для работы над своими проектами, так как файлы в подкаталогах {{{/usr}}} предназначены только для чтения (кроме случаев установки программного обеспечения). 

;{{{/usr/src/linux}}}
:Этот каталог всегда был традиционным местоположением исходных файлов ядра. Многие дистрибутивы размещают тут исходники для ядра. Для сборки собственного ядра, рекомендуется использовать другой каталог. 

;{{{/usr/tmp}}}
:Устарел. Должен быть ссылкой на /var/tmp. Эта ссылка оставлена только для совместимости систем, но ее не следует использовать. 

;{{{/var}}}
:Каталог, содержащий файлы, размер которых может меняться. Это файлы очередей и журнала. 

;{{{/var/adm}}}
:Этот каталог заменен на {{{/var/log}}} и должен быть символьной ссылкой на {{{/var/log}}}. 

;{{{/var/backups}}}
:Этот каталог зарезервирован. 

;{{{/var/cache}}}
:Кэшированные данные для программ. 

;{{{/var/catman/cat[1-9]}}} или {{{/var/cache/man/cat[1-9]}}}
:Эти каталоги содержат предварительно отформатированные странички руководства в соответствии с их разделами. (Категорически запрещается использовать их в работе). 

;{{{/var/cron}}}
:Зарезервированные каталог. 

;{{{/var/lib}}}
:Каталог с состоянием переменных для программ. 

;{{{/var/local}}}
:Данные по переменным для {{{/usr/local}}}. 

;{{{/var/lock}}}
:В этом каталоге содержатся файлы блокировки. Соглашения об именах файлов, блокирующих устройства, следующее: LCK..{{{&lt;устройство&gt;}}}, где {{{&lt;device&gt;}}} - это имя устройства файловой системы. Используется формат файлов блокировки HDU UUCP, то есть файлы блокировки содержат PID в виде 10-байтного числа ASCII в десятичной системе исчисления; после этого числа стоит символ новой строки. 

;{{{/var/log}}}
:Различные файлы журналов (log). 

;{{{/var/opt}}}
:Данные по переменным для {{{/opt}}}. 

;{{{/var/mail}}}
:Почтовые ящики пользователей. Заменяет {{{/var/spool/mail}}}. 

;{{{/var/msgs}}}
:Каталог зарезервирован. 

;{{{/var/preserve}}}
:Каталог зарезервирован. 

;{{{/var/run}}}
:Временные файлы, создаваемые во время работы. В них содержатся идентификаторы процессов (~PIDs) и журнал пользователей (utmp). Файлы из этого каталога обычно удаляются в процессе загрузки системы. 

;{{{/var/spool}}}
:Файлы, поставленные в очередь различными программами. 

;{{{/var/spool/at}}}
:Очередь задания [[at(1)|http://www.opennet.ru/man.shtml?topic=at&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]. 

;{{{/var/spool/cron}}}
:Очередь заданий [[cron(1).|http://www.opennet.ru/man.shtml?topic=cron&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]] 

;{{{/var/spool/lpd}}}
:Файлы, отправленные в очередь для печати. 

;{{{/var/spool/mail}}}
:Заменен на /var/mail. 

;{{{/var/spool/mqueue}}}
:Очередь исходящей почты. 

;{{{/var/spool/news}}}
:Спул-каталог для новостей. 

;{{{/var/spool/rwho}}}
:Файле в спуле для [[rwhod(8).|http://www.opennet.ru/man.shtml?topic=rwhod&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]] 

;{{{/var/spool/smail}}}
:Файлы, отправленные в очередь программой доставки почты [[smail(1)|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=smail&amp;titles=Title&amp;lr=lang_en]]. 

;{{{/var/spool/news}}}
:Каталог для подсистемы новостей. 

;{{{/var/spool/uucp}}}
:Файлы программы [[uucp(1)|http://www.opennet.ru/man.shtml?topic=uucp&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]. 

;{{{/var/tmp}}}
:Как и {{{/tmp}}}, этот каталог содержит временные файлы, помещенные в него на неопределенное время. 

;{{{/var/yp}}}
:Файлы с базами данных для NIS. 

!См. также
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/manpages/jaunty/en/man7/hier.7.html]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=hier&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="host - запрос информации о указанном домене или IP-адресе" modifier="Яковлев Иван" created="200906161304" modified="200907260037" tags="[[Команды для диагностики сети]] [[TODO - нужен перевод статьи]]" changecount="9">
<pre>!Описание
The host utility performs simple DNS lookups. It is normally used to convert names to IP addresses and IP addresses to names. When no arguments or options are given, host prints a short summary of its command line arguments and options.

The name argument is the domain name that is to be looked up. It can also be a dotted-decimal ~IPv4 address or a colon-delimited ~IPv6 address, in which case host by default performs a reverse lookup for that address. The optional server argument is either the name or IP address of the name server that host should query instead of the server or servers listed in {{{/etc/resolv.conf}}}.   

!Синтаксис 
{{{
host baltnet.ru
}}}
Выдаст на экран:
{{terminal{
{{{
baltnet.ru has address 217.168.64.59
baltnet.ru mail is handled by 20 mx.baltnet.ru.
baltnet.ru mail is handled by 10 mail.baltnet.ru.
}}}
}}}
А этот результат выдаст команда {{{host -d baltnet.ru}}}, где {{{-d}}} -- означает вывести больше информации:
{{terminal{
{{{
Trying &quot;baltnet.ru&quot;
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 9217
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 3, ADDITIONAL: 3

;; QUESTION SECTION:
;baltnet.ru.                    IN      A

;; ANSWER SECTION:
baltnet.ru.             5       IN      A       217.168.64.59

;; AUTHORITY SECTION:
baltnet.ru.             5       IN      NS      ns.baltnet.ru.
baltnet.ru.             5       IN      NS      ns4.nic.ru.
baltnet.ru.             5       IN      NS      ns8.nic.ru.

;; ADDITIONAL SECTION:
ns.baltnet.ru.          5       IN      A       217.168.64.2
ns4.nic.ru.             5       IN      A       194.226.96.8
ns8.nic.ru.             5       IN      A       193.232.130.14

Received 149 bytes from 192.168.221.2#53 in 17 ms
Trying &quot;baltnet.ru&quot;
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 46037
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 0

;; QUESTION SECTION:
;baltnet.ru.                    IN      AAAA

;; AUTHORITY SECTION:
baltnet.ru.             5       IN      SOA     ns.baltnet.ru. root.ns.baltnet.ru. 2009051401 43200 7200 1209600 86400

Received 72 bytes from 192.168.221.2#53 in 13 ms
Trying &quot;baltnet.ru&quot;
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 36356
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 3, ADDITIONAL: 5

;; QUESTION SECTION:
;baltnet.ru.                    IN      MX

;; ANSWER SECTION:
baltnet.ru.             5       IN      MX      10 mail.baltnet.ru.
baltnet.ru.             5       IN      MX      20 mx.baltnet.ru.

;; AUTHORITY SECTION:
baltnet.ru.             5       IN      NS      ns.baltnet.ru.
baltnet.ru.             5       IN      NS      ns4.nic.ru.
baltnet.ru.             5       IN      NS      ns8.nic.ru.

;; ADDITIONAL SECTION:
mail.baltnet.ru.        5       IN      A       217.168.64.25
mx.baltnet.ru.          5       IN      A       217.168.64.6
ns.baltnet.ru.          5       IN      A       217.168.64.2
ns4.nic.ru.             5       IN      A       194.226.96.8
ns8.nic.ru.             5       IN      A       193.232.130.14

Received 205 bytes from 192.168.221.2#53 in 16 ms
}}}
}}}

!Файлы
{{{/etc/resolv.conf}}} -- Resolver configuration file.

!См. также
[[dig(1M)|dig - поиск IP-адреса указанного домена]], named(1M), attributes(5)   

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=host&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=host&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="hostname - выдает или устанавливает имя компьютера" modifier="Яковлев Иван" created="200906161319" modified="200906161326" tags="[[Команды для диагностики сети]] [[Информационные команды]]" changecount="3">
<pre>!Описание
Выдает или устанавливает системное имя компьютера.

;{{{--help}}}
:выдает эту информацию и заканчивает работу 

;{{{--version}}}
:выдает информацию о версии и заканчивает работу 

!Синтаксис
{{{
hostname [ИМЯ]
hostname ПАРАМЕТР
}}}

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=hostname&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=hostname&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="htpasswd - Manage user files for basic authentication" modifier="Яковлев Иван" created="200906091452" modified="200906091511" tags="[[Команды администрирования]] [[TODO - нужен перевод статьи]]" changecount="9">
<pre>!Описание
htpasswd is used to create and update the flat-files used to store usernames and password for basic authentication of HTTP users. If htpasswd cannot access a file, such as not being able to write to the output file or not being able to read the file in order to update it, it returns an error status and makes no changes.
 

Resources available from the Apache HTTP server can be restricted to just the users listed in the files created by htpasswd. This program can only manage usernames and passwords stored in a flat-file. It can encrypt and display password information for use in other types of data stores, though. To use a DBM database see dbmmanage.

htpasswd encrypts passwords using either a version of ''~MD5'' modified for Apache, or the system's ''crypt()'' routine. Files managed by htpasswd may contain both types of passwords; some user records may have ~MD5-encrypted passwords while others in the same file may have passwords encrypted with ''crypt()''.

This manual page only lists the command line arguments. For details of the directives necessary to configure user authentication in httpd see the Apache manual, which is part of the Apache distribution or can be found at http://httpd.apache.org/. 

!Синтаксис
{{{
htpasswd [ -c ] [ -m ] [ -D ] passwdfile username

htpasswd -b [ -c ] [ -m | -d | -p | -s ] [ -D ] passwdfile username password

htpasswd -n [ -m | -d | -s | -p ] username

htpasswd -nb [ -m | -d | -s | -p ] username password 
}}}

!Параметры
;{{{-b}}}
:Use batch mode; i.e., get the password from the command line rather than prompting for it. This option should be used with extreme care, since the password is clearly visible on the command line. 
;{{{-c}}}
:Create the passwdfile. If passwdfile already exists, it is rewritten and truncated. This option cannot be combined with the {{{-n}}} option. 
;{{{-n}}}
:Display the results on standard output rather than updating a file. This is useful for generating password records acceptable to Apache for inclusion in non-text data stores. This option changes the syntax of the command line, since the passwdfile argument (usually the first one) is omitted. It cannot be combined with the {{{-c}}} option. 
;{{{-m}}}
:Use ''~MD5'' encryption for passwords. On Windows, Netware and TPF, this is the default. 
;{{{-d}}}
:Use crypt() encryption for passwords. The default on all platforms but Windows, Netware and TPF. Though possibly supported by htpasswd on all platforms, it is not supported by the httpd server on Windows, Netware and TPF. 
;{{{-s}}}
:Use ''SHA'' encryption for passwords. Facilitates migration from/to Netscape servers using the LDAP Directory Interchange Format (ldif). 
;{{{-p}}}
:Use plaintext passwords. Though htpasswd will support creation on all platforms, the httpd daemon will only accept plain text passwords on Windows, Netware and TPF. 
;{{{-D}}}
:Delete user. If the username exists in the specified htpasswd file, it will be deleted. 
;{{{passwdfile}}}
:Name of the file to contain the user name and password. If {{{-c}}} is given, this file is created if it does not already exist, or rewritten and truncated if it does exist. 
;{{{username}}}
:The username to create or update in passwdfile. If username does not exist in this file, an entry is added. If it does exist, the password is changed. 
;{{{password}}}
:The plaintext password to be encrypted and stored in the file. Only used with the {{{-b}}} flag. 

!Возвращаемый результат
*''zero status'' (&quot;{{{true}}}&quot;) if the username and password have been successfully added or updated in the passwdfile.
*{{{1}}} if it encounters some problem accessing files,
*{{{2}}} if there was a syntax problem with the command line,
*{{{3}}} if the password was entered interactively and the verification entry didn't match,
*{{{4}}} if its operation was interrupted,
*{{{5}}} if a value is too long (username, filename, password, or final computed record),
*{{{6}}} if the username contains illegal characters (see the Restrictions section),
*{{{7}}} if the file is not a valid password file. 

!Примеры
{{{
htpasswd /usr/local/etc/apache/.htpasswd-users jsmith
}}}
Adds or modifies the password for user jsmith. The user is prompted for the password. If executed on a Windows system, the password will be encrypted using the modified Apache ~MD5 algorithm; otherwise, the system's ''crypt()'' routine will be used. If the file does not exist, htpasswd will do nothing except return an error.
{{{
htpasswd -c /home/doe/public_html/.htpasswd jane
}}}
Creates a new file and stores a record in it for user jane. The user is prompted for the password. If the file exists and cannot be read, or cannot be written, it is not altered and htpasswd will display a message and return an error status.
{{{
htpasswd -mb /usr/web/.htpasswd-all jones Pwd4Steve
}}}
Encrypts the password from the command line (~Pwd4Steve) using the ~MD5 algorithm, and stores it in the specified file. 

!Вопросы Безопасности
Web password files such as those managed by htpasswd should not be within the Web server's URI space -- that is, they should not be fetchable with a browser.

The use of the {{{-b}}} option is discouraged, since when it is used the unencrypted password appears on the command line. 

!Ограничения
On the Windows and MPE platforms, passwords encrypted with htpasswd are limited to no more than 255 characters in length. Longer passwords will be truncated to 255 characters.

The ~MD5 algorithm used by htpasswd is specific to the Apache software; passwords encrypted using it will not be usable with other Web servers.

Usernames are limited to 255 bytes and may not include the character {{{:}}}. 

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/manpages/jaunty/en/man1/htpasswd.1.html]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=htpasswd&amp;russian=2&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="id - выводит информацию о имени указанного пользователя и его группы" modifier="Яковлев Иван" created="200906161330" modified="200906161332" tags="[[Информационные команды]]" changecount="4">
<pre>!Описание
Эта команда выводит информацию об указанном пользователе USERNAME или текущем пользователе, который запустил данную команду и не указал явно имя пользователя. По умолчанию выводятся подлинные числовые идентификаторы пользователя (UID) и группы (GID), действующие (именные) идентификаторы пользователей и групп, а также идентификаторы других групп, в которых состоит пользователь.

!Синтаксис
{{{
id [OPTION]... [USERNAME]  
}}}

!Пример использования
{{{
id имя_пользователя
}}}
Предположим, что имя пользователя ''uran'', тогда команда {{{id uran}}} выдаст следующий результат:
{{{
uid=1000(uran) gid=1000(uran) группы=1000(uran),4(adm),20(dialout),24(cdrom),
46(plugdev),106(lpadmin),109(ssh),121(admin),122(sambashare),1001(svn)
}}}

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=id&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=id&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="ifconfig - конфигурирование параметров сетевого интерфейса" modifier="Яковлев Иван" created="200906062347" tags="[[Команды для диагностики сети]] TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=ifconfig&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=ifconfig&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="iptables configuration file exemple" modifier="Яковлев Иван" created="200906192247" modified="200906192326" tags="[[Примеры конфигурационных файлов]] TODO" changecount="4">
<pre>{{{
*filter


#  Allows all loopback (lo0) traffic and drop all traffic to 127/8 that doesn't use lo0
-A INPUT -i lo -j ACCEPT
-A INPUT -i ! lo -d 127.0.0.0/8 -j REJECT


#  Accepts all established inbound connections
-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT


#  Allows all outbound traffic
#  You can modify this to only allow certain traffic
-A OUTPUT -j ACCEPT


# Allows HTTP and HTTPS connections from anywhere (the normal ports for websites)
-A INPUT -p tcp --dport 80 -j ACCEPT
-A INPUT -p tcp --dport 443 -j ACCEPT


#  Allows SSH connections
#
# THE -dport NUMBER IS THE SAME ONE YOU SET UP IN THE SSHD_CONFIG FILE
#
-A INPUT -p tcp -m state --state NEW --dport 30000 -j ACCEPT


# Allow ping
-A INPUT -p icmp -m icmp --icmp-type 8 -j ACCEPT


# log iptables denied calls
-A INPUT -m limit --limit 5/min -j LOG --log-prefix &quot;iptables denied: &quot; --log-level 7


# Reject all other inbound - default deny unless explicitly allowed policy
-A INPUT -j REJECT
-A FORWARD -j REJECT

COMMIT
}}}

{{textAlignRight{
Ссылка: http://articles.slicehost.com/assets/2007/9/4/iptables.txt
}}}

</pre>
</div>
<div title="jobs - вывод списка программ работающих в фоновом режиме" modifier="Яковлев Иван" created="200906161337" tags="[[Информационные команды]]" changecount="1">
<pre>!Описание
Показывает список программ работающих в фоновом режиме
{{{
jobs
}}}

!См. также
fg, bg, stop, notify

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=jobs&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=jobs&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="last, lastb - выводит список пользователей, зарегистрировавшихся в системе последними" modifier="Яковлев Иван" created="200906161341" modified="200906161347" tags="[[Информационные команды]]" changecount="5">
<pre>!Описание
Утилита ''last'' осуществляет обратный поиск по файлу {{{/var/log/wtmp}}} (или другому файлу, определённому ключом {{{-f}}}) и отображает список всех пользователей, прошедших регистрацию в системе (и завершивших сеанс работы) с момента создания этого файла. Можно также перечислить конкретные имена пользователей и терминальные линии tty, в этом случае last покажет только те записи, которые соответствуют данным аргументам. Названия tty можно сокращать, так last 0 это то же, что и last tty0.

Когда last принимает сигнал SIGINT (сгенерированный клавишей прерывания, обычно ''~Ctrl-C'') или сигнал SIGQUIT (сгенерированный клавишей выхода, обычно control-\), то last сообщит, какую часть файла она успела проанализировать; в случае получения сигнала SIGINT, last завершит работу.

При каждой перезагрузке в системе регистрируется псевдопользователь reboot. Таким образом, last reboot выведет информацию обо всех перезагрузках системы с момента создания файла журнала.

Команда ''lastb'' -- это та же ''last'', за исключением того, что по умолчанию она настроена на вывод журнальных записей файла {{{/var/log/btmp}}}, который содержит записи обо всех неудавшихся попытках регистрации пользователей в системе. 

!Синтаксис
{{{
last [-R] [-число] [ -n число ] [-adiox] [-w|s] [ -f файл ] [ -t ГГГГММДДЧЧММСС ] [имя...] [tty...]
lastb [-R] [-число] [ -n число ] [ -f файл ] [ -t ГГГГММДДЧЧММСС ] [-adiox] [-w|s] [имя...] [tty...]
}}}

!Файлы
{{{/var/log/wtmp}}}
{{{/var/log/btmp}}}

!См. также
shutdown(8), login(1), init(8)

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=last&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=last&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="ldd - выдаёт список зависимостей от динамических библиотек" modifier="Яковлев Иван" created="200906161350" modified="200906161350" tags="[[Информационные команды]]" changecount="2">
<pre>!Описание
ldd выдаёт списк динамических библиотек, которые требуются для каждой из заданных в командной строке программ или динамических библиотек.

!Синтаксис
{{{
ldd /usr/bin/имя_программы
}}}

!Опции
;{{{-V --version}}}
:Выдать номер версии ldd. 

;{{{-v --verbose}}}
:Выдать всю информацию, включая, например, информацию о версии символов. 

;{{{-d --data-relocs}}}
:Выполнить перемещения и показать все отсутствующие объекты (только для ELF). 

;{{{-r --function-relocs}}}
:Выполнить перемещения и для объектов данных и для функций и показать все отсутствующие объекты или функции (только для ELF). 

;{{{--help}}}
:Выдать подсказку.

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/manpages/jaunty/en/man1/ldd.1.html]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=ldd&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="ln - создание ссылки между файлами" modifier="Яковлев Иван" created="200906121113" tags="[[Команды для работы с файлами и каталогами]] [[TODO - нужен перевод статьи]]" changecount="1">
<pre>!Описание
You can create linked files. One use for such links are hardware device files such as {{{/dev/cdrom}}} and the UUID files in the {{{/dev/disk/by-uuid}}} directory. Assuming the local system includes a CD/DVD drive, you can see a link with the following command: 
{{{
$ ls -l /dev/cdrom
}}}
''lrwxrwxrwx 1 root root 4 2008-03-09 22:11 /dev/cdrom -&gt; scd0''

Linked files can also be used to provide access to the same file to multiple users, even in their home directories. Hard links include a copy of the file. As long as the hard link is made within the same partition, RAID array, or logical volume, the inode numbers are identical. Inode numbers can be verified with the {{{ls -i}}} filename command. You could delete a hard-linked file in one directory, and it would still exist in the other directory. For example, the following command creates a hard link from the actual Samba configuration file to smb.conf in the local directory:
{{{
$ ln /etc/samba/smb.conf smb.conf
}}}
On the other hand, a soft link serves as a redirect; when you open a file created with a soft link, you’re directed to the original file. If you delete the original file, although the link is still visible, the file is lost. While the soft linked file is still there, it has nowhere to go. The following command is an example of how you can create a soft link:
{{{
$ ln -s /etc/samba/smb.conf smb.conf
}}}

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=ln&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=ln&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="locate - поиск местоположения файла" modifier="Яковлев Иван" created="200906111533" tags="[[Команды для работы с файлами и каталогами]] [[TODO - нужен перевод статьи]] TODO" changecount="1">
<pre>!Описание
Ubuntu systems include a default database of all files and directories. Searches with the locate command are almost instantaneous, and don’t require the full filename. The drawback is that the locate command database is normally updated only once each day, as documented in the {{{/etc/cron.daily/mlocate}}} script.

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|TODO]]
*[[Описание на Opennet.ru|TODO]]


</pre>
</div>
<div title="ls - список файлов в текущей директории" modifier="Яковлев Иван" created="200906022213" modified="200907010008" tags="[[Команды для работы с файлами и каталогами]] [[Информационные команды]]" changecount="7">
<pre>!Описание
Команда {{{ls}}} отображает список файлов в текущей директории. Например, при наборе 
{{{
ls ~
}}}
будет показан список файлов в домашней директории.

При использовании команды {{{ls}}} совместно с опцией {{{-l}}}, результат будет дополнен информацией о текущих правах и владельце файлов.

!См. также
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=ls&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=ls&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]



</pre>
</div>
<div title="lsb_release - информация о релизе" modifier="Яковлев Иван" created="200906022250" modified="200906161111" tags="[[Информационные команды]]" changecount="5">
<pre>!Описание
Команда {{{lsb_release}}} с параметром -a покажет информацию о релизе Linux, который у Вас запущен. К примеру, команда 
{{{
lsb_release -a
}}}
покажет Вам: 
{{note{
No LSB modules are available.
Distributor ID: Ubuntu
Description: Ubuntu 9.04
Release: 9.04
Codename: jaunty
}}}

!См. также
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=lsb_release&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=lsb_release&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]



</pre>
</div>
<div title="lsmod - вывод списка загруженных модулей ядра" modifier="Яковлев Иван" created="200906161352" modified="200906161408" tags="[[Информационные команды]] TODO" changecount="4">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=lsmod&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=lsmod&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="mkdir - создать каталог" modifier="Яковлев Иван" created="200906022219" modified="200906031240" tags="[[Команды для работы с файлами и каталогами]]" changecount="4">
<pre>!Описание
Команда {{{mkdir}}} позволяет создавать каталоги. Например, при наборе 
{{{
mkdir music
}}}
в текущем каталоге будет создан подкаталог music.

!См. также
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=mkdir&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=mkdir&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="modinfo - вывод информации об указанном модуле ядра" modifier="Яковлев Иван" created="200906161354" modified="200906161356" tags="[[Информационные команды]] TODO" changecount="2">
<pre>!Описание
вывод информации об указанном модуле ядра
{{{
modinfo имя_тодуля
}}}

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|TODO]]
*[[Описание на Opennet.ru|TODO]]


</pre>
</div>
<div title="more и less - просмотр текста файла" modifier="Яковлев Иван" created="200906111547" tags="[[Команды для работы с файлами и каталогами]] [[TODO - нужен перевод статьи]] TODO" changecount="1">
<pre>!Описание
Larger files demand a command that can help you scroll though the file text at your leisure. Linux has two such commands: more and less. With the more filename command, you can scroll through the text of a file, from start to finish, one screen at a time. The ''SPACEBAR'' can then be used to scroll down the file.

Ironically, the less command is more powerful than the more command. With the less filename command, you can scroll in both directions through the same text using the ''PAGE UP'' and ''PAGE DOWN'' keys. Both commands support vi-style searches.

!См. также
TODO

!Ссылки
*[[Описание more на manpages.ubuntu.com|TODO]]
*[[Описание less на manpages.ubuntu.com|TODO]]
*[[Описание more на Opennet.ru|http://www.opennet.ru/man.shtml?topic=more+&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]
*[[Описание less на Opennet.ru|http://www.opennet.ru/man.shtml?topic=less&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="mv - переместить (переименовать) файлы" modifier="Яковлев Иван" created="200906022216" modified="200906031235" tags="[[Команды для работы с файлами и каталогами]]" changecount="4">
<pre>!Описание
Команда {{{mv}}} перемещает файл в указанное место или переименовывает файл. Например, 
{{{
mv foo bar
}}}
переименует файл foo в bar. 
{{{
mv foo ~/Desktop
}}}
переместит файл foo в директорию Desktop, но не переименует его.

!См. также
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=mv&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=mv&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]



</pre>
</div>
<div title="mysql" modifier="Яковлев Иван" created="200906041926" tags="[[Команды MySQL]]" changecount="1">
<pre>Здесь мог бы быть осмысленный текст на тему 'mysql'</pre>
</div>
<div title="mysqladmin - клиент администрирования сервера MySQL" modifier="Яковлев Иван" created="200906041457" modified="200906041547" tags="[[Команды MySQL]] [[Администрирование MySQL]]" changecount="11">
<pre>!SYNOPSIS
{{{
mysqladmin [options] command [command-options] [command [command-options]] ... 
}}}

!DESCRIPTION
mysqladmin is a client for performing administrative operations. You can use it to check the server's configuration and current status, to create and drop databases, and more. 

Invoke mysqladmin like this: 
{{{
shell&gt; mysqladmin [options] command [command-arg] [command [command-arg]] ...
}}}
mysqladmin supports the commands described in the following list. Some of the commands take an argument following the command name. 
;{{{create db_name}}}
:Create a new database named db_name. 

;{{{debug}}}
:Tell the server to write debug information to the error log. 

;{{{drop db_name}}}
:Delete the database named db_name and all its tables. 

;{{{extended-status }}}
:Display the server status variables and their values. 

;{{{flush-hosts }}}
:Flush all information in the host cache. 

;{{{flush-logs }}}
:Flush all logs. 

;{{{flush-privileges }}}
:Reload the grant tables (same as reload). 

;{{{flush-status }}}
:Clear status variables. 

;{{{flush-tables }}}
:Flush all tables. 

;{{{flush-threads }}}
:Flush the thread cache. 

;{{{kill id,id,... }}}
:Kill server threads. If multiple thread ID values are given, there must be no spaces in the list. 

;{{{old-password new-password }}}
:This is like the password command but stores the password using the old (pre-4.1) password-hashing format. (See Section 6.9, lqPassword Hashing as of ~MySQL 4.1rq.) 

;{{{password new-password }}}
:Set a new password. This changes the password to new-password for the account that you use with mysqladmin for connecting to the server. Thus, the next time you invoke mysqladmin (or any other client program) using the same account, you will need to specify the new password. 
:If the new-password value contains spaces or other characters that are special to your command interpreter, you need to enclose it within quotes. On Windows, be sure to use double quotes rather than single quotes; single quotes are not stripped from the password, but rather are interpreted as part of the password. For example: 
{{{
shell&gt; mysqladmin password &quot;my new password&quot;
}}}

;{{{ping }}}
:Check whether the server is alive. The return status from mysqladmin is 0 if the server is running, 1 if it is not. This is 0 even in case of an error such as Access denied, because this means that the server is running but refused the connection, which is different from the server not running. 

;{{{processlist }}}
:Show a list of active server threads. This is like the output of the SHOW PROCESSLIST statement. If the {{{--verbose}}} option is given, the output is like that of SHOW FULL PROCESSLIST. (See Section 5.4.19, lqSHOW PROCESSLIST Syntaxrq.) 

;{{{reload }}}
:Reload the grant tables. 

;{{{refresh }}}
:Flush all tables and close and open log files. 

;{{{shutdown }}}
:Stop the server. 

;{{{start-slave }}}
:Start replication on a slave server. 

;{{{status }}}
:Display a short server status message. 

;{{{stop-slave }}}
:Stop replication on a slave server. 

;{{{variables }}}
:Display the server system variables and their values. 

;{{{version }}}
:Display version information from the server. 

All commands can be shortened to any unique prefix. For example: 
{{{
shell&gt; mysqladmin proc stat
+----+-------+-----------+----+---------+------+-------+------------------+
| Id | User  | Host      | db | Command | Time | State | Info             |
+----+-------+-----------+----+---------+------+-------+------------------+
| 51 | monty | localhost |    | Query   | 0    |       | show processlist |
+----+-------+-----------+----+---------+------+-------+------------------+
Uptime: 1473624  Threads: 1  Questions: 39487  
Slow queries: 0  Opens: 541  Flush tables: 1  
Open tables: 19  Queries per second avg: 0.0268
}}}

The mysqladmin status command result displays the following values: 
;''Uptime''
:The number of seconds the ~MySQL server has been running. 

;''Threads''
:The number of active threads (clients). 

;''Questions'' 
:The number of questions (queries) from clients since the server was started. 

;''Slow queries'' 
:The number of queries that have taken more than long_query_time seconds. See Section 10.4, lqThe Slow Query Logrq. 

;''Opens'' 
:The number of tables the server has opened. 

;''Flush tables'' 
:The number of {{{flush-*}}}, {{{refresh}}}, and {{{reload}}} commands the server has executed. 

;''Open tables'' 
:The number of tables that currently are open. 

;''Memory in use'' 
:The amount of memory allocated directly by mysqld. This value is displayed only when ~MySQL has been compiled with {{{--with-debug=full}}}. 

;''Maximum memory used'' 
:The maximum amount of memory allocated directly by mysqld. This value is displayed only when ~MySQL has been compiled with {{{--with-debug=full}}}. 
If you execute mysqladmin shutdown when connecting to a local server using a Unix socket file, mysqladmin waits until the server's process ID file has been removed, to ensure that the server has stopped properly. 

mysqladmin supports the following options: 
;{{{--help, -? }}}
:Display a help message and exit. 

;{{{--character-sets-dir=path }}}
:The directory where character sets are installed. See Section 9.1, lqThe Character Set Used for Data and Sortingrq. 

;{{{--compress, -C }}}
:Compress all information sent between the client and the server if both support compression. 

;{{{--count=N, -c N }}}
:The number of iterations to make for repeated command execution. This works only with the {{{--sleep option}}}. 

;{{{--debug[=debug_options], -# [debug_options] }}}
:Write a debugging log. The debug_options string often is {{{d:t:o,file_name}}}. The default is {{{d:t:o,/tmp/mysqladmin.trace}}}. 

;{{{--default-character-set=charset_name }}}
:Use charset_name as the default character set. See Section 9.1, lqThe Character Set Used for Data and Sortingrq. 

;{{{--force, -f }}}
:Do not ask for confirmation for the drop db_name command. With multiple commands, continue even if an error occurs. 

;{{{--host=host_name, -h host_name }}}
:Connect to the ~MySQL server on the given host. 

;{{{--password[=password], -p[password] }}}
:The password to use when connecting to the server. If you use the short option form (-p), you cannot have a space between the option and the password. If you omit the password value following the {{{--password}}} or {{{-p}}} option on the command line, you are prompted for one. 
Specifying a password on the command line should be considered insecure. See Section 7.6, lqKeeping Your Password Securerq. 

;{{{--port=port_num, -P port_num }}}
:The TCP/IP port number to use for the connection. 

;{{{--protocol={TCP|SOCKET|PIPE|MEMORY} }}}
:The connection protocol to use. 

;{{{--relative, -r }}}
:vShow the difference between the current and previous values when used with the {{{--sleep}}} option. Currently, this option works only with the extended-status command. 

;{{{--silent, -s }}}
:Exit silently if a connection to the server cannot be established. 

;{{{--sleep=delay, -i delay }}}
:Execute commands repeatedly, sleeping for delay seconds in between. The {{{--count}}} option determines the number of iterations. 

;{{{--socket=path, -S path }}}
:For connections to localhost, the Unix socket file to use, or, on Windows, the name of the named pipe to use. 

;{{{--ssl}}}*
:Options that begin with {{{--ssl}}} specify whether to connect to the server via SSL and indicate where to find SSL keys and certificates. See Section 7.7.3, lqSSL Command Optionsrq. 

;{{{--user=user_name, -u user_name 
:The ~MySQL username to use when connecting to the server. 

;{{{--verbose, -v }}}
:Verbose mode. Print more information about what the program does. 

;{{{--version, -V }}}
:Display version information and exit. 

;{{{--vertical, -E }}}
:Print output vertically. This is similar to {{{--relative}}}, but prints output vertically. 

;{{{--wait[=count], -w[count]}}} 
:If the connection cannot be established, wait and retry instead of aborting. If a count value is given, it indicates the number of times to retry. The default is one time. 
You can also set the following variables by using {{{--var_name=value}}} syntax: 

;{{{connect_timeout}}}
:The maximum number of seconds before connection timeout. The default value is 43200 (12 hours). 

;{{{shutdown_timeout}}}
:The maximum number of seconds to wait for server shutdown. The default value is 3600 (1 hour). 

It is also possible to set variables by using {{{--set-variable=var_name=value}}} or {{{-O var_name=value}}} syntax. This syntax is deprecated.

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/manpages/karmic/en/man1/mysqladmin.1.html]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=mysqladmin&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="mysqldump" modifier="Яковлев Иван" created="200906041724" modified="200906041833" tags="[[Команды MySQL]]" changecount="7">
<pre>!Описание
The ''mysqldump'' utility is a console driven executable that allows us to specify a host of options to backup a database to an external resource such as a file, or even a completely different ~MySQL server running on the other side of the world!

I'm using the word backup rather loosely here, because ~MySQL doesn't actually backup our data per se. Rather, it creates a set of &quot;{{{CREATE TABLE}}}&quot; and &quot;{{{INSERT INTO}}}&quot; commands that can be executed against a ~MySQL server to re-create our database(s).

The mysqldump utility can be found in {{{c:\mysql\bin}}} on Windows operating systems, and in the {{{/usr/local/bin}}} directory on Unix/Linux systems where ~MySQL is installed. The mysqldump utility accepts several command-line arguments that you can use to change the way your databases are backed up.

In its simplest form, the mysqldump utility can be used like this:
{{{
mysqldump –-user [user name] –-password=[password] [database name] &gt; [dump file]
}}}
Let's take a look at each of the arguments that can be passed to the mysqldump utility, as shown above:
;{{{--user [user name]}}}
:The {{{--user}}} flag followed by a valid ~MySQL username tells ~MySQL the username of the account that we want to use to perform the database dump. ~MySQL user accounts are stored in the &quot;{{{user}}}&quot; table of the &quot;{{{mysql}}}&quot; database. You can view a list of users and their permissions for your ~MySQL server by using the following code at the ~MySQL console application:
{{{
use mysql;

select * from user;
}}}
;{{{--password=[password]}}}
:The password for the user account mentioned above.
;{{{[database name]}}}
:The name of the database that we would like the mysqldump utility to backup. Instead of specifying one single database name, we could use either {{{--databases}}} or {{{--all-databases}}} to backup every single database on our ~MySQL server.
;{{{&gt; [dump file]}}}
:If you're familiar with DOS and batch files, then you will know that the &quot;{{{&gt;}}}&quot; symbol specifies that we are directing output to a stream, port, or file. For the mysqldump utility, we prepend a &quot;{{{&gt;}}}&quot; to the filename we would like our database to be backed up to. If no path is specified for the file, then it will be created in the current directory.

Now that we're versed with the basic arguments that can be passed to the mysqldump utility, let's take a look at five different ways to use the mysqldump utility to backup our databases.

!Пример 1
{{{
mysqldump –-user admin –-password=password mydatabase &gt; sql.dump
}}}
In the example above, we're specifying that ~MySQL should check the grants for the user account of the &quot;{{{admin}}}&quot; user with a password of &quot;{{{password}}}&quot;. I'm running ~MySQL on Windows 2000, and these are the default credentials for the admin user account. I have chosen to backup the database named &quot;mydatabase&quot; into the file sql.dump.

If you're not sure what the names of your databases are, then use the following command at the ~MySQL console application to list them:
{{{
show databases;
}}}
On my system, ~MySQL responded with this:

{{borderNone{
[img[images/articles/mysqldump_1.gif]]
}}}
Here's a snippet of my database dump using the mysqldump utility as described in the example above:
{{{
#

# Table structure for table 'tbl_contactemails'

#

CREATE TABLE tbl_contactemails (

pk_ceId int(11) NOT NULL auto_increment,

ceEmail varchar(250) NOT NULL default '',

ceType int(11) default NULL,

PRIMARY KEY (pk_ceId),

UNIQUE KEY id (pk_ceId)

) TYPE=MyISAM;

#

# Dumping data for table 'tbl_contactemails'

#

INSERT INTO tbl_contactemails VALUES (18,'mitchell@devarticles.com',1);

INSERT INTO tbl_contactemails VALUES (17,'mitchell_harper@hotmail.com',1);

INSERT INTO tbl_contactemails VALUES (16,'mytch@dingoblue.net.au',1);
}}}
As you can see, the mysqldump command has taken the design of my tbl_contactemails table (which exists as part of the &quot;{{{mydatabase}}}&quot; database that I chose to back up) and turned it into a {{{CREATE TABLE}}} query, which (when imported back into ~MySQL) will re-create the tbl_contactemails table if it needs to.

Also notice the three {{{INSERT INTO}}} statements, which add rows of data to the tbl_contactemails table? I had three email addresses in my contact emails table, and when this data is restored, ~MySQL will execute these insert commands directly against my tbl_contactemails database to add the rows back into the table.

!Пример 2:
{{{
mysqldump --opt mydatabase &gt; sql.dump
}}}
Specifying the {{{--opt}}} argument when backing up our database should theoretically give us the fastest possible dump for reading back into ~MySQL server (the &quot;{{{opt}}}&quot; stands for optimize). When we specify the {{{--opt}}} argument, the mysqldump utility creates a more sophisticated set of dump commands, which includes the &quot;{{{DROP TABLE IF EXISTS}}}&quot; statement to delete the table from the database if it already exists when the dump file is being used to restore the database. The dump also includes several table locking statements.

Here's a sample of the sql.dump file that was generated when I backed up the same database with the {{{–-opt}}} argument:
{{{
#

# Table structure for table 'tbl_contactemails'

#

DROP TABLE IF EXISTS tbl_contactemails;

CREATE TABLE tbl_contactemails (

pk_ceId int(11) NOT NULL auto_increment,

ceEmail varchar(250) NOT NULL default '',

ceType int(11) default NULL,

PRIMARY KEY (pk_ceId),

UNIQUE KEY id (pk_ceId)

) TYPE=MyISAM;

#

# Dumping data for table 'tbl_contactemails'

#

LOCK TABLES tbl_contactemails WRITE;

INSERT INTO tbl_contactemails VALUES (18,'mitchell@devarticles.com',1),(17,'mitchell_harper@hotmail.com',1),(16,'mytch@dingoblue.net.au',1);

UNLOCK TABLES;
}}}

!Пример 3:
{{{
mysqldump --opt mydatabase | mysql --host=localhost -C newdatabase
}}}
One excellent feature of the mysqldump utility is that it supports backing up a database from one ~MySQL server to another with just one command. In the example above, I have chosen to backup the &quot;mydatabase&quot; database to the server named localhost (which is the net bios name of my local machine). I have used the {{{–C}}} argument to tell the mysqldump utility to enforce data compression between my ~MySQL server and the destination server if they both support it. Lastly, I have specified that all of the tables from the &quot;mydatabase&quot; database should be created in a new database on the remote server named &quot;newdatabase&quot;.

In the example above I have used localhost as the name of the remote ~MySQL server to send the backup data to. You can replace this with the net bios name of any other computer on your network, or the I.P. address of any local or remote computer if you want to send the database to a ~MySQL server over your network or the Internet.

There's one catch to using this method: You must have already created the database on the remote server. In our example we are simply backing up the &quot;{{{mydatabase}}}&quot; database on the same machine, so we would use the following command at the ~MySQL console application before we ran the mysqldump utility:
{{{
create database newdatabase;
}}}


</pre>
</div>
<div title="netstat - показ текущих сетевых подключений" modifier="Яковлев Иван" created="200906062059" modified="200907260036" tags="[[Команды для диагностики сети]] [[Информационные команды]]" changecount="5">
<pre>!Описание
Показывает текущие сетевые подключения
{{{
netstat -a
}}}
;{{{-a --all}}}
:Показать весь список

!Полезные примеры
Показ полного списка активных соединений с интернетом
{{{
netstat -an --inet
}}}
Выдаст:
{{terminal{
{{{
Активные соединения с интернетом (servers and established)
Proto Recv-Q Send-Q Local Address       Foreign Address              State
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:139             0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:21              0.0.0.0:*               LISTEN
tcp        0      0 192.168.122.1:53        0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN
tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN
tcp        0      0 0.0.0.0:445             0.0.0.0:*               LISTEN
tcp        0    116 192.168.221.139:22      192.168.221.1:8730      ESTABLISHED
tcp        0      0 192.168.221.139:22      192.168.221.1:8762      ESTABLISHED
udp        0      0 192.168.221.139:137     0.0.0.0:*
udp        0      0 192.168.122.1:137       0.0.0.0:*
udp        0      0 0.0.0.0:137             0.0.0.0:*
udp        0      0 192.168.221.139:138     0.0.0.0:*
udp        0      0 192.168.122.1:138       0.0.0.0:*
udp        0      0 0.0.0.0:138             0.0.0.0:*
udp        0      0 192.168.122.1:53        0.0.0.0:*
udp        0      0 0.0.0.0:67              0.0.0.0:*
udp        0      0 0.0.0.0:68              0.0.0.0:*
udp        0      0 0.0.0.0:40517           0.0.0.0:*
udp        0      0 0.0.0.0:5353            0.0.0.0:*
}}}
}}}

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/manpages/jaunty/en/man8/netstat.8.html]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=netstat&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="nmap - инструмент проверки безопасности сети и сканер портов" modifier="Яковлев Иван" created="200906122209" modified="200906122210" tags="[[Команды для диагностики сети]] TODO" changecount="2">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=nmap&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|TODO]]


</pre>
</div>
<div title="passwd - изменение пароля пользователя" modifier="Яковлев Иван" created="200906031653" modified="200906031713" changecount="8">
<pre>!Описание
Программа passwd изменяет пароли пользовательских учётных записей. Обычный пользователь может изменить пароль только своей учётной записи, суперпользователь может изменить пароль любой учётной записи. Программа passwd также изменяет информацию об учётной записи: полное имя пользователя, регистрационную оболочку командной строки или дату устаревания пароля и интервал.

Например, чтобы назначить пароль для нового пользователя ''newuser'' надо набрать: 
{{{
sudo passwd newuser
}}}

!!Изменение пароля
Сначала пользователя попросят ввести старый пароль, если он был. Этот пароль зашифровывается и сравнивается с имеющимся. У пользователя есть только одна попытка ввести правильный пароль. Для суперпользователя этот шаг пропускается, для того чтобы можно было изменить забытый пароль.

После ввода пароля проверяется информация об устаревании пароля, чтобы убедиться, что пользователю разрешено изменять пароль в настоящий момент. Если нет, то passwd не производит изменение пароля и завершает работу.

Затем пользователю предложат дважды ввести новый пароль. Значение второго ввода сравнивается с первым и для изменения пароли из обеих попыток должны совпасть.

Затем пароль тестируется на сложность подбора. Согласно общим принципам, пароли должны быть длиной от 6 до 8 символов и включать один или более символов каждого типа:
*строчные буквы 
*цифры от 0 до 9 
*знаки пунктуации 

Не включайте системные символы стирания и удаления. Программа {{{passwd}}} не примет пароль, который не имеет достаточной сложности.  

!!Выбор пароля
Безопасность пароля зависит от стойкости алгоритма шифрования и размера пространства ключа. В ~UNIXсистемах метод шифрования основан на алгоритме NBS DES и очень безопасен. Размер пространства ключа зависит от степени произвольности выбранного пароля.

Компромиссом в безопасности пароля является небрежный выбор пароля и сложность работы с ним. По этой причине, вы не должны использовать пароль, который является словом из словаря или который придётся записать из-за его сложности. Также, пароль не должен быть названием чего-либо, номером вашей лицензии, днём рождения и домашним адресом. Обо всём этом легко догадаться, что приведёт к нарушению безопасности системы.

Пароль должен легко запоминаться, чтобы не было необходимости записывать его на бумагу. Этого можно достичь соединив два маленьких слова в одно, разделив их специальным символом или цифрой. Например, ''Pass%word''.

Другим методом создания является выбор легко запоминающейся фразы из литературы и взятие первой или последней буквы каждого слова. Например:
*Ask not for whom the bell tolls 
*получается 
*An4wtbt 

Можете быть уверены, что некоторые взломщики включат этот пароль в свои словари. Поэтому вы должны выбрать свои собственные методы создания паролей и не полагаться на методы предложенные здесь.

!Параметры
;{{{-a, --all}}}
:Этот параметр можно использовать только вместе с -S для вывода статуса всех пользователей. 

;{{{-d, --delete}}}
:Удалить пароль пользователя (сделать его пустым). Это быстрый способ заблокировать пароль учётной записи. Это делает указанную учётную запись беспарольной. 

;{{{-e, --expire}}}
:Немедленно сделать пароль устаревшим. В результате это заставит пользователя изменить пароль при следующем входе в систему. 

;{{{-h, --help}}}
:Показать краткую справку и закончить работу. 

;{{{-i, --inactiveДНЕЙ}}}
:Этот параметр используется для блокировки учётной записи по прошествии заданного числа дней после устаревания пароля. То есть, если пароль устарел и прошло более указанных ''ДНЕЙ'', то пользователь больше не сможет использовать данную учётную запись. 

;{{{-k, --keep-tokens}}}
:Indicate password change should be performed only for expired authentication tokens (passwords). The user wishes to keep their non-expired tokens as before. 

;{{{-l, --lock}}}
:Заблокировать указанную учётную запись. Этот параметр блокирует учётную запись изменяя значение пароля на вариант, который не может быть шифрованным паролем. 

;{{{-m, --mindaysМИН_ДНЕЙ}}}
:Задать минимальное количество дней между сменой пароля. Нулевое значение этого поля указывает на то, что пользователь может менять свой пароль когда захочет. 

;{{{-q, --quiet}}}
:Не выводить сообщений при работе. 

;{{{-r, --repositoryРЕПОЗИТОРИЙ}}}
:Изменить пароль в ''РЕПОЗИТОРИИ''. 

;{{{-S, --status}}}
:Показать состояние учётной записи. Информация о состоянии содержит 7 полей. Первое поле содержит имя учётной записи. Второе поле указывает, заблокирована ли учётная запись (L), она без пароля (NP) или у неё есть рабочий пароль (P). Третье поле хранит дату последнего изменения пароля. В следующих четырёх полях хранятся минимальный срок, максимальный срок, период выдачи предупреждения и период неактивности пароля. Эти сроки измеряются в днях. 

;{{{-u, --unlock}}}
:Разблокировать указанную учётную запись. Этот параметр активирует учётную запись изменяя пароль на прежнее значение (которое было перед использованием параметра -l). 

;{{{-w, --warndaysПРЕД_ДНЕЙ}}}
:Установить число дней выдачи предупреждения, перед тем как потребуется смена пароля. В параметре ''ПРЕД_ДНЕЙ'' указывается число дней перед тем как пароль устареет, в течении которых пользователю будут напоминать, что пароль скоро устареет. 

;{{{-x, --maxdaysМАКС_ДНЕЙ}}}
:Установить максимальное количество дней, в течении которых пароль остаётся рабочим. После ''МАКС_ДНЕЙ'' пароль нужно изменить. 

!Файлы
;{{{/etc/passwd}}}
:содержит информацию о пользователях 
;{{{/etc/shadow}}}
:содержит защищаемую информацию о пользователях 

!См. также
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=passwd&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=passwd&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="php-5.2.10 ./configure --help" modifier="Яковлев Иван" created="200906231558" modified="200906231559" tags="listing" changecount="2">
<pre>Справка по доступным опциям конфигурирования пакета ~PHP5
{{{
  --disable-flatfile        DBA: FlatFile support (bundled)
  --enable-dbase          Enable the bundled dbase library
  --disable-dom           Disable DOM support
  --with-libxml-dir[=DIR]   DOM: libxml2 install prefix
  --enable-exif           Enable EXIF (metadata from images) support
  --with-fbsql[=DIR]      Include FrontBase support. DIR is the FrontBase base directory
  --with-fdftk[=DIR]      Include FDF support
  --disable-filter        Disable input filter support
  --with-pcre-dir           FILTER: pcre install prefix
  --enable-ftp            Enable FTP support
  --with-openssl-dir[=DIR]  FTP: openssl install prefix
  --with-gd[=DIR]         Include GD support.  DIR is the GD library base
                          install directory [BUNDLED]
  --with-jpeg-dir[=DIR]     GD: Set the path to libjpeg install prefix
  --with-png-dir[=DIR]      GD: Set the path to libpng install prefix
  --with-zlib-dir[=DIR]     GD: Set the path to libz install prefix
  --with-xpm-dir[=DIR]      GD: Set the path to libXpm install prefix
  --with-ttf[=DIR]          GD: Include FreeType 1.x support
  --with-freetype-dir[=DIR] GD: Set the path to FreeType 2 install prefix
  --with-t1lib[=DIR]        GD: Include T1lib support. T1lib version &gt;= 5.0.0 required
  --enable-gd-native-ttf    GD: Enable TrueType string function
  --enable-gd-jis-conv      GD: Enable JIS-mapped Japanese font support
  --with-gettext[=DIR]    Include GNU gettext support
  --with-gmp[=DIR]        Include GNU MP support
  --disable-hash          Disable hash support
  --without-iconv[=DIR]   Exclude iconv support
  --with-imap[=DIR]       Include IMAP support. DIR is the c-client install prefix
  --with-kerberos[=DIR]     IMAP: Include Kerberos support. DIR is the Kerberos install prefix
  --with-imap-ssl[=DIR]     IMAP: Include SSL support. DIR is the OpenSSL install prefix
  --with-interbase[=DIR]  Include InterBase support.  DIR is the InterBase base
                          install directory [/usr/interbase]
  --disable-json          Disable JavaScript Object Serialization support
  --with-ldap[=DIR]       Include LDAP support
  --with-ldap-sasl[=DIR]    LDAP: Include Cyrus SASL support
  --enable-mbstring       Enable multibyte string support
  --disable-mbregex         MBSTRING: Disable multibyte regex support
  --disable-mbregex-backtrack
                            MBSTRING: Disable multibyte regex backtrack check
  --with-libmbfl[=DIR]      MBSTRING: Use external libmbfl.  DIR is the libmbfl base
                            install directory [BUNDLED]
  --with-mcrypt[=DIR]     Include mcrypt support
  --with-mhash[=DIR]      Include mhash support
  --with-mime-magic[=FILE]
                          Include mime_magic support (DEPRECATED!!)
  --with-ming[=DIR]       Include MING support
  --with-msql[=DIR]       Include mSQL support.  DIR is the mSQL base
                          install directory [/usr/local/Hughes]
  --with-mssql[=DIR]      Include MSSQL-DB support.  DIR is the FreeTDS home
                          directory [/usr/local/freetds]
  --with-mysql[=DIR]      Include MySQL support. DIR is the MySQL base directory
  --with-mysql-sock[=DIR]   MySQL: Location of the MySQL unix socket pointer.
                            If unspecified, the default locations are searched
  --with-zlib-dir[=DIR]     MySQL: Set the path to libz install prefix
  --with-mysqli[=FILE]    Include MySQLi support.  FILE is the optional pathname
                          to mysql_config [mysql_config]
  --enable-embedded-mysqli  MYSQLi: Enable embedded support
  --with-ncurses[=DIR]    Include ncurses support (CLI/CGI only)
  --with-oci8[=DIR]       Include Oracle (OCI8) support. DIR defaults to $ORACLE_HOME.
                          Use --with-oci8=instantclient,/path/to/oic/lib
                          for an Oracle Instant Client installation
  --with-adabas[=DIR]     Include Adabas D support [/usr/local]
  --with-sapdb[=DIR]      Include SAP DB support [/usr/local]
  --with-solid[=DIR]      Include Solid support [/usr/local/solid]
  --with-ibm-db2[=DIR]    Include IBM DB2 support [/home/db2inst1/sqllib]
  --with-ODBCRouter[=DIR] Include ODBCRouter.com support [/usr]
  --with-empress[=DIR]    Include Empress support [$EMPRESSPATH]
                          (Empress Version &gt;= 8.60 required)
  --with-empress-bcs[=DIR]
                          Include Empress Local Access support [$EMPRESSPATH]
                          (Empress Version &gt;= 8.60 required)
  --with-birdstep[=DIR]   Include Birdstep support [/usr/local/birdstep]
  --with-custom-odbc[=DIR]
                          Include user defined ODBC support. DIR is ODBC install base
                          directory [/usr/local]. Make sure to define CUSTOM_ODBC_LIBS and
                          have some odbc.h in your include dirs. f.e. you should define
                          following for Sybase SQL Anywhere 5.5.00 on QNX, prior to
                          running this configure script:
                              CPPFLAGS=&quot;-DODBC_QNX -DSQLANY_BUG&quot;
                              LDFLAGS=-lunix
                              CUSTOM_ODBC_LIBS=&quot;-ldblib -lodbc&quot;
  --with-iodbc[=DIR]      Include iODBC support [/usr/local]
  --with-esoob[=DIR]      Include Easysoft OOB support [/usr/local/easysoft/oob/client]
  --with-unixODBC[=DIR]   Include unixODBC support [/usr/local]
  --with-dbmaker[=DIR]    Include DBMaker support
  --enable-pcntl          Enable pcntl support (CLI/CGI only)
  --disable-pdo           Disable PHP Data Objects support
  --with-pdo-dblib[=DIR]    PDO: DBLIB-DB support.  DIR is the FreeTDS home
                            directory
  --with-pdo-firebird[=DIR] PDO: Firebird support.  DIR is the Firebird base
                            install directory [/opt/firebird]
  --with-pdo-mysql[=DIR]    PDO: MySQL support. DIR is the MySQL base directory
  --with-zlib-dir[=DIR]       PDO_MySQL: Set the path to libz install prefix
  --with-pdo-oci[=DIR]      PDO: Oracle OCI support. DIR defaults to $ORACLE_HOME.
                            Use --with-pdo-oci=instantclient,prefix,version
                            for an Oracle Instant Client SDK.
                            For Linux with 10.2.0.3 RPMs (for example) use:
                            --with-pdo-oci=instantclient,/usr,10.2.0.3
  --with-pdo-odbc=flavour,dir
                            PDO: Support for 'flavour' ODBC driver.
                            include and lib dirs are looked for under 'dir'.

                            'flavour' can be one of:  ibm-db2, unixODBC, generic
                            If ',dir' part is omitted, default for the flavour
                            you have selected will used. e.g.:

                              --with-pdo-odbc=unixODBC

                            will check for unixODBC under /usr/local. You may attempt
                            to use an otherwise unsupported driver using the &quot;generic&quot;
                            flavour.  The syntax for generic ODBC support is:

                              --with-pdo-odbc=generic,dir,libname,ldflags,cflags

                            When build as shared the extension filename is always pdo_odbc.so
  --with-pdo-pgsql[=DIR]    PDO: PostgreSQL support.  DIR is the PostgreSQL base
                            install directory or the path to pg_config
  --without-pdo-sqlite[=DIR]
                            PDO: sqlite 3 support.  DIR is the sqlite base
                            install directory [BUNDLED]
  --with-pgsql[=DIR]      Include PostgreSQL support.  DIR is the PostgreSQL
                          base install directory or the path to pg_config
  --disable-posix         Disable POSIX-like functions
  --with-pspell[=DIR]     Include PSPELL support.
                          GNU Aspell version 0.50.0 or higher required
  --with-libedit[=DIR]    Include libedit readline replacement (CLI/CGI only)
  --with-readline[=DIR]   Include readline support (CLI/CGI only)
  --with-recode[=DIR]     Include recode support
  --disable-reflection    Disable reflection support
  --disable-session       Disable session support
  --with-mm[=DIR]           SESSION: Include mm support for session storage
  --enable-shmop          Enable shmop support
  --disable-simplexml     Disable SimpleXML support
  --with-libxml-dir=DIR     SimpleXML: libxml2 install prefix
  --with-snmp[=DIR]       Include SNMP support
  --with-openssl-dir[=DIR]  SNMP: openssl install prefix
  --enable-ucd-snmp-hack    SNMP: Enable UCD SNMP hack
  --enable-soap           Enable SOAP support
  --with-libxml-dir=DIR     SOAP: libxml2 install prefix
  --enable-sockets        Enable sockets support
  --disable-spl           Disable Standard PHP Library
  --without-sqlite=DIR    Do not include sqlite support.  DIR is the sqlite base
                          install directory [BUNDLED]
  --enable-sqlite-utf8      SQLite: Enable UTF-8 support for SQLite
  --with-regex=TYPE       regex library type: system, apache, php. [TYPE=php]
                          WARNING: Do NOT use unless you know what you are doing!
  --with-sybase[=DIR]     Include Sybase-DB support.  DIR is the Sybase home
                          directory [/home/sybase]
  --with-sybase-ct[=DIR]  Include Sybase-CT support.  DIR is the Sybase home
                          directory [/home/sybase]
  --enable-sysvmsg        Enable sysvmsg support
  --enable-sysvsem        Enable System V semaphore support
  --enable-sysvshm        Enable the System V shared memory support
  --with-tidy[=DIR]       Include TIDY support
  --disable-tokenizer     Disable tokenizer support
  --enable-wddx           Enable WDDX support
  --with-libxml-dir=DIR     WDDX: libxml2 install prefix
  --with-libexpat-dir=DIR   WDDX: libexpat dir for XMLRPC-EPI (deprecated)
  --disable-xml           Disable XML support
  --with-libxml-dir=DIR     XML: libxml2 install prefix
  --with-libexpat-dir=DIR   XML: libexpat install prefix (deprecated)
  --disable-xmlreader     Disable XMLReader support
  --with-libxml-dir=DIR     XMLReader: libxml2 install prefix
  --with-xmlrpc[=DIR]     Include XMLRPC-EPI support
  --with-libxml-dir=DIR     XMLRPC-EPI: libxml2 install prefix
  --with-libexpat-dir=DIR   XMLRPC-EPI: libexpat dir for XMLRPC-EPI (deprecated)
  --with-iconv-dir=DIR      XMLRPC-EPI: iconv dir for XMLRPC-EPI
  --disable-xmlwriter     Disable XMLWriter support
  --with-libxml-dir=DIR     XMLWriter: libxml2 install prefix
  --with-xsl[=DIR]        Include XSL support.  DIR is the libxslt base
                          install directory (libxslt &gt;= 1.1.0 required)
  --enable-zip            Include Zip read/write support
  --with-zlib-dir[=DIR]     ZIP: Set the path to libz install prefix

PEAR:

  --with-pear=DIR         Install PEAR in DIR [PREFIX/lib/php]
  --without-pear          Do not install PEAR

Zend:

  --with-zend-vm=TYPE     Set virtual machine dispatch method. Type is
                          one of CALL, SWITCH or GOTO [TYPE=CALL]
  --enable-maintainer-zts Enable thread safety - for code maintainers only!!
  --disable-inline-optimization
                          If building zend_execute.lo fails, try this switch
  --enable-zend-multibyte Compile with zend multibyte support

TSRM:

  --with-tsrm-pth[=pth-config]
                          Use GNU Pth
  --with-tsrm-st          Use SGI's State Threads
  --with-tsrm-pthreads    Use POSIX threads (default)

Libtool:

  --enable-shared[=PKGS]  build shared libraries [default=yes]
  --enable-static[=PKGS]  build static libraries [default=yes]
  --enable-fast-install[=PKGS]  optimize for fast installation [default=yes]
  --with-gnu-ld           assume the C compiler uses GNU ld [default=no]
  --disable-libtool-lock  avoid locking (might break parallel builds)
  --with-pic              try to use only PIC/non-PIC objects [default=use both]
  --with-tags[=TAGS]      include additional configurations [automatic]

  --with-gnu-ld           assume the C compiler uses GNU ld [default=no]
}}}


</pre>
</div>
<div title="php-fpm make install summery" modifier="Яковлев Иван" created="200906241811" tags="listing" changecount="1">
<pre>{{{
Installing PHP SAPI module:       cgi
Installing PHP CGI binary: /usr/bin/
Installing FPM config:            /etc/php-fpm.conf
                                  (installing as php-fpm.conf.default)
Installing init.d script:         /usr/sbin/php-fpm
Installing PHP CLI binary:        /usr/bin/
Installing PHP CLI man page:      /usr/man/man1/
Installing build environment:     /usr/lib/php/build/
Installing header files:          /usr/include/php/
Installing helper programs:       /usr/bin/
  program: phpize
  program: php-config
Installing man pages:             /usr/man/man1/
  page: phpize.1
  page: php-config.1
Installing PEAR environment:      /usr/lib/php/
[PEAR] Archive_Tar    - already installed: 1.3.3
[PEAR] Console_Getopt - already installed: 1.2.3
[PEAR] Structures_Graph- already installed: 1.0.2
[PEAR] XML_Util       - already installed: 1.2.1
[PEAR] PEAR           - already installed: 1.8.0
Wrote PEAR system config file at: /etc/pear.conf
You may want to add: /usr/lib/php to your php.ini include_path
Installing PDO headers:          /usr/include/php/ext/pdo/
}}}


</pre>
</div>
<div title="ping - посылка пакетов ICMP ECHO_REQUEST сетевым хостам" modifier="Яковлев Иван" created="200906122205" modified="200906122208" tags="[[Команды для диагностики сети]] TODO" changecount="2">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=ping&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=ping&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="printenv - вывод всех переменных окружения для текущего пользователя" modifier="Яковлев Иван" created="200906161401" tags="[[Информационные команды]] TODO" changecount="1">
<pre>!Описание
Выводит все переменные окружения для текущего пользователя
{{{
printenv
}}}

!Ссылки
*[[Описание на manpages.ubuntu.com|TODO]]
*[[Описание на Opennet.ru|TODO]]


</pre>
</div>
<div title="ps - показ текущих процессов" modifier="Яковлев Иван" created="200906161409" modified="200906171843" tags="[[Информационные команды]]" changecount="2">
<pre>!Описание
Показывает запущенные процесс
{{{
ps aux
}}}
;{{{a}}}
:Показать все процессы.
{{note{
''ЗАМЕЧАНИЕ:''
при указании дополнительных опций тире не надо.
}}}
;{{{f}}}
:Показать владельца процесса используя древовидный стиль отображения.

;{{{u}}}
:Ограничить список только процессами запущенными для текущего пользователя, а также запущенные текущим пользователем.

;{{{x}}}
:Включить в список процессы запущенные не текущим пользователем, но работающие под его идентификатором пользователя (UID).

!Пример использования
{{{
ps -a | grep имя_процесса
}}}
данная команда из всего списка запущенных процессов выбирает указанное имя процесса и выводит информацию о нем.

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=ps&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=ps&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="pv - pipeviewer просмотрщик пайпов" modifier="Яковлев Иван" created="200907260035" modified="200907260042" tags="[[Команды администрирования]]" changecount="3">
<pre>!Описание
И так pv — это сокращенно от pipeviewer, то есть просмотрщик пайпов. Про эффективность использования пайпов расказывать думаю не стоит, ни для кого это не секрет. Единственное, «но» в работе с ними — это то, что набрав команду и нажав Enter часто не хватает самой малости — знать сколько времени займет ее выполнение. Именно cкорость обработки данных и будет нам показывать pv.

!Примеры использования
Установка pv в Debian/Ubuntu довольно проста.
{{{
sudo aptitude install pv
}}}
Дальше вводная, допустим у вас есть логи, которые вы хотите заархивировать, например так:
{{{
cat rt94-171-06 | gzip &gt; rt94-171-06.gz
}}}
Есть мысли, сколько времени займет эта операция?

Тоже самое при помощи pv:
{{{
pv rt94-171-06 | gzip &gt; rt94-171-06.gz
}}}
{{terminal{
{{{
128MB 0:00:15 [ 9.1MB/s] [=====&gt;.....................] 18% ETA 0:01:07
}}}
}}}
Наглядно видно, что через пайп за 15 секунд прошло 128Мб — это 18% от всего объема, операция займет еще минуту и 7 секунд. 

Может показаться, что pv это такая замена для cat, но на самом деле ее возможности намного шире. Например, упаковываем весь каталог в сжатый архив
{{{
tar -czf - . | pv &gt; out.tgz
}}}
{{terminal{
{{{
21.9MB 0:00:15 [1.47MB/s] [...&lt;=&gt;.....................]
}}}
}}}
Уже неплохо, но хочеться большего, чтобы показывалось время окончания работы. Для этого всего лишь надо при помощи ключа -s передать pv размер каталога в байтах
{{{
tar -czf - . | pv -s $(du -sb | grep -o '[0-9]*') &gt; out.tgz
}}}
{{terminal{
{{{
44.3MB 0:00:27 [1.73MB/s] [&gt;..........................] 0% ETA 13:36:22
}}}
}}}
У меня вся операция займет 13 с половиной часов. Хех, накопил =)

Можно так же составлять команды из несколько копий pv:
{{{
tar -cf - . | pv -cN tar -s $(du -sb | grep -o '[0-9]*') | gzip | pv -cN gzip &gt; out.tgz
}}}
{{terminal{
{{{
tar: 97.1MB 0:00:08 [12.3MB/s] [&gt;......................] 0% ETA 1:50:26
gzip: 13.1MB 0:00:08 [1.6MB/s] [....&lt;=&gt;................]
}}}
}}}
Ключ {{{-c}}} нужен, чтобы несколько копий pv не выводили информацию друг поверх друга. Ключ {{{-N}}} дает имя шкале.

Ну и под конец забавный пример с одного англоязычного блога о Линуксе
{{{
pv /dev/urandom &gt; /dev/null
}}}
{{terminal{
{{{
18MB 0:00:05 [ 3,6MB/s] [...&lt;=&gt;............................]
}}}
}}}

!Ссылки
*[[Описание на Хабре|http://habrahabr.ru/blogs/linux/65384/#habracut]]


</pre>
</div>
<div title="pwd - показать путь к текущей директории" modifier="Яковлев Иван" created="200906022212" modified="200906161111" tags="[[Навигация по каталогам]] [[Информационные команды]]" changecount="7">
<pre>!Описание
Команда {{{pwd}}} отображает директорию, в которой вы находитесь в настоящее время (акроним {{{pwd}}} означает &quot;print working directory&quot;). Например, при наборе 
{{{
pwd
}}}
в директории {{{Desktop}}}, будет показано {{{/home/username/Desktop}}}. 
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
GNOME Терминал отображает эту информацию в заголовке окна.
}}}

!См. также
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=pwd&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=pwd&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]



</pre>
</div>
<div title="rcp - небезопасное удаленное копирование файлов" modifier="Яковлев Иван" created="200906061901" modified="200906151126" tags="[[Команды для работы с файлами и каталогами]] TODO" changecount="2">
<pre>!Описание
TODO

!См. также
*[[rsync - более быстрая и гибкая замена rcp]]

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/manpages/intrepid/man1/krcp.1.html]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=rcp&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="rm - удалить файлы или каталоги" modifier="Яковлев Иван" created="200906022218" modified="200906031235" tags="[[Команды для работы с файлами и каталогами]]" changecount="3">
<pre>!Описание
{{{rm}}} используется для удаления файлов. 
{{{
rm foo
}}}
удалит файл foo из текущей директории.

По умолчанию команда {{{rm}}} не удаляет каталоги. Для удаления каталога необходимо использовать ключ {{{-R}}}. Например, 
{{{
rm -R foobar
}}}
удалит каталог foobar, ''и всё его содержимое!''

!См. также
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=rm&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=rm&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]



</pre>
</div>
<div title="rsync - более быстрая и гибкая замена rcp" modifier="Яковлев Иван" created="200906151128" modified="200906301315" tags="[[Команды для работы с файлами и каталогами]]" changecount="6">
<pre>!Описание
Утилита rsync ведет себя во многом подобно rcp с той разницей, что имеет гораздо больше параметров и использует протокол удаленного обновления (remote-update protocol) для значительного ускорения передачи файлов, которые уже существуют в месте назначения. 

Благодаря этому протоколу rsync передает только различия между двумя наборами файлов через сетевое соединение, используя эффективный алгоритм поиска контрольных сумм (cheksum-search algorithm), описанный в сопровождающей этот пакет документации. 

Вот некоторые дополнительные особенности rsync: 
*поддержка копирования ссылок, файлов устройств, атрибутов владельца, группы и прав 
*параметры исключения путей exclude и exclude-from подобно GNU tar 
*~CVS-подобный режим исключения для определенных файлов, которые игнорируются тем же образом, каким их должен игнорировать CVS 
*может прозрачно использовать любую оболочку удаленного доступа, включая rsh или ssh 
*не нуждается в привилегиях суперпользователя root 
*конвейеризация передач файлов для уменьшения задержек 
*поддержка анонимного сервера rsync или сервера rsync с аутентификацией (идеально для зеркалирования)

!Синтаксис
{{{
rsync [OPTION]... SRC [SRC]... [USER@]HOST:DEST

rsync [OPTION]... [USER@]HOST:SRC DEST

rsync [OPTION]... SRC [SRC]... DEST

rsync [OPTION]... [USER@]HOST::SRC [DEST]

rsync [OPTION]... SRC [SRC]... [USER@]HOST::DEST

rsync [OPTION]... rsync://[USER@]HOST[:PORT]/SRC [DEST] 
}}}

!Главное
Относительно rsync существует восемь способов его использования:
*Для локального копирования файлов, когда ни исходный SRC, ни конечный DEST пути не содержат двоеточия {{{:}}}. 
*Для копирования локальных файлов на удаленный хост, используя программу удаленной оболочки в качестве транспорта (например, rsh или ssh). В этом случае конечный путь DEST содержит одно двоеточие : как разделитель адреса удаленного хоста и пути файловой системы на нем. 
*Для копирования с удаленного хоста в локальные файлы, используя программу удаленной оболочки. Это происходит, если исходный путь SRC содержит двоеточие {{{:}}}. 
*Для копирования с удаленного rsync-сервера в локальные файлы, когда исходный путь SRC содержит либо двойное двоеточие {{{::}}} , либо он сформирован в виде URL, начинающийся с {{{rsync:// }}}. 
*Для копирования локальных файлов на удаленный rsync-сервер. В этом случае конечный путь DEST содержит {{{::}}} или является URL'ом вида {{{rsync:// }}}. 
*Для копирования с удаленной машины с использованием удаленной оболочки как транспорта и удаленного rsync-сервера. Это происходит, когда исходный путь SRC содержит разделителем двойное двоеточие {{{::}}} и установлен параметр {{{--rsh=COMMAND}}} (или {{{-e &quot;COMMAND&quot;}}}). 
*Для копирования с локальной машины на удаленную с использованием удаленной оболочки как транспорта и удаленного rsync-сервера. Это происходит, когда конечный путь DEST содержит разделителем двойное двоеточие {{{::}}} и установлен параметр {{{--rsh=COMMAND}}} (или {{{-e &quot;COMMAND&quot;}}}). 
*Для получения списка файлов на удаленной машине. Это происходит, если не указать (оставить пустым) локальный путь. 

Обратите внимание, что во всех случаях (кроме запроса списка) как минимум один путь (либо исходный SRC, либо конечный DEST) должен быть локальным. 

!Использование
Применение rsync подобно rcp. Вы должны указать исходный путь и конечный путь назначения, один из которых может быть на удаленном хосте.

Вот некоторые примеры работы с утилитой:
{{{
    rsync *.c foo:src/ 
}}}
Копирует все файлы по шаблону {{{*.c}}} из текущего каталога в каталог {{{src}}}, расположенный на машине {{{foo}}}. Если какой-либо из файлов уже существует, rsync использует протокол удаленного обновления для передачи только различий. За деталями протокола обращайтесь к соответствующей документации.
{{{
    rsync -avz foo:src/bar /data/tmp 
}}}
Копирует все файлы рекурсивно из каталога {{{src/bar}}} с машины foo в локальный каталог {{{/data/tmp/bar}}}. Передача файлов происходит в &quot;архивном&quot; режиме, который гарантирует сохранение символьных ссылок, файлов-устройств, атрибутов, разрешений и т.д. Кроме того, используется сжатие для уменьшения объема непосредственно передаваемых данных.
{{{
    rsync -avz foo:src/bar/ /data/tmp 
}}}
Слэш в окончании исходного пути меняет поведение при копировании так, что все файлы копируются в каталог {{{/data/tmp}}} без создания дополнительного уровня вложения каталогов. Завершающий исходный путь слэш означает &quot;копировать содержимое этого каталога&quot;. Без завершающего слэша - &quot;копировать каталог&quot;. В обоих случаях (со слэшем и без него) атрибуты содержащего файлы каталога копируются на содержащий их копии каталог назначения. Другими словами, в каждом последующем примере команды копируют файлы одинаково, включая атрибуты /dest/foo :
{{{
    rsync -avz /src/foo /dest 

    rsync -avz /src/foo/ /dest/foo 
}}}
Вы также можете использовать rsync в режиме только локального копирования, когда ни один из путей НЕ содержит двоеточия {{{:}}}. Тогда rsync ведет себя как улучшенная команда копирования.
{{{
    rsync somehost.mydomain.com:: 
}}}
Запрашивает весь список анонимно-доступных модулей на машине {{{somehost.mydomain.com}}}.

!Файлы 
*{{{/etc/rsyncd.conf}}} или {{{rsyncd.conf}}}

!См. также
*[[WinSCP - бесплатный графический клиент SFTP и SCP для Windows]]

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/manpages/jaunty/en/man1/rsync.1.html]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=rsync&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="run - запуск программ из консоли Windows и скрытие консоли" modifier="Яковлев Иван" created="200906061558" modified="200906061601" tags="Приложения [[TODO - нужен перевод статьи]] [[Команды Windows]]" changecount="3">
<pre>!Manual for Run Utility
!!Name
       ''run'' - start programs with hidden console window

!!Synopsis
{{{
       run [ -p path ] command [ -wait ] arguments
}}}

!!Description
       Windows  programs  are  either  GUI  programs or console programs. When
       started console  programs  will  either  attach  to an existing console
       or  create a new one. GUI programs can  never attach to an exiting con-
       sole. There is no way to attach to an existing console, but hide it, if
       starting a GUI program.

       run will do this for you. It works as intermediate and starts a console
       program but makes the console window hidden. This is especially  useful
       for  creating  desktop  shortcuts  and  using  ssh  for starting remote
       clients.

       With -p path you can add path to the PATH environment  variable.   Note
       that  the  %PATH% separator has been changed to dos style, i.e. ';' not
       ':' in the native Windows version of run.

       Issuing -wait as first program  argument will make run wait for program
       completion, otherwise it returns immediately.

!!Examples
{{{
       run -p &quot;C:\Program Files\Xming&quot; xeyes
}}}

{{{
       run emacs -wait
}}}

{{{
       run make -wait
}}}

!!Authors
*Charles S. Wilson
*Harold L Hunt II
*Jehan Bing
*Alexander Gottwald
*Colin Harrison

!Ссылки
*http://www.straightrunning.com/run.php
*http://www.straightrunning.com/XmingNotes/#head-146


</pre>
</div>
<div title="runlevel - текущий уровень безопасности, на котором работает система" modifier="Яковлев Иван" created="200906232021" tags="[[Информационные команды]]" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=runlevel&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=runlevel&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="scp - безопасное копирование (программа удаленного копирования файлов)" modifier="Яковлев Иван" created="200906061856" modified="200906061941" tags="[[Команды для работы с файлами и каталогами]] TODO" changecount="6">
<pre>!НАЗВАНИЕ
scp - безопасное копирование (программа удаленного копирования файлов)   

!СИНТАКСИС
{{{
scp [-pqrvC1246] [-F ssh_config] [-S programm] [-P port] [-c cipher] [-i identity_file] 
[-l limit] [-o ssh_option] [[user@]host1:]file1 [...] [[user@]host2:]file2
}}}

!ОПИСАНИЕ
scp копирует файлы между машинами в сети. scp использует [[ssh(1)|http://www.opennet.ru/man.shtml?topic=ssh&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]] для передачи файлов; использует ту же самую аутентификацию и предоставляет ту же самую защиту что и ssh(1). В отличие от [[rcp(1)|http://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=rcp&amp;category=1]], scp запросит пароль или ключевую фразу, если это необходимо для аутентификации. 

Любое имя файла может содержать определение машины и пользователя для обозначения, что этот файл должен быть скопирован на этот компьютер или с него. Разрешено копирование между двумя удаленными машинами. 

Имеются следующие опции: 
;-с cipher
:Указывает шифр, используемый для шифрования передачи данных. Эта опция передается напрямую к ssh(1). 
;-i identity_file
:Указывает файл, из которого будет прочитана идентификационная информация (private key) для ~RSA-аутентификации. Эта опция передается напрямую к ssh(1). 
;-l limit
:Ограничивает пропускную способность заданную в Kbit/сек. 
;-p
:Сохраняет время модификации, время и права доступа и как у файла-оригинала. 
;-r
:Рекурсивное копирование дерева каталогов с подкаталогами. 
;-v
:Режим отладки. Принуждает scp и ssh(1) выводить отладочную информацию об их работе. Это полезно для отладки соединения, аутентификации и проблем конфигурации. 
;-B
:Выбор пакетного режима (предотвращает запрос пароля или ключевой фразы). 
;-q
:Отключает индикатор прогресса. 
;-C
:Включает сжатие. Передает ssh(1) флаг -C для включения сжатия. 
;-F ssh_config
:Указывает альтернативный файл настроек для ssh. Эта опция передаётся напрямую к ssh(1). 
;-P port
:Определяет порт для связи с удаленной машиной. Имейте в виду, что эта опция пишется с заглавной &quot;''Р''&quot;, так как ''-p'' зарезервировано сохранения времени модификации, времени и прав доступа и как у файла-оригинала в rcp(1). 
;-S program
:Название программы (program), используемой для зашифрованного подключения. Программа должна понимать опции ssh(1). 
;-о ssh_option
:Может быть использована для передачи опций ssh(1) в формате, используемом в [[ssh_config(5)|http://www.opennet.ru/man.shtml?topic=ssh_config&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]. Полезно для передачи опций не имеющих специальных флагов командной строки scp. 
:''-1'' -- Принуждает scp использовать протокол версии 1.
:''-2'' -- Принуждает scp использовать протокол версии 2.
:''-4'' -- Принуждает scp использовать только ~IPv4 адреса. 
:''-6'' -- Принуждает scp использовать только ~IPv6 адреса.

!См. также
*[[Описание на Википедии|http://ru.wikipedia.org/wiki/SCP]]

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=scp&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=scp&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]



</pre>
</div>
<div title="screen - запуск толстой оболочки эмулятора терминала (Rich Shell)" modifier="Яковлев Иван" created="200906161458" modified="200906161513" tags="[[Команды администрирования]] [[TODO - нужен перевод статьи]]" changecount="6">
<pre>!Синтаксис
{{{
screen [ -options ] [ cmd [ args ] ]
screen -r [[pid.]tty[.host]]
screen -r sessionowner/[[pid.]tty[.host]] 
}}}

!Опции
Screen has the following command-line options:

;{{{-a}}}
:include all capabilities (with some minor exceptions) in each window's termcap, even if screen must redraw parts of the display in order to implement a function. 

;{{{-A}}}
:Adapt the sizes of all windows to the size of the current terminal. By default, screen tries to restore its old window sizes when attaching to resizable terminals (those with &quot;WS&quot; in its description, e.g. suncmd or some xterm). 

;{{{-c file}}}
:override the default configuration file from &quot;{{{$HOME/.screenrc}}}&quot; to file. 

;{{{-d|-D [pid.tty.host]}}}
:does not start screen, but detaches the elsewhere running screen session. It has the same effect as typing &quot;{{{C-a d}}}&quot; from screen's controlling terminal. {{{-D}}} is the equivalent to the power detach key. If no session can be detached, this option is ignored. In combination with the {{{-r/-R}}} option more powerful effects can be achieved: 

;{{{-d -r}}}
:Reattach a session and if necessary detach it first. 

;{{{-d -R}}}
:Reattach a session and if necessary detach or even create it first. 

;{{{-d -RR}}}
:Reattach a session and if necessary detach or create it. Use the first session if more than one session is available. 

;{{{-D -r}}}
:Reattach a session. If necessary detach and logout remotely first. 

;{{{-D -R}}}
:Attach here and now. In detail this means: If a session is running, then reattach. If necessary detach and logout remotely first. If it was not running create it and notify the user. This is the author's favorite. 

;{{{-D -RR}}}
:Attach here and now. Whatever that means, just do it.
{{note{
''ЗАМЕЧАНИЕ:''
It is always a good idea to check the status of your sessions by means of &quot;{{{screen -list}}}&quot;. 
}}}
;{{{-e xy}}}
:specifies the command character to be x and the character generating a literal command character to y (when typed after the command character). The default is &quot;{{{C-a}}}&quot; and `{{{a}}}', which can be specified as &quot;{{{-e^Aa}}}&quot;. When creating a screen session, this option sets the default command character. In a multiuser session all users added will start off with this command character. But when attaching to an already running session, this option changes only the command character of the attaching user. This option is equivalent to either the commands &quot;defescape&quot; or &quot;escape&quot; respectively. 

;{{{-f, -fn, and -fa}}}
:turns flow-control on, off, or &quot;automatic switching mode&quot;. This can also be defined through the &quot;defflow&quot; .screenrc command. 

;{{{-h num}}}
:Specifies the history scrollback buffer to be num lines high. 

;{{{-i}}}
:will cause the interrupt key (usually ''Ctr-c'') to interrupt the display immediately when flow-control is on. See the &quot;defflow&quot; .screenrc command for details. The use of this option is discouraged. 

;{{{-l and -ln}}}
:turns login mode on or off (for {{{/etc/utmp}}} updating). This can also be defined through the &quot;deflogin&quot; .screenrc command. 

;{{{-ls and -list}}}
:does not start screen, but prints a list of pid.tty.host strings identifying your screen sessions. Sessions marked `detached' can be resumed with &quot;{{{screen -r}}}&quot;. Those marked `attached' are running and have a controlling terminal. If the session runs in multiuser mode, it is marked `multi'. Sessions marked as `unreachable' either live on a different host or are `dead'. An unreachable session is considered dead, when its name matches either the name of the local host, or the specified parameter, if any. See the {{{-r}}} flag for a description how to construct matches. Sessions marked as `dead' should be thoroughly checked and removed. Ask your system administrator if you are not sure. Remove sessions with the -wipe option. 

;{{{-L}}}
:tells screen to turn on automatic output logging for the windows. 

;{{{-m}}}
:causes screen to ignore the {{{$STY}}} environment variable. With &quot;{{{screen -m}}}&quot; creation of a new session is enforced, regardless whether screen is called from within another screen session or not. This flag has a special meaning in connection with the `{{{-d}}}' option: 

;{{{-d -m}}}
:Start screen in &quot;detached&quot; mode. This creates a new session but doesn't attach to it. This is useful for system startup scripts. 

;{{{-D -m}}}
:This also starts screen in &quot;detached&quot; mode, but doesn't fork a new process. The command exits if the session terminates. 

;{{{-O}}}
:selects a more optimal output mode for your terminal rather than true ~VT100 emulation (only affects auto-margin terminals without `LP'). This can also be set in your .screenrc by specifying `OP' in a &quot;termcap&quot; command. 

;{{{-p number_or_name}}}
:Preselect a window. This is usefull when you want to reattach to a specific windor or you want to send a command via the &quot;{{{-X}}}&quot; option to a specific window. As with screen's select commant, &quot;{{{-}}}&quot; selects the blank window. As a special case for reattach, &quot;{{{=}}}&quot; brings up the windowlist on the blank window. 

;{{{-q}}}
:Suppress printing of error messages. In combination with &quot;-ls&quot; the exit value is as follows: 9 indicates a directory without sessions. 10 indicates a directory with running but not attachable sessions. 11 (or more) indicates 1 (or more) usable sessions. In combination with &quot;{{{-r}}}&quot; the exit value is as follows: 10 indicates that there is no session to resume. 12 (or more) indicates that there are 2 (or more) sessions to resume and you should specify which one to choose. In all other cases &quot;{{{-q}}}&quot; has no effect. 

;{{{-r [pid.tty.host]}}}
;{{{-r sessionowner/[pid.tty.host]}}}
:resumes a detached screen session. No other options (except combinations with {{{-d/-D}}}) may be specified, though an optional prefix of [pid.]tty.host may be needed to distinguish between multiple detached screen sessions. The second form is used to connect to another user's screen session which runs in multiuser mode. This indicates that screen should look for sessions in another user's directory. This requires setuid-root. 

;{{{-R}}}
:attempts to resume the first detached screen session it finds. If successful, all other command-line options are ignored. If no detached session exists, starts a new session using the specified options, just as if {{{-R}}} had not been specified. The option is set by default if screen is run as a login-shell (actually screen uses &quot;{{{-xRR}}}&quot; in that case). For combinations with the {{{-d/-D}}} option see there. 

;{{{-s}}}
:sets the default shell to the program specified, instead of the value in the environment variable {{{$SHELL}}} (or &quot;{{{/bin/sh}}}&quot; if not defined). This can also be defined through the &quot;shell&quot; .screenrc command. 

;{{{-S sessionname}}}
:When creating a new session, this option can be used to specify a meaningful name for the session. This name identifies the session for &quot;{{{screen -list}}}&quot; and &quot;{{{screen -r}}}&quot; actions. It substitutes the default [tty.host] suffix. 

;{{{-t name}}}
:sets the title (a.k.a.) for the default shell or specified program. See also the &quot;shelltitle&quot; .screenrc command. 

;{{{-U}}}
:Run screen in UTF-8 mode. This option tells screen that your terminal sends and understands UTF-8 encoded characters. It also sets the default encoding for new windows to `{{{utf8}}}'. 

;{{{-v}}}
:Print version number. 

;{{{-wipe [match]}}}
:does the same as &quot;{{{screen -ls}}}&quot;, but removes destroyed sessions instead of marking them as `dead'. An unreachable session is considered dead, when its name matches either the name of the local host, or the explicitly given parameter, if any. See the {{{-r}}} flag for a description how to construct matches. 

;{{{-x}}}
:Attach to a not detached screen session. (Multi display mode). 

;{{{-X}}}
:Send the specified command to a running screen session. You can use the {{{-d}}} or {{{-r}}} option to tell screen to look only for attached or detached screen sessions. Note that this command doesn't work if the session is password protected.

!Описание
The ssh command gives you only one screen. If you lose that screen, you lose all you were doing on the remote computer. That can be very bad if you were in the middle of something important, such as a 12-hour compile. And if you want to do three things at once, for example {{{vi httpd.conf, tail -f error_log}}}, and service httpd reload, you need to open three separate ssh sessions.

Essentially, screen is a terminal multiplexer. If you are a system administrator working on remote servers, screen is a great tool for managing a remote computer with only a command line interface available. Besides allowing multiple shells sessions, screen also lets you disconnect from it, and then reconnect to that same screen session later. The screen software package is installed by default with Ubuntu. To use screen, run the ssh command from a client system to connect to the Linux server where screen is installed. Then simply type the following command:
{{{
screen
}}}
If you ran screen from a Terminal window, you should first see a welcome message asking for pizza and beer, and then see a regular bash prompt in the window. To control screen, press the ''Ctrl+a'' key combo, followed by another keystroke. For example, ''Ctrl+a'' followed by ''?'' (noted as ''Ctrl+a'', ''?'') displays the help screen. With screen running, here are some commands and control keys you can use to operate screen.

!Горячие клавиши для screen
|!СочетаниеКлавишь|!Описание|
|''Ctrl+a'', ''?''|Show help screen.|
|''Ctrl+a'', ''c''|Create new window.|
|''Ctrl+a'', ''d''|Detach screen from terminal. The screen session and its windows keep running.|
|''Ctrl+a'', ''“''|View list of windows.|
|''Ctrl+a'', ''’''|Prompt for number or name of window to switch to.|
|''Ctrl+a'', ''n''|View next window.|
|''Ctrl+a'', ''p''|View previous window.|
|''Ctrl+a'', ''[''|Terminal’s vertical scroll is disabled in screen. These keys turn on screen’s scrollback mode. Press Enter twice to exit.|
|''Ctrl+a'', ''Shift+a''|Rename current window.|
|''Ctrl+a'', ''w''|Show the list of window names in the title bar.|

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=screen&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=screen&amp;russian=2&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="sed - потоковый редактор (Stream EDitor)" modifier="Яковлев Иван" created="200906121434" modified="200906121435" tags="[[Команды обработки содержимого файла]] [[TODO - нужен перевод статьи]]" changecount="2">
<pre>!Описание
The sed command, short for stream editor, allows you to search for and change specified words or even text streams in a file. For example, the following command changes the first instance of the word Windows to the word Linux in each line of the file opsys, and then writes the result to the file newopsys:
{{{
$ sed 's/Windows/Linux/' opsys &gt; newopsys
}}}
However, this may not be enough. If a line contains more than one instance of Windows; the noted sed command would not change the second and later instances of that word. However, you can make it change every appearance of Windows by adding the global suffix, ''g'':
{{{
$ sed 's/Windows/Linux/g' opsys &gt; newopsys
}}}

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=sed&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=sed&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="slider" modifier="Яковлев Иван" created="200906181726" changecount="1">
<pre>{{{
&lt;&lt;slider &quot;chk-cd&quot; [[cd]] &quot;cd&quot; &quot;Показать/Скрыть описание команды cd&quot;&gt;&gt;
}}}</pre>
</div>
<div title="sort - сортировка строк текстовых файлов" modifier="Яковлев Иван" created="200906121420" modified="200906121422" tags="[[Команды обработки содержимого файла]] [[TODO - нужен перевод статьи]]" changecount="2">
<pre>!Описание
You can sort the contents of a file in a number of ways. By default, the sort command sorts the contents in alphabetical order depending on the first letter in each line. For example:
{{{
sort /etc/passwd
}}}
This command would sort all users (including those associated with specific services and such) by username.

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=sort&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=sort&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="ssh-keygen - создание, обслуживание и преобразование аутентификационных ключей" modifier="Яковлев Иван" created="200907221123" modified="200907221136" tags="[[Команды Unix]] SSH" changecount="4">
<pre>!Синтаксис
{{{
ssh-keygen [-q] [-b bits] [-t type] [-N new_passphrase] [-C comment] [-f output_keyfile] 
ssh-keygen -p [-P old_passphrase] [-N new_passphrase] [-f keyfile] 
ssh-keygen -i [-f input_keyfile] 
ssh-keygen -e [-f input_keyfile] 
ssh-keygen -y [-f input_keyfile] 
ssh-keygen -c [-P passphrase] [-C comment] [-f keyfile] 
ssh-keygen -l [-f input_keyfile] 
ssh-keygen -B [-f input_keyfile] 
ssh-keygen -D reader 
ssh-keygen -U reader [-f input_keyfile]
}}}

!Описание
''ssh-keygen'' создает, обслуживает и преобразует ключи аутентификации для ssh(1). ssh-keygen может создавать ~RSA-ключи для использования с протоколом SSH версии 1 и ~DSA- или ~RSA-ключи для использования с протоколом SSH версии 2. Тип создаваемого ключа определяется при помощи опции {{{-t}}}. 

Обычно каждый пользователь, желающий использовать SSH с RSA или DSA аутентификацией, запускает его единожды для создания аутентификационного ключа в {{{$HOME/.ssh/identity}}}, {{{$HOME/.ssh/id_dsa}}} или {{{$HOME/.ssh/id_rsa}}}. Дополнительно, системный администратор может использовать его для создания ключей машины, как это видно из {{{/etc/rc}}}. 

Обычно эта программа генерирует ключи и спрашивает название файла в котором надо сохранить приватный ключ. Публичный ключ будет сохранен в файле с тем же именем, только к нему будет добавлено расширение &quot;{{{.pub}}}&quot;. Программа также спросит у вас ключевую фразу. Ключевая фраза может быть пустой, это означает, что ключевая фраза не используется (ключ машины должен иметь пустую ключевую фразу), или это может быть строка произвольной длины. Ключевая фраза схожа с паролем, за исключением того, что ключевая фраза может состоять из набора слов, знаков препинания, цифр, пробелов или любого набора символов, какой вы пожелаете. Хорошими считаются ключевые фразы из 10-30 символов, не являющиеся простыми предложениями или легко угадываемыми (английская проза имеет только 1-2 бита энтропии на символ и обеспечивает очень плохие ключевые фразы) и содержать чередование букв, цифр и не буквенно-цифровых, набранных в верхнем и нижнем регистре, знаков. Ключевая фраза может быть позднее изменена при помощи опции -p. 

Не существует возможности восстановить утерянную ключевую фразу. Если ключевая фраза утеряна или забыта, вы должны создать новый ключ и скопировать соответствующий публичный ключ на другие машины. 

Для ~RSA1-ключей в файле ключа имеется поле комментария, который служит только для удобства пользователя, чтобы было проще идентифицировать ключ. Комментарий может вам сообщить для чего этот ключ или чем он полезен. Комментарий инициализируется при создании для &quot;''user@host''&quot;, но может быть изменен при помощи опции {{{-c}}}. 

После генерации ключа будут приведены инструкции куда его надо поместить для активации.

!Опции
;-b bits
:Определяет число бит в ключе при его создании. Минимум это 512 бит. Как правило, 2048 бит считается достаточным. По умолчанию используется 2048 бит. 

;-c
:Запрашивает изменение комментария в файлах приватных и публичных ключей. Операция поддерживается только для ~RSA1-ключей. Программа предложит указать файл содержащей приватный ключ, спросит ключевое слово, если таковое имеется, и новый комментарий. 

;-е
:Эта опция позволяет прочитать приватный или публичный ~OpenSSH-файл ключа и распечатать его в &quot;SECSH Public Key File Format&quot; в стандартный вывод. Также, данная опция позволяет экспортировать ключи для использования с некоторыми коммерческими реализациями SSH. {{{-f filename}}} Определяет имя файла для файла ключа. 

;-i
:Эта опция считывает не зашифрованный ~SSH2-совместимый приватный (или публичный) файл ключа и распечатывает ~OpenSSH-совместимый приватный (или публичный) ключ в стандартный вывод. Также, ssh-keygen считывает &quot;SECSH Public Key File Format&quot;. Данная опция позволяет импортировать ключи из некоторых коммерческих реализаций SSH. 

;-l
:Показывает распечатку указанного приватного или публичного ключа. Также поддерживаются приватные ~RSA1-ключи. Для ~RSA- и ~DSA-ключей ssh-keygen предпримет попытку найти соответствующие публичные ключи и их отпечатки. 

;-p
:Запрашивает изменение ключевой фразы приватного ключа вместо создания нового приватного ключа. Программа предложит указать имя файла содержащего приватный ключ, старую ключевую фразу и, дважды, новую ключевую фразу. 

;-q
:Тихий ssh-keygen. Используется в работе {{{/etc/rc}}} при создании нового ключа. 

;-y 
:Эта опция читает приватный ~OpenSSH-формат файла и печатает публичный ключ ~OpenSSH в стандартный вывод. 

;-t type
:Определяет тип создаваемого ключа. Допустимыми являются значения &quot;rsa1&quot;, для протокола версии 1, и &quot;rsa1&quot; или &quot;dsa&quot;, для протокола версии 2. 

;-В 
:Этот параметр отображает &quot;bubblebabble&quot; дайджест заданного файла публичного или приватного ключа. 

;-C comment
:Обеспечивает ввод нового комментария. 

;-D reader
:Копировать сохранённый публичный ~RSA-ключ со smartcard в устройстве reader. 

;-N new_passphrase
:Обеспечивает ввод новой ключевой фразы. 

;-P passphrase
:Обеспечивает ввод (старой) ключевой фразы. 

;-D reader
:Копировать публичный ~RSA-ключ на smartcard в устройстве reader.

!Файлы
;{{{$HOME/.ssh/identity}}}
Содержит идентификацию для ~RSA-аутентификации пользователя по протоколу версии 1. Этот файл должен быть доступен для чтения только владельцу. Этого можно добиться путем указания ключевой фразы при создании ключа; эта ключевая фраза будет использована для шифрования приватной части этого файла с использованием 3DES. Этот файл не доступен для ssh-keygen автоматически, но подразумевается, что это файл по умолчанию для приватного ключа. ssh(1) будет считывать данные из этого файла, если будет предпринята попытка входа в систему. 

;{{{$HOME/.ssh/identity.pub}}}
Содержит публичный ключ для ~RSA-аутентификации по протоколу версии 1. Содержимое этого файла должно быть добавлено к {{{$HOME/.ssh/authorized_keys}}} на всех машинах, где вы желаете иметь возможность входа в систему с использованием ~RSA-аутентификации. Нет никакой необходимости хранить содержимое этого файла в тайне. 

;{{{$HOME/.ssh/id_dsa}}}
Содержит идентификацию для ~DSA-аутентификации пользователя по протоколу версии 2. Этот файл должен быть доступен для чтения только владельцу. Этого можно добиться путем указания ключевой фразы при создании ключа; эта ключевая фраза будет использована для шифрования приватной части этого файла с использованием 3DES. Этот файл не доступен для ssh-keygen автоматически, но подразумевается, что это файл по умолчанию для приватного ключа. ssh(1) будет считывать данные из этого файла, если будет предпринята попытка входа в систему. 

;{{{$HOME/.ssh/id_dsa.pub}}}
Содержит публичный ключ для ~DSA-аутентификации по протоколу версии 2. Содержимое этого файла должно быть добавлено к {{{$HOME/.ssh/authorized_keys}}} на всех машинах, где вы желаете иметь возможность входа в систему с использованием аутентификации с публичным ключем. Нет никакой необходимости хранить содержимое этого файла в тайне. 

;{{{$HOME/.ssh/id_rsa}}}
Содержит идентификацию для ~RSA-аутентификации пользователя по протоколу версии 2. Этот файл должен быть доступен для чтения только владельцу. Этого можно добиться путем указания ключевой фразы при создании ключа; эта ключевая фраза будет использована для шифрования приватной части этого файла с использованием 3DES. Этот файл не доступен для ssh-keygen автоматически, но подразумевается, что это файл по умолчанию для приватного ключа. ssh(1) будет считывать данные из этого файла, если будет предпринята попытка входа в систему. 

;{{{$HOME/.ssh/id_rsa.pub}}}
Содержит публичный ключ для ~RSA-аутентификации по протоколу версии 2. Содержимое этого файла должно быть добавлено к {{{$HOME/.ssh/authorized_keys}}} на всех машинах, где вы желаете иметь возможность входа в систему с использованием аутентификации с публичным ключем. Нет никакой необходимости хранить содержимое этого файла в тайне.

!См. также
*[[OpenSSH сервер]]

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=ssh-keygen&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=ssh-keygen&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="sshd configuration file exemple" modifier="Яковлев Иван" created="200906192251" modified="200906192326" tags="[[Примеры конфигурационных файлов]] TODO" changecount="2">
<pre>{{{
# Package generated configuration file
# See the sshd(8) manpage for details

# What ports, IPs and protocols we listen for
Port 30000
# Use these options to restrict which interfaces/protocols sshd will bind to
#ListenAddress ::
#ListenAddress 0.0.0.0
Protocol 2
# HostKeys for protocol version 2
HostKey /etc/ssh/ssh_host_rsa_key
HostKey /etc/ssh/ssh_host_dsa_key
#Privilege Separation is turned on for security
UsePrivilegeSeparation yes

# Lifetime and size of ephemeral version 1 server key
KeyRegenerationInterval 3600
ServerKeyBits 768

# Logging
SyslogFacility AUTH
LogLevel INFO

# Authentication:
LoginGraceTime 120
PermitRootLogin no
StrictModes yes

RSAAuthentication yes
PubkeyAuthentication yes
#AuthorizedKeysFile	%h/.ssh/authorized_keys

# Don't read the user's ~/.rhosts and ~/.shosts files
IgnoreRhosts yes
# For this to work you will also need host keys in /etc/ssh_known_hosts
RhostsRSAAuthentication no
# similar for protocol version 2
HostbasedAuthentication no
# Uncomment if you don't trust ~/.ssh/known_hosts for RhostsRSAAuthentication
#IgnoreUserKnownHosts yes

# To enable empty passwords, change to yes (NOT RECOMMENDED)
PermitEmptyPasswords no

# Change to yes to enable challenge-response passwords (beware issues with
# some PAM modules and threads)
ChallengeResponseAuthentication no

# Change to no to disable tunnelled clear text passwords
PasswordAuthentication no

# Kerberos options
#KerberosAuthentication no
#KerberosGetAFSToken no
#KerberosOrLocalPasswd yes
#KerberosTicketCleanup yes

# GSSAPI options
GSSAPIAuthentication no
#GSSAPICleanupCredentials yes

X11Forwarding no
X11DisplayOffset 10
PrintMotd no
PrintLastLog yes
KeepAlive yes
#UseLogin no

#MaxStartups 10:30:60
#Banner /etc/issue.net

# Allow client to pass locale environment variables
AcceptEnv LANG LC_*

Subsystem sftp /usr/lib/openssh/sftp-server

UsePAM no

UseDNS no

AllowUsers demo
}}}

{{textAlignRight{
Ссылка: http://articles.slicehost.com/assets/2007/9/4/sshd_config.txt
}}}


</pre>
</div>
<div title="su - запуск командной оболчки от имени другого пользователя" modifier="Яковлев Иван" created="200906171649" modified="200906171650" tags="[[Команды администрирования]] [[TODO - нужен перевод статьи]]" changecount="2">
<pre>!Описание
Временный вход и работа под другим пользователем системы, если не указать пользователя, то работа будет осуществляться от имени супер пользователя root, обладающего всеми правами над системой (при это должна быть включена учетная запись root-пользователя).

!Синтаксис
{{{
su [OPTION]... [-] [USER [ARG]...]
}}}

!Опции
Change the effective user id and group id to that of USER.

;{{{-, -l, --login}}}
:make the shell a login shell 

;{{{-g --group=group}}}
:specify the primary group 

;{{{-G --supp-group=group}}}
:specify a supplemental group 

;{{{-c, --commmand=COMMAND}}}
:pass a single COMMAND to the shell with {{{-c}}} 

;{{{--session-command=COMMAND}}}
:pass a single COMMAND to the shell with {{{-c}}} and do not create a new session 

;{{{-f, --fast}}}
:pass {{{-f}}} to the shell (for csh or tcsh) 

;{{{-m, --preserve-environment}}}
:do not reset environment variables 

;{{{-p}}}
:same as {{{-m}}} 

;{{{-s, --shell=SHELL}}}
:run SHELL if {{{/etc/shells}}} allows it 

;{{{--help}}}
:display this help and exit 

;{{{--version}}}
:output version information and exit 

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=su&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=su&amp;russian=2&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="sudo - выполнение команды от имени суперпользователя" modifier="Яковлев Иван" created="200906052202" modified="200906161513" tags="[[Команды администрирования]] TODO" changecount="5">
<pre>!Описание
''sudo'' (англ. superuser [substitute user] do, дословно «выполнить от имени суперпользователя») -- это программа, разработанная в помощь системному администратору и позволяющая делегировать те или иные привилегированные ресурсы пользователям с ведением протокола работы. Основная идея -- дать пользователям как можно меньше прав, но при этом ровно столько, сколько необходимо для решения поставленных задач.

Команда sudo предоставляет возможность пользователям выполнять команды от имени root, либо других пользователей. Правила, используемые sudo для принятия решения о предоставлении доступа, находятся в файле /etc/sudoers; язык их написания и примеры использования подробно изложены в [[sudoers(5)|http://manpages.ubuntu.com/manpages/jaunty/en/man5/sudoers.5.html]].

Для редактирования файла {{{/etc/sudoers}}} следует использовать программу visudo, которая проверяет синтаксис и тем самым позволяет избежать ошибок в правилах.

В большинстве случаев грамотная настройка sudo делает работу от имени суперпользователя ненужной.

!См. также
*[[Настройка sudo в Debian GNU/Linux и Ubuntu Linux|http://sudouser.com/nastrojka-sudo-v-debian-gnulinux-i-ubuntu-linux.html#more-141]]

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/manpages/jaunty/en/man8/sudo.8.html]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=sudo&amp;russian=2&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="tac - объединяет и печатает файлы в обратной последовательности" modifier="Яковлев Иван" created="200906161425" modified="200906161426" tags="[[Команды для работы с файлами и каталогами]]" changecount="2">
<pre>!Описание
Печатает каждый из ФАЙЛОВ на стандартный вывод, начиная с последней строки. Если ФАЙЛ не задан или задан как -, читает стандартный вывод.
{{{
tac [ОПЦИЯ]... [ФАЙЛ]...
}}}
Аргументы, обязательные для длинных ключей, обязательны и для коротких.
;{{{-b, --before}}}
:присоединяет разделитель к началу, а не к концу 

;{{{-r, --regex}}}
:воспринимает разделитель как регулярное выражение 

;{{{-s, --separator=СТРОКА}}}
:использовать СТРОКУ как разделитель вместо разделителя ' 

;{{{--help}}}
:показать справку и выйти 

;{{{--version}}}
    показать информацию о версии и выйти 

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=tac&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=tac&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="tail - вывести последние строки" modifier="Яковлев Иван" created="200906161432" modified="200906161433" tags="[[Команды для работы с файлами и каталогами]]" changecount="2">
<pre>!Описание
Печатает последние 10 строк каждого из ФАЙЛОВ на стандартный вывод. Если задано несколько ФАЙЛОВ, сначала печатается заголовок с именем файла. Если ФАЙЛ не задан или задан как {{{/-}}}, читает стандартный ввод.

Обязательные аргументы для длинных ключей обязательны и для коротких.
{{{
tail имя_файла.txt
}}}

;{{{--retry}}}
:продолжать попытки открытия файлов, даже если он недоступен, когда tail запущен, или если он стал недоступен позднее; полезно только при наблюдении по имени, например, при {{{--follow=ФАЙЛ}}}

;{{{-c, --bytes=N}}}
:вывести последние N байт 

;{{{-f, --follow[={ФАЙЛ|ДЕСКРИПТОР}]}}}
:выводить поступающие данные по мере роста файла; {{{-f}}}, {{{--follow}}}, и {{{--follow=descriptor}}} эквивалентны 

;{{{-F}}}
:синоним {{{--follow=ИМЯ --retry}}}

;{{{-n, --lines=N}}}
:выводить последние N строк, а не последние 10 

;{{{--max-unchanged-stats=N}}}
:с ключом {{{--follow=ФАЙЛ}}}, повторно открывать ФАЙЛ, который не изменялся последние N (по умолчанию 5) итераций, чтобы проверить не был ли он удалён или переименован (такое обычно бывает при ротации системных протокольных файлов) 

;{{{--pid=PID}}}
:с ключом {{{-f}}}, прерваться, когда процесс с заданным PID завершил работу 

;{{{-q, --quiet, --silent}}}
:не выводить заголовки с именами файлов 

;{{{-s, --sleep-interval=S}}}
:с ключом {{{-f}}}, бездействовать примерно S секунд (по умолчанию 1.0) перед итерацией. 

;{{{-v, --verbose}}}
:всегда выводить заголовки с именами файлов 

;{{{--help}}}
:показать справку и выйти 

;{{{--version}}}
:показать информацию о версии и выйти 

Если первым знаком в N (числе байт или строк) является `{{{+}}}', выводит, начиная с N-ого элемента от начала каждого файла, иначе выводит последние N элементов в файле. N может иметь суффикс-множитель: b 512, k 1024, m 1024*1024.

С ключом {{{--follow (-f)}}}, tail по умолчанию следит за дескриптором файла, что означает что даже если файл переименован, tail будет и далее следить за его концом. Этот режим работы, принимаемый по умолчанию, нежелателен, если вы хотите следить за действительным именем файла, а не за дескриптором (например, при ротации файлов-протоколов). В таком случае используйте {{{--follow=ФАЙЛ}}}. Это заставит tail следить за указанным файлом, открывая его периодически, чтобы узнать, не был ли он удалён и заново создан какой-нибудь другой программой.

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=tail&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=tail&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="tar и untar" modifier="Яковлев Иван" created="200906202155" modified="200906202157" tags="[[Администрирование сервера]] [[TODO - нужен перевод статьи]] TODO" changecount="3">
<pre>!Описание
TODO

!Ссылки
*http://articles.slicehost.com/2007/9/7/tar-and-untar
*http://articles.slicehost.com/2007/9/7/tar-and-untar-part-deux


</pre>
</div>
<div title="top - информация об исполняемых процессах и ресурсах системы" modifier="Яковлев Иван" created="200906022248" modified="200906161111" tags="[[Информационные команды]]" changecount="4">
<pre>!Описание
{{{top}}} на системах GNU/Linux выводит информацию об исполняемых процессах и ресурсах системы, включая использование процессора, памяти, раздела подкачки и общего числа исполняемых процессов. Для выхода из {{{top}}}, нажмите q.

!См. также
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=top&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=top&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]



</pre>
</div>
<div title="traceroute - print the route packets take to network host" modifier="Яковлев Иван" created="200906062350" tags="[[Команды для диагностики сети]] [[TODO - нужен перевод статьи]] TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/manpages/intrepid/man8/traceroute-nanog.genuine.8.html]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=traceroute&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="uname - информация о системе" modifier="Яковлев Иван" created="200906022248" modified="200906161436" tags="[[Информационные команды]]" changecount="6">
<pre>!Описание
Команда {{{uname}}} с параметром {{{-a}}} выводит полную информацию о системе, включая имя компьютера, название и версию ядра, а также некоторые другие детали. Наиболее полезна для проверки, какое ядро используется в системе.
{{{
uname -a
}}}
Выдаст на экран:
{{{
Linux uran-ubuntu 2.6.28-11-generic #42-Ubuntu SMP Fri Apr 17 01:57:59 UTC 2009 i686 GNU/Linux
}}}

!См. также
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=uname&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=uname&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]



</pre>
</div>
<div title="uptime - выводит информацию о времени работы компьютера" modifier="Яковлев Иван" created="200906161439" modified="200906161439" tags="[[Информационные команды]]" changecount="2">
<pre>!Описание
Выдает текущее время, время работы компьютера с его включения, количество пользователей в системе и среднее количество заданий в очередях за последние 1, 5 и 15 минут. Если ФАЙЛ не указан, то используется /var/run/utmp. /var/log/wtmp используется, как ФАЙЛ в общем случае.

;{{{--help}}}
:выдает эту информацию и заканчивает работу 

;{{{--version}}}
:выдает информацию о версии и заканчивает работу

!Использование
{{{
uptime
}}}
выдасть на экран:
{{{
 17:38:59 up 1 day,  2:57,  3 users,  load average: 0.06, 0.07, 0.06
}}}

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=uptime&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=uptime&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="userdel - удаляет регистрационное имя пользователя из системы" modifier="Яковлев Иван" created="200906151659" modified="200906151659" tags="[[Команды для работы с группами и пользователями]] TODO" changecount="2">
<pre>!Описание
Команда ''userdel'' удаляет определение регистрационного имени пользователя из системы. Она удаляет определение указанного регистрационного имени и выполняет соответствующие изменения в регистрационных файлах и файловой системе. Команда также запоминает идентификационный номер удаляемого пользователя (UID) в файле {{{/etc/security/ia/ageduid}}}, так что этот идентификатор не будет повторно использован на протяжении определенного периода времени. Эта практика не использования идентификатора пользователя называется устареванием идентификатора (UID aging).

!Синтаксис
{{{
userdel [-r] [-n месяцев] рег_имя
}}}
Поддерживаются следующие опции:
;-r
:Удалить начальный каталог пользователя из системы. Этот каталог должен существовать. После успешного выполнения команды файлы и подкаталоги в начальном каталоге будут недоступны. Учтите, что начальный каталог пользователя может быть не удален, если размещение начального каталога администрируется сетевой информационной службой (Network Information Service - NIS) и NIS недоступна в момент удаления записи пользователя.

;-n месяцев
:Задает, сколько месяцев идентификатор пользователя должен устаревать перед повторным использованием. Задайте {{{-1}}}, чтобы указать, что идентификатор пользователя никогда не должен использоваться повторно. Задайте 0, чтобы указать, что идентификатор пользователя можно немедленно повторно использовать. Если опция -n не задана, идентификатор будет устаревать стандартное количество месяцев перед повторным использованием.

;рег_имя
:Строка печатных символов, задающая существующее в системе регистрационное имя. Она не может содержать двоеточие ({{{:}}}) или символ перевода строки ({{{\n}}}). Если регистрационное имя администрируется сетевой информационной службой (NIS), оно будет удалено только из локальной системы, но не из базы данных NIS.

!Замечания
При любом использовании команды ''userdel'' для удаления регистрационного имени пользователя, необходимо выполнить {{{adminuser -d рег_имя}}} во избежание создания брешей в защите; в противном случае при удалении регистрационных имен для пользователей, добавленных в базу данных системы доверительного управления (Trusted Facility Management - TFM), появятся нарушения защиты. Используйте средства рабочего стола для удаления пользователей, добавленных с помощью средств рабочего стола.

Не у всех пользователей имеются соответствующие привилегии, но у пользователей рабочего стола они обычно есть. Если пользователь, регистрационное имя которого было удалено, не имеет привилегий, а для него будет выполнена команда {{{adminuser -d}}}, будет просто выдано сообщение об ошибке ({{{UX:adminuser:ERROR:Undefined user рег_имя}}}).

!Файлы
{{{
    /etc/default/userdel
    /etc/group
    /etc/passwd
    /etc/security/ia/ageduid
    /etc/security/ia/audit
    /etc/security/ia/index
    /etc/security/ia/master
    /etc/shadow
}}}
Файл {{{/etc/security/ia/audit}}} не доступен, если не установлены утилиты аудита (Auditing Utilities).

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=userdel&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=userdel&amp;category=1]]


</pre>
</div>
<div title="usermod - изменение учётной записи пользователя" modifier="Яковлев Иван" created="200906031620" modified="200906031633" tags="[[Команды для работы с группами и пользователями]]" changecount="3">
<pre>!Описание
Команда usermod изменяет системные файлы учётных записей согласно переданным в командной строке параметрам.
Например, чтобы добавить пользователя в группу, надо выполнить следующую команду:
{{{
sudo usermod -a -G svn www-data
}}}
Здесь мы добавляем в группу ''svn'' пользователя ''www-data'' (под этим пользователем работает сервер Apache)
;{{{-a, --append}}}
:Добавить пользователя в дополнительную группу(ы). Использовать только вместе с параметром {{{-G}}}.
;{{{-G, --groupsГРУППА1[,ГРУППА2,...[,ГРУППАN]]] }}}
:A list of supplementary groups which the user is also a member of. Each group is separated from the next by a comma, with no intervening whitespace. The groups are subject to the same restrictions as the group given with the -goption. If the user is currently a member of a group which is not listed, the user will be removed from the group. This behaviour can be changed via the -a option, which appends the user to the current supplementary group list. 
{{note{
@@font-weight: bold;ЗАМЕЧЕНИЕ:@@
Команда {{{usermod}}} не будет изменять имя пользователя, если этот пользователь в данный момент работает в системе. Если требуется изменить числовой идентификатор пользователя, нужно проверить, что от этого пользователя нет запущенных процессов. Владельца файлов crontab нужно изменять вручную. Владельца заданий at нужно изменять вручную. Также вручную нужно сделать все изменения связанные с NIS на сервере NIS. 
}}}

!Файлы
;{{{/etc/group}}}
:содержит информацию о группах 
;{{{/etc/passwd}}}
:содержит информацию о пользователях 
;{{{/etc/shadow}}}
:содержит защищаемую информацию о пользователях 

!См. также
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/manpages/jaunty/en/man8/usermod.8.html]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=+usermod&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="wc - вывод числа строк, слов и байт в указанных файлах" modifier="Яковлев Иван" created="200906121432" tags="[[Команды обработки содержимого файла]] [[TODO - нужен перевод статьи]]" changecount="1">
<pre>!Описание
The wc command, short for word count, can return the number of lines, words, and characters in a file. The {{{wc}}} options are straightforward:
{{{wc -w filename
}}}
command returns the number of words in the filename file.
{{{
wc -l filename
}}}
command returns the number of lines in that file. 
{{{
wc -c filename
}}}
command returns the number of characters in that file.

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=wc&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=wc&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="wc - печатает число строк, слов и байт в файлах" modifier="Яковлев Иван" created="200906161443" tags="[[Информационные команды]] [[Команды для работы с файлами и каталогами]]" changecount="1">
<pre>!Описание
Печатает число переводов строк, слов и байт для каждого ФАЙЛА и итоговую строку, если было задано несколько ФАЙЛОВ. Если ФАЙЛ не задан или задан как -, читает стандартный ввод.
{{{
wc имя_файла.txt
}}}
;{{{-c, --bytes}}}
:печать числа байтов 

;{{{-m, --chars}}}
:печать числа символов 

;{{{-l, --lines}}}
:печать числа строк 

;{{{-L, --max-line-length}}}
:печать количества символов в самой длинной строке 

;{{{-w, --words}}}
:печать количества слов 

;{{{--help}}}
:вывести справку и закончить работу 

;{{{--version}}}
:вывести информацию о версии и закончить работу 

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=wc&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=wc&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="whatis - Показывает однострочную информацию о заданной команде" modifier="Яковлев Иван" created="200906161445" tags="[[Информационные команды]]" changecount="1">
<pre>!Описание
whatis показывает краткое описание команд, содержащих СЛОВО.
База даных whatis создается при использовании команды @makewhatis@.

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=whatis&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=whatis&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="who - кто сейчас залогинен в систему" modifier="Яковлев Иван" created="200906211542" modified="200906211549" tags="[[Информационные команды]]" changecount="2">
<pre>!Описание
Сообщает о всех зарегистрировавшихся в системе пользователях.

Если не указаны никакие опции, выводит листинг со следующей информацией о каждом пользователе вошедшем в настоящее время в систему: имя, терминал, время регистрации, имя дистанционного (удалённого) узла ({{{localhost}}} - для локально зарегистрировавшихся) или X-дисплей ({{{:0}}}).

Как правило, команда ''who'' получает свои входные данные из файла {{{/var/run/utmp}}}. Аргумент {{{ФАЙЛ}}} может задать другой файл с данными, например, {{{/var/log/wtmp}}} с информацией о завершенных сессиях или {{{/var/log/btmp}}} с информацией о неудачных попытках входа в систему (правда только в том случае, когда ваша система сконфигурирована для протоколирования этих событий). Под {{{АРГ1}}} {{{АРГ2}}} подразумевается использование `{{{am i}}}' или `{{{mom likes}}}' (см. опцию {{{-m}}})

!Синтаксис
{{{
who [ОПЦИИ]... [ ФАЙЛ | АРГ1 АРГ2 ]
}}}

!Пример
Команда
{{{
who
}}}
выдаст:
{{{
uran     tty7         2009-06-20 17:14 (:0)
uran     pts/0        2009-06-21 16:34 (192.168.221.1)
}}}
А команда
{{{
who am i
}}}
выдаст:
{{{
uran     pts/0        2009-06-21 16:34 (192.168.221.1)
}}}

!Опции
;{{{-a, --all}}}
:равносильно {{{-b -d --login -p -r -t -T -u}}} 

;{{{-b, --boot}}}
:время последней загрузки системы 

;{{{-d, --dead}}}
:выводит спящие процессы 

;{{{-H, --heading}}}
:выводит строку заголовка (шапку) для столбцов таблицы листинга 

;{{{-i, --idle}}}
:в листинге, после времени входа в систему, указывает количество ЧАСОВ:МИНУТ бездействия (простоя) пользователя в его терминале. Точка ({{{.}}}) в этом поле означает, что пользователь был активен в течение последней минуты, а слово old (старый) - бездействовал более суток (опция {{{-u}}}). 

;{{{-l, --login}}}
:выводит системные процессы, ожидающие регистрации пользователей (т.е. свободные терминалы) 

;{{{--lookup}}}
:пытается узаконить (канонизировать) имена узлов, найденные через DNS 

;{{{-m}}}
:выводит информацию о пользователе, связанном с текущим терминалом (о себе). Синоним команды ''whoami''. 

;{{{-p, --process}}}
:выводит активные процессы, порожденные программой init (см. информацию об ''init'') 

;{{{-q, --count}}}
:выводит только имена и количество зарегистрировавшихся пользователей 

;{{{-r, --runlevel}}}
:выводит информацию о текущем уровне выполнения (runlevel) для пользователя в системе 

;{{{-s, --short}}}
:выводит только имя, терминал, время регистрации, имя дистанционного (удалённого) узла (по умолчанию) 

;{{{-t, --time}}}
:если есть, то выводит информацию о последнем изменении времени в системе (см. информацию о команде ''hwclock'') 

;{{{-T, -w, --mesg}}}
:после каждого имени печатает символ, указывающий доступен ли для записи терминал пользователя или нет (см. информацию о командах ''mesg'' и ''write''): 
:{{{+}}} : разрешается писать сообщения 
:{{{-}}} : запрещается писать сообщения 
:{{{?}}} : не может обнаружить терминальное устройство (например, для X-дисплея) 

;{{{-u, --users}}}
то же, что и опция {{{-i}}} 

;{{{--message}}}
:то же, что и опция {{{-T}}} 

;{{{--writable}}}
:то же, что и опция {{{-T}}} 

;{{{--help}}}
:вывести справку о программе, её опциях и завершить работу 

;{{{--version}}}
:вывести информацию о версии программы и завершить работу

!Ссылки
*[[Описание на manpages.ubuntu.com|http://manpages.ubuntu.com/cgi-bin/search.py?cx=003883529982892832976%3A5zl6o8w6f0s&amp;cof=FORID%3A9&amp;ie=UTF-8&amp;q=who&amp;titles=Title&amp;lr=lang_en]]
*[[Описание на Opennet.ru|http://www.opennet.ru/man.shtml?topic=who&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]]


</pre>
</div>
<div title="Администрирование сервера" modifier="Яковлев Иван" created="200906041652" modified="200906202202" tags="MainMenu slider" changecount="14">
<pre>''Резервное копирование''
*[[Резервное копирование через rsync|Резервное копирование с помощью rsync]]
*[[Авто-backup через rsync+cron|Ежедневное автоматизированное резервное копирование средствами rsync]]
*[[tar и untar]]
*[[Бекап MySQL|Правильный бекап MySQL]]
''Сеть''
*[[Настройка OpenVPN|Настройка OpenVPN на Ubuntu Server]]
''Удаленное администрирование''
*[[Настройка eBox]]
''Безопасность''
*[[SSHD в среде chroot|Установка и настройка SSHD в среде chroot при помощи makejail]]
</pre>
</div>
<div title="Активация логических томов" modifier="Яковлев Иван" created="200906122145" tags="LVM [[TODO - нужен перевод статьи]]" changecount="1">
<pre>After you’ve created an LV, a couple more steps are required -- the volume must be formatted and mounted. These steps are similar to those associated with a new partition and a RAID array, as described earlier in this chapter. For the LV created in this section, {{{/dev/volgroup1/logvol1}}}, I’ve set up 1000MB of space for that volume. Now I’ll set up the LV for the {{{/home/book}}} directory.

To format the new LV to the default ext3 filesystem, I run the following command:
{{{
sudo mkfs.ext3 /dev/volgroup1/logvol1
}}}
Now I create the /home/book directory if it doesn’t already exist. To do so, I run the following command to mount the new LV on that directory:
{{{
sudo mount /dev/volgroup1/logvol1 /home/book
}}}
{{note{
''ЗАМЕЧАНИЕ:''
Remember that before expanding (or reducing the size of) an LV, you should make sure the data is backed up on the volume; then unmount it, and then expand (or reduce) the size of the LV. You can then remount the LV.
}}}

!См. далее
*[[Конфигурация логических томов в файле /etc/fstab]]


</pre>
</div>
<div title="Безопасность" modifier="Яковлев Иван" created="200906051319" modified="200906211410" tags="[[Установка/настройка сервера]] slider" changecount="12">
<pre>#[[Права доступа к сист. файлам|Рекомендуемые права доступа к важным системным файлам/каталогам]]
#[[AppArmor]]
#[[Файрвол UFW|Установка файрвола UFW]]
#[[Apache2 в среде chroot|Запуск web сервера apache2 в среде chroot в Debian и Ubuntu]]
#[[Особенности режима chmod 2770|Ньюансы безопасности web-хостинга и режим chmod 2770]]
#[[Защита от DoS-атак в nginx|Защита от DoS атак в nginx]]</pre>
</div>
<div title="Блокировка нежелательных URL с помощью iptables" modifier="Яковлев Иван" created="200906052348" modified="200906052348" tags="Статьи Безопасность iptables TODO" changecount="2">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/blokirovka-nezhelatelnyx-url-s-pomoshhyu-iptables.html#more-124]]



</pre>
</div>
<div title="Введение в Subversion" modifier="Яковлев Иван" created="200906202218" tags="[[Настройка Subversion (SVN)]] [[TODO - нужен перевод статьи]] TODO" changecount="1">
<pre>TODO

!Ссылки
*[[Оригинал статьи|http://articles.slicehost.com/2007/9/5/introduction-to-subversion]]


</pre>
</div>
<div title="Введение в виртуальные хосты" modifier="Яковлев Иван" created="200906200121" modified="200907021254" tags="[[Установка/настройка Web-сервера]] [[TODO - нужен перевод статьи]] TODO slicehost" changecount="5">
<pre>!Описание
The term Virtual Hosts is used a great deal when setting up your Slice. Let's take a look at what Virtual Hosts are and why they are important. It is also worth noting that the term Virtual Hosts is used with all web servers. Once you have the principle clear in your mind, it makes setting them up on any web server much easier.

!Процесс
Let's take a quick look at what happens when you type a web address into your browser. This is not a technical document so forgive the simplicity but the basics are quite simple:
*Your browser sends an HTTP request to your ISP.
*The request is routed, via your ISP and other servers, to where the IP address is located (i.e. your Slice).
*The Slice web server processes the HTTP request and returns the HTML representation of the request to your browser.
*Your browser interprets the HTML representation and parses the page for you.
*You click 'next' and the whole process is repeated.

!Один IP адрес
In this simple outline there is an important issue to note in that the web address you type into the browser is turned into an IP address. So, for example, {{{www.bbc.co.uk}}} is turned into 212.58.227.75 (try it, put both into your browser, they both display the same thing). We use names as humans are pretty bad at remembering numbers.

!У меня есть только один выделенный IP адрес
So if my Slice only has one IP address can I only host one domain? Nope. This is where virtual hosts come in... You can allocated many domains to one IP address. 

So lets say you have three domains: {{{domain1.com}}}, {{{domain2.com}}} and {{{domain3.com}}} and all of them have been configured to point to your Slice's IP address. Using exactly the same (simplified) routing shown above, when any of your 3 domains are entered into a browser, the requests end up at your Slice.

!Web сервер
Enter the Web Server. It doesn't really matter what Web Server we are talking about here, it could be Apache, Litespeed, Nginx, lighttpd or any of the dozens of Web Servers available. The point is that the request for 3 different domains has arrived at a single point: Your Slice and your Web Server.

!Виртуальные хосты
You see Web Servers are quite cool. They are able to look at those requests and say &quot;Hey, this guy wants an HTML representation of domain1.com and look, this guy wants one of domain2.com&quot;. The server knows which file to parse and what to send back to the browser because you defined different settings and file locations for each domain in your Virtual Hosts file.

Each web server differs slightly in how to set up the Virtual Hosts file but they all have the same base settings:
*''Virtual Host Name:'' The name of the domain being requested - e.g. domain3.com.
*''Domain Directory:'' The location of the files for the requested domain.

{{textAlignCenter{
[img[images/articles/layout3.jpg]]
}}}

!Это действительно так?
Pretty much.

Of course, there are loads of settings you can customise for each Virtual Host but the basics remain the same: Receive a request for a domain, located the requested domain's directory and, depending on what was requested, serve the requested files.

!А что если я введу IP адрес?
Ah. Now you've hit on the weak spot of name based Virtual Hosts: If all the domains have the same IP address, what happens when I enter the IP address?

There is usually a 'default' domain. You may not have expressly set it up that way, but if the IP address is entered it is 'usual' for the first domain (alphabetically) to be served.

As an example, in the Debian Etch Apache install, the default Virtual Host is named '000-default'. So if you have not expressly defined a Virtual Host for the IP address, then 000-default will be used.

It is worth saying that different web servers do act differently here. The main point is that, in this example, there is only one IP address so only one domain can be served.

However, it is relatively rare for people to browse around using IP addresses. Take this site, did you enter the IP address or the domain name?

!Заключение
As I said, this is not a technical document (in case you didn't notice!) but the intention was to introduce the principles of Virtual Hosts. I recommend reading the [[Настройка окружения для виртуальных хостов]] article next. It outlines the Virtual Host directory structure and file locations used throughout these articles.

!Ссылки
*[[Оригинал статьи на slicehost.com|http://articles.slicehost.com/2007/9/17/introduction-to-virtual-hosts]]


</pre>
</div>
<div title="Виртуальный FTP-сервер на основе  ProFTP" modifier="Яковлев Иван" created="200906191553" modified="200906191643" tags="[[Установка FTP сервера]] ProFTP" changecount="14">
<pre>Рассмотрим конфигурирование виртуального ~FTP-сервера на примере ~ProFTP. Демон proftpd позволяет обслуживать сразу несколько ~FTP-узлов. Виртуальные ~FTP-узлы нужны когда мы, например, хотим организовать несколько ~FTP-узлов -- один для одной рабочей группы, другой - для второй, в третий может быть анонимным и т.д. 

Настройка виртуального ~FTP-узла очень похожа на настройку виртуального Web-сервера -- даже используется та же директива {{{VirtualHost}}}. Linux может поддерживать несколько Ip-адресов, благодаря чему мы можем создать виртуальные узлы. Дополнительные ~IP-адреса, которыми вы располагаете можно использоваться виртуальными узлами. При конфигурировании виртуальных ~FTP-узлов каждому виртуальному узлу нужно присвоить отдельный ~IP-адрес.

Для конфигурирования виртуального FTP в файл proftpd.conf нужно добавить директиву {{{VirtualHost}}}, содержащую ~IP-адрес.
{{{
        &lt;VirtualHost 192.168.1.5&gt;
         ServerName &quot;Virtual FTP Server&quot;
        &lt;/VirtualHost&gt;
}}}
В блок ~VirtualHost можно другие вставить директивы, например, директиву Anonymous, которая создаст гостевой узел. Можно также задать каталог или порт.

!!Пример 1:
{{{
&lt;VirtualHost ftp.library.com&gt;
    ServerName         &quot;Online library&quot;
    MaxClients         15
    MaxLoginAttempts   1
    DeferWelcome       on

    &lt;Limit LOGIN&gt;
        Allow  from        192.168.1
        Deny   from        all
    &lt;/Limit&gt;

    &lt;Limit WRITE&gt;
        AllowUser libadmin
        DenyAll
    &lt;/Limit&gt;

    &lt;Anonymous  /var/ftp/library/books&gt;
        User                     library
        Group                    library
        AnonRequirePassword      on

    &lt;Anonymous /var/ftp/library&gt;
        User   ftp
        Group  ftp
        UserAlias anonymous ftp
    &lt;/Anonymous&gt;
&lt;/VirtualHost&gt;
}}}
В примере приведена конфигурация виртуального сервера {{{ftp.library.com}}}. В директиве {{{VirtualHost}}} используется доменное имя, которое должно быть прописано в сервере DNS. ~IP-адрес должен указывать на узел сети, на котором запущен демон proftpd. В конфигурации также конфигурируются две анонимных учетных записи - library и ftp. Причем учетная запись library требует ввода пароля при регистрации. Пароль должен совпадать с паролем того пользователя, который запустил демон. Доступ к виртуальному серверу разрешен только для нашей подсети (192.168.1.0). Записывать данные на сервер может только пользователь libadmin.

!Директивы конфигурации сервера ~ProFTP
;{{{AccessGrantMsg message}}}
:Ответное сообщение, которое будет отправлено пользователю в случае его регистрации или получения анонимного доступа. Символы {{{%u}}} будут заменены на имя пользователя, которое он ввел при регистрации.

;{{{Allow from all | host | network [,host | network[, ...]]}}}
:Используется внутри блока Limit. Ограничивает доступ к серверу (а именно разрешает доступ). По умолчанию {{{allow from all}}}

;{{{AllowAll}}}
:Разрашает доступ к блокам {{{Directory}}}, {{{Anonymous}}}, {{{Limit}}}

;{{{AllowForeignAddress on | off}}}
:Разрешает клиенту указывать при соединении соединения адрес, который не соответствует ему. По умолчанию off. Может использоваться в блоках {{{VirtualHost}}}, {{{Anonymous}}}, {{{&lt;Global&gt;}}}

;{{{AllowGroup group_list}}}
:Разрешает доступ определенным группам. Используется в блоке Limit

;{{{AllowUser user_list}}}
:Разрешает доступ определенным группам. Используется в блоке Limit

;{{{AnonRequirePassword on | off}}}
:Требует пароль при анонимной регистрации. Пароль должен совпадать с паролем того пользователя, который запустил демон. По умолчанию опция выключена.

;{{{&lt;Anonymous directory&gt;}}}
:Создает анонимную учетную запись, directory - корневой каталог анонимного сервера.

;{{{AuthGroupFile path}}}
:Позволяет указать путь к альтернативному файлу group. По умолчанию используется файл {{{/etc/group}}}

;{{{AuthUserFile path}}}
:Указывает альтернативный файл passwd

;{{{Bind address}}}
:Разрешает привязку дополнительного ~IP-адреса к основному или виртуальному хосту.

;{{{DefaultRoot directory}}}
:Задает корневой каталог по умолчанию

;{{{Deny from all | host | network}}}
:Запрещает доступ к серверу. Блок {{{Limit}}}

;{{{DenyAll}}}
:Запрещает анонимным пользователям доступ к объектам, указанным в блоке {{{Limit}}}

;{{{DenyUser user_list}}}
:Запрещает доступ определенным пользователям

;{{{&lt;Directory&gt; path}}}
:Используется в {{{VirtualHost}}}, {{{Anonymous}}} для того, чтобы определить особенные параметры доступа к каталогу и его подкаталогам

;{{{DisplayFirstChdir filename}}}
:Текстовый файл filename будет выводиться, когда пользователь впервые за время сеанса войдет в данный каталог. Используется в {{{VirtualHost, Directory, Anonymous}}}

;{{{DisplayLogin filename}}}
:Этот файл будет отображен, когда пользователь зарегистрируется

;{{{&lt;Global&gt;}}}
:Используется для задания параметров, которые будут использоваться как основным, так и всеми виртуальными серверами

;{{{&lt;Limit command&gt;}}}
:Ограничение на выполнение данной ~FTP-команды, например LOGIN, WRITE

;{{{MaxClients number | none | message}}}
:Ограничение на количество клиентов. Message будет отображено, если пользователю будет отказано в доступе. Блоки {{{Anonymous}}}, {{{Global}}}

;{{{MaxLoginAttempts}}}
:Максимальное количество попыток зарегистрироваться. По умолчанию 3. Блоки {{{VirtualHost}}}, {{{Global}}}

;{{{Order allow, deny | deny, allow}}}
:Порядок выполнения директив {{{Allow}}} и {{{Deny}}} в блоке {{{Limit}}}

;{{{PersistentPassword on | off}}}
:При значении on будут использованы системные файлы {{{/etc/passwd}}} и {{{/etc/group}}}, несмотря на то, что командой chroot корневой каталог был изменен.

;{{{RequireValidShell on | off}}}
:Разрешает или запрещает регистрацию при использовании оболочек (shells), которые не указаны в файле {{{/etc/shells}}}

;{{{ServerAdmin email}}}
:Определяет email администратора сервера.

;{{{ServerType}}}
:Определяет режим работы сервера standalone (по умолчанию) или inetd. В первом случае сервер будет запускаться автоматически из стартовых сценариев системы, во втором - его будет запускать сервер inetd при попытке соединения.

;{{{TimeoutIdle seconds}}}
:Время в секундах, в течение которого пользователь имеет право не проявить активности. По умолчанию 60 (1 минута).

;{{{User username}}}
:Имя пользователя, присвоенное демону ~ProFTP

;{{{UserAlias Alias User}}}
:Создает псевдоним (alias) для пользователя (user)

;{{{&lt;VirtualHost address&gt;}}}
:Создает виртуальный сервер

!Ссылки
*[[Оригинал статьи|http://www.opennet.ru/base/net/virtual_ftp_http.txt.html]]


</pre>
</div>
<div title="Выделенный VPS сервер" modifier="Яковлев Иван" created="200906192150" modified="200907021307" tags="MainMenu slider" changecount="6">
<pre>#[[Настройка VPS сервера|Настройка своего выделенного VPS сервера на основе Ubuntu Hardy LTS]]
#[[Несколько доменов на одном  VPS|Создание и обслуживание нескольки доменов на одном выделенном сервере VPS]]
#[[Xостинга на VPS|Организация хостинга на VPS]]
#[[Хостинг на VPS от linod.com|http://www.linode.com/wiki/index.php/Main_Page]]</pre>
</div>
<div title="Горячие клавиши MC" modifier="Яковлев Иван" created="200906211742" modified="200906211810" tags="MidnightCommander" changecount="11">
<pre>|!Сочетание|!Значение|
|''F3''|Просмотр файла. |
|''F4''|Редактирование файла. |
|''Insert''|Выделение текущего объекта. |
|''+''|вызывает окно для выделения группы файлов (можно использовать регулярные выражения) |
|''\''|снимает отметку с группы файлов (действие, обратное тому, которое вызывается по клавише {{{+}}}) |
|''Alt+Enter Esc+Enter''|Вставить 'текущий объект'^^{{{1}}}^^ в командную строку. |
|''Alt+.''|не показывать или показать скрытые файлы или каталоги (начинаются на точку '{{{.}}}'). |
|''Alt+,''|Переключить режим отображения панелей (вертикально/горизонтально). |
|''Alt+a Esc,a Ctrl+x,p''|Посылает в командную строку полный путь в текущей активной панели. |
|''Alt+c Esc+c''|Вызывается меню быстрой смены текущего каталога на активной панели. |
|''Alt+g''|отмечает первый файл или каталог в отображаемом списке на панели |
|''Alt+h Esc+h''|Вызов меню последних выполненных команд. |
|''Alt+i Esc+i''|Смена текущего каталога на неактивной панели, на каталог в котором вы находитесь в активной панели. |
|''Alt+j''|отмечает последний файл или каталог в отображаемом списке на панели |
|''Alt+n Esc+n''|Вернуть последующую выполненную командную строку. |
|''Alt+o''|неактивная панель переходит в каталог на который указывает активная панель. |
|''Alt+p Esc+p''|Вернуть предыдущую выполненную командную строку. |
|''Alt+r''|отмечает средний файл или каталог в отображаемом списке на панели |
|''Alt+t Esc+t''|Смена режима работы панели ('Стандартный','Укороченный','Расширенный') |
|''Alt+Shift+? Esc,Shift+?''|Вызывается меню расширенного поиска файлов. |
|''Alt+Shift+A Esc,Shift+A Ctrl+x,Ctrl+p''|Посылает в командную строку полный путь в неактивной панели. |
|''Alt+Shift+H''|Отобразить историю каталогов. |
|''Ctrl+\''|Вызывается меню часто используемых каталогов. |
|''Ctrl+&quot;&quot;&quot;l&quot;&quot;&quot;''|Перерисовать экран. |
|''Ctrl+o''|Скрытие/показ панелей. |
|''Ctrl+r''|перечитать содержимое каталога. |
|''Ctrl+s''|Быстрый поиск файла или каталога. |
|''Ctrl+Space''|Показать размер текущего каталога. |
|''Ctrl+x,a''|Отображается список активных соединений виртуальных файловых систем. |
|''Ctrl+x,c''|Просмотр/правка прав доступа текущего объекта. |
|''Ctrl+x,i''|Быстрый просмотр информации о текущем объекте на второй панели. |
|''Ctrl+x,j''|Показ фоновых задач. |
|''Ctrl+x,l''|Создать жесткую ссылку с текущего объекта. |
|''Ctrl+x,o''|Просмотр/правка владельца/группы для текущего объекта. |
|''Ctrl+x,q''|Быстрый просмотр содержимого файла на второй панели. |
|''Ctrl+x,s''|Создает символьную ссылку symlink для текущего объекта. |
|''Ctrl+x,t''|Вставка всех выделенных объектов в командную строку. |
|''Ctrl+x, Ctrl+s''|Редактировать symlink. |
|''Shift+F1''|Вызывается меню быстрого перехода между точками монтирования на левой панели. |
|''Shift+F2''|Вызывается меню быстрого перехода между точками монтирования на правой панели. |
|''Shift+F3''|Просмотр файла raw без учета расширения. |
|''Shift+F4''|Создает новый файл.|
{{note{
^^{{{1}}}^^ Текущий объект -- файл или каталог на котором установленн курсор.

''Ctrl+x, Ctrl+s'' -- означает, что сначала нажимаем ''Ctrl+x'', затем отпускаем и нажимаем  ''Ctrl+s''
}}}

!Ссылки
*[[Эта сатья в формате PDF|data/Linux - MC/HotKey Midnight Commander (PDF).pdf]]
*[[Более детальный список горячих клавиш для файловой панели|http://www.midnight-commander.org/wiki/ru/doc/filePanels/hotkeys]]
*[[Список горячих клавиш для редактора|http://www.midnight-commander.org/wiki/ru/doc/editor/hotkeys]]
*[[Список горячих клавиш для просмотрщика|http://www.midnight-commander.org/wiki/ru/doc/viewer/hotkeys]]


</pre>
</div>
<div title="Горячие клавиши bash" modifier="Яковлев Иван" created="200906121313" modified="200906121643" tags="[[Командная оболочка bash]]" changecount="8">
<pre>''{{{стрелки Вверх/Вниз}}}'' или ''{{{Ctr+P, Ctr+N}}}'' -- переход по истории недавно набранных команд
''{{{TAB}}}'' -- автозавершение команды или вывод списка подходящих команд или путей к файлам
{{note{
Применим и при установке пакетов: {{{apt-get install незавершенное_имя_пакета&lt;TAB&gt;}}}
}}}
''{{{Ctr+A}}}'' -- переход в начало строки
''{{{Ctr+E/End}}}'' -- переход в конец строки
''{{{Ctrl+W/Alt+Backspace}}}'' – удалить одно слово в текущей строке перед курсором
''{{{Ctrl+U}}}'' – удалить все символы перед курсором
''{{{Ctr+K}}}'' -- удалить все символы за курсором
''{{{Ctr+Y}}}'' -- отменить последнюю операцию редактирования
''{{{Ctr+L}}}'' -- очистить экран ( поднимает текущее местоположение курсора в самый верх экрана)
''{{{Ctrl+C}}}'' – завершить текущую команду
''{{{Ctrl+Z}}}'' – остановить текущую команду, продолжть с fg на переднем плане или bg в фоне
''{{{Ctr+R}}}'' -- поиск по истории команд
''{{{Ctrl+D}}}'' – разлогиниться, тоже самое, что и exit
''{{{Ctr+T}}}'' -- меняет местами сиволы за и перед курсором
''{{{q}}}'' -- выйти из текущего процееса (например из режима чтения мануала)
''{{{exit}}}'' – разлогиниться


</pre>
</div>
<div title="Дополнительные материалы" modifier="Яковлев Иван" created="200906191927" modified="200906200040" tags="MainMenu slider" changecount="7">
<pre>''Статьи''
*[[Хостинг на VPS|Организация хостинга на VPS]]
*&lt;&lt;slider &quot;chk-lvm&quot; [[LVM]] &quot;Логические тома (LVM)&quot; &quot;Показать/Скрыть раздел Логические тома (LVM)&quot;&gt;&gt;
*[[GNOME 2.6.0 в FreeBSD|http://www.opennet.ru/base/X/gnome26_install.txt.html]]
''Народные советы''
*&lt;&lt;slider &quot;chk-tips&quot; [[Народные советы]] &quot;Народные советы&quot; &quot;Показать/Скрыть раздел Народные советы&quot;&gt;&gt;
''Ссылки''
*&lt;&lt;slider &quot;chk-links&quot; [[Ссылки]] &quot;Ссылки&quot; &quot;Показать/Скрыть раздел Ссылки&quot;&gt;&gt;
''Приложения''
*[[Категории команд Unix]]
*[[Клавиатурные сокращения]]
*[[Ходовые файлы и директории|Список часто используемых файлов и директорий]]
*[[Система (RCS)|Использование системы контроля ревизий (RCS)]]
*[[Работать в MC|Как надо правильно работать в Midnight Commander]]
*[[Сетевые префиксы|Сетевые префиксы (NetPreffix)]]

</pre>
</div>
<div title="Ежедневное автоматизированное резервное копирование средствами rsync" modifier="Яковлев Иван" created="200906202153" tags="[[Администрирование сервера]] [[TODO - нужен перевод статьи]] TODO" changecount="1">
<pre>!Описание
TODO

!Ссылки
*[[Оригинал статьи|http://articles.slicehost.com/2007/10/11/automating-a-daily-rsync-backup]]



</pre>
</div>
<div title="Зависимости" modifier="Яковлев Иван" created="200906032340" modified="200906040900" tags="[[Установка ПО в Ubuntu]]" changecount="3">
<pre>Разные разработчики разрабатывают разные программы и библиотеки. Определенная программа может зависеть от десятка библиотек, которые разработали разные люди. Следить за всем этим вручную - неблагодарное занятие. Можете попробовать вручную скомпилировать программу, у которой много зависимостей, и вы поймете о чем я говорю.

К счастью для нас, проблема эта решена. Каждый раз когда вы ставите какое-либо ПО из репозитория или вручную при помощи пакета-установщика, программа-установщик разбирает эти зависимости и устанавливает их вместе с нужным вам приложением. Но иногда бывает и такая ситуация, когда репозитории не подключены (например если нету интернета) и единственный способ поставить программу - скачать ее предварительно где-нибудь и потом ставить вручную. В этом случае вам придется поставить зависимости вручную. 
В любом случае при установке вы будете предупреждены, если нужная зависимость не установлена и не может быть найдена в репозиториях, так что теперь вы знаете в чем дело.

И напоследок о зависимостях: допустим, вам надо скачать какую-то программу. Она тянет за собой 5 зависимостей. Каждый из них тянет за собой по 5 зависимостей еще. В итоге может получиться так, что сама программа занимает 1 мегабайт, а скачать надо 50. Так что потом не удивляйтесь.

!См. далее
*[[.deb = setup.exe]]


</pre>
</div>
<div title="Заключение" modifier="Яковлев Иван" created="200906032340" modified="200906040939" tags="[[Установка ПО в Ubuntu]]" changecount="2">
<pre>Программное обеспечение можно устанавливать из репозиториев или вручную. Программа может зависеть от других программ или библиотек. Это называется зависимостями. Зависимости должны быть установлены до того, как будет установлена сама программа. 
Чтобы установить программу из репозитория, используйте Synaptic или команду {{{apt-get}}}.

Консольный вариант очень хорош для использования в скриптах или если надо установить сразу много пакетов. Чтобы установить пакет, который вы предварительно скачали, вручную - просто дважды на нем кликните или используйте команду dpkg. Иногда можно поломать пакеты, чтобы исправить это используйте Synaptic или команду {{{sudo apt-get -f install}}}. 

Пакеты .rpm можно конвертировать в .deb, хотя это и не рекомендуется. Используйте программу alien чтобы сделать это. Иногда не знаешь, что нужно поставить, а просто хочется поэкспериментировать. Для этих целей лучше всего подходит программа, которую можно вызвать через меню: Приложения- Установка/удаление приложений.

Все операции по установке-удалению должны быть произведены от имени суперпользователя.

!Оригинал статьи
*http://ubuntologia.ru/software-installation


</pre>
</div>
<div title="Запуск web сервера apache2 в среде chroot в Debian и Ubuntu" modifier="Яковлев Иван" created="200906052323" modified="200906181737" tags="[[Настройка Apache]] Безопасность Статьи TODO" changecount="7">
<pre>!Описание
Для начала давайте разберемся что такое chroot и для чего оно нам надо. Обратимся в wikipedia для разъяснения.
&lt;&lt;&lt;
chroot в ~Unix-подобных операционных системах -- это операция изменения корневого каталога. Программа, запущенная с изменённым корневым каталогом, будет иметь доступ только к файлам, содержащимся в данном каталоге. Поэтому, если нужно обеспечить программе доступ к другим каталогам или файловым системам (например, {{{/proc}}}), нужно заранее примонтировать в целевом каталоге необходимые каталоги или устройства.

Изменение корневого каталога производится при помощи системного вызова chroot(2). Изменение корневого каталога затрагивает только текущий процесс (то есть процесс, сделавший системный вызов chroot(2)) и всех его потомков. Если требуется запустить некоторую программу с изменённым корневым каталогом, но в данной программе не предусмотрено выполнение вызова chroot(2), используют программу chroot(8). Эта программа принимает в качестве параметров новый корневой каталог и путь к программе. Она сначала сама выполняет вызов chroot(2) для изменения собственного корневого каталога на указанный, а затем запускает программу по заданному пути. Так как изменённый корневой каталог наследуется потомками процессов, программа запускается с изменённым корневым каталогом.

Сам по себе термин chroot может относиться или к концепции изменений корневого каталога, или к системному вызову chroot(2), или к программе chroot(8), что обычно понятно из контекста.

Программа, корень которой был перенесён в другой каталог, не может обращаться к файлам вне этого каталога. Это обеспечивает удобный способ помещения в «sandbox» («песочницу») тестовой, ненадёжной или любой другой потенциально опасной программы. Это также простой способ механизма «jail» («тюрьмы»). Но наиболее часто chroot используется для сборки дистрибутивов или отдельных программ как бы в «чистой» среде.
&lt;&lt;&lt;

Теперь можно начинать настройку нашего вебсервера, помещение его в среду chroot мы будем делать при помощи mod_chroot.

Установим и включим mod_chroot выполнив пару команд
{{{
sudo apt-get update
sudo apt-get install libapache2-mod-chroot
a2enmod mod_chroot
/etc/init.d/apache2 force-reload
}}}
Теперь настроим наш веб сервер, для chroot будет использоваться директория {{{/var/www}}}. По умолчанию файл процесса apache хранится в {{{/var/run/apache2.pid}}}, но после помещения apache в chroot он будет перемещен в {{{/var/www/var/run/apache2.pid}}}, необходимо создать эту директорию
{{{
mkdir -p /var/www/var/run
chown -R root:root /var/www/var/run
}}}
;{{{-p, --parents}}}
:Создает недостающие родительские каталоги для каждого указанного каталога. Права доступа к родительским каталогам устанавливаются в значение umask, логически сложенное с `u+wx'. Аргументы, соответствующие существующим каталогам, игнорируются. (Таким образом, если каталог {{{/a}}} существует, то `{{{mkdir /a}}}' выдаст ошибку, а `{{{mkdir -p /a}}}' -- нет.)

Затем надо указать в конфиге apache что мы хотим использовать директорию {{{/var/www}}} как среду chroot, для этого отредактируем файл {{{/etc/apache2/apache2.conf}}}, найдите там строку в которой указан путь для хранения файла ''pid'' и добавьте ниже строку, так как показано ниже.
{{{
[...]
#
# PidFile: The file in which the server should record its process
# identification number when it starts.
#
PidFile /var/run/apache2.pid
ChrootDir /var/www
[...]
}}}
Далее надо заменить в конфигурационных файлах виртуальных хостов пути ~DocumentRoot, так как например путь {{{/var/www/}}} теперь будет для apache директорией {{/}}}, но есть второй способ, который позволит не изменять конфигурацию, а просто создать символические ссылки на нужные директории. Например нам надо оставить в качестве ~DocumentRoot директорию {{{/var/www}}}, ниже приведен пример правильного создания символических ссылок.
{{{
mkdir -p /var/www/var
cd /var/www/var
ln -s ../../ www
}}}
Теперь остановите apache и создайте символическую ссылку на ''pid'' файл, затем снова запустите apache
{{{
/etc/init.d/apache2 stop
ln -s /var/www/var/run/apache2.pid /var/run/apache2.pid
/etc/init.d/apache2 start
}}}
Теперь ваш веб сервер работает в chroot среде, и должен без проблем показывать html и php страницы, но у вас могут возникнуть проблемы с ипользовванием CGI или ~SUphp, для этого надо скопировать в chroot среду файлы интерпритаторов ({{{/usr/bin/perl}}}, {{{/usr/sbin/suphp}}}) и необходимые для их работы библиотеки. Узнать какие файлы нужны для работы например suphp можно командой ldd
{{{
server2:/var/www/web1/log# ldd /usr/sbin/suphp
linux-gate.so.1 =&gt; (0xffffe000)
libstdc++.so.6 =&gt; /usr/lib/libstdc++.so.6 (0xb7e34000)
libm.so.6 =&gt; /lib/tls/i686/cmov/libm.so.6 (0xb7e0f000)
libgcc_s.so.1 =&gt; /lib/libgcc_s.so.1 (0xb7e03000)
libc.so.6 =&gt; /lib/tls/i686/cmov/libc.so.6 (0xb7cd2000)
/lib/ld-linux.so.2 (0xb7f23000)
}}}
Скопируйте все неоходимое в среду chroot, проблемы должны исчезнуть.
Для более подробной инфрмации и решения некоторых проблем рекомендуется посетить ресурс http://core.segfault.pl

!Ссылки
*[[Оригинал статьи {русс.)|http://sudouser.com/zapusk-web-servera-apache2-v-srede-chroot-v-debian-i-ubuntu.html]]
*[[Оригинал статьи (англ.)|http://www.howtoforge.com]]



</pre>
</div>
<div title="Запуск виртуальных хостов Apache2 от разных пользователей" modifier="Яковлев Иван" created="200906052319" modified="200906052319" tags="[[Установка/настройка Web-сервера]] Безопасность Статьи TODO" changecount="2">
<pre>!Описание
Допустим у вас есть 3 пользователя, и они имеют сайты на вашем сервере, но при стандартном веб сервере apache2 все они имеют привелегии пользователя ''www-data'' от которого запущен веб сервер. Допустим, пользователь user1 при помощи простого php скрипта может просмотреть файлы в директории пользователя user2, так же получить доступ к файлам конфигурации сайта и в итоге к паролям от баз данных. Есть несколько способов решения этой пролемы, такие как chroot или jail, или запуск виртуальных хостов от имени разных системных пользователей. Для этого нам потребуетс установить немного модифицированный apache, для операционных систем Debian и Ubuntu он уже включен в официальные репозитории, насчет остальных не знаю, подробнее вы сможете узнать на сайте разработчика по адресу {{{http://mpm-itk.sesse.net}}} В настройке нет ничего трудного и заумет это всего несколько минут.

TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/zapusk-virtualnyx-xostov-apache2-ot-raznyx-polzovatelej.html#more-179]]



</pre>
</div>
<div title="Запуск/Остановка сервисов в Ubuntu" modifier="Яковлев Иван" created="200906041244" modified="201001191916" tags="Важное Сервисы" changecount="4">
<pre>В Ubuntu стартовать/перезапускать/останавливать сервисы возможно по умолчанию посредством скриптов в каталоге {{{/etc/init.d/}}}. То есть к примеру чтобы остановить сервис ''Samba'' нужно ввести следующую команду: 
{{{
sudo /etc/init.d/samba stop
}}}

Итак, основные аргументы для скриптов запустка в {{{/etc/init.d}}} это: 
*{{{stop}}} - остановить сервис 
*{{{start}}} - стартовать сервис 
*{{{restart}}} - рестартовать сервис 
*{{{reload}}} - &quot;мягкий рестарт&quot; (перечитывание конфигов программой) 
*{{{status}}} - узнать в каком состоянии в данный момент находиться тот или иной сервис (запущен или нет) 

sysvconfig - пакет позволяющий проделывать все те же операции не прописывая пути до {{{/etc/init.d}}}, нужно всего лишь ввести к примеру: {{{sudo service samba restart}}} Такой вид управления сервисами по умолчанию принят в Fedora, ~RedHat Linux. 

Для того чтобы установить sysvconfig: 
{{{
sudo apt-get install sysvconfig 
}}}
Так же есть мелочь сильно облегчающая жизнь новичкам (и не только) - графическая оболочка, в которой можно конфигурить сервисы запускаемые при старте самого Linux. Для вызова этой оболочки достаточно вписать:
{{{
sudo sysvconfig
}}}

!Оригинал статьи
*http://www.openkazan.info/sysvconfig


</pre>
</div>
<div title="Запуск/Остановка сервисов в Windows" modifier="Яковлев Иван" created="200906091648" modified="200906091734" tags="Важное Сервисы" changecount="2">
<pre>!Описание
Чтобы запустить сервис Windows необходимо ввести в командной строке:
{{{
net start имя_сервиса
}}}

Чтобы остановить сервис Windows необходимо ввести в командной строке:
{{{
net stop имя_сервиса
}}}



!См. также
*[[Запуск/Остановка сервисов в Ubuntu]]


</pre>
</div>
<div title="Защита от DoS атак в nginx" modifier="Яковлев Иван" created="200906191652" modified="200906200045" tags="Безопасность MainMenu [[Настройка Nginx]]" changecount="4">
<pre>в sysctl
{{{
    kern.maxfiles=90000
    kern.maxfilesperproc=80000
    net.inet.tcp.blackhole=2
    net.inet.udp.blackhole=1
    kern.polling.burst_max=1000
    kern.polling.each_burst=50
    net.inet.tcp.msl=10000
    kern.ipc.somaxconn=32768
}}}    
в nginx  моменты
{{{
        worker_processes  1;
        worker_rlimit_nofile 80000;
        events {
           worker_connections  50000;
        }

        server_tokens off;
        log_format IP '$remote_addr';
        reset_timedout_connection on;

        listen      xx.xx.xx.xx:80 default rcvbuf=8192 sndbuf=16384
        backlog=32000 accept_filter=httpready;
}}}
фильтрацию url например по критерию POST {{{index.php?action=login}}} с пустым реферером можно реализовать так
{{{
       set $add 1;
       location /index.php {
           limit_except  GET POST {
               deny   all;
           }
           set $ban &quot;&quot;;
           if ($http_referer = &quot;&quot; )            {set $ban  $ban$add;}
           if ($request_method = POST )        {set $ban  $ban$add;}
           if ($query_string = &quot;action=login&quot; ){set $ban  $ban$add;}
           if ($ban = 111 ) {
               access_log /var/log/nginx/ban IP;
               return 404;
           }
         proxy_pass http://127.0.0.1:8000;#тут живёт апач
      }
}}}
ну и по крону уже раз в минуту добавлять в ipfw table новые ИП из лога

25Мбитный ~DDoS, преимущесвенно режущийся ipfw, остатки проходят на nginx, который по критерию обучает ipfw и остатки проксирует на апач - LA 0, сайт работает.

Чуть более мощный сервер на гигабитном Realtek re и 100Мбит порту  с поллингом загибался от pps где-то до 20Мбит

Будьте готовы, что при атаке в системе закончатся сокеты для соединия nginx - backend. Так что я  бы добавил
{{{
        sysctl net.inet.tcp.msl=3000 - уменьшаем время TIMEWAIT
        sysctl net.inet.tcp.maxtcptw=40960 - ограничиваем количество TIMEWAIT сокетов
        sysctl net.inet.tcp.nolocaltimewait=1 - отключаем TIMEWAIT для локальных сокетов.
        sysctl net.inet.ip.portrange.first=1024
        sysctl net.inet.ip.portrange.last=65535
        sysctl net.inet.ip.portrange.randomized=0
}}}
Дальше резали на  уровне pf - загружали в таблицу IP с которых приходило  слишком много хитов. PF с таблицами работает очень быстро.  Исходники парсера логов есть на http://www.comsys.com.ua/files

!Ссылки
*[[Оригинал статьи|http://www.opennet.ru/base/net/ddos_nginx.txt.html]]


</pre>
</div>
<div title="Защищаем MySql. Шаг за шагом" modifier="Яковлев Иван" created="200906231549" modified="200906231549" tags="[[Настройка MySQL]] TODO" changecount="2">
<pre>!Описание
TODO

!Ссылки
*[[Описание на Opennet.ru|http://www.opennet.ru/base/sec/mysql_sec.txt.html]]


</pre>
</div>
<div title="Знакомство с svnserve" modifier="Яковлев Иван" created="200906202219" modified="200906202220" tags="[[Настройка Subversion (SVN)]] [[TODO - нужен перевод статьи]] TODO" changecount="3">
<pre>!Описание
TODO

!Ссылки
*[[Оригинал статьи|http://articles.slicehost.com/2007/9/5/introduction-to-svnserve]]


</pre>
</div>
<div title="Информационные команды" modifier="Яковлев Иван" created="200906022231" modified="200907010007" tags="[[Команды Unix]] slider" changecount="35">
<pre>*[[date|date - выводит или устанавливает системные дату и время]]
*[[df|df - информация об использовании дискового пространства]]
*[[free|free - информация о доступной и занятой оперативной памяти системы]]
*[[fuser|fuser - идентифицирует процессы, которые используют указанные файлы или сокеты]]
*[[hostname|hostname - выдает или устанавливает имя компьютера]]
*[[id|id - выводит информацию о имени указанного пользователя и его группы]]
*[[jobs|jobs - вывод списка программ работающих в фоновом режиме]]
*[[lsb_release|lsb_release - информация о релизе]]
*[[last, lastb|last, lastb - выводит список пользователей, зарегистрировавшихся в системе последними]]
*[[ldd|ldd - выдаёт список зависимостей от динамических библиотек]]
*[[ls|ls - список файлов в текущей директории]]
*[[lsmod|lsmod - вывод списка загруженных модулей ядра]]
*[[modinfo|modinfo - вывод информации об указанном модуле ядра]]
*[[printenv|printenv - вывод всех переменных окружения для текущего пользователя]]
*[[ps|ps - показ текущих процессов]]
*[[pwd|pwd - показать путь к текущей директории]]
*[[runlevel|runlevel - текущий уровень безопасности, на котором работает система]]
*[[top|top - информация об исполняемых процессах и ресурсах системы]]
*[[uname|uname - информация о системе]]
*[[uptime|uptime - выводит информацию о времени работы компьютера]]
*[[dmesg|dmesg - выводит сообщения ядра при начальной загрузке Linux или настраивает их буфер]]
*[[wc|wc - печатает число строк, слов и байт в файлах]]
*[[whatis|whatis - Показывает однострочную информацию о заданной команде]]
*[[who - кто сейчас залогинен|who - кто сейчас залогинен в систему]]
*[[whoami - кто я]]</pre>
</div>
<div title="Использование Nginx Как Reverse-Proxy Сервера На Загруженных Сайтах" modifier="Яковлев Иван" created="200906191309" modified="200907021236" tags="[[Nginx + Apache]]" changecount="10">
<pre>!Описание
Две недели назад мы запустили новую версию одного из наших оcновных веб-проектов и начали массивную рекламную поддержку этого сайта. В результате рекламы, исходящий трафик только с одного сервера достиг 200-250Mbit/s! В данной статье я опишу, как построить стабильный и эффективный веб-сайт с двухуровневой архитектурой обработки запросов (с двумя веб-серверами: frontend и backend) или как модифицировать ваш текущий сервер, чтобы получить дополнительные ресурсы для обработки большего количества запросов.

Для начала, опишу типичный процесс обслуживания запроса к веб-серверу и структуру самого сервера:
#Клиент инициирует запрос к серверу.
#Его браузер устанавливает соединение с сервером.
#Ваш сервер (например, Apache) создает новый поток/процесс для обработки запроса. 
#Если клиент запросил динамический контент (например, отправил запрос к php-скрипту), веб-сервер создает отдельный ~CGI-процесс или запускает модуль обработки скриптов (например, mod_php) и ждет, пока запрос будет обработан. Как только он получает результирующую web-страницу, то она отправляется клиенту. 
#Если же клиент запросил статический файл, то сервер просто отправляет этот файл клиенту. 
#Браузер клиента получает ответ, закрывает соединение с сервером и отображает “ответ”.

Как видите, если к серверу приходит очень много запросов, он должен создавать много параллельных потоков/процессов и держать их в памяти, пока клиент не закроет соединение. Если соединение у клиента не быстрое, то серверные процессы будут висеть в памяти достаточно долго и используемые ими ресурсы будут увеличиваться очень быстро.

!Настройка
Как же решить данную проблему? Простым решением может быть бесконечное увеличение объемов оперативной памяти на сервере и покупка дополнительных или более мощных процессоров в ожидании момента, когда сервер умрет под нагрузкой… Но существует более эффективное решение! Вы можете просто поместить небольшую программку (nginx, например) перед Вашим большим веб-сервером и дать ей возможность обслуживать запросы к статическим файлам, а запросы к динамике проксировать к главному серверу. При таком решении Ваш большой сервер не будет создавать дополнительных процессов для обработки статических страниц и файлов и будет отдавать результаты обработки динамических запросов маленькому frontend-серверу очень быстро, что позволит ему освободить ресурсы для использования в обработке других запросов. Маленький frontend же может ждать сколь угодно долго, пока клиент заберет свой “ответ” и закроет соединение, а backend не будет тратить ресурсы для этого!

Вот примерная диаграма предложенной конфигурации веб-сервера:

{{textAlignCenter{
[img[images/articles/general_c.png]]
}}}
В дополнение к описанному, Вы получите еще очень удобную возможность так называемых контролируемых закачек, которая будет описана ниже.

Если Ваш сервер содержит какие-то статические ресурсы, которые можно скачивать только определенной части аудитории сайта (контент-провайдеры могут предоставлять возможность скачивания mp3-файлов только пользователям с положительным балансом; некоторые сайты дают скачивать файлы только зарегистрированным пользователям и т.п.), в типичном случае вам необходимо создать некий скрипт для обработки запросов на скачивание и создать набор жутких ссылок вида {{{http://some.service.com/down.php?file=xxx.mp3…}}} В дополнение к этому Ваши пользователи не будут иметь возможность докачки (исключая те случаи, когда Ваш скрипт настолько сложен, что понимает заголовок Ranges в ~HTTP-запросах)… 

В конфигурации с использованием nginx как frontend-сервера, Вы имеете возможность создать простое правило для переписывания ссылок в запросах так, чтобы все красивые ссылки типа {{{http://your.cool-service.com/files/cool.mp3}}} автоматически направлялись на некоторый скрипт {{{/down.php}}} и, если он вернет заголовок ''~X-Accel-Redirect'', файл автоматически отдавался клиенту с поддержкой Ranges и всех остальных прелестей раздачи статического контента с frontend-сервера. Backend-сервер в это время сможет обрабатывать другие запросы. Ваши пользователи могут даже не знать о том, что их закачки контролируются Вами. Примерная диаграмма описанного алгоритма приведена ниже:

{{textAlignCenter{
[img[images/articles/algorithm_c.png]]
}}}
Позвольте обратить Ваше внимание на важный факт: Если Вам нужно только увеличение производительности работы сайта с помощью описанной здесь техники, и вы не хотите использовать систему контроля за скачиванием, то Вам не нужно ничено менять в скриптах на Вашем сервере! Они будут работать так же, как и раньше!

Итак, последнее, чем я могу помочь Вам в тяжелом труде оптимизации использования ресурсов Вашего сервера -- это пример конфигурации для nginx, которая может быть использована Вами в качестве базовой при конфигурации Вашего сервера:
{{{
server {
        listen       80;
        server_name  some-server.com www.server-name.com;

        access_log  logs/host.access.log  main;

        # Main location
        location / {
            proxy_pass         http://127.0.0.1:8080/;
            proxy_redirect     off;

            proxy_set_header   Host             $host;
            proxy_set_header   X-Real-IP        $remote_addr;
            proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;

            client_max_body_size       10m;
            client_body_buffer_size    128k;

            proxy_connect_timeout      90;
            proxy_send_timeout         90;
            proxy_read_timeout         90;

            proxy_buffer_size          4k;
            proxy_buffers              4 32k;
            proxy_busy_buffers_size    64k;
            proxy_temp_file_write_size 64k;
        }

        # Static files location
        location ~* ^.+.(jpg|jpeg|gif|png|ico|css|zip|tgz|gz|rar|bz2|doc|xls|exe|pdf|ppt|txt|tar|mid|midi|wav|bmp|rtf|js)$ {
            root   /spool/www/members_ng;
        }

    }
}}}
{{note{
''ЗАМЕЧАНИЕ:''
Если скрипты на Вашем backend-сервере используют ~IP-адреса клиентов в каких-то целях, то Вам необходимо установить на сервер модуль mod_rpaf module, чтобы он использовал передаваемый nginx заголовок ''~X-Real-IP'' в качестве основного адреса пользователя.
}}}
Вот и все! Теперь Вы можете установить себе на сервер nginx, отконфигурировать его и получить возможность обслуживать большее количество клиентов при использовании меньшего количества ресурсов! Все будет работать абсолютно прозрачно для уже написанных скриптов и, если хотите, Вы сможете организивать контролируемое скачивание при помощи метода, который я опишу в одном из следующих постов.

!Комментарии
{{note{
;А как избавиться после ридеректа на apache от номера порта в урле? В моём случае {{{http://greg.dobroe.net:8080/pma/}}}
:Использовать директиву proxy_redirect.
----

;Подскажите пожалуйста, как сделать так, чтобы из определённой папки nginx отдавал файлы “как есть” - картинки - картинками, скрипты - файлами (download), не переадресовывая запрос. Т.е. цель - запрет исполнения всего в папке, но возможность скачивания без ошибок. Переопределение типа на application/octet-stream для этой папки результата не даёт
:И оно действительно отдает application/octet-stream? Проверьте через curl/GET/wget…
----

;Алексей, добрый день. Возникла ситуация: есть один тяжёлый проект бежит это на nginx добавили несколько дополнительных серверов с ~FastCGI происходит потеря сессий  как с этим бороться? Заранее благодарен за ответ.
:Что вы имеете ввиду под “потеря сессий”? Если то, что пхп-шные сессии перестали работать, так это логично - они ведь в файлах во дефолту хранятся. Решений я знаю как минимум 2: 
:#хранение сессий на nfs-share
:#хранение сессий в базе данных
}}}

!См. также
*http://www.opennet.ru/base/net/nginx_ipb.txt.html
*http://sysoev.ru/nginx/docs/ -- документация по nginx

!Ссылки
*[[Оригинал статьи|http://blog.kovyrin.net/2006/05/18/nginx-as-reverse-proxy/lang/ru/]]


</pre>
</div>
<div title="Использование SSH совместно с svnserve" modifier="Яковлев Иван" created="200906202223" tags="[[Настройка Subversion (SVN)]] [[TODO - нужен перевод статьи]] TODO" changecount="1">
<pre>!Описание
TODO

!Ссылки
*[[Оригинал статьи|http://articles.slicehost.com/2007/9/5/using-ssh-with-svnserve]]


</pre>
</div>
<div title="Использование X-Accel-Redirect с Nginx для реализации контролируемых скачиваний (с примерами для rails и php)" modifier="Яковлев Иван" created="200906191349" modified="200906191427" tags="[[Nginx + Apache]]" changecount="6">
<pre>Иногда вам может быть нужно реализовать т.н. контролируемое скачивание, когда все запросы на скачивание файлов передаются скрипту, который решает, как поступить: отправить пользователю какой-либо файл, или показать стриницу access denied, или, может быть, сделать что-то еще. При использовании сервера lighttpd это может быть реализовано при помощи заголовка ''~X-Sendfile'', возвращаемого из скрипта. Nginx имеет свою союственную реализацию описанной идеи с использованием заголовка ''~X-Accel-Redirect''. В этой короткой статье я попытаюсь описать, как использовать эту возможность из приложений на PHP или Rails.

!Описание
Представим, что у вас есть какой-либо сайт, работающий на Apache с PHP или Rails для генерации нинамического контента. Если вы будете использовать nginx в качестве reverse-proxy перед вашим сервером Apache, вы получите сразу две положительных возможности:
#Вы сможете освободить больше ресурсов вашего сервера для обслуживания клиентов, т.к. nginx возьмет на себя работу с медленными клиентами (детальнее - [[здесь|Использование Nginx Как Reverse-Proxy Сервера На Загруженных Сайтах]]).
#Вы сможете реализовать контролируемое скачивание статических файлов с вашего сайта.

В этой статье я предпологаю, что сайт расположен в каталоге {{{/var/www}}} и статические файлы (например, фильмы, музыка или что-то еще) расположены в каталоге {{{/var/www/files}}}. Apache слушает на порту {{{http://127.0.0.1:8080}}}.

!Настройка
Для начала, давайте рассмотрим нашу конфигурацию сервера nginx:
{{{
http {
    ....
    server {
        listen       80;
        server_name  your-domain.com;

        location / {
            rewrite ^/download/(.*) /down.php?path=$1 last;

            proxy_pass         http://127.0.0.1:8080/;
            proxy_redirect     off;

            proxy_set_header   Host             $host;
            proxy_set_header   X-Real-IP        $remote_addr;
            proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;

            client_max_body_size       10m;
            client_body_buffer_size    128k;

            proxy_connect_timeout      90;
            proxy_send_timeout         90;
            proxy_read_timeout         90;

            proxy_buffer_size          4k;
            proxy_buffers              4 32k;
            proxy_busy_buffers_size    64k;
            proxy_temp_file_write_size 64k;

        }

        location /files {
            root /var/www;
            internal;
        }
    }
}
}}}
Как вы видите, у нас есть дополнительная “internal” секция {{{location /files}}}. Это ключевое влово “internal” позволяет нам иметь секции location, которые будут доступны для пользователя только в случае внутренних редиректов внутри nginx и при использование заголовка ''~X-Accel-Redirect'' в ответах от сриптов backend-сервера. Итак, мы можем использовать простой скрипт на PHP или код на Rails для реализации контролируемых скачиваний с поддержкой заголовков Ranges (докачка) и всех остальных возможностей, предоставляемых при прямом скачивании статического контента с серверов под управлением nginx.

Вот пример очень простого скрипта down.php:
{{{
&lt;?php
// Get requested file name
$path = $_GET[&quot;path&quot;];

//...
// Perform any required security checks, validation 
// and/or stats accounting
//...

// And redirect user to internal location
header(&quot;X-Accel-Redirect: /files/&quot; . $path);

?&gt;
}}}

В приложениях Rails вы можете использовать следубщий код в вашем controller’е:
{{{
// Get requested file name
path = @params[&quot;path&quot;]

# ...
# Perform any required security checks, validation 
# and/or stats accounting
# ...

# And redirect user to internal location
@response.headers['X-Accel-Redirect'] = &quot;/files/&quot; + path
}}}
Вот и все! При помощи описанного подхода вы сможете реализовать очень гибкую и удивительно эффективную систему раздачи любого статического контента!

!Комментарии
{{note{
Нет, это статья не все. если использовать пхп как модуль апача, то сервер ляжет под нагрузкой, когда обратятся несколько юзверов при помощи флашгета с 10 потоками. Лучшим вариантом будет запуск проверяющего скрипта на фастCGI.
----

При таком подходе в заголовке ~Content-Type всегда оказывается text/html. Соответственно, бинарный файл загружается браузером в окно а не предлагается для скачивания. Как оказалось, это заголовок по умолчанию, который выдает сам PHP скрипт, и nginx его уже не трогает. Выход довольно прост, надо запретить PHP выдавать этот заголовок, например, так:
{{{
ini_set(’default_mimetype’, ”);
}}}
Если кто подскажет, как это сделать более элегантно - буду благодарен.
----

перед ''~X-Accel-Redirect'' вставьте:
{{{
header(”Content-Disposition: attachment; filename=\”&quot; . $filename . “\”&quot;);
}}}
где {{{$filename}}} -- имя файла (только имя, путь - отсутствует).
После этого все браузеры должны открывать окно с приглашением сохранить файл или открыть. Ну у MIME типы уже сам nginx отдаст если в его конфиге добавлено include conf/mime.types
}}}

!См. также
*[[Использование Nginx Как Reverse-Proxy Сервера На Загруженных Сайтах]]

!Ссылки
*[[Оригинал статьи|http://blog.kovyrin.net/2006/11/01/nginx-x-accel-redirect-php-rails/]]


</pre>
</div>
<div title="Использование lighttpd, Mplayer/Mencoder и Flvtool2 для реализации потоковой раздачи Flash Video" modifier="Яковлев Иван" created="200906191532" modified="200906191549" tags="[[Потоковое видео]] TODO" changecount="7">
<pre>!Описание
Это очень короткий пост о том, как при помощи набора бесплатных инструсментов реализовать полнофункциональный потоковый видео сервер, основанный на flash video. Итак, что же мы хотим получить после окончания настройки сервера? Все очень просто - мы хотим получить бесплатный функциональный аналог решения по стримингу видео, реализованного в [[Flash Communication Server (Flash Media Server)|http://www.adobe.com/products/flashmediaserver/]] компании Macromedia.

Первым нашим шагом, как и при использовании любой другой технологии потоковой передачи видео, будет конвертация видео файлов в специализированный формат, предназначенный для передачи по сети в виде потока (этот формат называется “Flash Video” (flv)) и добавление в него специализированной мета-информации, предназначенной для плееров, которые реализуют “перемотку” видео потока до нужного вам места в видео файле. 

В интернете есть множество статей, авторы которых смело заявляют “просто запустите ffmpeg и все будет отлично”, но я вынужден не согласиться с ними. Ffmpeg - это не подходящий инструмент для поставленной задачи, т.к. он поддерживает очень маленькое количество входных форматов видео-файлов, а мы не хотим организовывать двухэтапное перекодирование видео через промежуточных формат, понятный ffmpeg. 

Именно поэтому мой выбор - это бесплатное ПО со скромным именем mplayer, содержащее в себе утилиту mencoder, предназначенную для перекодирования видео-файлов из одного формата в другой и понимающей огромное количество входных форматов.

!Mplayer/Mencoder
В первую очередь вам нужно будет скачать пакет исходных кодов для mplayer с [[официального сайта mplayer|http://www.mplayerhq.hu/]] и скомпилировать их. Я не буду описывать здесь, как это сделать, т.к. существует море статей, рассказывающий ою этом, но хочу привлечь ваше внимание к просому факту: Постарайтесь минимизировать набор выключенных кодеков на этапе компиляции установив все требующиеся библиотеки из репозитория вашего дистрибутива или соберите их самостоятельно, т.к. чем больше кодеков у вас будет, тем больше форматов видео файлов вы сможете обрабатывать”.

!Flvtool2
После установки mplayer/mencoder вам будет нужно установить интерпретатор языка Ruby чтобы запустить ПО flvtool2. Пожалуйста, убедитесь, что у вас стоит версия Ruby не ниже 1.8.4.

Следующим шагом будет инсталляция flvtool2 - небольшой утилиты, позволяющей вставлять meta-информацию в видео-файлы и позволяющую использовать “перемотку” видео потока во flash плеерах. Исходные тексты можно получить на домашней странице проекта, но я хочу посоветовать вам использовать последнюю версию flvtool2 из ~SVN-репозитария (процесс описан на [[домашней странице проекта|http://inlet-media.de/flvtool2]]).

Небольшое замечание: текущая версия flvtool2 содержит маленькую, но очень неприятную ошибку, не дающую использовать данное ПО с файлами, сгенерированными mencoder’ом. Когда вы запустите flvtool2, вы получите следующий результат:
{{{
/usr/local/lib/site_ruby/1.8/flv/amf_string_buffer.rb:163: [BUG] Segmentation fault
}}}
Для решения этой проблемы откройте файл {{{lib/flv/amf_string_buffer.rb}}} в исходных текстах flvtool2 и измените строку 163 с 
{{{
    write [(time.to_i * 1000.0)].pack('G')
}}}
на
{{{
    write [(time.to_f * 1000.0)].pack('G')
}}}
Хочу сказать ОГРОМНОЕ СПАСИБО Дмитрию Штефлюку за это исправление. 

Итак, сейчас вы готовы к конвертации ваших видео файлов из любого формата в формат flv. Вы можете сделать это, используя следующий набор команд:
{{{
$ mencoder \\
orig_file.ext \\
-ofps 25 \\
-o dest_file.flv \\
-of lavf \\
-oac mp3lame \\
-lameopts abr:br=64 \\
-srate 22050 \\
-ovc lavc \\
-lavfopts i_certify_that_my_video_stream_does_not_use_b_frames \\
-lavcopts vcodec=flv:keyint=50:vbitrate=300:mbd=2:mv0:trell:\\
v4mv:cbp:last_pred=3 -vop scale=320:240
....
....
$ flvtool2 -UP dest_file.flv
...
}}}
Эти команды конвертируют файл ''orig_file.ext'' в ''dest_file.flv'' и добавляют meta информацию в него.

!Lighttpd 
Последнее, что вам нужно будет сделать - это скачать [[Lighttpd web server|http://www.lighttpd.net/]] с его официального сайта и установить его . После этого, включите [[стриминг-модуль|http://trac.lighttpd.net/trac/wiki/Docs%3AConfigurationOptions#Optionsformod_flv_streaming-flvstreamingmodule]] в config-файле и вы сможете ипользовать любой flash player, понимающий идею стриминга видео для создания вашего союственного сервиса Youtube и зарабатывания вашего первого миллиарда долларов.

!См. также
*[[Стриминг Flash Video при помощи Nginx]]

!Ссылки
*[[Оригинал статьи|http://blog.kovyrin.net/2006/10/08/lighttpd-memcoder-flvtool-for-streaming/]]



</pre>
</div>
<div title="Использование x11vnc" modifier="Яковлев Иван" created="200906171442" modified="200906171653" tags="[[Подключение к рабочему столу через VNC]] [[Удаленное подключение]]" changecount="4">
<pre>!Описание
In computing, x11vnc is a program to allow remote access to an existing X server session via Virtual Network Computing (VNC) (for introduction and concepts see that article). It works by continuously polling the X server's frame buffer for changes. This allows the user to control their Linux desktop (KDE, GNOME, XFCE, etc) from a remote computer either on the user's own network, or from over the internet as if the user were sitting in front of it.

''x11vnc'' это программа для обеспечения удаленного доступа к рабочей сессии X сервера Linux (удаленного доступа к рабочему столу Linux) через виртуальную сеть Virtual Network Computing -- протокол VNC. ''x11vnc'' формирует буфер данных о текущем состоянии и изменениях удаленного рабочего стола, что позволяет программе-клиенту формировать изображение удаленного рабочего стола Linux-машины на экране компьютера удаленного пользователя и осуществлять управление по сети или через интернет так, как если бы вы сидите прямо перед монитором удаленного компьютера.

x11vnc является частью открытого проекта ~LibVNCServer и доступна для использования под свободной лицензией GNU General Public License.

''x11vnc'' обладает всем необходимым функционалом, и даже кое-какими дополнительными возможностями по сравнению с другими популярными VNC серверами (например масштабирование экрана).

!Установка
Для начала установим x11vnc:
{{{
sudo aptitude x11vnc
}}}

Установка не займёт много времени, поскольку исходные тексты занимают всего около двух мегабайт. После установки на диске появятся следующие файлы (список может немного меняться в зависимости от версии и ~USE-флагов,использованных при сборке):
{{{
/usr/bin/x11vnc
/usr/share/man/man1/x11vnc.1.bz2
/usr/share/x11vnc/classes/ssl/VncViewer.jar
/usr/share/x11vnc/classes/ssl/index.vnc
/usr/share/x11vnc/classes/ssl/SignedVncViewer.jar
/usr/share/x11vnc/classes/ssl/proxy.vnc
/usr/share/x11vnc/classes/ssl/README
/usr/share/x11vnc/classes/ssl/UltraViewerSSL.jar
/usr/share/x11vnc/classes/ssl/SignedUltraViewerSSL.jar
/usr/share/x11vnc/classes/ssl/ultra.vnc
/usr/share/x11vnc/classes/ssl/ultrasigned.vnc
/usr/share/x11vnc/classes/ssl/ss_vncviewer
/usr/share/x11vnc/classes/VncViewer.jar
/usr/share/x11vnc/classes/index.vnc
/usr/share/doc/x11vnc-0.9.3/ChangeLog.bz2
/usr/share/doc/x11vnc-0.9.3/README.bz2
}}}
В самом простом случае для запуска достаточно просто выполнить команду:
{{{
x11vnc
}}}
Однако если у вас слабый канал, то может быть полезным отключение полной цветопередачи (опция -notruecolor) а так же включить масштабирование (опция {{{-scale}}}). В этом случае команда будет выглядеть примерно так:
{{{
x11vnc -notruecolor -scale 2/3
}}}
В результате по сети будет передаваться изображение с восьмибитным цветом и размером в 2/3 от оригинала.
{{note{
''ЗАМЕЧАНИЕ:''
У x11vnc есть ещё одна особенность: после запуска x11vnc ждёт подключения клиента, а по завершении подключения - завершает свою работу. Если необходимо чтобы x11vnc был запущен постоянно и не завершал работу после отключения клиента - нужно добавить опцию -forever к строке запуска. Дополняя предыдущую команду получим:
{{{
x11vnc -notruecolor -scale 2/3 -forever
}}}
}}}
Так же полезно явно указать используемый дисплей при помощи опции {{{-display}}}. Если опция не указана то используется дисплей, указанный в переменной окружения DISPLAY. Если же переменная окружения DISPLAY не указана - создаётся новый дисплей.

Кроме того полезно настроить авторизацию. Для этого выполните команду:
{{{
x11vnc -storepasswd
}}}
Пароль будет сохранён как и в случае с другими реализациями vnc в файле {{{~/.vnc/passwd}}}. Причём если у вас уже есть этот файл (например созданный при помощи realvnc) то его можно использовать без изменений. Чтобы x11vnc использовал авторизацию ему нужно передать опцию {{{-usepw}}}. В итоге получится вот такая команда:
{{{
x11vnc -notruecolor -scale 2/3 -forever -display :0 -usepw
}}}
Если используется KDE и есть необходимость запустить x11vnc вместе с KDE то можно создать скрипт {{{~/.kde/Autostart/startvnc.sh}}} следующего содержания:
{{{
#!/bin/sh

x11vnc -notruecolor -scale 2/3 -forever -display :0 -usepw
}}}
Всё. Теперь нужно выполнить этот скрипт или перезапустить KDE и можно подключаться к вашему компьютеру командой:
{{{
vncviewer &lt;Ваш_IP&gt;
}}}
Большая часть написанного выше не привязана к конкретному дистрибутиву, и потому может быть использовано и в других дистрибутивах.

!Ссылки
*[[Оригинал статьи|http://ylsoftware.com/view/373]]
*http://en.wikipedia.org/wiki/X11vnc -- раздел на Википедии


</pre>
</div>
<div title="Использование системы контроля ревизий (RCS)" modifier="Яковлев Иван" created="200906031912" modified="200906031912" tags="Приложения" changecount="2">
<pre>1) В каждой папке, где располагаются файлы подлежащие контролю системой RCS, необходимо создать директорию RCS:
{{{
mkdir  RCS
}}}

2) Помещаем нужный файл конфигурации в систему контроля ревизий:
{{{
ci –u loader.conf
}}}

3) Блокируем файл для последующего изменения и занесения этих изменений в систему RCS:
{{{
co –l loader.conf
}}}
4) Редактируем файл с помощью текстового редактора:
{{{
vi loader.conf
}}}
добавляем в первую строчку файла  {{{#$Id$}}} – это обеспечит вывод информации о проделанной ревизии в самом файле (для удобства последующего просмотра проделанных изменений).

Осуществляем нужные нам изменения (например, задаем задержку меню выбора варианта загрузки в 3 сек. и лого в виде цветного чертика):
{{{
autoboot_delay=”3”
loader_logo=”beastie”
}}}

5) После завершения изменения файла – разблокируем его:
{{{
ci –u loader.conf
}}}

6) Возврат (откат)  к предыдущим ревизиям:
{{{
co –r1.1 loader.conf
}}}


</pre>
</div>
<div title="Исправление пакетов с ошибками" modifier="Яковлев Иван" created="200906032341" modified="200906040936" tags="[[Установка ПО в Ubuntu]]" changecount="3">
<pre>Иногда можно перестараться с установкой ПО и поломать что-нибудь. В этом случае вы увидите предупреждающее сообщение в трее через некоторое время. Либо вы увидите сообщение при запуске Synaptic или если вручную попробуете что-нибудь установить.

{{textAlignCenter{
[img[images/articles/packet-error.png]]
}}}
Эта ситуация может возникнуть, например, если с помощью {{{dpkg -i}}} попытаться поставить пакет, для которого не были найдены зависимости. Ну и много других ситуаций. Чтобы увидеть проблемный пакет в Synaptic выберите  &quot;Специальные фильтры - С ошибками&quot;.

{{textAlignCenter{
[img[images/articles/packet-with-error.png]]
}}}
Чтобы починить пакет, выберите пункт меню &quot;Правка - Исправить пакеты с ошибками&quot;.


{{textAlignCenter{
[img[images/articles/menu-fix-errors.png]]
}}}
После этого нужно применить те действия, которые приготовил Synaptic. Это может быть просто установка дополнительных пакетов или удаление неверного пакета, если зависимости не могут быть найдены.

{{textAlignCenter{
[img[images/articles/packet-fixed.png]]
}}}
После того как вы нажмете &quot;Применить&quot; - вы увидите какие действия будут выполнены. В консоли можно сделать тоже самое с помощью команды:
{{{
sudo apt-get -f install
}}}

!См. далее
*[[Alien]]


</pre>
</div>
<div title="Как быть хорошим (и ленивым) сисадмином" modifier="Яковлев Иван" created="200906052357" tags="Статьи Приложения [[Администрирование сервера]] TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/kak-byt-xoroshim-i-lenivym-sisadminom.html#more-165]]



</pre>
</div>
<div title="Как надо правильно работать в Midnight Commander" modifier="Яковлев Иван" created="200906031923" modified="200906031928" tags="Приложения" changecount="5">
<pre>!Начальные настройки
Интересен тот факт, что некоторые (чаще весьма крутые :) юниксоды работают в deco или вообще в командной строке. Командная строка - это конечно показатель высокого класса, но с другой стороны - это прошлый век. Не надо забывать и о цивилизованном подходе.

Не будем вдаваться во флейм, а просто перейдем к повествованию все &quot;крутых&quot; качеств Midnight commander.
Прежде всего надо бы заглянуть в ядро и посмотреть включена ли там поддержка псевдотерминалов:
 
{{{[*] Unix98 PTY support}}}
{{{(256) Maximum number of Unix98 PTYs in use (0-2048)}}}

если так, то все отлично. Запустим ''mc'' и будем настраивать его так, как я считаю нужным. Прежде всего зайдем в меню ''F9'' и в ''Options'' поставим в ''Display Bits'' поддержку ''8bit'' символов на входе и выходе. Опять в ''Options-&gt;Layout'':
Убрать ''menubar visible'' (экранное пространство очень дорого чтобы там валялась бестолковая строчка с меню)
Убрать ''keybar visible'' (по тем же соображениям, кнопки все надо помнить наизусть!)
Включить ''hintbar visible'' (там будет показано много интересного)

Запишите все опции. Теперь ''mc'' принял приемлемый вид.
Понятно что просмотр содержимого каталогов сразу по входу в них - это очень удобно. Не надо все время давить {{{ls -la}}} для просмотра состояния каталога. Все показано к тому же в удобоваримом виде.

!Какие кнопки давить?
Стандартные кнопки писать не буду (любому известно что ''F5'' это копирование).
''{{{Insert}}}'' - отмечать файлы и каталоги
''{{{Ctrl-ENTER}}}'' (''{{{ESC+ENTER}}}'' или ''{{{Alt-ENTER}}}'') - послать текущий объект в командную строку
''{{{Ctrl-X+T}}}'' - послать выделенные об'екты в командную строку
''{{{Alt-p}}}'' (''{{{ESC+p}}}'') - вернуть предыдущую (предыдущие) командную строку (строки)
''{{{Alt-n}}}'' (''{{{ESC+n}}}'') - вернуть последующую (последующие) командную строку (строки)
''{{{Ctrl-\}}}'' - hotlist (для частоиспользуемых директорий)
''{{{Shift-F3}}}'' - просмотр файла ({{{raw/}}} без учета расширения)
''{{{Shift-F4}}}'' - создать новый файл
''{{{F12}}}'' - Save as
''{{{Ctrl-O}}}'' - погасить панели и посмотреть что под ними (@@color: red;работает ТОЛЬКО в linux!@@)
здесь же можно поработать в shell'e.
Если при включенных панелях у вас не запускается ничего и выдается
ошибка &quot;The shell is already running a command&quot; - это значит что нужно
освободить шелл. Погасите снова панели и нажмите ''{{{ENTER}}}'' пару раз.
''{{{Ctrl-S}}}'' - поиск файла
''{{{Сtrl-X+A}}}'' - текущие VFS (ftp и пр.)
''{{{Ctrl-X+C}}}'' - посмотреть/поменять permissions
''{{{Ctrl-X+O}}}'' - посмотреть/поменять owner
''{{{Ctrl-X+L}}}'' - создать link
''{{{Ctrl-X+S}}}'' - создать symlink
''{{{Ctrl-X+Ctrl-S}}}'' - редактировать symlink
''{{{Ctrl-X+D}}}'' - сравнить каталоги
''{{{Ctrl-X+J}}}'' - фоновые задачи
''{{[Ctrl-X+Q}}}'' - быстрый просмотр содержимого файла

''{{[ESC+A}}}'' - послать в командную строку текущий каталог
''{{{ESC+C}}}'' - быстро сменить каталог
''{{{ESC+H}}}'' - history
''{{{ESC+P}}}'' - вернуть предыдущую (предыдущие) командную строку (строки)
''{{{ESC+N}}}'' - вернуть последующую (последующие) командную строку (строки)
''{{{ESC+S}}}'' - поиск файла (в текущей директории)
''{{{ESC+?}}}'' - расширенный поиск фала (или вхождения/regular expression)
''{{{ESC+цифра}}}'' - тоже что и ''{{{F{цифра}}}}'' (''{{{ESC+5}}}'' = ''{{{F5}}}'')

''{{{F4}}}'' (в редакторе) - поиск с заменой
''{{{F6}}}'' (в редакторе) - поиск с помощью регулярного выражения
''{{{Shift-Del}}}'' (в редакторе) - удалить блок (и положить его в clipboard)
''{{{Shift-Ins}}}'' (в редакторе) - вставить блок из clipboard (работает даже в другой консоли!!!) Можно редактировать два и более файлов на разных консолях и гонять блоки между ними. 

''{{{Alt-TAB}}}'' (''{{{ESC+TAB}}}'') - Крутейшая кнопка для поиска загружаемых файлов (например вы забыли как полностью пишется netcfg. Достаточно набрать в командной строке net и нажать ''{{{Alt-TAB}}}'' - вам сразу покажут что можно запустить, которое начинается со слова net) нажимать два раза!
''{{{Alt-TAB'' (''{{{ESC+TAB}}}'') - работает так же как в Bash ''{{{TAB}}}'' (т.е. подгоняет по первым буквам имена файлов или директорий. Наберите {{{cd /u}}} потом ''{{{Alt-TAB}}}'' - сразу будет {{{cd /usr/}}} и т.д.)

Если нужно что-то срезать мышью с экрана давите ''{{{Shift}}}'', а только потом отмечайте. Тоже самое касается вставки из мышиного clipboard'a.

!Что еще крутого там есть?
Ну то, что он может работать с ftp серверами понятно - это из меню.
Редактор!!! - Это полный рулез!!!
Самое хорошее - это то, что там можно блоки отмечать с помощью ''Shift-стрелки''
{{note{
@@font-weight: bold;Далее hint!@@
Пойдите к себе в домашнюю директорию {{{cd ~/.cedit}}}
Найдите там файл {{{Syntax}}}, посмотрите какая версия Syntax у вас, запомните ее! Затем возьмите мой Syntax. Исправьте в нем версию на ту, которая поддерживается вашим ''mc'' (измените число в первой строчке) и положите вместо своего. Все!
Теперь попробуйте отредактировать перловый скрипт или программу на C (например), имеющие расширение &quot;{{{.pl}}}&quot; или &quot;{{{.c}}}&quot;. Авек плезир - все цветное!
}}}

!Ссылки
*http://mgul.ac.ru


</pre>
</div>
<div title="Как установить LDAP сервер и его клиентов (ldap linux debian &amp; ubuntu auth)" modifier="Яковлев Иван" created="200906052328" tags="LDAP [[Установка/настройка сервера]] Статьи TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/kak-ustanovit-ldap-server-i-ego-klientov-ldap-linux-debian-ubuntu-auth.html#more-67]]



</pre>
</div>
<div title="Категории команд Unix" modifier="Яковлев Иван" created="200906052207" tags="Приложения" changecount="1">
<pre>*(1) - Executable programs or shell commands
*(2) - System calls (functions provided by the kernel)
*(3) - Library calls (functions within program libraries)
*(4) - Special files (usually found in /dev)
*(5) - File formats and conventions eg /etc/passwd
*(6) - Games
*(7) - Miscellaneous (including macro packages and conventions)
*(8) - System administration commands (usually only for root)
*(9) - Kernel routines [Non standard]


</pre>
</div>
<div title="Клавиатурные сокращения" modifier="Яковлев Иван" created="200906032104" modified="200906032109" tags="Приложения" changecount="3">
<pre>!Система
''Ctrl+Alt+Delete'' - перезагрузить компьютер
''Ctrl+Alt+Backspace'' - перезагрузить X-сервер

''Ctrl + Alt + Стрелка вправо (влево)'' - Переключить на следующий (предыдущий) рабочий стол. Примечание: если у вас включен compiz и стоит &quot;Куб рабочего стола&quot;, то для вращения куба держите нажатыми ''Ctrl+Alt+Левая кнопка мыши и вращайте куб движениями мыши''.

''Alt+F1'' - вызов главного меню (аналог нажатия кнопки Win в Windows)
''Alt+F2'' - окно запуска приложений (аналог Win+R в Windows)

''Ctrl + Alt + F1'' = Переключиться на первую виртуальную консоль 
''Ctrl + Alt + F2(F3)(F4)(F5)(F6)'' = Переключиться на виртуальную консоль номер ....
''Ctrl + Alt + F7'' = Переключиться в графический режим 

!Консоль / Терминал
''Ctrl+A'' = Передвинуть курсор в начало строки
''Ctrl+E'' = Передвинуть курсор в конец строки
''Tab'' = показать возможные команды (Например: пишем iw и тыкаем tab, консоль нам показывает варианты = iwconfig iwevent iwgetid iwlist iwpriv iwspy) а также полезно для подстановки имени файла в команды
''Ctrl+U'' = Удалить строку
''Ctrl+K'' = Удалить строку от курсора
''Ctrl+W'' = Удалить строку до курсора

Стрелки &quot;''Вверх''&quot; &quot;''Вниз''&quot; =  История команд пользователя
''Ctrl+R'' = Поиск по истории команд пользователя

''Shift+~PageUp / ~PageDown'' = Пролистывание вывода терминала
''Ctrl+L'' = Очистить терминал
''Ctrl+D'' =Выход (аналог команды &quot;exit&quot;)
''Shift+insert'' = Вставить

!Nautilus (Файловый менеджер)
''Ctrl+H'' : Показать скрытые файлы

''Ctrl+T'' : Создать новую вкладку
''Ctrl+W'': Закрыть текущую вкладку или окно если вкладка одна
''Ctrl+~PgUp (~PgDown)'' : Переместиться на предыдущую (следующую) вкладку
''Alt+1 (2, 3, 4..)'' : Переместиться на вкладу 1 (2, 3, 4 ..), если существует

''Alt+Home'' : Перейти в домашнюю директорию
''Alt+вверх'' : Перейти в родительскую директорию (на одну выше), если такая существует
''Alt+влево (вправо)'' : Вперед (назад) по истории переходов

''Alt+Enter'' : свойства файла\папки

''Ctrl+1 (2, 3)'' : Переключение в вид значки (список, компактный)

''Ctrl+Shift+N'' : Создать новую директорию
''Ctrl+M'' : Создать ссылку на текущий файл (директорию)

''Del'' : Удалить в корзину
''Shift+Del'' : Удалить (без корзины)

!Firefox
''Ctrl+F'': Поиск текста
''Ctrl+L'': Активировать адресную строку, выделив текущий урл.
''Ctrl+~PgUp'': Следующая вкладка
''Ctrl+~PgDwn'': Предыдущая  вкладка
''Ctrl+Tab/~Ctrl-Shift+Tab'': Тоже самое
''~Ctrl-Shift-T'' :  Открыть последнюю закрытую вкладку

''Ctrl+T'' : Новая вкладка
''Ctrl+R'' или ''F5'': перезагрузить страницу
''Ctrl + U'' :Просмотр ~HTML-кода страницы


</pre>
</div>
<div title="Команды MySQL" modifier="Яковлев Иван" created="200906032123" modified="200907181107" tags="MainMenu" changecount="6">
<pre>*[[Подключение/отключение|Подключение и отключение от сервера MySQL]]
*[[mysql]]
*[[mysqladmin (manpage)|mysqladmin - клиент администрирования сервера MySQL]]
*[[mysqldump]]</pre>
</div>
<div title="Команды SVN" modifier="Яковлев Иван" created="200906032124" modified="200906032137" tags="MainMenu" changecount="4">
<pre>*TODO
*TODO</pre>
</div>
<div title="Команды Unix" modifier="Яковлев Иван" created="200906032125" modified="200907221124" tags="MainMenu slider" changecount="17">
<pre>*[[Шпоргалка по командам|Шпоргалка по основным командам Unix/Linux и оболочке bash]]
*[[Man и получение помощи]]
*&lt;&lt;slider &quot;chk-inst-cmd&quot; [[Команды установки пакетов]] &quot;Команды для установки&quot; &quot;Показать/Скрыть Команды установки пакетов&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-navigation-cmd&quot; [[Навигация по каталогам]] &quot;Навигация по каталогам&quot; &quot;Показать/Скрыть Навигация по каталогам&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-file-folder-cmd&quot; [[Команды для работы с файлами и каталогами]] &quot;Файлы и каталоги&quot; &quot;Показать/Скрыть Команды для работы с файлами и каталогами&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-sys-cmd&quot; [[Информационные команды]] &quot;Информационные команды&quot; &quot;Показать/Скрыть Информационные команды&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-users-groups-cmd&quot; [[Команды для работы с группами и пользователями]] &quot;Группы и пользователи&quot; &quot;Показать/Скрыть Команды для работы с группами и пользователями&quot;&gt;&gt;
*[[Монт./размонт. дисков|Монтирование и размонтирование дисков]]
*&lt;&lt;slider &quot;chk-sys-admin&quot; [[Команды администрирования]] &quot;Администрирование&quot; &quot;Показать/Скрыть Команды администрирования&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-netdiag&quot; [[Команды для диагностики сети]] &quot;Диагностика сети&quot; &quot;Показать/Скрыть Команды для диагностики сети&quot;&gt;&gt;
*[[ssh-keygen|ssh-keygen - создание, обслуживание и преобразование аутентификационных ключей]]</pre>
</div>
<div title="Команды Windows" modifier="Яковлев Иван" created="200906061601" modified="200906061602" tags="MainMenu" changecount="2">
<pre>*[[run|run - запуск программ из консоли Windows и скрытие консоли]]</pre>
</div>
<div title="Команды администрирования" modifier="Яковлев Иван" created="200906052214" modified="200907260042" tags="[[Команды Unix]] slider" changecount="4">
<pre>*[[sudo|sudo - выполнение команды от имени суперпользователя]]
*[[htpasswd|htpasswd - Manage user files for basic authentication]]
*[[pv - просмотрщик пайпов|pv - pipeviewer просмотрщик пайпов]]
*[[screen|screen - запуск толстой оболочки эмулятора терминала (Rich Shell)]]</pre>
</div>
<div title="Команды для диагностики сети" modifier="Яковлев Иван" created="200906062057" modified="200906171800" tags="[[Команды Unix]] slider" changecount="14">
<pre>*[[dig|dig - поиск IP-адреса указанного домена]]
*[[host|host - запрос информации о указанном домене или IP-адресе]]
*[[hostname|hostname - выдает или устанавливает имя компьютера]]
*[[ping|ping - посылка пакетов ICMP ECHO_REQUEST сетевым хостам]]
*[[ifconfig|ifconfig - конфигурирование параметров сетевого интерфейса]]
*[[netstat|netstat - показ текущих сетевых подключений]]
*[[traceroute|traceroute - print the route packets take to network host]]
*[[nmap|nmap - инструмент проверки безопасности сети и сканер портов]]</pre>
</div>
<div title="Команды для работы с группами и пользователями" modifier="Яковлев Иван" created="200906022256" modified="200906151713" tags="[[Команды Unix]] slider" changecount="17">
<pre>*[[groups|groups - выдает группы, в которые входит пользователь]]
*[[addgroup и groupadd|addgroup - создание новой группы]]
*[[groupdel|groupdel - удаление определения группы из системы]]
*[[groupmod|groupmod - изменение определения группы в системе]]
*[[adduser и useradd|adduser - создание нового пользователя]]
*[[userdel|userdel - удаляет регистрационное имя пользователя из системы]]
*[[usermod|usermod - изменение учётной записи пользователя]]
*[[chroot|chroot - выполнение команды или оболочки shell с особым корневым каталогом]]
*[[passwd|passwd - изменение пароля пользователя]]
</pre>
</div>
<div title="Команды для работы с файлами и каталогами" modifier="Яковлев Иван" created="200906022143" modified="200907010007" tags="[[Команды Unix]] slider" changecount="35">
<pre>*&lt;&lt;slider &quot;chk-file-content-cmd&quot; [[Команды обработки содержимого файла]] &quot;Содержимое файлов&quot; &quot;Показать/Скрыть Команды обработки содержимого файла&quot;&gt;&gt;
*[[find|find - поиск файлов по каталогам]]
*[[locate|locate - поиск местоположения файла]]
*[[file|file - идентификация типа файла]]
*[[cat|cat - объединяет файлы и направляет их на стандартный вывод]]
*[[chmod|chmod - изменяет права доступа к файлу/каталогу]]
*[[chown|chown - смена владельца и группы для файла или каталога]]
*[[chgrp|chgrp - смена группы файлов]]
*[[more и less|more и less - просмотр текста файла]]
*[[head и tail|head - просмотр первых 10 строк и tail - просмотр последних 10 (tail) строк файла]]
*[[cp|cp - копировать файл или каталог]]
*[[rcp|rcp - небезопасное удаленное копирование файлов]]
*[[scp|scp - безопасное копирование (программа удаленного копирования файлов)]]
*[[rsync|rsync - более быстрая и гибкая замена rcp]]
*[[mkdir|mkdir - создать каталог]]
*[[rm|rm - удалить файлы или каталоги]]
*[[mv|mv - переместить (переименовать) файлы]]
*[[ln|ln - создание ссылки между файлами]]
*[[ls|ls - список файлов в текущей директории]]
*[[chattr|chattr - смена атрибутов файла]]
*[[tac|tac - объединяет и печатает файлы в обратной последовательности]]
*[[tail|tail - вывести последние строки]]
*[[wc|wc - печатает число строк, слов и байт в файлах]]</pre>
</div>
<div title="Команды обработки содержимого файла" modifier="Яковлев Иван" created="200906121416" modified="200906121437" tags="[[Команды для работы с файлами и каталогами]] slider" changecount="4">
<pre>*[[sort|sort - сортировка строк текстовых файлов]]
*[[grep и egrep|grep и egrep - поиск образцов в файле]]
*[[wc|wc - вывод числа строк, слов и байт в указанных файлах]]
*[[sed|sed - потоковый редактор (Stream EDitor)]]
*[[awk|awk - язык поиска и обработки шаблонов]]</pre>
</div>
<div title="Команды сервера Apache2" modifier="Яковлев Иван" created="200906032123" tags="MainMenu" changecount="1">
<pre>*TODO
*TODO</pre>
</div>
<div title="Команды установки пакетов" modifier="Яковлев Иван" created="200906121102" modified="200906200033" tags="[[Команды Unix]] slider" changecount="7">
<pre>*[[apt-cache|apt-cache - команда для работы с локальным кешем базы данных пакетов]]
*[[apt-get|apt-get - утилита управления APT (интерфейс командной строки)]]
*[[aptitude|aptitude - высокоуровневый командный интерфейс к менеджеру пакетов]]
*[[dpkg|dpkg - менеджер пакетов Debian]]
*[[dpkg-reconfigure|dpkg-reconfigure - перенастраивает заново уже установленный пакет]]
*[[Компиляция из исходников|Компиляция ПО из исходников]]
</pre>
</div>
<div title="Компиляция ПО из исходников" modifier="Яковлев Иван" created="200906040944" modified="200906200033" tags="[[Настройка Ubuntu]] [[Команды установки пакетов]]" changecount="2">
<pre>Данная статья расчитывает на то что вы:
*Скачали исходники, распаковали их и знаете где они находятся у вас на локальном диске
*Все зависимости удовлетворены. Если вы не уверены, просто попробуйте скомпилировать. Если появляются ошибки - попробуйте погуглить. 

Итак, сам процесс. Команды вставлять без кавычек!
*Перейти (с помощью команды &quot;{{{cd}}}&quot;) в каталог, содержащий исходные коды устанавливаемого пакета. 
*Выполнить команду &quot;{{{./configure}}}&quot;, которая осуществляет конфигурирование пакета в соответствии с Вашей системой. Процесс выполнения этой команды занимает довольно длительное время, причем команда выдает на экран сообщения, сообщающие, какие именно особенности системы испытываются.
*Выполнить команду &quot;{{{make}}}&quot;, для того, чтобы скомпилировать пакет.
*После этого можно выполнить (это шаг не является обязательным) команду &quot;{{{make check}}}&quot;, которая вызывает запуск процедур самотестирования, которые поставляются с пакетом.
*Выполнить команду &quot;{{{make install}}}&quot; для установки программ, а также файлов данных и документации. (Для деинсталляции - {{{make uninstall}}}). 
*Заключительный этап состоит в выполнении команды &quot;{{{make clean}}}&quot;, которая удаляет промежуточные объектные и двоичные файлы из каталога с исходными кодами. Для удаления временных файлов, которые создала команда &quot;{{{configure}}}&quot; (после чего пакет можно компилировать для другого типа компьютеров), надо выполнить команду &quot;{{{make distclean}}}&quot;.
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
А вообще читайте README.txt или INSTALL.txt или нечто похожее, что всегда идет с пакетом.
}}}
Если программы не компилируются, попробуйте установить пакет build-essential.
{{{
sudo apt-get install build-essential
}}}

!Оригинал статьи
*http://ubuntologia.ru/compile-software

</pre>
</div>
<div title="Конфигурационные файлы" modifier="Яковлев Иван" created="200906032124" modified="200906302359" tags="MainMenu" changecount="13">
<pre>*[[/etc/fstab - файловые системы|/etc/fstab - статическая информация о файловых системах]]
*[[/etc/group - список групп]]
*[[/etc/hosts - список хостов]]
*[[/etc/hostname - имя компьютера|/etc/hostname - содержит имя компьютера]]
*[[/etc/motd - сообщение дня]]
*[[/etc/passwd - файл паролей]]
*[[/etc/resolv.conf - список DNS|/etc/resolv.conf - ip-адреса DNS серверов]]</pre>
</div>
<div title="Конфигурация логических томов в файле /etc/fstab" modifier="Яковлев Иван" created="200906122148" modified="200906122158" tags="LVM [[TODO - нужен перевод статьи]]" changecount="5">
<pre>As with any new partition and RAID array, it’s important to document the mount directory associated with the new LV in the {{{/etc/fstab}}} configuration file. I need to make sure the array gets properly mounted on the {{{/home/book}}} directory the next time this server is booted. To do so, I need to set up the array in the {{{/etc/fstab}}} configuration file.

I don’t need to use ~UUIDs. I could just cite the device file associated with the LV -- in this case, {{{/dev/volgroup1/logvol1}}}. If I choose to use ~UUIDs, I need to generate one using the uuidgen command. Despite the LV UUID shown in the output to the lvdisplay command, I need to set up a dedicated UUID for this purpose, which I save to a text file with the following command:
{{{
uuidgen /dev/volgroup1/logvol1 &gt; uuidlv1
}}}
I then apply the new UUID to the LV device:
{{{
sudo tune2fs -U `cat uuidlv1` /dev/volgroup1/logvol1
}}}
Now I need to add the LV and the {{{/home/book}}} directory to the {{{/etc/fstab}}} configuration file. As command line–based appending requires root administrative access, I first run this:
{{{
sudo su
}}}
I can then add an appropriate line to the end of the {{{/etc/fstab}}} configuration file. This command is a bit dangerous, so I first back up the {{{/etc/fstab}}} configuration file:
{{{
# cp /etc/fstab ~
}}}
I can then add the appropriate line to {{{/etc/fstab}}} with the following command:
{{{
# echo &quot;UUID=`cat uuidlv1` /home/book ext3 defaults 0 2&quot; &gt;&gt; /etc/fstab
}}}
While the exit command is not required, I run that command to leave the administrative prompt. I still need to create a link from the {{{/dev/disk/by-uuid}}} directory, which is easy to do with the following command:
{{{
sudo ln -s /dev/volgroup1/logvol1 /dev/disk/by-uuid/`cat uuidlv1`
}}}
Now I can try the changes with the {{{sudo mount -a}}} command. If it works, I’ll see the {{{/home/book}}} directory mounted on the LV device in the output to the mount command. It’s actually mounted on a LV mapper; the device should be configured on a {{{/dev/mapper/volgroup1-logvol1}}} device. The mounts in {{{/etc/fstab}}} should also now work the next time the system is booted.

!См. далее
*[[Ссылки|Ссылки по LVM]]


</pre>
</div>
<div title="Конфигурирование сервера Apache в Ubuntu" modifier="Яковлев Иван" created="200906200139" modified="200907021257" tags="[[Настройка Apache]] [[TODO - нужен перевод статьи]] TODO slicehost" changecount="11">
<pre>*''Описание''
*''Настройки по умолчанию''
*''файл {{{/etc/apache2/ports.conf}}}''
*''файл {{{/etc/apache2/apache2.conf}}}''
**''Timeout''
**''~KeepAlive''
**''~MaxKeepAliveRequests''
**''~KeepAliveTimeout''
**''prefork MPM''
**''~ServerName''
**''~HostnameLookups''
*''Настройки безопасности сервера -- файл /etc/apache2/conf.d/security''
**''~ServerTokens''
**''Подпись сервера (~ServerSignature)''
*''Заключение''

!Описание
As we know from the [[previous article|Описание окружения Apache применительно к Ubuntu]], Ubuntu Intrepid uses a different layout from other non-Debian based systems - let's move on and take a look at the main apache2.conf and ports.conf.

We're not actually going to change a lot at this point, just look at the main settings and see what they mean and what a change will actually do.

!Настройки по умолчанию
Why no specific changes to the default?

Well, it's difficult to give a definitive configuration as there are so many variables to consider such as expected site traffic, Slice size, site type, etc.

Remember that it is very unlikely the default Apache configuration will be ideal for your Slice. Don't be intimidated by the thought of 'optimising' the install - following the next couple of articles will allow you to understand the meaning behind the concepts.

You'll also find the same things apply to any web server - they may call them different things, but the concepts remain the same. My advice is very simple: experiment. Find what works best on your setup.

!файл /etc/apache2/ports.conf
Let's start with the ports.conf file:
{{{
NameVirtualHost *:80
Listen 80

&lt;IfModule mod_ssl.c&gt;
    # SSL name based virtual hosts are not yet supported, therefore no
    # NameVirtualHost statement here
    Listen 443
&lt;/IfModule&gt;
}}}
Well, that seems fair enough. Port 80 is the standard HTTP port to listen on and if you have the ssl module loaded, then it will also listen on port 443 (HTTPS).

Also, name based virtual hosts are enabled by default, for HTTP requests made on all interfaces ({{{*}}}) on port 80, per the {{{NameVirtualHost}}} directive. Note the comment concerning the lack of support for SSL name based virtual hosts — in practical terms this means that you will need an additional public IP assigned to your Slice for each additional ~SSL-enabled site that you intend to host on the same Slice.

Configuring Apache to listen on another port, say 8080, is as simple as adding:
{{{
Listen 8080
}}}
Once that is added to the file and Apache restarted, it would listen on port 8080. You would want to change the port specified in the ~NameVirtualHost directive to match.

!файл /etc/apache2/apache2.conf
now open up the main Intrepid Apache config file:
{{{
sudo nano /etc/apache2/apache2.conf
}}}
I won't list the contents here but, if you are not familiar with the settings, have a read of the comments. I find them very informative and straight to the point.

You may be surprised how well config files are documented. I always recommend giving them a read - sure, they may not make a lot of sense to begin with but as time goes by you will be able to glance at them and know what to change.

Anyway, let's look at some of the main settings and what they mean:

!!Timeout
Default:
{{{
Timeout 300
}}}
This sets (in simple terms) the maximum time, in seconds, to wait for a request, action it and the response to the request.

The default is deliberately set high to allow for varied situations. You can reduce this to something more sane, such as 45 or even lower. A decrease may also help in reducing the effects of a DOS attack.

!!~KeepAlive
Default:
{{{
KeepAlive On
}}}
Keep this set at 'On' as it allows for persistent connections to a client so each file, image, etc is not requested with a new connection. This allows for more efficiency. Define the ~KeepAlive settings as shown below:

!!~MaxKeepAliveRequests
Default:
{{{
MaxKeepAliveRequests 100
}}}
Now we have our persistent connection, set the maximum number of requests per connection. Keep this high more maximum efficiency. If you have a site with lots of images, javascripts, etc, try increasing this to 200.

!!~KeepAliveTimeout
Default:
{{{
KeepAliveTimeout 15
}}}
So how long does the persistent connection wait for the next request? The default setting is very high and can easily be reduced to 2 or 3 seconds. If no new requests are received during this time the connection is killed.

What does this mean? Well, once a connection has been established and the client has requested the files needed for the web page, this setting says &quot;sit there and ignore everyone else until the time limit is reached or you get a new request from the client&quot;.

Why would you want a higher time? In cases where there will be a lot of interactivity on the site. However, in most cases, people will go to a page, read it for a while and then click for the next page. You don't want the connection sat there doing nothing and ignoring other users.

!!prefork MPM
During the [[Установка Apache и PHP]] we selected ''apache2-mpm-prefork'' and not ''apache2-mpm-worker''. If you want to know more about the differences between the two I will point you towards the [[official Apache docs|http://httpd.apache.org/docs/2.2/]] (which are actually very good).
Default:
{{{
&lt;IfModule mpm_prefork_module&gt;
    StartServers          5
    MinSpareServers       5
    MaxSpareServers      10
    MaxClients          150
    MaxRequestsPerChild   0
&lt;/IfModule&gt;
}}}
Again, it's difficult to give a suggestion here as to what is best for your site but have a read of the definitions below and see if anything could be improved when you consider what your site(s) serves.
*''~StartServers:'' number of child server processes created at startup
*''~MinSpareServers:'' minimum number of child server processes not doing anything (idle).
*''~MaxSpareServers:'' maximum number of child server processes not doing anything (idle) — any more than the maximum will be killed.
{{note{
''ЗАМЕЧАНИЕ:''
Don't set Max lower than Min, but Apache will ignore silly numbers here and set the Max at Min+1.
}}}
*''~MaxClients:'' sets the maximum simultaneous requests that Apache will handle. Anything over this number will be queued until a process is free to action the request. 
{{note{
''ЗАМЕЧАНИЕ:''
~MaxClients is not the same as the maximum number of visitors you can have. It is the maximum requests.

Remember the ~KeepAliveTimeout? This was set low so the next request can be actioned and the original (now 'idle') client will still be sat there reading your webpage — the new (active) request will be actioned or, if the ~MaxClients limit has been reached, will be queued ready for the next available process.

In most cases, the client is not 'active'. Take this page, for example: you requested it (using an active process) and then spent a while reading it which uses no processes — you are 'idle' (as far as the server is concerned!).
}}}
*''~MaxRequestsPerChild:'' sets how many requests a child process will handle before terminating. The default is zero, which means it will never die.

Why change this if the Max numbers are set as shown above? Well, it can help in managing your Slice memory usage.

If you change the default you give a child a finite number of actions before it will die. This will, in effect, reduce the number of processes in use when the server is not busy. Thus freeing memory.

Freeing it for what though? If other software needed memory then it would also need it when the server is under load. It is unlikely you will have anything that requires memory only when the server is quiet.

!!~ServerName
Default: Not Set

The ~ServerName is usually a hostname or a FQDN (Fully Qualified Domain Name). If you followed the [[Установка Apache и PHP]] and ~PHP5 article, you will have already set the ~ServerName configuration.

If you fail to set the ~ServerName then on an Apache restart you will see the following warning:
{{{
apache2: Could not reliably determine the server's fully qualified domain name, \
using 127.0.0.1 for ServerName
}}}
To stop the warning and set the ~ServerName, add the following to the apache2.conf:
{{{
ServerName demo
}}}
Remember the test slice has a hostname of '''demo''' - set this to your hostname or FQDN.

!!~HostnameLookups
Default:
{{{
HostnameLookups Off
}}}
If you want happy users and to save traffic, keep this at Off.

Setting this to 'On' will enable DNS lookups so host names can be logged (it performs a reverse DNS check), setting it to 'Double' will not only perform the reverse DNS check it will then check the resulting hostname.

All a bit much and if you desperately need hostname information from your visitors it is advised to use logresolve (located in {{{/usr/sbin/logresolve}}}) for this purpose. A small explanation can be found [[here|http://httpd.apache.org/docs/2.2/programs/logresolve.html]].

!Настройки безопасности сервера -- файл /etc/apache2/conf.d/security
It's a good idea to review a couple of security-related settings for Apache — ~ServerTokens and ~ServerSignature — which in the Ubuntu Intrepid Apache layout are stored by default in the 'security' config file:
{{{
/etc/apache2/conf.d/security
}}}

!!~ServerTokens
Default:
{{{
ServerTokens Full
}}}
The ~ServerTokens setting will dictate how much information is sent in the Headers with regard to Apache version and modules in use.

The default (Full) would send something like this:
{{{
Apache/2.2.9 (Ubuntu) PHP/5.2.6-2ubuntu4 with Suhosin-Patch Server
}}}
Does this make a difference? Well, yes. If we can suppress that information it will make it harder for someone to find an exploit.

It does not make the actual install any more secure but all someone has to do right now is look for an exploit in Ubuntu Apache 2.2.9 and so on. Why make it easy for them?

The options are (with example outputs):
*''Full'': Apache/2.2.9 (Ubuntu) PHP/5.2.6-2ubuntu4 with ~Suhosin-Patch
*''OS'': Apache/2.2.9 (Ubuntu) Server
*''Minimal'': Apache/2.2.9 Server
*''Minor'': Apache/2.2 Server
*''Major'': Apache/2 Server
*''Prod'': Apache Server

It's up to you what level of info you want to give out. I prefer setting ~ServerTokens to Prod.

!!Подпись сервера (~ServerSignature)
Default:
{{{
ServerSignature On
}}}
Server generated pages, such as 404 pages or directory listings, can contain a footer line which includes server information and can include the ~ServerAdmin email address.

If you navigate to your Slice IP address and a non-existent page, you will see a 404 Page not found page with the footer information:

{{textAlignCenter{
[img[images/articles/apache-404-footer.jpg]]
}}}
The options are:

*''Off:'' Produces no footer
*''On:'' Produces footer information (at a level defined by the ServerTokens setting)
*''Email:'' Adds an email link to the information (email address is defined in the vhosts file with the ServerAdmin setting)
{{note{
''ЗАМЕЧАНИЕ:''
Keep in mind that many settings can be overridden by a virtual host file.

If you disable the ServerSignature in the 'security' config file, but a virtual host file has:
{{{
ServerSignature On
}}}
Then the global setting will be overridden and a footer will still be displayed on 404 pages, etc. for any sites associated with that virtual host.
}}}

!Заключение
There are some simple steps in this article, but ones which I believe are quite useful and aid in increasing the efficiency of your Slice and assist in the overall security of your Slice.

!Ссылки
*[[Оригинал статьи на slicehost.com (часть 1)|http://articles.slicehost.com/2008/12/11/ubuntu-intrepid-apache-configuration-1]]
*[[Оригинал статьи на slicehost.com (часть 2)|http://articles.slicehost.com/2008/12/11/ubuntu-intrepid-apache-configuration-2]]


</pre>
</div>
<div title="Концепция логических томов" modifier="Яковлев Иван" created="200906121957" modified="200906122011" tags="LVM [[TODO - нужен перевод статьи]]" changecount="5">
<pre>The concept of logical volumes makes it easier to increase or reduce the size of a filesystem after Linux is installed. For example, since extra space is available on the {{{/var}}} directory volume, and more space is needed for {{{/home}}} directories, you can use the logical volume tools to help you reassign the space. Alternatively, you can add a new physical disk and allocate its storage capacity using logical volume tools to an existing {{{/home}}} directory partition.

In a logical volume, physical hard disk partitions are set up in a bunch of equal-sized chunks known as physical extents (~PEs). These ~PEs from one or more partitions are mapped to logical extents (~LEs), which are then organized into logical volumes (~LVs). Volume groups can then be created from the space available in a LV. But that’s a mouthful, especially if you’re not familiar with logical volume concepts, so here are some  definitions:
*Физический том (Physical volume -- ''PV'') A standard primary or logical partition configured to a logical volume format type.
*Физический экстент (Physical extent -- ''PE'') A chunk of disk space; every PV is divided into a number of equal sized ~PEs.
*Группа (Volume group -- ''VG'') A group of ~PVs; configures the pool of space for logical volumes.
*Логический экстент (Logical extent -- ''LE'') A chunk of disk space; every LE is mapped to a specific PE.
*Логический том (Logical volume -- ''LV'') A group of ~LEs; you can mount a filesystem such as {{{/home}}} and {{{/var}}} on a LV.

While it’s easiest to create logical volumes during the Ubuntu installation process, it’s not always possible. To set up a logical volume, you need to create a new PV using a command such as {{{pvcreate}}}, assign the space to a VG with a command such as vgcreate, and allocate the space from some part of available ~VGs to a LV with a command such as {{{lvcreate}}}.

To add space to an existing LV, you need to add free space from an existing VG with a command such as lvextend. If you have no existing VG space, you’ll need to add to it with unassigned PV space with a command such as vgextend. If all your ~PVs are taken, you might need to create a new PV from an unassigned partition or hard drive with the {{{pvcreate}}} command.

But that might sound like a lot of gobbledygook to those unfamiliar with logical volumes, so the following sections break down the process. Just be sure to install the ''lvm2 package'' for access to required commands, like so:
{{{
sudo apt-get install lvm2
}}}
A substantial number of files reside in the ''lvm2 package''. The dmsetup package is also installed as a dependency, which also configures the device mapper for creating logical volumes from volume groups.

As an overview, logical volume configuration files are stored in the {{{/etc/lvm}}} directory. For ~PV-related commands, run the ls {{{/sbin/pv}}}* command. For ~VG-related commands, run the {{{ls /sbin/vg*}}} command. For ~LV-related commands, run the {{{ls /sbin/lv*}}} command. These files are described in more detail in the following sections.

Before you continue, run the following command to add the appropriate module:
{{{
sudo modprobe dm-mod
}}}
Otherwise, you’ll have problems when creating a logical volume. A couple of other modules are required for certain actions related to copies  and snapshots of logical volumes:
{{{
sudo modprobe dm-mirror
sudo modprobe dm-snapshot
}}}

!См. далее
*[[Создание физических томов]]


</pre>
</div>
<div title="Кэш установленных пакетов" modifier="Яковлев Иван" created="200906032342" modified="200906040918" tags="[[Установка ПО в Ubuntu]]" changecount="4">
<pre>Каждый раз когда вы устанавливаете новый пакет - он сохраняется в директории {{{/var/cache/apt/archives/}}}

{{textAlignCenter{
[img[images/articles/apt-cache.png]]
}}}
Что это означает?
*Во-первых, если вы удалите, например, Krusader, и попытаетесь его поставить заново, то вам не придется ничего скачивать.
*Во-вторых, если для вас критично место на жестком диске и срочно нужно очистить его, то вы можете удалить файлы из кэша. Например, после установки системы и всех обновлений у меня размер уже вырос до 300Мб. Позже я покажу как удалить весь кеш одной командой, а сейчас он нам еще понадобится.

!См. далее
*[[Удаление ненужных зависимостей]]


</pre>
</div>
<div title="Листинг скрипта для автоматизации настроек пользователей" modifier="Яковлев Иван" created="200906152340" modified="200906152340" tags="listing" changecount="2">
<pre>{{{
#!/bin/bash
#Скрипт управляет виртуальными пользователями vsftpd
#По вопросам, предложениям и замечаниям по данному скрипту пишите по адресу: 0--0@list.ru

ftp_login= #Логин пользователя базы данных vsftpd
mysqlbase=vsftpd #Имя базы данных vsftpd
ftp_path=&quot;/srv/vsftpd/&quot; #Путь к директориям пользователей vsftpd
ftp_backup_dir=&quot;/srv/vsftpd_back/&quot; #Путь к резервной копии директорий пользователей
ftp_group= #Группа vsftpd
passdigit=6 #Минимальная длинна пароля пользователя в символах

function input_correct_pass { #Функция проверяет корректность пароля сервера vsftpd
corr=1
while [ &quot;$corr&quot; -ne 0 ];
do
echo &quot;Введите пароль пользователя базы ftp&quot;
read -s ftp_pass
mysql -u $ftp_login --password=$ftp_pass -e exit &amp;&gt; /dev/null
corr=$?
if [ &quot;$corr&quot; -ne 0 ]; then
clear
echo &quot;Вы ввели неправильный пароль!&quot;
echo
fi

done
}

function cor_usr_pass { #Функция проверяет корректность пароля пользователя
numb=${#usr_pass}
while [ -z &quot;$usr_pass&quot; ] || [ &quot;$numb&quot; -lt &quot;$passdigit&quot; ]
do
if [ -z &quot;$usr_pass&quot; ]; then
echo  &quot;Пароль нулевой длинны не допустим&quot;
elif [ &quot;$numb&quot; -lt &quot;$passdigit&quot; ]; then
echo &quot;Длинна пароля должна быть не менее $passdigit символов&quot;
fi
echo &quot;Введите другой пароль&quot;
read -s  usr_pass
numb=${#usr_pass}
done
}

function usr_add { # Функция добавляет нового пользователя в базу vsftpd и создает рабочую директорию
clear
read -p &quot;Введите логин нового пользователя ftp: &quot; ftp_usr
# Данный участок кода проверяет корректность вводимых данных========================================================================================
ctrl_login=`mysql -e &quot;SELECT username FROM accounts WHERE username='$ftp_usr';&quot; -u $ftp_login --password=$ftp_pass -D $mysqlbase`
ctrl_login=${ctrl_login:9}
while [ -z &quot;$ftp_usr&quot; ] || [ &quot;$ctrl_login&quot; == &quot;$ftp_usr&quot; ]
do
if [ -z &quot;$ftp_usr&quot; ]; then
echo &quot;логин не может быть пустым&quot;
elif [ &quot;$ctrl_login&quot; == &quot;$ftp_usr&quot; ]; then
echo &quot;Пользователь существует&quot;
fi
read -p &quot;Введите логин заново: &quot; ftp_usr
ctrl_login=`mysql -e &quot;SELECT username FROM accounts WHERE username='$ftp_usr';&quot; -u $ftp_login --password=$ftp_pass -D $mysqlbase`
ctrl_login=${ctrl_login:9}
done
#====================================================================================================================================================
echo &quot;Введите пароль для нового пользователя ftp:&quot;
read -s usr_pass
cor_usr_pass
mysql -e &quot;INSERT INTO accounts (username, pass) VALUES('$ftp_usr', PASSWORD('$usr_pass'));&quot; -u $ftp_login --password=$ftp_pass -D $mysqlbase&amp;&amp;
mkdir $ftp_path$ftp_usr&amp;&amp;
chown $ftp_login:$ftp_group $ftp_path$ftp_usr&amp;&amp;
chmod 770 $ftp_path$ftp_usr

if [ &quot;$?&quot; -eq 0 ]; then
clear
echo &quot;Пользователь $ftp_usr добавлен успешно&quot;
else
echo &quot;Ошибка добавления пользователя $ftp_usr&quot;
fi

}

function change_pass { #Функция меняет пароль пользователя
read -p &quot;для какого пользователя менять пароль: &quot; ftp_usr
ctrl_login=`mysql -e &quot;SELECT username FROM accounts WHERE username='$ftp_usr';&quot; -u $ftp_login --password=$ftp_pass -D $mysqlbase`
ctrl_login=${ctrl_login:9}
while [ -z &quot;$ftp_usr&quot; ] || [ &quot;$ctrl_login&quot; != &quot;$ftp_usr&quot; ]
do
if [ -z &quot;$ftp_usr&quot; ]; then
echo &quot;логин не может быть пустым&quot;
elif [ &quot;$ctrl_login&quot; != &quot;$ftp_usr&quot; ]; then
echo &quot;Пользователь не существует&quot;
fi
read -p &quot;Введите логин заново: &quot; ftp_usr
ctrl_login=`mysql -e &quot;SELECT username FROM accounts WHERE username='$ftp_usr';&quot; -u $ftp_login --password=$ftp_pass -D $mysqlbase`
ctrl_login=${ctrl_login:9}
done
echo &quot;Введите новый пароль для пользователя $ftp_usr&quot;
read -s usr_pass
cor_usr_pass
mysql -e &quot;UPDATE vsftpd . accounts SET pass=PASSWORD('$usr_pass') WHERE (accounts . username='$ftp_usr');&quot; -u $ftp_login --password=$ftp_pass -D $mysqlbase
if [ &quot;$?&quot; -eq 0 ]; then
clear
echo &quot;Пароль пользователя $ftp_usr успешно изменен&quot;
else
echo &quot;Ошибка изменения пароля для пользователя $ftp_usr&quot;
fi
}

function del_usr { #Функция удаляет существуюсего пользователя, его директорию и делает резервную копию
read -p &quot;Введите логин удаляемого пользователя: &quot; ftp_usr
ctrl_login=`mysql -e &quot;SELECT username FROM accounts WHERE username='$ftp_usr';&quot; -u $ftp_login --password=$ftp_pass -D $mysqlbase`
ctrl_login=${ctrl_login:9}
while [ -z &quot;$ftp_usr&quot; ] || [ &quot;$ctrl_login&quot; != &quot;$ftp_usr&quot; ]
do
if [ -z &quot;$ftp_usr&quot; ]; then
echo &quot;логин не может быть пустым&quot;
elif [ &quot;$ctrl_login&quot; != &quot;$ftp_usr&quot; ]; then
echo &quot;Пользователь не существует&quot;
fi
read -p &quot;Введите логин заново: &quot; ftp_usr
ctrl_login=`mysql -e &quot;SELECT username FROM accounts WHERE username='$ftp_usr';&quot; -u $ftp_login --password=$ftp_pass -D $mysqlbase`
ctrl_login=${ctrl_login:9}
done

mysql -e &quot;DELETE FROM accounts WHERE (username='$ftp_usr');&quot; -u $ftp_login --password=$ftp_pass -D $mysqlbase&amp;&amp;
tar -cvf $ftp_path$ftp_usr$(date +%d%m%Y%).tar $ftp_path$ftp_usr&amp;&amp;
rm -r $ftp_path$ftp_usr&amp;&amp;
mv $ftp_path$ftp_usr$(date +%d%m%Y%).tar $ftp_backup_dir
if [ &quot;$?&quot; -eq 0 ]; then
clear
echo &quot;Пользователь $ftp_usr успешно удален&quot;
else
echo &quot;Ошибка удаления пользователя $ftp_usr&quot;
fi
}

function show_all_users { #Функция показывает всех существующих пользователей vsftpd
clear
mysql -e &quot;SELECT username FROM accounts;&quot; -u $ftp_login --password=$ftp_pass -D $mysqlbase
}

input_correct_pass
clear
echo

chpass=&quot;Изменить_пароль_пользователя&quot;
new_usr=&quot;Создать_нового_пользователя&quot;
rmusr=&quot;Удалить_пользователя&quot;
dback=&quot;Удалить_резервную_копию_каталогов_пользователей&quot;
show_users=&quot;Показать_список_всех_пользователей&quot;
ext=&quot;Выход&quot;

select opt in $chpass $new_usr $rmusr $dback $show_users $ext ; do
if [ &quot;$opt&quot; = &quot;Изменить_пароль_пользователя&quot; ]; then
change_pass
elif [ &quot;$opt&quot; = &quot;Создать_нового_пользователя&quot; ]; then
usr_add
elif [ &quot;$opt&quot; = &quot;Удалить_пользователя&quot; ]; then
del_usr
elif [ &quot;$opt&quot; = &quot;Удалить_резервную_копию_каталогов_пользователей&quot; ]; then
clear&amp;&amp;rm -rfv $ftp_backup_dir*
elif [ &quot;$opt&quot; = &quot;Показать_список_всех_пользователей&quot; ]; then
show_all_users
elif [ &quot;$opt&quot; = &quot;Выход&quot; ]; then
clear
exit
else
clear
echo &quot;Допускаются цифры от 1 до 6&quot;
echo &quot;Для возврата в меню нажмите Enter&quot;
fi
done
}}}</pre>
</div>
<div title="Методы организации массового хостинга" modifier="Яковлев Иван" created="200906191842" tags="[[Народные советы]]" changecount="1">
<pre>!Вопрос
Интересно, что в различной литературе особо подчеркивается, что в случае cgi-скриптов они всегда исполняются не от имени владельца файла скрипта, а с правами пользователя '''nobody''', и использование ''SUID'' скриптов является делом чрезвычайно небезопастным.
!Ответ
Потому что различная литература написана не для админов массовых хостингов.

!Вопрос
Hа самом же деле, оказывается, что на 'массовых хостингах' все скрипты фактически исполняются со столь широкими полномочиями владельца скрипта?
!Ответ
Хитрость заключается в том, что на массовых хостингах требуется в первую очередь разграничить полномочия МЕЖДУ пользователями.

Т.е. скрипт выложенный на сервер юзером vasya должен уметь работать (и читать, и писать) с какими-то данными юзера vasya, но не должен иметь доступа  к данным юзера petya и наоборот. 

Поэтому недопустимо чтобы скрипты обоих этих юзеров выполнялись из-под одного пользователя.

Если пользователь vasya поставил себе глючный скрипт, который взломали и попортили его данные - он сам себе дурак. А если админ позволил юзеру petya намерено  написать такой скрипт, котоорый портит данные юзера vasya и у юзера vasya нет никакой возможности от этого защититься, потому что от этого перестанут работать его собственные скрипты, то виноват админ.

По хорошему счету для каждого юзера нужно заводить двух системных пользователей - одного, который имеет право выкладывать на сервер файлы, а другого, от имени которого выполняются скрипты, и объединять их в группу, чтобы тот, который выкладывает файлы, мог дать право скриптам писать в определенные файлы (скажем сохранять реплики, запощенные в форум) или читать из них (скажем пароли к базе данных). Hо что-то я не знаю ни одного хостинга, где бы с этим заморачивались.

Реально попадались три варианта
#Все скрипты из-под одного юзера (www)
#Скрипты каждого юзера выполняются от его имени, и от этого же имени выкладываются на сервер его данные
#Каждому юзеру по виртуальной машине.

!Ссылки
*[[Оригинал топика|http://www.opennet.ru/base/dev/mass_host_notes.txt.html]]


</pre>
</div>
<div title="Множество проектов и subversion" modifier="Яковлев Иван" created="200906202226" modified="200906202227" tags="[[Настройка Subversion (SVN)]] [[TODO - нужен перевод статьи]] TODO" changecount="2">
<pre>!Описание
TODO

!Ссылки
*[[Оригинал статьи|http://articles.slicehost.com/2007/9/6/multiple-projects-and-subversion]]


</pre>
</div>
<div title="Множество репозитариев и subversion" modifier="Яковлев Иван" created="200906202229" tags="[[Настройка Subversion (SVN)]] [[TODO - нужен перевод статьи]] TODO" changecount="1">
<pre>!Описание
TODO

!Ссылки
*[[Оригинал статьи|http://articles.slicehost.com/2007/9/6/multiple-repositories-and-subversion]]


</pre>
</div>
<div title="Мониторинг web сервера Apache с помощью Cacti" modifier="Яковлев Иван" created="200906052332" tags="[[Установка/настройка Web-сервера]] [[Администрирование Web-сервера]] Статьи TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/monitoring-web-servera-apache-s-pomoshhyu-cacti.html]]



</pre>
</div>
<div title="Мониторинг нагрузки Apache 2" modifier="Яковлев Иван" created="200906182107" modified="200906182120" tags="[[Настройка Apache]]" changecount="7">
<pre>!Описание
Рассмотрим ситуацию: у вас на сервере хостится несколько сайтов работающих через mod_php под Apache 2.x. Вы обнаруживаете, что сервер начинает тормозить. Запускаете top и видите, что верхние строчки занимает процесс apache2 (или httpd). Ваша задача — узнать какой из сайтов и какими запросами грузит сервер. 

!Решение
Первый шаг — разрешить загрузку модуля mod_status и сконфигурировать его в {{{/etc/apache2/mods-available/status.conf}}} или в {{{/etc/apache2/apache2.conf}}} (здесь будут описываться пути и команды применительно к Debian/Ubuntu):
{{{
&lt;IfModule mod_status.c&gt;
    ExtendedStatus On
    &lt;Location /server-status&gt;
        SetHandler server-status
    &lt;/Location&gt;
&lt;/IfModule&gt;
}}}
Можно опционально ограничить доступ к URL /server-status по ~IP-адресу или даже поставить пароль.

Добавляем к любому сайту на сервере путь /server-status и смотрим, что там показывается. Если видим много запросов к какому либо сайту в состоянии «W», то можно предположить, что проблема с этим сайтом. Но это будет лишь гипотеза, так как узнать точно ситуацию по нагрузке, используя данный отчет, невозможно.
{{textAlignCenter{
&lt;html&gt;&lt;a class=&quot;imgLink&quot; href=&quot;images/articles/apache-server-status-screenshot.jpeg&quot; target=&quot;_blank&quot; title=&quot;&quot;&gt;&lt;img src=&quot;images/articles/apache-server-status-screenshot.jpeg&quot; width=&quot;550&quot; alt=&quot;apache-server-status-screenshot.jpeg&quot; /&gt;&lt;/a&gt;&lt;/html&gt;
}}}
Используем хитрый ход. Установим модуль mod_perl:
{{{
sudo aptitude install libapache2-mod-perl2 apache2-prefork-dev
}}}
Пакет apache2-prefork-dev нужен для последующей установки перловых модулей. Далее запустим cpan и установим пару модулей:
{{{
cpan&gt; install Sys::Proctitle
cpan&gt; install Apache2::ShowStatus
}}}
В файл {{{/etc/apache2/mods-available/perl.conf}}} добавим следующие строчки:
{{{
&lt;IfModule mod_perl.c&gt;
    PerlModule Apache2::ShowStatus
    PerlInitHandler Apache2::ShowStatus
&lt;/IfModule&gt;
}}}
Проставим линк на этот файл и перезагрузим Apache:
{{{
ln -s /etc/apache2/mods-available/perl.conf /etc/apache2/mods-enabled/
apache2 -t
invoke-rc.d apache2 restart
}}}
Смотрим что из этого получилось:
{{{
ps -o user,pid,%cpu,args --sort=-%cpu -u www-data | egrep '^USER|httpd' | grep -v grep

USER       PID %CPU COMMAND
www-data 14039  0.6 httpd: GET /notices_item/????? HTTP/1.0
www-data 14073  0.5 httpd: GET /notice/???????.html HTTP/1.0
www-data 14069  0.5 httpd: GET /r_9/ HTTP/1.0    
www-data 14075  0.5 httpd: GET /notice/???????.html HTTP/1.0
}}}
Я заменил часть ~URL-ов вопросиками из соображений конфиденциальности.

Ну что же, это неплохо, теперь мы видим отсортированные по полю %CPU процессы Apache, а так же видим, какой запрос они выполняют в данный момент. Но мы не видим к какому сайту относятся эти запросы. Придеться немного подпатчить модуль {{{Apache2::ShowStatus}}} в файле {{{/usr/local/share/perl/5.8.8/Apache2/ShowStatus.pm}}}:
{{{
--- ShowStatus.pm.orig	2009-01-22 14:19:26.122058102 +0300
+++ ShowStatus.pm	2009-01-22 14:21:01.030847967 +0300
@@ -16,7 +16,7 @@
   my $r=shift;

   $r-&gt;pnotes( 'ProctitleObject'=&gt;
-	      Sys::Proctitle-&gt;new( 'httpd: '.$r-&gt;the_request ) );
+             Sys::Proctitle-&gt;new( 'httpd: ['.$r-&gt;get_server_name().'] '.$r-&gt;the_request ) );
   return Apache2::Const::DECLINED;
 }
}}}
Перезагружаем Apache:
{{{
sudo /etc/init.d/apache2 restart
}}}
Смотрим, что получилось:
{{{
# ps -o user,pid,%cpu,args --sort=-%cpu -u www-data | grep httpd | grep -v grep
www-data 16927  3.3 httpd: [www.????????.ru] GET /img_code.html HTTP/1.0
www-data 16885  3.2 httpd: [76.?????????.ru] GET /notices_item/???????/user_register/ HTTP/1.0
www-data 16921  1.0 httpd: [www.??????.ru] GET /products_item/?????? HTTP/1.0
www-data 16933  0.5 httpd: [www.????????.ru] GET /notice/????????.html HTTP/1.0
www-data 16878  0.5 httpd: [??????????.ru] GET /main_???????? HTTP/1.0
www-data 16930  0.2 httpd: [www.??????????.ru] GET /notice/??????????.html?sd=?????????????????????????????? HTTP/1.0
}}}
Ну вот, теперь мы видим и сайт, к которому пришел запрос, и сам запрос.

Кто еще какие способы использует для мониторинга нагрузки на хостинге в окружении ~Apache2 + mod_php5?

!Комментарии
{{note{
Здравствуйте. насколько это действительно полезно?
Дело в том что в web большая часть запросов работает в диапазоне 40-500 мс. Если апач не стартует новый процесс при каждом обращении, то %cpu будет неко средней температурой по больнице. Да, таким образом можно отследить тяжёлые запросы, которые долго исполняются. Но, на практике, таких запросов очень мало.
Более логична следующая схема: надо измерять время обработки запроса. Естественно, что время отдачи модемному клиенту никого не интересует в рамках настройки производительности. Если апач выступает в качестве backend для nginx, то в качестве характеристики производительности запроса может выступать время выполнения запроса, которое пишется в access_log. При больших нагрузках писать в access log всё подряд непозволительная роскошь. Здесь помогает возможность апача писать в пайп логи. Пишем в perlscript access log, фильтруем по категории и времени исполнения. остаток периодически мониторим и думаем причины.

В php-fpm есть довольно занятная возможность: писать slow log с backtrace затупивших запросов.

В качестве сенсора на мониторинг хорошо подходит измерение времени ответа на основных страницах (помните про cookies!). Мне больше всего нравится реализация со сбором информации в zabbix. В случае если запросы начинают тупить, мы получаем тревогу на sms и экран специалиста по мониторингу.
также можно сделать сенсор для nagios и собирать статистику в munin или cacti
----

Апач спрятан за nginx, nginx в свои логи пишет $upstream_response_time. Логи читаются скрптиком на python.
}}}

!Ссылки
*[[Оригинал статьи|http://blog.antage.name/posts/мониторинг-нагрузки-apache-2.html]]


</pre>
</div>
<div title="Монтирование и размонтирование дисков" modifier="Яковлев Иван" created="200906031900" modified="200906031904" changecount="6">
<pre>!Монтирование стандартной файловой системы
Чтобы вручную смонтировать файловую систему имеющуюся в списке файловых систем (в файле {{{/etc/fstab}}}), например {{{/var}}} или {{{/usr}}} -- передайте в качестве параметра команды [[mount(8)|TODO]] имя файловой системы, которую Вы хотите смонтировать:
{{{
# mount /usr
}}}

!Монтирование всех файловых систем перечисленных в файле {{{/etc/fstab}}}.
Если необходимо смонтировать все разделы перечисленные в файле {{{/etc/fstab}}} со всеми заданными для них параметрами используется флаг {{{–a}}}:
{{{
# mount -a
}}}

!Монтирование в нестандартные локации.
Если необходимо смонтировать файловую систему в другую точку, обычно это выполняется при установке нового диска, используйте имя монтируемого устройства и местоположение точки монтирования. Например, если раздел {{{/usr}}} находится на устройстве {{{/dev/ad0s1e}}}, и нам необходимо смонтировать его в {{{/mnt}}}, то используем команду:
{{{
# mount /dev/ad0s1e /mnt
}}}

!Монтирование USB дисков для конкретного пользователя.
По умолчанию только администратор (''root'') может монтировать файловые системы и он же является владельцем всех не Unix-like файловых систем. Если необходимо, назначить владельцем смонтированной файловой системы ~FAT32, NTFS или ~ISO9660 некоторого пользователя  с именем username и группой username, используйте флаги {{{–u}}} для задания имени пользователя и {{{–g}}} для задания группы:
{{{
# mount -t msdosfs -u username -g username /dev/da0 /mnt
}}}

!Монтирование CD дисков.
~FreeBSD, Ubuntu предоставляет специальную точку монтирования {{{/cdrom}}} для CD дисков. Для CD дисков используется файловая система ISO 9660 (для DVD дисков может использоваться файловая система UFS). Вот пример монтирования CD диска в {{{/cdrom}}}:
{{{
# mount -t cd9660 /dev/acd0 /cdrom
}}}

!Размонтирование устройств.
{{{
# umount /usr
}}}


</pre>
</div>
<div title="Навигация по каталогам" modifier="Яковлев Иван" created="200906111446" modified="200907010008" tags="[[Команды Unix]] slider" changecount="4">
<pre>*[[Тильда (~)|Тильда (~) - домашний каталог пользователя]]
*[[Точка . и две точки ..]]
*[[Пути (Paths)]]
*[[pwd|pwd - показать путь к текущей директории]]
*[[cd|cd - сменить текущую дирректорию]]</pre>
</div>
<div title="Народные советы" modifier="Яковлев Иван" created="200906062103" modified="200906191934" tags="slider [[Дополнительные материалы]]" changecount="6">
<pre>#[[Советы по Ubuntu]]
#[[Советы по SSH]]
#[[Советы по Apache]]
#[[Советы по MySQL]]
#[[Советы по SVN]]
#[[Советы по Tac]]
#[[Рекомендации|Рекомендации по созданию больших web-проектов]]
#[[МетодыМассовогоХостинга|Методы организации массового хостинга]]</pre>
</div>
<div title="Настраиваем VPN соединение в Linux" modifier="Яковлев Иван" created="200906052355" tags="[[Установка/настройка сервера]] VPN Статьи TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/nastraivaem-vpn-soedinenie-v-linux.html]]



</pre>
</div>
<div title="Настройка Apache" modifier="Яковлев Иван" created="200906181739" modified="200906210102" tags="[[Установка/настройка Web-сервера]] slider" changecount="18">
<pre>''Установка:''
*[[Установка сервера Apache]]
*[[Установка Apache и PHP]]
*[[Окружения Apache в Ubuntu|Описание окружения Apache применительно к Ubuntu]]
''Конфигурирование:''
*[[Конфигурирование в Ubuntu|Конфигурирование сервера Apache в Ubuntu]]
*[[Настройка виртуальных хостов|Настройка виртуальных хостов в Apache]]
*[[Типы виртуальных хостов|Настройка различных типов виртуальных хостов]]
''Безопасность:''
*[[Создание SSL сертификатов|Создание SSL сертификатов для связки Apache и mod_ssl]]
*[[Apache в среде chroot|Запуск web сервера apache2 в среде chroot в Debian и Ubuntu]]
*[[Особенности режима chmod 2770|Ньюансы безопасности web-хостинга и режим chmod 2770]]
''Обслуживание:''
*[[Мониторинг нагрузки|Мониторинг нагрузки Apache 2]]</pre>
</div>
<div title="Настройка DynDNS сервиса" modifier="Яковлев Иван" created="200906171849" modified="200906191420" tags="MainMenu slider" changecount="8">
<pre>#[[Стандартная настройка|Стандартный алгоритм настройки DynDNS сервиса]]
#[[Устранение проблем|Устранение проблем в работе сервиса DynDNS]]
#[[НастройкаФорвордингаПортов|Настройка форвординга портов (PortForwarding)]]
#[[НастройкаDynDNSнаUbuntu|Настройка сервиса DynDNS для Ubuntu]]</pre>
</div>
<div title="Настройка MySQL" modifier="Яковлев Иван" created="200906182053" modified="200906231548" tags="[[Установка/настройка Web-сервера]] slider" changecount="3">
<pre>''Установка''
*[[Установка MySQL|Установка MySQL в Ubuntu]]
''Настройка''
*TODO
''Безопасность''
*[[Защищаем MySql. Шаг за шагом]]</pre>
</div>
<div title="Настройка Nginx" modifier="Яковлев Иван" created="200906200003" modified="200906232317" tags="[[Установка/настройка Web-сервера]] slider" changecount="20">
<pre>''Стандартная установка:''
*[[Установка Nginx через aptitude]]
''Установка из исходников:''
*[[Установка Nginx из исходников|Установка Nginx из исходных кодов]]
*[[Настройка автозапуска|Настройка автоматическго запуска nginx]]
*[[Настройка окружения для Ubuntu|Настройка окружения nginx для Ubuntu]]
''Конфигурирование:''
*[[Начальное конфигурирование|Начальное конфигурирование Nginx]]
*[[Настройка виртуальных хостов]]
''Примеры конф. файлов''
*[[Пример конфига nginix сервера|Пример конфигурации nginix сервера]]
''Безопасность:''
*[[Защита от DoS-атак в nginx|Защита от DoS атак в nginx]]
''Дополнительно''
*[[Nginx + Memcached|Nginx and Memcached, a 400proc boost]]</pre>
</div>
<div title="Настройка OpenVPN на Ubuntu Server" modifier="Яковлев Иван" created="200906191854" modified="200906191854" tags="[[Установка/настройка сервера]] [[Администрирование сервера]]" changecount="2">
<pre>Объединение центрального офиса с филиалами, складами и т.д. в единую сеть - это то, с чем приходится довольно часто сталкиваться администратору сети. Объединять сети можно &quot;хардвардным&quot; способом на железяках (Cisco, ~D-Link, etc) и &quot;программным&quot; на серваках под разными ОС (Windows, Linux, BSD). При наличии сервера на железяки можно не разоряться, а воспользоваться тем что есть, тем более что функционал в этом случае будет более широкий. В связи с планирующимся расширением фирмы, я решил заранее выбрать и обкатать наиболее подходящую схему объединения офисов. 

Немного погуглив, остановился на ~OpenVPN, как на более защищенном и не особо замороченом способе. Дистрибутивом взял Ubuntu Server 8,04 i386 т.к. очень хотелось пощупать Убунту в виде сервера и посмотреть на что она способна. Экспериментировал в виртуальных сетях под ~VMware Server.  

Схема соединения сетей следующая:
{{{
        192.168.120.0 &lt;serv1&gt; 10.0.0.0 &lt;serv2&gt; 192.168.110.0
}}}
На каждом сервере поднят межсетевой экран iptables и nat. Для того, чтобы серверы могли устанавливать ПО из реальной глобальной сети, я подключал к ним третий bridged интерфейс. Далее в конфигурационных файлах я его упоминать не стал.

!Устанавливаем сервер (serv1)
После нетривиальной установки, которую не буду описывать, конфигурируем сетевые интерфейсы:
{{{
        sudo cat /etc/network/interfaces

        auto lo
        iface lo inet loopback

        auto eth0
        iface eth0 inet static
        address 10.0.0.10
        netmask 255.255.255.0

        auto eth1
        iface eth1 inet static
        address 192.168.120.20
        netmask 255.255.255.0
}}}
Делаем из него роутер путем добавления в {{{/etc/sysctl.conf}}} строчки:
{{{
        net.ipv4.ip_forward=1
}}}
Настраиваем путь к репозитариям из которых будем устанавливать ПО:
{{{
        sudo cat /etc/apt/sources.list

        deb http://ru.archive.ubuntu.com/ubuntu/ hardy main contrib non-free restricted universe multiverse
        deb-src http://ru.archive.ubuntu.com/ubuntu/ hardy main contrib non-free restricted universe multiverse

        deb http://ru.archive.ubuntu.com/ubuntu/ hardy-updates main contrib non-free restricted universe multiverse
        deb-src http://ru.archive.ubuntu.com/ubuntu/ hardy-updates main contrib non-free restricted universe multiverse

        deb http://ru.archive.ubuntu.com/ubuntu/ hardy-security main contrib non-free restricted universe multiverse
        deb-src http://ru.archive.ubuntu.com/ubuntu/ hardy-security main contrib non-free restricted universe multiverse
}}}
Дальше устанавливаем дополнительное ПО, предварительно обновившись:
{{{
        sudo aptitude update
        sudo aptitude upgrade
        sudo aptitude install console-cyrillic mc traceroute openvpn vsftpd
}}}

Для работы ~OpenVPN необходимо создать сретификаты и конфигурационный файл openvpn.conf.
Для генерирования сертификатов переходим в каталог easy-rsa:
{{{
        sudo cd /usr/share/doc/openvpn/examples/easy-rsa/2,0
}}}
Заполняем шаблонный файл с пременными vars. Я заполнил только последнюю часть с данными о фирме, городе и т.п., плюс изменил директорию с ключами:
{{{
        export KEY_DIR=&quot;/etc/openvpn/keys&quot;
}}}
Генерируем сертификаты:
{{{
        sudo ./build-dh
        sudo ./pkitool -initca
        sudo ./pkitool -server server
        sudo ./pkitool client
}}}
Созданные сертификаты должны появиться в вышеуказанной папке, если конечно вы ее предварительно создали.

Дальше пишем конфиг сервера. Читал разные статьи на эту тему, наступал на грабли, но в итоге плюнул и без проблем все сделал по примерам, которые лежат в папке {{{/usr/share/doc/openvpn/examples/sample-config-files}}}. В итоге получился такой конфиг:
{{{
        sudo cat /etc/openvpn/openvpn.conf

        dev tun
        tls-server
        proto udp
        port 3333
        comp-lzo
        persist-tun
        persist-key
        
        # указываем узловые точки виртуальной сети
        ifconfig 10.1.0.1 10.1.0.2
        # добавляем маршрут к локальной сети филиала
        route 192.168.110.0 255.255.255.0

        dh /etc/openvpn/keys/dh1024.pem
        ca /etc/openvpn/keys/ca.crt
        cert /etc/openvpn/keys/server.crt
        key /etc/openvpn/keys/server.key

        log /var/log/openvpn.log
        verb 3
}}}
Все готово, делаем рестарт сервера и убеждаемся в том, что все ОК:
{{{
        sudo /etc/init.d/openvpn restart
        sudo ps -ely | grep openvpn
}}}
Для полного счастья добавляем правила в  iptables (приведенный ниже вариант может отличаться, в зависимости от вашей конфигурации):
{{{
        iptables -A INPUT -p udp -dport 3333 -j ACCEPT
        iptables -A INPUT -i tun0 -j ACCEPT
        iptables -A FORWARD -i tun0 -j ACCEPT
        iptables -A FORWARD -o tun0 -j ACCEPT
}}}

!Установка клиента (serv2)
В плане установки и настройки системы проделываем то же самое, что и с предыдущем сервером.
{{{
        sudo cat /etc/network/interfaces

        auto lo
        iface lo inet loopback

        auto eth0
        iface eth0 inet static
        address 10.0.0.20
        netmask 255.255.255.0

        auto eth1
        iface eth1 inet static
        address 192.168.110.10
        netmask 255.255.255.0
}}}
Сертификаты нужно скопировать с центрального сервера. Я для этих целей поднимал там ftp.
{{{
        dev tun
        tls-client
        remote 10.0.0.10
        proto udp
        port 3333
        comp-lzo
        persist-tun
        persist-key

        # указываем узловые точки виртуальной сети
        ifconfig 10.1.0.2 10.1.0.1
        # добавляем маршрут к локальной сети офиса
        route 192.168.120.0 255.255.255.0

        dh /etc/openvpn/keys/dh1024.pem
        ca /etc/openvpn/keys/ca.crt
        cert /etc/openvpn/keys/client.crt
        key /etc/openvpn/keys/client.key

        log /var/log/openvpn.log
        verb 3
}}}

Запускаем:
{{{
        sudo /etc/init.d/openvpn restart
}}}

Правим фаервол:
{{{
        iptables -A INPUT -i tun0 -j ACCEPT
        iptables -A FORWARD -i tun0 -j ACCEPT
        iptables -A FORWARD -o tun0 -j ACCEPT
}}}
Пингуем хосты противоположных сетей по их внутренним  адресам с обоих серверов и с клиентских машин каждой локальной сети.
Итоговые впечатления: все стабильно, секьюрно и удобно, а Ubuntu Server может быть достойной заменой Debian.

!Ссылки
*[[Оригинал статьи|http://www.opennet.ru/base/net/openvpn_office.txt.html]]


</pre>
</div>
<div title="Настройка PHP" modifier="Яковлев Иван" created="200906181858" modified="200906231535" tags="[[Установка/настройка Web-сервера]] slider" changecount="11">
<pre>''Установка''
*[[Установка PHP5]]
*[[Установка PHP из исходников|http://ru.php.net/install.unix]]
*[[Доступные опции ./configure|http://ru.php.net/manual/ru/configure.about.php]]
*[[PHP-FPM (FastCGI режим)|Настройка PHP-FPM (FastCGI Process Manager)]]
''Конфигурация''
*TODO
''Безопасность''
*[[Вопросы безопасности PHP|http://ru.php.net/manual/ru/security.php]]</pre>
</div>
<div title="Настройка PHP-FPM (FastCGI Process Manager)" modifier="Яковлев Иван" created="200906181859" modified="200907021304" tags="[[Настройка PHP]]" changecount="69">
<pre>*''Описание''
*''Установка ~PHP-FPM на Centos/Fedora/Debian/Ubunru''
**''Подготовка''
**''Компиляция и установка''
**''Ротация лога''
**''init и автозапуск''
**''См. также''
*''Ссылки''

!Описание
~PHP-FPM, замечательный патч, созданный и поддерживаемый Andrei Nigmatulin.

Предназначен он, для того, что бы довести имеющуюся поддержку CGI интерфейса у PHP до состояния, когда его можно будет использовать в серьезных проектах. Официальная версия PHP, стабильно работает только под Apache, через интерфейс взаимодействия модулей. И хотя Apache является стандартом де-факто в Интернете, популярность таких вебсерверов, как Nginx и Lighttpd не стоит преуменьшать. Достоинства этих серверов максимально проявляются в отдаче статики, но оба они умеют взаимодействовать со скриптовыми языками(их интерпретаторами), через интерфейс ~FastCGI. По своему опыту, могу утверждать, что хотя ~FastCGI работает относительно mod_php медленнее, но нагрузку держит намного лучше и более рационально расходуются ресурсы серверов. Работа, которую проделал Andrei Nigmatulin, революционна для всего Интернета, поскольку на еще один шаг приближает решение проблемы C10k(проблема обслуживания 10000 одновременных соединений) и этот проект имеет своей целью поддержать его начинания.

!Установка ~PHP-FPM на Centos/Fedora/Debian/Ubunru
!!Подготовка
Удаляем предыдущую версию PHP
{{{
# centos/fedora
yum -y erase php-*
}}}
{{{
# debian/ubuntu
sudo aptitude -y remove php-*
}}}
где {{{-y}}} -- означает &quot;Yes&quot;, т.е. ответ да на все вопросы, которые могут возникнуть при выполнении команды. Это исключает вывод сообщений с необходимостью подтверждения пользователем.
{{{
# Установленную из исходников
rm -rf /usr/{local/,}bin/php{,-cgi,-cli,-config,ize} /usr/{local/,}include/php* \
/usr/{local/,}lib/php*
}}}

Ставим компилятор и devel-пакеты
{{{
# centos/fedora
yum -y install gcc pcre-devel zlib-devel bzip2-devel libidn-devel \
libjpeg-devel freetype-devel libpng-devel \
openssl-devel libxml2-devel curl-devel \
libmcrypt-devel \
mysql-devel
}}}
''Для debian/ubuntu'' Ставим дополнительные библиоетки
{{{
sudo aptitude install \
build-essential \
libtool \
libltdl3-dev \
libgd-dev \
libmcrypt-dev \
libxml2-dev \
libmysqlclient16-dev \
flex \
m4 \
awk \
automake \
autoconf \
bison make \
libbz2-dev \
libpcre3-dev \
libssl-dev \
zlib1g-dev \
re2c \
libjpeg-dev \
libpng-dev \
libcurl4-openssl-dev \
libfreetype6-dev
}}}
Качаем и распаковываем PHP (http://www.php.net/downloads.php#v5)
{{{
wget http://ru.php.net/get/php-5.2.10.tar.bz2/from/this/mirror
tar xjf php-*.tar.bz2
}}}
Качаем php-fpm патч (http://php-fpm.anight.org/download.html)
{{{
wget http://php-fpm.org/downloads/php-5.2.10-fpm-0.5.11.diff.gz
}}}
Патчим PHP
{{{
gzip -cd php-5.2.10-fpm-0.5.11.diff.gz | patch -d php-5.2.10 -p1
}}}
{{note{
''ЗАМЕЧАНИЕ:''
Здесь предполагается, что в текущем каталоге располагаются:
#каталог &quot;''php-5.2.10''&quot; с уже распакованным дистрибутивом нужной версией PHP,
#архив патча для создания php-fmp нужной версии в данном случае &quot;''php-5.2.10-fpm-0.5.11.diff.gz''&quot;.
}}}
или таким способом:
{{{
cd php*/
zcat ../php*fpm*.diff.gz | patch -p1
}}}

!!Компиляция и установка
Переходим в каталог где расположен пропатченный дистрибутив PHP:
{{{
cd php-5.2.10
}}}
Устанавливаем ~PHP-FPM из иходников (полный список доступных опций находится [[здесь|php-5.2.10 ./configure --help]]:
{{{
EXTENSION_DIR=/usr/lib/php5/modules ./configure \
--prefix=/usr \
--sysconfdir=/etc \
--with-config-file-path=/etc --with-config-file-scan-dir=/etc/php.d \
--enable-fastcgi \
--enable-force-cgi-redirect \
--enable-gd-native-ttf \
--disable-posix \
--enable-exif \
--enable-ftp \
--enable-bcmath \
--enable-zip \
--enable-mbstring \
--with-bz2 \
--with-gd --with-gettext --with-freetype-dir --with-jpeg-dir --with-png-dir \
--with-openssl \
--with-pcre-regex=/usr \
--with-zend-vm=GOTO \
--with-zlib \
--with-mysql \
--with-mysqli \
--with-mysql-sock \
--with-pdo-mysql \
--with-mcrypt \
--enable-fpm \
--with-fpm-conf=/etc/php-fpm.conf \
--with-fpm-log=/var/log/php-fpm.log \
--with-fpm-pid=/var/run/php-fpm.pid \
}}}
{{note{
''ЗАМЕЧАНИЕ:''
При компиляции было выдано следующее сообщение об ошибке:
{{{
configure: error: Please reinstall the libcurl distribution -
    easy.h should be in &lt;curl-dir&gt;/include/curl/
}}}
Проблема оказалась в неустановленном пакете &quot;''libcurl4-openssl-dev''&quot;, после его установки ошибка исчезла.

Далее было выдано сообщение об ошибке:
{{{
configure: error: freetype.h not found.
}}}
Проблема оказалась в неустановленном пакете &quot;''libfreetype6-dev''&quot;, после его установки ошибка исчезла и компиляция пакета успешно дошла до конца.
}}}
Теперь:
{{{
make
}}}
Вырезаем ненужный php-cgi, т.к. у нас уже есть php-fpm:
{{{
strip sapi/cgi/php-cgi
}}}
устанавливаем php-fpm:
{{{
sudo make install
}}}
После окончания установки я получил следующее сообщение::
{{{
Installing PHP SAPI module:       cgi
Installing PHP CGI binary: /usr/bin/
Installing FPM config:            /etc/php-fpm.conf
Installing init.d script:         /usr/sbin/php-fpm
Installing PHP CLI binary:        /usr/bin/
Installing PHP CLI man page:      /usr/man/man1/
Installing build environment:     /usr/lib/php/build/
Installing header files:          /usr/include/php/
Installing helper programs:       /usr/bin/
  program: phpize
  program: php-config
Installing man pages:             /usr/man/man1/
  page: phpize.1
  page: php-config.1
Installing PEAR environment:      /usr/lib/php/
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1391
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1396
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1400
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1391
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1396
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1400
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1391
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1396
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1400
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1391
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1396
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1400
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1391
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1396
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1400
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1391
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1396
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1400
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1391
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1396
Warning: Cannot use a scalar value as an array in phar://install-pear-nozlib.phar/PEAR/ChannelFile.php on line 1400
[PEAR] Archive_Tar    - installed: 1.3.3
[PEAR] Console_Getopt - installed: 1.2.3
[PEAR] Structures_Graph- installed: 1.0.2
[PEAR] XML_Util       - installed: 1.2.1
[PEAR] PEAR           - installed: 1.8.0
Wrote PEAR system config file at: /etc/pear.conf
You may want to add: /usr/lib/php to your php.ini include_path
Installing PDO headers:          /usr/include/php/ext/pdo/
}}}
{{note{
''ЗАМЕЧАНИЕ:''
Вероятная причина рассматривается на форуме PEAR по адресу http://www.pear-forum.org/post-5072.html
Скорее всего это баг версии php 5.2.10, при этом как сообщается на сайте  http://aspn.activestate.com/ASPN/Mail/Message/php-Dev/3724690 не работает PEAR.
}}}


!!Ротация лога
Создаём скрипт для ротации лога php-fpm:
{{{
sudo nano /etc/logrotate.d/php-fpm
/var/log/php-fpm.log {
    missingok
    notifempty
    sharedscripts
    postrotate
        /bin/kill -USR1 `cat /var/run/php-fpm.pid` 2&gt; /dev/null || true
    endscript
}
}}}

!!init и автозапуск
Создаём линк на php-fpm
{{{
sudo ln -s /usr/sbin/php-fpm /etc/init.d/php-fpm
}}}
После конфигурации запускаем php-fpm
{{{
/etc/init.d/php-fpm start
}}}
{{note{
''ЗАМЕЧАНИЕ:''
У меня после запуска система выдала следующую ошибку:
{{{
Starting php_fpm Jun 23 23:26:54.046627 [ERROR] fpm_unix_conf_wp(), line 124: 
please specify user and group other than root, pool 'default'
................................... failed
}}}
Причиной оказалось не настроенный должным образом конфигурационный файл {{{/etc/php-fpm.conf}}}. В это файле надо исправить следующие строки:
*Строка 37 -- пользователь под которым работает процесс записи лога ошибок php-fpm:
{{{
&lt;value name=&quot;name&quot;&gt;root&lt;/value&gt;
}}}
*Строка 63 -- имя пользователя, под которым будет запущен процесс php-fpm. Я указал имя как для apache:
{{{
&lt;value name=&quot;user&quot;&gt;www-data&lt;/value&gt;
}}}
*Строка 66 -- название группы в которую входит пользователь, под которым работает php-fpm:
{{{
&lt;value name=&quot;group&quot;&gt;www-data&lt;/value&gt;
}}}
}}}
Добавляем php-fpm в автозагрузку
{{{
sudo /usr/sbin/update-rc.d -f php-fpm defaults
}}}
или более некрасивым способом (обычно runlevel 3), поэтому:
{{{
sudo ln -s ../init.d/php-fpm /etc/rc3.d/S95php-fpm
}}}

!Настройка php.ini
Создаем файл:
{{{
sudo gedit /usr/local/lib/php.ini
}}}
Вставляем в пустой файл следующую конфигурацию:
{{{
; php.ini
[core]
;allow_url_fopen = Off
allow_url_include = On
;default_charset = &quot;windows-1251&quot;
default_charset = &quot;utf-8&quot;
disable_functions = &quot;shell_exec, exec, system, passthru, popen, proc_open, link, symlink&quot;
;display_errors = Off
display_startup_errors = On
enable_dl = Off
;error_log = &quot;php_error.log&quot;
;error_reporting = E_ALL
expose_php = Off
;extension_dir = &quot;/usr/lib/php/extensions&quot;
html_errors = Off
ignore_repeated_errors = On
;log_errors = On
log_errors_max_len = 8192
magic_quotes_gpc = Off
;max_execution_time = 15
max_input_time = 30
memory_limit = 64M
;open_basedir = &quot;.&quot;
output_buffering = 8192
;open_basedir = /www:/tmp
post_max_size = 64M
realpath_cache_size = 256K
;register_argc_argv = Off
register_long_arrays = Off
;register_globals = On
;short_open_tag = Off
upload_max_filesize = 64M
upload_tmp_dir = &quot;/tmp&quot;
variables_order = &quot;CGPS&quot;
 
[date]
;date.timezone = &quot;Europe/Moscow&quot;
date.timezone = &quot;Europe/Kaliningrad&quot;
 
[mysql]
;mysql.allow_persistent = Off
mysql.connect_timeout = 30
;mysql.default_socket = &quot;/tmp/mysql.sock&quot;
mysql.max_links = 256
mysql.max_persistent = 128
 
[session]
;session.name = sess
session.save_path = &quot;/tmp&quot;
 
[zlib]
;zlib.output_compression = On
}}}
Теперь у нас установлен и настроен php-fpm на основе php 5.2.10

{{textAlignCenter{
[img[images/articles/phpinfo-img.jpg]]
}}}
{{note{
''ЗАМЕЧАНИЕ:''
А это дополнение к конфигурации php.ini (но для него надо будет еще установить дополнительные модули, о которых будет расказано позже):
{{{
magic_quotes_gpc=0
[xcache-common]
#zend_extension = /usr/local/lib/php/extensions/no-debug-non-zts-20060613/xcache.so
[xcache]
#xcache.shm_scheme = &quot;mmap&quot;
#xcache.size = 64M
default_charset = &quot;utf-8&quot;
[memcache]
#extension = memcache.so
#memcache.hash_strategy=&quot;consistent&quot;
[memcache]
[suhosin]
#extension = suhosin.so
#extension = apc.so
#apc.shm_size = 48
[suhosin]
; For Unix only. You may supply arguments as well (default: &quot;sendmail -t -i&quot;).
sendmail_path = /usr/sbin/sendmail -i -t
upload_max_filesize=8M
[eaccelerator]
#zend_extension=&quot;/usr/local/lib/php/extensions/no-debug-non-zts-20060613/eaccelerator.so&quot;
#eaccelerator.shm_size=&quot;16&quot;
#eaccelerator.cache_dir=&quot;/tmp/eaccelerator&quot;
#eaccelerator.enable=&quot;1&quot;
#eaccelerator.optimizer=&quot;1&quot;
#eaccelerator.check_mtime=&quot;1&quot;
#eaccelerator.debug=&quot;0&quot;
#eaccelerator.filter=&quot;&quot;
#eaccelerator.shm_max=&quot;0&quot;
#eaccelerator.shm_ttl=&quot;0&quot;
#eaccelerator.shm_prune_period=&quot;0&quot;
#eaccelerator.shm_only=&quot;0&quot;
#eaccelerator.compress=&quot;1&quot;
#eaccelerator.compress_level=&quot;9&quot;
[eaccelerator]
}}}
}}}

!Ссылки
*[[Оригинал этой стаьи|http://ru.wikipedia.org/wiki/Участник:Roxis/Установка_php-fpm_на_Centos/Fedora/Debian]]
*[[Еще один вариант установки PHP_FPM|http://vkimo.org/node/11]]

*[[Официальный сайт проекта PHP-FPM|http://php-fpm.anight.org/]]
*[[Страница загрузки ~PHP_FPM|http://php-fpm.org/download.html]]

*[[Пример конфигурационного файла php|http://ru.wikipedia.org/wiki/Участник:Roxis/Пример_конфигурации_PHP]]
*[[Пример конфигурационного файла php-fpm|http://ru.wikipedia.org/wiki/Участник:Roxis/Пример_конфигурации_php-fpm]]



</pre>
</div>
<div title="Настройка Subversion (SVN)" modifier="Яковлев Иван" created="200906202216" modified="200906202230" tags="[[Установка/настройка Web-сервера]] slider" changecount="8">
<pre>''Установка''
*[[Введение в Subversion|Введение в Subversion]]
*[[Установка Subversion]]
''Настройка''
*[[Знакомство с svnserve]]
*[[Использование SSH с svnserve|Использование SSH совместно с svnserve]]
''Организация репозитариев''
*[[Множество проектов и SVN|Множество проектов и subversion]]
*[[Множество репозитариев и SVN|Множество репозитариев и subversion]]</pre>
</div>
<div title="Настройка Ubuntu" modifier="Яковлев Иван" created="200906032232" modified="200906171851" tags="MainMenu slider" changecount="14">
<pre>*&lt;&lt;slider &quot;chk-update&quot; [[Репозитарии и обновление в Ubuntu]] &quot;Репозитарии и обновление&quot; &quot;Показать/Скрыть раздел Репозитарии и обновление в Ubuntu&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-install&quot; [[Установка ПО в Ubuntu]] &quot;Установка ПО&quot; &quot;Показать/Скрыть раздел Установка ПО в Ubuntu&quot;&gt;&gt;
*[[Apt-Get]]
*[[Aptitude]]
*[[Компиляция ПО|Компиляция ПО из исходников]]
*[[Настройка загрузки|Настройка процесса загрузки в Ubuntu]]
*[[Шрифты Windows|Установка шрифтов Windows в Ubuntu]]
*[[Рабочий стол GNOME]]</pre>
</div>
<div title="Настройка VPN через SSH с использованием PuTTY" modifier="Яковлев Иван" created="200906061149" modified="200906151042" tags="[[Удаленное подключение]] SSH PuTTY [[SSH - работа с PuTTY]]" changecount="11">
<pre>!Описание
Сегодня пришлось вспоминать минут 20 как сделать сабж, попарился и решил написать на сайт, для себя как памятку и для других - вдруг кому пригодиться.

Итак, имеем:
компьютер на базе Windows (удаленная рабочая станция, условно ''КЛИЕНТ'');
почтовый сервер (не важно, какой именно, будь то Kerio ~MailServer, ~MDaemon или другой, условно ''СЕРВЕР_ПОЧТЫ'' в локальной сети - ну предположим, что вам надо с ним работать, а просто так локальный почтовый сервер в мир не подключен);
шлюз (прокси-сервер) в интернет с запущенным сервером SSH (например, ~FreeBSD или Linux, которые во многих организациях стоят как брандмауэры, условно ''БРАНДМАУЭР'').

!Задача
осуществить безопасное (шифрованное) соединение от ''КЛИЕНТА'' к ''СЕРВЕРУ_ПОЧТЫ'' по протоколу ~POP3 (получение почты, обычно порт 110). Ну и пусть нам это надо не постоянно, а иногда (иначе надо все-таки настраивать нормальный ~VPN-сервер).

{{textAlignCenter{
[img[images/articles/putty-ssh-vpn.gif]]
}}}

!Решение
Т.к. по умолчанию трафик по протоколу ~POP3 передается открытым текстом, а мы передаем очень секретный пароль от почтового ящика, то почтовый трафик надо шифровать :) Чем мы будем его шифровать? Поднимать специальный ~VPN-сервер, редирект портов, настраивать сертификаты и прочее - часто не выход, т.к. это сложно даже для большинства системных администраторов, к тому же, как сказано чуть выше, нам все это надо для периодических сеансов работы, возможно, только для нас и нужных ;)

Мы будем делать соединение между ''КЛИЕНТОМ'' и ''СЕРВЕРОМ_ПОЧТЫ'' внутри шифрованного содинения по протоколу ssh.

!!Шаг 1
Возьмем бесплатный клиент ssh для Windows - Putty - и установим его на КЛИЕНТА (по умолчанию, в папку &quot;{{{C:\Program Files\Putty}}}&quot;).

!!Шаг 2
Далее установим зашифрованное соединение между ''КЛИЕНТОМ'' и ''БРАНДМАУЭРОМ'' так, чтобы для ''КЛИЕНТА'' работа с почтой внутри локальной сети была бы точно такой, как если бы он (клиент) был бы у себя в офисе.

У ''КЛИЕНТА'' запускаем консоль: Пуск -&gt; выполнить -&gt; cmd

В консоли набираем команды:
{{{
cd C:\Program Files\Putty
putty.exe -v -ssh -2 -P 22 -C -l user -pw password -L 8110:192.168.1.10:110 81.222.111.10
}}}
где:
*{{{-v}}} - т.н. ''verbose'' режим, с расширенными комментариями,
*{{{-ssh -2}}} - использовать протокол ssh версии 2,
*{{{-P 22}}} - порт, открытый на ''БРАНДМАУЭРЕ'' для подключения по ssh,
*{{{-C}}} - использовать сжатие,
*{{{-l user}}} - имя пользователя, который имеет право входить на сервер ssh на ''БРАНДМАУЭРЕ'',
*{{{-pw password}}} - пароль этого пользователя,

*{{{-L 8110:192.168.1.10:110}}} - локальный порт, который будет доступен на компьютере ''КЛИЕНТА'', а 192.168.1.10 - локальный ip-адрес почтового сервера внутри организации,
*{{{110}}} - соответственно, порт ~POP3 на этом сервере;
*{{{81.222.111.10}}} - внешний ip-адрес ''БРАНДМАУЭРА'', к которому и будет соединяться ''КЛИЕНТ'' по ssh с помощью putty.

После набора последней команды 
{{{
putty.exe -v -ssh -2 -P 22 -C -l user -pw password -L 8110:192.168.1.10:110 81.222.111.10
}}}
откроется окно сеанса связи по протоколу ssh. Все, окно сворачиваем (''не закрываем!''), и настраиваем нашу почтовую программу на получение почты с адреса ''localhost'' и ''портом 8110'', а не ''110'', который стоит по умолчанию.

Вроде бы все. Во время получения почты почтовая программа будет соединяться с ''портом 8110'', который будет переадресован на удаленный почтовый сервер в офисе, при этом весь трафик соединения будет зашифрован. Завершить сеанс связи можно просто закрыв окно сеанса putty. После этого локальный ''порт 8110'' уже не будет доступен.

!Заключение
Можно добавить, что похожим образом можно соединяться не только к почтовому серверу, но и к другим сервисам, например, я таким образом соединялся с ~RAdmin, установленным на компьютере в локальной сети, при этом никаких port-мапперов на самом шлюзе делать не надо. Вот что самое хорошее! Достаточно иметь актуальную версию сервера ssh на шлюзе и, желательно, фильтровать на брандмауэре подключения к ''порту 22 (ssh)'', например по ip-адресу, если у вас дома или где там еще подключение к интернет постоянное. Но это уже мелочи жизни и тема другой статьи.

Вообще у ssh и putty, есть ооочень много всяких разных приятностей, которые здесь не упомянуты. Надеюсь, эта статья подтолкнет вас к небольшому исседованию, начать которое [[очень просто|http://www.google.ru/search?complete=1&amp;hl=ru&amp;newwindow=1&amp;q=ssh&amp;lr=&amp;aq=f]]

Кроме того, упомянутые в статье программы (за исключением почтовых серверов и ОС самого клиента ;)) являются бесплатными и свободно распространяемыми, а стремление быть легальным и бесплатным - хороший стимул приглядеться к реализации подобного безопасного соединения через ssh.

И еще, конечно же, при написании этой заметки я использовал другие ресурсы для &quot;освежения&quot; памяти. Вот самая полезная ссылка, которая и стала финальной в моих тестовых экспериментах перед опубликованием статьи: http://wiki.kaytaz.ru/doku.php/ssh-tunnel_cherez_putty.

{{note{
''Примечания (составлены по итогам комментариев на 27.03.2008)''
;isx
:Если туннель простаивает некоторое время, то соединение рвется, потому стоит поменять параметры сервера: {{{TCPKeepAlive}}}. Увеличить {{{LoginGraceTime}}}, выставить {{{ClientAliveInterval}}} и {{{ClientAliveCountMax}}}. Убрать {{{UseDns}}}, иначе длительные ожидания при установке соединений.
----
;isx
:А отчего не сделаешь все через ssl? Если не хочется возиться с почтовиком, то можно воспользоваться программой [[stunnel|http://www.stunnel.org/]], поднимая ее на шлюзе(брандмауэре). 
&lt;&lt;&lt;
Stunnel (http://stunnel.mirt.net/) использует ~OpenSSl или ~SSLeavy для шифрования трафика. Используется для установления шифрованных тонелей связи между клиентом и сервером. Работает в Linux, Windows, OS/2 и прочих осях.
&lt;&lt;&lt;
----
;Serg
:Если человек не админ брендмауэра - могут быть проблемы. Кто-то может гарантировать, что в настройках sshd не выключен форвардинг и/или туннелирование? 
&lt;&lt;&lt;
Действительно, к данному решению надо подходить взвешенно и понимать, что указанный способ туннелирования действительно больше всего подходить только для админа.
&lt;&lt;&lt;
}}}

!См. также
*[[Подключение к серверу]]

!Ссылки
*[[Оригинал статьи|http://bozza.ru/?p=content&amp;c=339]]


</pre>
</div>
<div title="Настройка ZendServer CE" modifier="Яковлев Иван" created="200907041249" tags="[[Установка/настройка Web-сервера]] slider" changecount="1">
<pre>''Установка''
*[[TODO|TODO]]
*[[TODO|TODO]]
''Настройка''
*[[TODO|TODO]]
*[[TODO|TODO]]</pre>
</div>
<div title="Настройка eBox" modifier="Яковлев Иван" created="200906042225" modified="200906062002" tags="[[Администрирование сервера]] [[TODO - нужен перевод статьи]]" changecount="13">
<pre>!Описание
eBox is a web framework used to manage server application configuration. The modular design of eBox allows you to pick and choose which services you want to configure using eBox.

!Установка
The different eBox modules are split into different packages, allowing you to only install those necessary. One way to view the available packages is to enter the following from a terminal:
{{{
apt-cache rdepends ebox | uniq
}}}
To install the ebox package, which contains the default modules, enter the following:
{{{
sudo apt-get install ebox
}}}
During the installation you will be asked to supply a password for the ebox user. After installing eBox the web interface can be accessed from: {{{https://yourserver/ebox.}}}


!Настройка
An important thing to remember when using eBox is that when configuring most modules there is a Change button that implements the new configuration. After clicking the Change button most, but not all, modules will then need to be Saved. To save the new configuration click on the “Save changes” link in the top right hand corner.
{{note{
@@font-weight: bold;ЗАМЕСАНИЕ:@@
Once you make a change that requires a Save, the link will change from green to red
}}}

!Модули
By default all eBox Modules are not enabled, and when a new module is installed it will not be automatically enabled. 

To enable a disabled module click on the Module status link in the left hand menu. Then check which modules you would like to enable and click the “Save” link.

!!Модули по-умолчанию
This section provides a quick summary of the default eBox modules.
*''System'': contains options allowing configuration of general eBox items. 
**''//General//'': allows you to set the language, port number, and contains a change password form. 
**''//Disk Usage//'': displays a graph detailing information about disk usage. 
**''//Backup//'': is used to backup eBox configuration information, and the Full Backup option allows you to save all eBox information not included in the Configuration option such as log files. 
**''//Halt/Reboot//'': will shutdown the system or reboot it. 
**''//Bug Report//'': creates a file containing details helpful when reporting bugs to the eBox developers. 
*''Logs'': allows eBox logs to be queried depending on the purge time configured. 
*''Events'': this module has the ability to send alerts through rss, jabber, and log file. 
**''//Available Events//'': 
***//Free Storage Space//: will send alert if free disk space drops below a configured percentage, 10% by default. 
***//Log Observer//: unfortunately this event does not work with the eBox version shipped with Ubuntu 7.10. 
***//RAID//: will monitor the RAID system and send alerts if any issues arise. 
***//Service//: sends alerts if a service restarts multiple times in a short time period. 
***//State//: alerts on the state of eBox, either up or down. 
**''//Dispatchers//'': 
***//Log//: this dispatcher will send event messages to the eBox log file /var/log/ebox/ebox.log. 
***//Jabber//: before enabling this dispatcher you must first configure it by clicking on the “Configure” icon. 
***//RSS//: once this dispatcher is configured you can subscribe to the link in order to view event alerts.

!Дополнительные модули
Here is a quick description of other available eBox modules:
*''Network'': allows configuration of the server's network options through eBox. 
*''Firewall'': configures firewall options for the eBox host. 
*''~UsersandGroups'': this module will manage users and groups contained in an ~OpenLDAP LDAP directory. 
*''DHCP'': provides an interface for configuring a DHCP server. 
*''DNS'': provides ~BIND9 DNS server configuration options. 
*''Objects'': allow configuration of eBox Network Objects, which allow you to assign a name to an IP address or group of IPs. 
*''Services'': displays configuration information for services that are available to the network. 
*''Squid'': configuration options for the Squid proxy server. 
*''CA'': configures a Certificate Authority for the server. 
*''NTP'': set Network Time Protocol options. 
*''Printers'': allows the configuration of printers. 
*''Samba'': configuration options for Samba. 
*''~OpenVPN'': setup options for ~OpenVPN Virtual Private Network application.

!Ссылки
*[[Описание на ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/ebox.html]]
*http://ebox-platform.com/ -- официальный сайт
*http://en.wikipedia.org/wiki/EBox -- описание на Википедии


</pre>
</div>
<div title="Настройка ssl (https) в nginx" modifier="Яковлев Иван" created="200906182252" modified="200906191238" tags="[[Nginx + Apache]] [[SSL и сертификаты]]" changecount="7">
<pre>Чтобы защитить передаваемый трафик между сервером и клиентом можно использоваться механизм SSL шифрования. Так как nginx часто выступает в роли фронтенда перед апачем, то лучше возложить шифрование на него.

!Использование массового самоподписанного сертификата
Настроим использование одного самоподписанного сертификата для нескольких сайтов. 

Создадим общий файл конфигурации SSL {{{/etc/nginx/ssl.conf}}}: 
{{{
# Подключение самоподписанного сертификата
# генерация сертификата:
# openssl req -new -x509 -days 9999 -nodes -out cert.pem -keyout cert.key

ssl			on;
ssl_protocols		SSLv3 TLSv1;
ssl_certificate		/etc/nginx/ssl/cert.pem;
ssl_certificate_key	/etc/nginx/ssl/cert.key;
}}}
Создадим папку где будем хранить сертификаты: 
{{{
sudo mkdir /etc/nginx/ssl
}}}
Для большей безопасности ограничиваем доступ к сертификатам:
{{{
sudo chown nginx:nginx /etc/nginx/ssl
sudo chmod 700 /etc/nginx/ssl
}}}
Перейдем в эту папку и сгенерируем сертификат:
{{{
cd /etc/nginx/ssl
sudo openssl req -new -x509 -days 9999 -nodes -out cert.pem -keyout cert.key
}}}
{{note{
''ЗАМЕЧАНИЕ:''
При генерации вас попросят указать некоторые данные, так как мы создаём сертификат для себя то заполнять их не обязательно. 
Во время генерации CSR вас попросят ввести некоторое количество информации. Один из вопросов будет {{{Common Name (eg, YOUR name) []:}}}
Важно чтобы это поле содержало полностью квалифицированное имя домена вашего сервера. Если вебсайт имеет адрес {{{www.zatusim.ru}}} то вы должны написать именно {{{www.zatusim.ru}}}
}}}

Теперь для включения шифрования нужных сайтов будум использовать следующий шаблон: 

в конфигурации сайтов nginx:
{{{
server {
        listen          *:443;       # порт https
        server_name     my.site.com; # ваш сайт

        include	/etc/nginx/ssl.conf; # подключение конфигурации ssl

        ...
}
}}}
Пример с принудительным перенаправлением с http на https: 
в конфигурации сайтов nginx:
{{{
server {
        listen          *:443;       # порт https
        listen		*:80;        # порт http
        server_name     my.site.com; # ваш сайт

        include	/etc/nginx/ssl.conf; # подключение конфигурации ssl

        if ( $scheme = &quot;http&quot; ) {
	      rewrite ^/(.*)$	https://$host/$1 permanent;
        }

        ...
}
}}}
После настройки необходимо перезагрузить nginx: 
{{{
sudo /etc/init.d/nginx reload
}}}
Всё готово, для доступа к сайту следует использовать https протокол - {{{https://my.site.com}}} 

Так как сертификат самоподписанный браузер попросит подтвердить исключение на его использование.

!Дополнительные опции создания ~SSL-сертификата
Создание сертификата командой:
{{{
openssl req -new -x509 -days 9999 -nodes -out cert.pem -keyout cert.key
}}}
запрашивает некоторую информацию для создания сертификата, заполнение которой можно пропустить. 

Но если интересно вот описание параметров:
|!Значение|!Описание|!Обязательный параметр?|
| С |Двухсимвольный код страны (Country)| нет |
| ST |	Название региона/области/края/республики/… (State Name)| нет |
| L |Название города/поселка/… (Locality Name)| нет |
| O |Название организации (Organization Name)| нет |
| OU |Название отдела (Organization Unit)| нет |
| CN |Имя сертификата, при создании серверных сертификатов используется доменное имя сайта (Common Name)| да |
|emailAddress 	почтовый адрес (~E-mail address)| нет |

Чтобы не вводить эти параметры интерактивное можно использовать опцию -subj: 
{{{
openssl req -new -x509 -days 9999 -nodes -subj /C=RU/O=My\ site/CN=my.site.com/
    emailAddress=admin@site.com -out cert.pem -keyout cert.key
}}}

!Ссылки
*[[Оригинал статьи|http://wiki.enchtex.info/howto/nginx_ssl]]
*http://www.opennet.ru/tips/info/2036.shtml


</pre>
</div>
<div title="Настройка автоматическго запуска nginx" modifier="Яковлев Иван" created="200906200110" modified="200907021301" tags="[[Настройка Nginx]] [[TODO - нужен перевод статьи]] slicehost" changecount="9">
<pre>!Описание
I am assuming you have followed the [[previous article|Установка Nginx из исходных кодов]] and installed Nginx from source. If you have used other options or have placed the nginx binary in a directory other than '{{{/usr/local/sbin/}}}' then you will need to adjust the script shown below to match your installation.

!Stop
If you have nginx running then stop the process using:
{{{
sudo kill `cat /usr/local/nginx/logs/nginx.pid`
}}}

!!Init script
The script I use below is from an Ubuntu Intrepid 'aptitude' install and has been adapted to take into account our custom install of nginx.

Let's go ahead and create the script:
{{{
sudo nano /etc/init.d/nginx
}}}
Inside the blank file place the following:
{{{
#! /bin/sh

### BEGIN INIT INFO
# Provides:          nginx
# Required-Start:    $all
# Required-Stop:     $all
# Default-Start:     2 3 4 5
# Default-Stop:      0 1 6
# Short-Description: starts the nginx web server
# Description:       starts nginx using start-stop-daemon
### END INIT INFO

PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
DAEMON=/usr/local/sbin/nginx
NAME=nginx
DESC=nginx

test -x $DAEMON || exit 0

# Include nginx defaults if available
if [ -f /etc/default/nginx ] ; then
    . /etc/default/nginx
fi

set -e

. /lib/lsb/init-functions

case &quot;$1&quot; in
  start)
    echo -n &quot;Starting $DESC: &quot;
    start-stop-daemon --start --quiet --pidfile /usr/local/nginx/logs/$NAME.pid \
        --exec $DAEMON -- $DAEMON_OPTS || true
    echo &quot;$NAME.&quot;
    ;;
  stop)
    echo -n &quot;Stopping $DESC: &quot;
    start-stop-daemon --stop --quiet --pidfile /usr/local/nginx/logs/$NAME.pid \
        --exec $DAEMON || true
    echo &quot;$NAME.&quot;
    ;;
  restart|force-reload)
    echo -n &quot;Restarting $DESC: &quot;
    start-stop-daemon --stop --quiet --pidfile \
        /usr/local/nginx/logs/$NAME.pid --exec $DAEMON || true
    sleep 1
    start-stop-daemon --start --quiet --pidfile \
        /usr/local/nginx/logs/$NAME.pid --exec $DAEMON -- $DAEMON_OPTS || true
    echo &quot;$NAME.&quot;
    ;;
  reload)
      echo -n &quot;Reloading $DESC configuration: &quot;
      start-stop-daemon --stop --signal HUP --quiet --pidfile /usr/local/nginx/logs/$NAME.pid \
          --exec $DAEMON || true
      echo &quot;$NAME.&quot;
      ;;
  status)
      status_of_proc -p /usr/local/nginx/logs/$NAME.pid &quot;$DAEMON&quot; nginx &amp;&amp; exit 0 || exit $?
      ;;
  *)
    N=/etc/init.d/$NAME
    echo &quot;Usage: $N {start|stop|restart|reload|force-reload|status}&quot; &gt;&amp;2
    exit 1
    ;;
esac

exit 0
}}}
There's not really the space to go into the workings of the script, but suffice to say, it defines where the main nginx binary and pid files are located so nginx can be started correctly.

!Execute
As the init file is a shell script, it needs to have executable permissions.

We set them like so:
{{{
sudo chmod +x /etc/init.d/nginx
}}}

!!update-rc
Now we have the base script prepared, we need to add it to the default run levels:
{{{
sudo /usr/sbin/update-rc.d -f nginx defaults
}}}
The output will be similar to this:
{{{
Adding system startup for /etc/init.d/nginx ...
 Adding system startup for /etc/init.d/nginx ...
   /etc/rc0.d/K20nginx -&gt; ../init.d/nginx
   /etc/rc1.d/K20nginx -&gt; ../init.d/nginx
   /etc/rc6.d/K20nginx -&gt; ../init.d/nginx
   /etc/rc2.d/S20nginx -&gt; ../init.d/nginx
   /etc/rc3.d/S20nginx -&gt; ../init.d/nginx
   /etc/rc4.d/S20nginx -&gt; ../init.d/nginx
   /etc/rc5.d/S20nginx -&gt; ../init.d/nginx
}}}
Done.

!Start, Stop and Restart
Now we can start, stop and restart nginx just as with any other service:
{{{
sudo /etc/init.d/nginx start
...
sudo /etc/init.d/nginx stop
...
sudo /etc/init.d/nginx restart
}}}
The script will also be called on a reboot so nginx will automatically start.

!Заключение
Adding a process to the run levels like this saves a lot of frustration and effort, not only in manually starting and stopping the process, but also in having it automatically start on a reboot. 

Now let's look at [[Настройка окружения nginx для Ubuntu]] for our source-installed nginx webserver.

!См. далее
*[[Настройка окружения nginx для Ubuntu]]

!Ссылки
*[[Оригинал статьи на slicehost.com|http://articles.slicehost.com/2009/3/4/ubuntu-intrepid-adding-an-nginx-init-script]]
*http://wiki.nginx.org/Nginx-init-ubuntu -- готовый скрипт для контроля запуском и остановкой
*http://chrisjohnston.org/2009/setting-up-a-lemp-stack-ubuntu-904 -- тоже самое для Ubuntu 9.04


</pre>
</div>
<div title="Настройка виртуальных хостов" modifier="Яковлев Иван" created="200906200117" modified="200907021302" tags="[[Настройка Nginx]] [[TODO - нужен перевод статьи]] slicehost" changecount="4">
<pre>*''Создаем окружение''
*''index.html''
*''Virtual Hosts Layout''
*''Virtual Host''
*''sites-enabled''
*''Restart Nginx''
*''Проверка работы''
*''Rinse and Repeat''
*''Логи''
*''Предварительный итог''

*''Listen''
*''server_name''
*''alias''
*''root''
*''error_page''
*''internal''
*''Заключение''

!Создаем окружение
Let's create the basic layout for each domain. In your home directory create a 'public_html' folder:
{{{
mkdir /home/demo/public_html
}}}
Now for each domain you want to host (I use the examples of domain1.com and domain2.com) create a folder with a standard set of sub-folders:
{{{
mkdir -p /home/demo/public_html/domain1.com/{public,private,log,backup}
}}}
and
{{{
mkdir -p /home/demo/public_html/domain2.com/{public,private,log,backup}
}}}
That will create the folders public, private, log and backup for each of our domains (domain1.com and domain2.com).

!index.html
The content of the public folder is, naturally, up to you but for this example I am going to use a very simple html file so we can check the virtual hosts work.

So for each domain:
{{{
nano /home/demo/public_html/domain1.com/public/index.html
}}}
Enter something like this into the file:
{{{
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;domain1.com&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;domain1.com&lt;/h1&gt;
  &lt;/body&gt;
&lt;/html&gt;
}}}
Repeat the process so you have a similar file for domain2.com (don't forget to change the index.html content so it shows domain2.com and not domain1.com).

!Virtual Hosts Layout
If you have been following the articles for the Nginx install, you will have a 'Debian' style layout (using 'sites-available' and 'sites-enabled' folders) whether you installed via the package manager or via source.

As such, we'll use that layout from now on when creating the virtual hosts.

!Virtual Host
Let's go ahead and create the vhost file for domain1:
{{{
sudo nano /etc/nginx/sites-available/domain1.com
}}}
Remember to adjust the path according to your install. So installing from source would require:
{{{
sudo nano /usr/local/nginx/sites-available/domain1.com
}}}
The contents look like this:
{{{
server {

            listen   80;
            server_name  www.domain1.com;
            rewrite ^/(.*) http://domain1.com/$1 permanent;
}


server {

            listen   80;
            server_name domain1.com;

            access_log /home/demo/public_html/domain1.com/log/access.log;
            error_log /home/demo/public_html/domain1.com/log/error.log;

            location / {

                        root   /home/demo/public_html/domain1.com/public/;
                        index  index.html;

           }

}
}}}
{{note{
''ЗАМЕЧАНИЕ:''
This example vhost is pretty basic. However, the next article on Nginx virtual hosts will include details of many more settings that are available.
}}}
The first server module in the file is a simple rewrite rule that redirects visitors to domain1.com from www.domain1.com. You can, of course, have this the other way around if you prefer. The second server module has very basic information including the 'server_name' which is the domain name you want to serve.

It then defines the log locations for easy analysis and finally sets the server root and the index file.

As said, it's a very basic config at this stage.

!sites-enabled
The last configuration step is to 'enable' our site.

This is done with a symlink in the 'sites-enabled' directory as follows:
{{{
sudo ln -s /etc/nginx/sites-available/domain1.com /etc/nginx/sites-enabled/domain1.com
}}}
Again, depending on how you installed Nginx, you may need to adjust the paths:
{{{
sudo ln -s /usr/local/nginx/sites-available/domain1.com /usr/local/nginx/sites-enabled/domain1.com
}}}

!Restart Nginx
Although there is a restart option for the Nginx init script, it doesn't always work as expected and may not facilitate any changes you have made.

As such, I recommend a stop-and-start approach rather than a simple restart:
{{{
sudo /etc/init.d/nginx stop
...
sudo /etc/init.d/nginx start
}}}

!Проверка работы
To test the domain without creating a DNS zone and record(s) on some Internet namserver(s), I've modified the '/etc/hosts' file on my local computer to include some entries mapping 'domain1.com', etc. to the demo slice's public IP:
{{{
127.0.0.1    localhost
...

# entries related to the demo slice
123.45.67.890   domain1.com
123.45.67.890   www.domain1.com
123.45.67.890   domain2.com
...
}}}
You can add similar entries in your own 'hosts' file, though it's location will vary depending on what OS is loaded on your local computer (try a Google search).
{{note{
''ЗАМЕЧАНИЕ:''
Entries in the 'hosts' file will need to be removed prior to testing and using live DNS zones and records created on Internet nameservers. Failure to remove them will likely lead to confusion on your part and inaccurate tests of new or modified public DNS records.
}}}
With such changes made for testing purposes, you can navigate to your site in a web browser on your local computer:

{{textAlignCenter{
[img[images/articles/nginx-vhost-domain1.jpg]]
}}}
Nice.

!Rinse and Repeat
All you need to do for your next virtual host (domain2.com in this example) is to repeat the process. I know I mention it a lot, but do remember to adjust any paths to match your Nginx installation.

So create a virtual host file:
{{{
sudo nano /etc/nginx/sites-available/domain2.com
}}}
Enter the details as shown above but for domain2.com and then create a symlink in the 'sites-enabled' folder like this:
{{{
sudo ln -s /etc/nginx/sites-available/domain2.com /etc/nginx/sites-enabled/domain2.com
}}}
Restart Nginx:
{{{
sudo /etc/init.d/nginx stop
...
sudo /etc/init.d/nginx start
}}}
And away you go.

!Логи
Remember we defined custom locations for the domain logs?

Well, let's have a check they are there:
{{{
ls /home/demo/public_html/domain1.com/log/
...
access.log  error.log
}}}
Excellent, everything is working as we expected and we have our domain logs in a nice and convenient location.

!Предварительный итог
Setting up virtual hosts with Nginx is a simple process using the 'sites-available' and 'sites-enabled' folders. Although the example here is quite basic, I hope you can see that getting to grips with Nginx syntax and configurations is not too difficult.

The next article will concentrate on some other settings for use in the virtual hosts file, thus allowing for more control and flexibility for your hosting needs.

!Listen
{{{
server {
    listen   80;
}
}}}
Inside the server module, the 'listen' setting defines the port for that virtual host. The two most common ports will be port 80 (the standard HTTP port) and port 443 (the standard HTTPS port). Of course, you can add any port. For example, you might want to test a site on port 8080.

!server_name
The usual course of a virtual host file means the next line is the 'server_name'. As such, the beginning of a vhost server module would normally look like this:
{{{
server {
    listen   80;
    server_name domain1.com;
}
}}}
You can also add a simple rewrite rule here to direct users from www.domain1.com to domain1.com:
{{{
server {
    listen   80;
    server_name  www.domain1.com;
    rewrite ^/(.*) http://domain1.com/$1 permanent;
}
}}}

!alias
{{{
location  /img/ {
        alias  /home/public_html/domain.com/images/;
}
}}}
Sets an alias location.

In this instance the address '{{{/img/dog.png}}}' would return the file located at:
{{{
/home/public_html/domain.com/images/dog.png
}}}
This can make for cleaner image/file url's and means you can 'share' an image directory with another site on the same Slice.

!root
Following on from the 'alias' setting is a similar one where you can set the 'root' of a location:
{{{
location  /img/ {
        root /home/public_html/domain.com;
}
}}}
This time, a request for '/img/dog.png' would return the file located at:
{{{
/home/public_html/domain.com/img/dog.png
}}}
There is a subtle, but fundamental difference between the 'alias' and 'root' settings.

!error_page
{{{
error_page    404    /error/404.html;
}}}
Sets the location for a custom error page. In this example I have an 'error' folder in my public directory where I place my custom error pages.

You can redirect multiple error types to one file as such:
{{{
error_page    502 503 504    /error/50x.html;
}}}

!internal
Following from the error page setting, it is possible to ensure the user only receives the error page on an actual error. In other words, at the moment, a user can enter the url:
{{{
http://domain.com/error/50x.html
}}}
and be served the 50x.html file.

Not very good, especially if the error file contains variables which may help the user in working out why they are receiving the error (such as previous page, IP address, etc). We can set the 'internal' tag to ensure specific pages are only served from an internal trigger and not from an external url request.

Let's have look at an example which includes the above 50x error page example:
{{{
error_page    502 503 504    /error/50x.html;

location    /error/50x.html {
    internal;
}
}}}
This will ensure that the /error/50x.html file is only triggered and served via an internal error.

Now if one were to navigate to:
{{{
http://domain.com/error/50x.html
}}}
You would receive a 404 (file not found) error instead of directly accessing the 50x.html file.

Much better. 

You can also set this for the 404.html page but there is little point in doing that as all it would do is serve you the same 404 page!

!Заключение
Nginx has many Virtual Host settings and there are more available for use. If you want to delve into the depths of Nginx you should have a look at the main [[Http Core Modules page|http://wiki.codemongers.com/NginxHttpCoreModule]] on the Nginx site.

However, there should be enough here to get you going with the basics of setting up your vhosts.

!Ссылки
*[[Оригинал статьи на slicehost.com (часть 1)|http://articles.slicehost.com/2009/3/6/ubuntu-intrepid-nginx-virtual-hosts-1]]
*[[Оригинал статьи на slicehost.com (часть 2)|http://articles.slicehost.com/2009/3/7/ubuntu-intrepid-nginx-virtual-hosts-2]]


</pre>
</div>
<div title="Настройка виртуальных хостов в Apache" modifier="Яковлев Иван" created="200906200141" modified="200907021257" tags="[[Настройка Apache]] [[TODO - нужен перевод статьи]] TODO slicehost" changecount="8">
<pre>*''Описание''

*''Создание окружения для виртуальных хостов''
*''index.html''
*''~NameVirtualHost''
*''Custom Virtual Hosts''
*''a2ensite''
*''Тестирование''
*''~ServerAlias''
*''Логи''
*''Настройки по умолчанию''

*''Email''
*''Domain Name''
*''Index Files''
*''Documents''
*''Log Files''
*''Error Documents''
*''Apache Footers''
*''cgi-bin''
*''Directory''
*''Directory Browsing''
*''SSI''
*''Symlinks''
*''.htaccess''
*''No Options''
*''Hierarchy''

*''Заключение''

!Описание
Now we have Apache installed and running, we can configure it to serve multiple domains using {{{Virtual Hosts}}}. Do note the layout used in these articles is explained [[here|Настройка окружения для виртуальных хостов]] - feel free to use the directories of your choice.

!Создание окружения для виртуальных хостов
In this example we'll be using two domains: ''domain1.com'' and ''domain2.com''.

In your home directory create a '''public_html''' folder:
{{{
cd ~
mkdir public_html
}}}
Now for each domain we want to host create a folder with a standard set of sub-folders:
{{{
mkdir -p public_html/domain1.com/{public,private,log,cgi-bin,backup}
}}}
and
{{{
mkdir -p public_html/domain2.com/{public,private,log,cgi-bin,backup}
}}}
That will create the folders public, private, log, cgi-bin and backup for each of our domains (domain1.com and domain2.com).

!index.html
The content of the public folder is, naturally, up to you but for this example I am going to use a very simple html file so we can check the virtual hosts work.

So for each domain create an index.html file:
{{{
nano public_html/domain1.com/public/index.html
}}}
add the following to the index.html file:
{{{
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;domain1.com&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;domain1.com&lt;/h1&gt;
  &lt;/body&gt;
&lt;/html&gt;
}}}
Repeat the process so you have a similar file for domain2.com (simply replace all instances of 'domain1.com' with 'domain2.com).

OK. Now we have a basic structure for our two domains we can look at defining two virtual hosts.

!~NameVirtualHost
With virtual hosts, one thing that often confuses people is the {{{NameVirtualHost}}} setting. For each interface and port on which Apache is set to listen on, we need a ~NameVirtualHost directive. Something to keep in mind is you can only define it once per port.

In the Apache layout for Ubuntu Intrepid Ibex there is a default {{{NameVirtualHost}}} directive in the 'ports.conf' file. If you've worked through the [[Конфигурирование сервера Apache в Ubuntu]] article for Intrepid, you may remember it being noted previously.

Let's take another look at the contents of 'ports.conf':
{{{
cat /etc/apache2/ports.conf
}}}
You should get the following output (unless you've previously modified the file):
{{{
# If you just change the port or add more ports here, you will likely also
# have to change the VirtualHost statement in
# /etc/apache2/sites-enabled/000-default

NameVirtualHost *:80
Listen 80

&lt;IfModule mod_ssl.c&gt;
    # SSL name based virtual hosts are not yet supported, therefore no
    # NameVirtualHost statement here
    Listen 443
&lt;/IfModule&gt;
}}}
The default {{{NameVirtualHost}}} setting satisfies our requirements at present -- Apache will apply named based virtual host logic and settings for HTTP requests made on any available interface ({{{*}}}) at port 80.
{{note{
''ЗАМЕЧАНИЕ:''
The placement of the default {{{NameVirtualHost}}} directive in 'ports.conf' is new to Ubuntu Intrepid's Apache layout; prior Ubuntu releases placed a similar setting in the default vhost. If you are working with a pre-Intrepid Ubuntu release (e.g. Hardy or Gutsy), refer to the appropriate &quot;Apache Virtual Hosts&quot; articles listed on the [[Apache articles pages|https://articles.slicehost.com/apache]].
}}}

!Custom Virtual Hosts
We've set up the basics and now we're ready to add our own virtual hosts so we can start to serve our domains.

Let's go ahead and create the vhost file for domain1:
{{{
sudo nano /etc/apache2/sites-available/domain1.com
}}}
The contents look like this:
{{{
# Place any notes or comments you have here
# It will make any customisation easier to understand in the weeks to come

# domain: domain1.com
# public: /home/demo/public_html/domain1.com/

&lt;VirtualHost *:80&gt;

  # Admin email, Server Name (domain name) and any aliases
  ServerAdmin webmaster@domain1.com
  ServerName  domain1.com
  ServerAlias www.domain1.com


  # Index file and Document Root (where the public files are located)
  DirectoryIndex index.html
  DocumentRoot /home/demo/public_html/domain1.com/public


  # Custom log file locations
  LogLevel warn
  ErrorLog  /home/demo/public_html/domain1.com/log/error.log
  CustomLog /home/demo/public_html/domain1.com/log/access.log combined

&lt;/VirtualHost&gt;
}}}

!a2ensite
Now we have the site available, we need to enable it:
{{{
sudo a2ensite domain1.com
}}}
The output of the command is:
{{{
Site domain1.com installed; run /etc/init.d/apache2 reload to enable.
}}}
Seems like good advice:
{{{
sudo /etc/init.d/apache2 reload
}}}

!Тестирование 
To test the domain without creating a DNS zone and record(s) on some Internet namserver(s), I've modified the '{{{/etc/hosts}}}' file on my local computer to include some entries mapping 'domain1.com', etc. to the demo Slice's public IP:
{{{
127.0.0.1    localhost
...

# entries related to the demo slice
123.45.67.890   domain1.com
123.45.67.890   www.domain1.com
123.45.67.890   domain2.com
...
}}}
You can add similar entries in your own 'hosts' file, though it's location will vary depending on what OS is loaded on your local computer (try a Google search).
{{note{
''ЗАМЕЧАНИЕ:''
Entries in the 'hosts' file will need to be removed prior to testing and using live DNS zones and records created on Internet nameservers. Failure to remove them will likely lead to confusion on your part and inaccurate tests of new or modified public DNS records.
}}}
With such changes made for testing purposes, you can navigate to your site in a web browser on your local computer:

{{textAlignCenter{
[img[images/articles/apache-vhostworking-domain1.jpg]]
}}}
Tada! You now have the contents of public/index.html being shown:

!~ServerAlias
Note that in the vhost file, we set a {{{ServerAlias}}}. Providing you have the DNS set up correctly you can also use that address -- for quick testing purposes you can place another entry in your 'hosts' file (I've already done so in the example code given above):

{{textAlignCenter{
[img[images/articles/apache-vhostworking-domain1.jpg]]
}}}
We'll talk about forcing one address or the other in a later article about rewrite rules.

!Repeat as necessary
To create and enable domain2.com simply go through the process again:
{{{
sudo nano /etc/apache2/sites-available/domain2.com
...
# Enter the details for domain2.com as per the example shown above
}}}
Then enable the site and restart Apache:
{{{
sudo a2ensite domain2.com
...
sudo /etc/init.d/apache2 reload
}}}
Finally navigate to your second domain:
{{{
http://domain2.com
}}}
or
{{{
http://www.domain2.com
}}}
All being well, you will see the 'domain2.com' index file.

!Логи
As defined in the vhosts file, each domain has its own log files. Let's take a quick look:
{{{
ls /home/demo/public_html/domain1.com/log/
}}}
The output is exactly as expected:
{{{
access.log  error.log
}}}
This makes for much easier analysis as each set of logs is self contained.

!Настройки по умолчанию
Remember that although we changed the default virtual host, we did leave it in place. Now, if someone enters the IP address of the Slice they are served the contents of that default vhosts file (providing, of course, you have not set up a separate vhost for the IP address).

Why are they served from that vhost file?

Apache searches the enabled vhosts in alphabetical order and if it can't find one for the requested IP address or domain name, it serves the first one (alphabetically).

If we had disabled or deleted the default vhost, then the contents of domain1.com would be displayed (being before domain2.com alphabetically).

This is something to keep in mind when planning your websites. Do you want a particular domain to be the default? Do you want the IP address to have completely different content?

!Email
~ServerAdmin
{{{
ServerAdmin webmaster@domain.com
}}}
Sets the email address for the server administrator - this will be used if you have setup the server to contact you on errors. It is also shown in the {{{ServerSignature}}} (if set to '{{{Email}}}' - see below)

!Domain Name
~ServerName and ~ServerAlias
{{{
ServerName domain.com
ServerAlias www.domain.com
}}}
Sets the domain name for the virtual host. You can have as many aliases as required. For example, you can have domain.com and domain.net point to the same content.
{{note{
''ЗАМЕЧАНИЕ:''
This is not a rewrite rule (we'll look at those later) but the domains defined here will serve the same content (assuming you have set the DNS to point to your Slice IP).
}}}

!Index Files
~DirectoryIndex
{{{
DirectoryIndex index.html
}}}
Defines the index file (the 'home' page that is shown on entering the domain address). Useful if you have want the user to be directed to an alternate page or to a non-standard home page.

Do note this is not a good way of redirecting users as they may go directly to a non specified page such as domain.com/index.php whilst the {{{DirectoryIndex}}} will only work for those entering domain.com.

!Documents
~DocumentRoot
{{{
DocumentRoot /home/demo/public_html/domain.com/public
}}}
The location of the domain's public files. Use an absolute path name.

!Log Files
~ErrorLog and ~CustomLog
{{{
LogLevel warn
ErrorLog  /home/demo/public_html/domain.com/log/error.log
CustomLog /home/demo/public_html/domain.com/log/access.log combined
}}}
Set the Log levels and the location for the Virtual Hosts log files. Very useful for easy analysis of the domain statistics.

!Error Documents
~ErrorDocument
{{{
ErrorDocument 404 /errors/404.html
ErrorDocument 403 /errors/403.html
}}}
Used for all the standard error messages.

In these examples I have an 'errors' folder in my public directory. I created each error document and place them in the 'errors' folder. The paths shown are relative to the {{{DocumentRoot}}} folder defined above.

If not defined, Apache will generated its own error pages. Custom error pages are more user friendly and can be customised as much, or as little, as you want.

!Apache Footers
~ServerSignature
{{{
ServerSignature On
}}}
Sets whether the server details are displayed in any server generated error pages or index lists. Options are {{{On}}}, {{{Off}}} and {{{Email}}}.
{{note{
''ЗАМЕЧАНИЕ:''
The level of detail in the signature is configured via {{{ServerTokens}}} which cannot be set in the Virtual Hosts file — for Ubuntu Intrepid's Apache layout this is properly set in '{{{/etc/apache2/conf.d/security}}}'. See the [[Конфигурирование сервера Apache в Ubuntu]] article for more details.

If set to Email, the ~ServerAdmin email will be displayed.
}}}

!cgi-bin
~ScriptAlias
{{{
ScriptAlias /cgi-bin/ /home/demo/public_html/domain.com/cgi-bin/
&lt;Location /cgi-bin&gt;
  Options +ExecCGI
&lt;/Location&gt;
}}}
Enables the cgi-bin location as defined by the custom virtual hosts layout. You can, of course, leave the cgi-bin in the {{{DocumentRoot}}} location if you so wish.

!Directory
&lt;Directory xxx/xxx&gt;
{{{
&lt;Directory /home/demo/public_html/domain.com/public&gt;
  Options FollowSymLinks
&lt;/Directory&gt;
}}}
Set the Options for the specified directory - the example shown allows the Option {{{FollowSymLinks}}} to be enable for the public directory of domain.com

Listed below are further Options that can be set:

!Directory Browsing
Options
{{{
Options -Indexes
}}}
To turn off directory browsing use '{{{-Indexes}}}' or '{{{None}}}'. To turn them on, use '{{{+Indexes}}}'.

!SSI
Options
{{{
Options -Includes
}}}
This Option disables Server Side Inlcudes.

!Symlinks
Options
{{{
Options -FollowSymLinks
}}}
Enable or disable the option to follow symlinks. Be careful with this option as it can lead to security risks (inadvertently linking to configuration folders).

You can consider using the {{{SymLinksIfOwnerMatch}}} directive instead of {{{FollowSymLinks}}}. The {{{SymLinksIfOwnerMatch}}} allows symbolic links to be followed only if the owner of the link is identical to the owner of the target file or directory (in terms of Linux filesystem ownership/permissions). Thus preventing many of the security risks that a simple {{{FollowSymlinks}}} directive can create.

!.htaccess
~AllowOverride
{{{
AllowOverride None
}}}
Setting {{{AllowOverride}}} to none disables .htaccess support. Set to All to allow them.

You can also specify which .htaccess features to enable such as:
{{{
AllowOverride AuthConfig Indexes
}}}
The Apache [[htaccess|http://httpd.apache.org/docs/2.2/howto/htaccess.html]] and [[AllowOverride|http://httpd.apache.org/docs/2.2/mod/core.html#allowoverride]] docs have more information on the different features.

Remember to specifically protect your .htaccess file. This can be done in two ways:

Firstly rename it to something obscure and, secondly, deny access to the file from external sources:
{{{
AccessFileName .myobscurefilename
&lt;Files ~ &quot;^\.my&quot;&gt;
    Order allow,deny
    Deny from all
    Satisfy All
&lt;/Files&gt;
}}}

!No Options
Options
{{{
Options None
}}}
This will turn off all the available options.

!Hierarchy
Remember that the Options directives can be set per directory like this:
{{{
&lt;Directory /&gt;
  AllowOverride None
  Options None
&lt;/Directory&gt;

&lt;Directory /home/demo/public_html/domain.com/public&gt;
  AllowOverride All
&lt;/directory&gt;
}}}
This will turn of all Options and disable .htaccess support for all directories.

However, the second Directory setting will override the first and allow .htaccess support for the domain.com/public directory.

!Заключение
The Virtual Hosts file is at once an easy tool to use and a very powerful one. My advice is to enter one setting and test it. Then enter the next setting and so on. Once familiar you will see you have fine control over all of your web folders and files.

!Ссылки
*[[Оригинал статьи на slicehost.com (часть 1)|http://articles.slicehost.com/2008/12/17/ubuntu-intrepid-apache-virtual-hosts-1]]
*[[Оригинал статьи на slicehost.com (часть 2)|http://articles.slicehost.com/2008/12/17/ubuntu-intrepid-apache-virtual-hosts-1]]


</pre>
</div>
<div title="Настройка доступа по SSH на базе секретных ключей без ввода пароля" modifier="Яковлев Иван" created="200907201155" modified="200907201157" tags="[[Удаленное подключение]] SSH" changecount="3">
<pre>!Описание
В {{{/etc/ssh/sshd_config}}} проверяем активна ли опция &quot;{{{PubkeyAuthentication yes}}}&quot;. 
Запускаем на локальной машине программу ssh-keygen (ssh-keygen -t rsa), на все задаваемые вопросы принимаем значения по умолчанию (поле passphrase оставляем пустым).
Далее, запускаем программу 
{{{
ssh-copy-id -i ~/.ssh/id_rsa.pub user@remotehost
}}}
где
*''user'' -- пользователь удаленной машины 
*''remotehost'' -- адрес удаленной машины,
( или вручную, на удаленной машине в директории {{{~/.ssh}}}, создаем файл ''authorized_keys'', куда копируем содержимое файла identity.pub (id_rsa.pub) с локальной машины). 

Для увеличения безопасности в файл {{{~/.ssh/authorized_keys}}} на удаленной машине добавляем перед ключом (разделив пробелом) строку:
{{{
    from=&quot;localhost&quot;
}}}
где localhost - адрес локальной машины ({{{from=&quot;localhost&quot; 1024 23 1343.....}}}).

!См. также
*[[OpenSSH сервер]]

!Ссылки
*[[Статья на Opennet.ru|http://www.opennet.ru/tips/info/284.shtml]]


</pre>
</div>
<div title="Настройка кодировки в vsFTPd" modifier="Яковлев Иван" created="200906052334" tags="Статьи FTP TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/nastrojka-kodirovki-v-vsftpd.html#more-92]]



</pre>
</div>
<div title="Настройка маршрутизации в Ubuntu Linux для начинающих" modifier="Яковлев Иван" created="200906052343" tags="[[Установка/настройка сервера]] Статьи TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/nastrojka-marshrutizacii-v-ubuntu-linux-dlya-nachinayushhix.html#more-110]]



</pre>
</div>
<div title="Настройка маршрутизации с помощью Quagga (zebra)" modifier="Яковлев Иван" created="200906052344" tags="[[Установка/настройка сервера]] Статьи TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/nastrojka-marshrutizacii-s-pomoshhyu-quagga-zebra.html#more-116]]



</pre>
</div>
<div title="Настройка окружения nginx для Ubuntu" modifier="Яковлев Иван" created="200906200112" modified="200907021302" tags="[[Настройка Nginx]] [[TODO - нужен перевод статьи]] slicehost" changecount="7">
<pre>!Описание
Following from [[Установка Nginx из исходных кодов]] и [[Настройка автоматическго запуска nginx]] we can now move onto looking at the Nginx layout.

The idea of this article is to change the default layout to one more in keeping with the 'Debian' style. Installing Nginx via the package manager creates this layout automatically -- we need to do it by hand.

!Зачем?
You do, of course, have the option of leaving the layout exactly as it is. However, any further Nginx articles will use the 'Debian' layout which includes sites-available and sites-enabled folders.

This gives common ground to those who installed Nginx via the 'aptitude' package manager and those who installed Nginx via source. As an aside, I also find it a very convenient and easy way of organising my virtual hosts.

!Layout
As alluded to, the layout we want to create is the same as if we installed Nginx via the package manager. The main difference being that any any virtual host files are kept in a 'sites-available' folder — each vhost has its own file and configurations.

This makes for easy administration as they are not all placed in one unwieldy monolithic file. One thing to note is that any vhosts in the 'sites-available' folder are not 'live' — to enable a vhost, we simply place a symlink in a 'sites-enabled' folder pointing to the vhost file.

!Folders
Let's start by creating the two main folders (remember Nginx was installed into '/usr/local/nginx'):
{{{
sudo mkdir /usr/local/nginx/sites-available
...
sudo mkdir /usr/local/nginx/sites-enabled
}}}
Done.

!Configuration
Now we need to adjust the main Nginx configuration file to look in the sites-enabled folder for our vhosts:
{{{
sudo nano /usr/local/nginx/conf/nginx.conf
}}}
I won't list the contents of the file here but note that the vast majority of the contents consists of two virtual hosts -- a default for port 80 and a default for port 443 (which is actually commented out).

This is a great example of an unwieldy file -- it contains just two virtual hosts and is already difficult to follow in a terminal.

The easiest thing is to delete the contents of the file (you can make a copy if you wish) and replace it with this:
{{{
user www-data;
worker_processes  1;

events {
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        on;

    keepalive_timeout  65;

    gzip  on;

    include /usr/local/nginx/sites-enabled/*;

}
}}}
The contents are very similar to those created when installing Nginx via the package manager. Let's save the file and move onto creating a default vhost.

!Default vhost
Create a default vhost file in the sites-available folder:
{{{
sudo nano /usr/local/nginx/sites-available/default
}}}
The contents are very simple and come from the original configuration:
{{{
server {
    listen       80;
    server_name  localhost;

    location / {
        root   html;
        index  index.html index.htm;
    }


    # redirect server error pages to the static page /50x.html
    #
    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root   html;
    }

}
}}}
To enable the vhost all we need to do is create a symlink:
{{{
sudo ln -s /usr/local/nginx/sites-available/default /usr/local/nginx/sites-enabled/default
}}}

!Restart
Restart Nginx:
{{{
sudo /etc/init.d/nginx restart
}}}
Navigating to your slice's IP will show the default &quot;Welcome to nginx!' page.

Done.

To create any further virtual hosts all you need to do is create the main file in the 'sites-available' folder, create a symlink in the 'sites-enabled' folder and restart Nginx.

All very simple and very organised.

!Дополнительная настройка для php-fpm
надо отрегулировать fastcgi_params
{{{
sudo gedit /usr/local/nginx/conf/fastcgi_params
}}}
и в самый верх добавляем:
{{{
fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
}}}
{{note{
''ЗАМЕЧАНИЕ:''
Если мы не используем Apache, то надо закомментировать строчку
{{{
fastcgi_param REDIRECT_STATUS 200;
}}}
т.е. заменить на следующий вид:
{{{
#fastcgi_param REDIRECT_STATUS 200;
}}}
}}}

!Заключение
Mirroring the layout used when installing Nginx via the aptitude package manager allows for much easier administration of your virtual hosts — each vhost has its own file and can be switched on and off by a symlink to the sites-enabled folder.

The next article will look at configuring and optimising Nginx for use on your Slice.

!См. далее
*[[Начальное конфигурирование Nginx]]

!Ссылки
*[[Оригинал статьи на slicehost.com|http://articles.slicehost.com/2009/3/4/ubuntu-intrepid-nginx-from-source-layout]]


</pre>
</div>
<div title="Настройка окружения для виртуальных хостов" modifier="Яковлев Иван" created="200906200123" modified="200907021255" tags="[[Установка/настройка Web-сервера]] [[TODO - нужен перевод статьи]] TODO slicehost" changecount="3">
<pre>!Описание
During these articles I will be talking about different operating systems, different web servers and different, er, stuff. To make things easier to understand and reference between articles and systems, I will use a 'standard' layout for hosting multiple sites (virtual hosts). Let me explain the layout I use.

!Особенности
As you know, there are several differences between distributions and not just in libraries, package management and so on. The default directory locations for serving domains also differs. Some default to {{{/var/www/}}} and some to {{{/srv/www/}}}. Some organisations recommend {{{/srv/domain.com/}}}.

!Последовательность
The way I will use is not the only way, nor is it special or the 'Slicehost' way. It is, however, one way of organising your domains in one place and will work across different operating systems and web servers.

I will also mention that if you are using a shared hosting environment on your Slice then do stick with the OS defaults. My method places the domain directories in my home directory.

I am the only user of my Slice and this is, as far as I am aware, the case with the vast majority of Slice users, so I do not have to be concerned about other users logging in and accessing my home directory (apart from the usual security measures that is).

!Окружение
My domains are laid in their own directories in my {{{/home/demo/public_html}}} folder (''demo'' is my main user name). In each domain, I have a standard set of folders including logs, cgi, private, public, backup and so on, but feel free to add/delete directories as you see fit.

One advantage of this layout is consistency between technologies. A standard Ruby on Rails application will have many directories with the main content being served from the 'public' directory. My layout coincides with this so my plain html and dynamic PHP content are also served from the {{{domain.com/public}}} directory.

I can't incorporate every technology into one layout but I think this covers most eventualities. Specific articles (such as using Capistrano) will note the differences.

!Каталоги
Let's take a look at the folders in use throughout these articles:

{{textAlignCenter{
[img[images/articles/layout1.jpg]]
}}}
So in this example I have three domains - each in their own directory. I always class subdomains as separate from the 'main' domain. After all, they have different content.

!Детали
Let's look in detail at the domain1.com folder:

{{textAlignCenter{
[img[images/articles/layout2.jpg]]
}}}
The layout is quite simple once you get used to all the connections:
*''public:'' where publicly served files, images, etc are placed.
*''private:'' used for files you do not want in the public domain such as PHP mysql connection files.
*''cgi-bin:'' umm, the cgi-bin
*''logs:'' place domain logs here - it keeps them separate and easily accessible.
*''backup:'' I place daily database backups here - makes for easier slice backups.

!Изменения
Naturally, add/delete folders as you see fit. However, this is the layout that will be used throughout the articles when it comes to domain configurations. Also, do use the OS default if you feel more comfortable doing so. Simply adjust the paths used in the demonstrations.

!Ссылки
*[[Оригинал статьи на slicehost.com|http://articles.slicehost.com/2007/9/13/multiple-hosts-layout]]


</pre>
</div>
<div title="Настройка прав доступа для виртуальных хостов" modifier="Яковлев Иван" created="200906200126" modified="200907021255" tags="[[Установка/настройка Web-сервера]] [[TODO - нужен перевод статьи]] TODO slicehost" changecount="7">
<pre>!Описание
One thing that can cause concern and configuration headaches is virtual hosts permissions. Using the multiple hosts layout in [[this article|Настройка окружения для виртуальных хостов]] is a good way of keeping your domains in one place and with easy access. Let's take a look at the permissions of the folders.
{{note{
''ЗАМЕЧАНИЕ:''
A quick reminder of the layout used in these articles:
*All the vhosts directories are place in the user's home directory under ''public_html''. Each domain has it's own directory with a 'standard' set of folders such as ''public'', ''private'', ''logs'', ''cgi-bin'', ''backup'' and so on.
*[[The multiple hosts layout article|Настройка окружения для виртуальных хостов]] has some images to show the layout in detail.
}}}

!Пользователи
We have to think of who will want access to the folders. There are two users to consider. The first is the Slice user - in this case my username is 'demo'. It is in demo's home directory that the public_html directory is placed. 

Secondly is the Apache user. On Debian based systems it is usual for Apache to be '''www-data''' and be in the '''www-data''' group. Other Linux distributions use the user '''nobody''' or even '''apache'''.

!Права доступа
Now we need to think about what actions will need to be taken by what user. Apache needs to be able to enter the public_html folder and to be able to read the public and private directories.

The logs are written by the 'parent' Apache process which is root so we don't have to worry about that (root will have access to the logs directory anyway - all other Apache processes are completed by the child process which will be '''www-data''' or '''nobody''').

!Права на запись
OK, but what happens if Apache needs write access? An example of this would be uploading images or files.

One way would be to allow world write access to the folder (setting the permissions at ''777''). The problem with this is that the world has write access to the folder. Even if you had a specific upload folder and were careful with your scripts, it still leaves a ''777'' folder exposed to the public.

!Группы 
Remember the layout being used is for single user Slices. I host many websites on one Slice and I am the only one who has access to it. What if we placed the main user (demo) in the 'www-data' group? That way, any folder that Apache needs to write to, such as the image upload folder, would only need ''660'' permissions.

There is no need for any other system user to access those folders. This also stops the practice of having a folder with ''777'' permissions.

!Настройка пользователя
So let's start by adding the main user to the Apache user group:
{{{
sudo usermod -a -G www-data demo
}}}
That adds the user '''demo''' to the '''www-data''' group. Do ensure you use both the {{{-a}}} and the {{{-G}}} options with the usermod command shown above.

You will need to log out and log back in again to enable the group change.

Check the groups now:
{{{
groups
...
# demo www-data
}}}
So now I am a member of two groups: My own (''demo'') and the Apache group (''www-data'').

!Настройка каталогов
Now we need to ensure the ''public_html'' folder is owned by the main user (''demo'') and is part of the Apache group (''www-data'').

Let's set that up:
{{{
sudo chgrp -R www-data /home/demo/public_html
}}}
As we are talking about permissions I'll add a quick note regarding the sudo command: It's a good habit to use absolute paths ({{{/home/demo/public_html}}}) as shown above rather than relative paths ({{{~/public_html}}}). It ensures sudo is being used in the correct location.
{{note{
@@font-weight: bold;color: red;ВНИМАНИЕ:@@
If you have a public_html folder with symlinks in place then be careful with that command as it will follow the symlinks. In those cases of a working public_html folder, change each folder by hand.
}}}

!Привязка
Good so far, but remember the command we just gave only affects existing folders. What about anything new? We can set the ownership so anything new is also in the '''www-data''' group.

The first command will change all permissions in the ''public_html'' directory so, again, be careful if you have existing content and symlinks:
{{{
sudo chmod -R 2750 /home/demo/public_html
}}}
That will ensure that any new files are given the user '''demo''' and the group '''www-data'''.

If we need to allow write access to Apache, to an uploads directory for example, then set the permissions for that folder like so:
{{{
sudo chmod -R 2770 /home/demo/public_html/domain1.com/public/uploads
}}}
The permissions only need to be set once as new files will automatically be assigned the correct ownership.
{{note{
''ЗАМЕЧАНИЕ:''
Чтобы разобраться что значит {{{chmod 2770}}} прочтите эту статью: [[Ньюансы безопасности web-хостинга и режим chmod 2770]].
}}}


!Dry
This may get a bit tedious when you add new domains to your public_html folder. In that case, I would create a 'skeleton' domain structure with the relevant permissions and simply copy it to the new domain:
{{{
cp -a /home/demo/public_html/skeleton /home/demo/public_html/my_new_domain
}}}
That way you have a nice and new set of folders with the correct permissions in one simple command.

!Заключение
Permissions are a sensitive topic and you do have to be careful with them. Don't just enter a '{{{chmod -R}}}' command without thinking about the contents and symlinks. I hope this helps alleviate concerns about vhosts and permissions. I'd also like to thank Placid for his help in proof-reading this article - it was one I did not want to get wrong!

!См. также
*[[Ньюансы безопасности web-хостинга и режим chmod 2770]]

!Ссылки
*[[Оригинал статьи на slicehost.com|http://articles.slicehost.com/2007/9/18/apache-virtual-hosts-permissions]]


</pre>
</div>
<div title="Настройка процесса загрузки в Ubuntu" modifier="Яковлев Иван" created="200906040950" modified="200906041008" tags="[[Настройка Ubuntu]]" changecount="4">
<pre>Рассмотрим процесс загрузки операционной системы. Его можно условно разделить на три части: ''Grub'', ''Usplash'' и ''GDM''.

!Grub
Grub - менеджер загрузок операционных систем.

{{textAlignCenter{
[img[images/articles/grub.png]]
}}}
На рисунке выше вы можете видеть список операционных систем, доступных для загрузки. На самом деле их там только две: Ubuntu и Windows XP. Первые две записи - Ubuntu в обычном режиме и в режиме восстановления. Чуть ниже вы видите две строки, которые идентичны предыдущим, но с разными числовыми значениями. Это загрузка с другим ядром. Обычно такая ситуация возникает, если ядро обновлялось. После этого идет тест памяти и загрузка Windows XP.

Сейчас мы посмотрим как изменить это меню, настроить его под себя и немного преобразить интерфейс. Как обычно бывает в Linux - сделать это можно с помощью графической утилиты, либо вручную.

{{note{
@@color: red;font-weight: bold;ВНИМАНИЕ!@@
Не устанавливайте qgrub editor, описанный ниже. Он приводит к краху системы. Пожалуйста, используйте описание действия программы только для того, чтобы понять, как сделать тоже самое вручную. Статья будет изменена в ближайшем будущем.
}}}

Для начала рассмотрим первый способ. Есть несколько утилит для работы с Grub, я предпочитаю ~QGrubEditor. Когда поймете основы - выберите то, что вам больше по душе. Установим утилиту.
{{{
sudo apt-get install qgrubeditor
}}}
Или через Synaptic. Прежде чем что-либо делать - сделайте копию файла  {{{/boot/grub/menu.lst}}}. Сделайте это хотя бы для того, чтобы потом можно было посмотреть на исходных файл с комментариями и разобраться что к чему. Можно сделать скрытую директорию {{{.backups}}} в домашнем каталоге и складывать туда все такие файлы.
{{{
mkdir ~/.backups &amp;&amp; cp /boot/grub/menu.lst ~/.backups
}}}
Можно приступать. Заходим в меню &quot;Приложения - Системные - ~QGrubEditor&quot;.

{{textAlignCenter{
[img[images/articles/menu-qgrubeditor.png]]
}}}
Вы видите пункты меню из Grub. Их можно удалять, изменять, переименовывать, менять местами. Например, можно удалить загрузчики для старого ядра.

{{textAlignCenter{
[img[images/articles/qgrub-editor.png]]
}}}
После удаления стало немного почище. Я не рекомендую вам удалять режим восстановления или тест памяти. Хотя вы можете им никогда не воспользоваться - все же такая ситуация может наступить когда-нибудь.

По умолчанию загружается первый пункт меню - т.е. Ubuntu в обычном режиме. Это поведение можно изменить. Нажмите правой кнопкой мыши на том пункте, который вас интересует в первую очередь и сделайте &quot;Set Default&quot; или что-то в этом роде.

Выделите какой-нибудь пункт (например первый) и нажмите кнопку редактировать запись.

{{textAlignCenter{
[img[images/articles/press-edit-entry.png]]
}}}
В появившемся окне вы можете отредактировать все, что касается данной записи. Например, можно изменить заголовок, который показывается при загрузке. Все остальное стоит менять только в том случае, если вы знаете что делаете, иначе система может не загрузиться вообще!

{{textAlignCenter{
[img[images/articles/edit-entry.png]]
}}}
Чуть позже мы еще вернемся к этому окну. А теперь перейдем к более интересному. Щелкните на закладке Grub Settings внизу программы.

{{textAlignCenter{
[img[images/articles/choose-image.png]]
}}}
Здесь вы можете поменять время, через которое начнется загрузка пункта меню по умолчанию, отключить показ меню (или включить его, если у вас одна операционная система), поставить пароль на загрузку. Но самый интересный пункт это Splash Image.

Можно поставить картинку на загрузку. Это называется grub splash image. Картинки можно сделать самому, или взять на сайте. 
Заходим на http://www.gnome-look.org/. К сожаленью, пункта меню для картинок Grub нету, но их можно найти по поиску, если ввести в поле запроса &quot;grub&quot;. Можете взять для теста картинку, которой я пользуюсь.

Включаем пункт &quot;Splash Image&quot; и указываем путь к заставке. Она должна быть в формате xpm.gz. Закрываем программу, перегружаемся и видим такую вот красоту.

{{textAlignCenter{
[img[images/articles/new-grub.png]]
}}}
Теперь тоже самое только вручную.

!Конфигурационный файл Grub
Все настройки для grub хранятся в файле {{{/boot/grub/menu.lst}}}. Откроем его на редактирование
{{{
sudo gedit /boot/grub/menu.lst
}}}
Я надеюсь, что вы предварительно все же сделали копию. Вот пример файла после изменений в ~QGrubEditor:
{{{
splashimage=(hd0,5)/boot/grub/themes/beLinux.xpm.gz
default 4
timeout 10

title Ubuntu 8.04.1, kernel 2.6.24-21-generic
root (hd0,5)
kernel /boot/vmlinuz-2.6.24-21-generic root=UUID=2671a137-8615-47ca-8017-d9bf9468230e ro splash
initrd /boot/initrd.img-2.6.24-21-generic
quiet

title Ubuntu 8.04.1, kernel 2.6.24-21-generic (recovery mode)
root (hd0,5)
kernel /boot/vmlinuz-2.6.24-21-generic root=UUID=2671a137-8615-47ca-8017-d9bf9468230e ro single
initrd /boot/initrd.img-2.6.24-21-generic

title Ubuntu 8.04.1, memtest86+
root (hd0,5)
kernel /boot/memtest86+.bin
quiet

title Other operating systems:
root 

title Microsoft Windows XP Professional RU
root (hd0,0)
chainloader +1
savedefault
makeactive
}}}

Каждый отдельный пункт загрузчика выделен в свою область, это легко прослеживается и изменяется, но будьте осторожны: при неправильном изменении система может не загрузится вообще.

Обратите внимание на то, что путь к splashimage (картинка) в моем примере содержит (''hd0,5''). У вас это значение будет свое. Как его узнать? Да очень просто. Найдите пункт меню, который указывает на загрузку Ubuntu и посмотрите на строчку ''root''. Параметр ''default'' указывает на пункт меню, который будет грузится по умолчанию. ''timeout'' - время ожидания. Все остальное - пункты меню и, если вы не знаете что делаете, изменяйте только ''title'' - это название самих пунктов.

!Usplash
После того, как вы выбрали нужный пункт меню в Grub, начинается загрузка операционной системы.

{{textAlignCenter{
[img[images/articles/usplash-default.png]]
}}}
Перед нам Usplash. Его тоже можно немного затюнить. Открывайте опять ~QGrubEditor, находите пункт меню загрузки Ubuntu и нажимайте редактировать запись. Ищите строку Kernel. То, что нас интересует, находится в самом конце.

{{textAlignCenter{
[img[images/articles/ro-quiet-splash.png]]
}}}
Последние символы - &quot;ro quiet splash&quot;. Если удалить &quot;quiet&quot; (будьте аккураты с пробелами), то при загрузке вы увидите такую картину:

{{textAlignCenter{
[img[images/articles/usplash-no-quiet.png]]
}}}
Выглядит довольно привлекательно, можно контролировать процесс загрузки. Ну и если удалить splash, то вы увидите обычную консоль.

{{textAlignCenter{
[img[images/articles/without-usplash.png]]
}}}
Но это уже на любителя.

Естественно, тоже самое можно сделать, просто отредактировав файл {{{/boot/grub/menu.lst}}}.

!GDM
Ну и наконец мы добрались до Gnome Display Manager. Залогиньтесь и зайдите в пункт меню &quot;Система - Администрирование - Окно входа в систему&quot;.

{{textAlignCenter{
[img[images/articles/menu-gdm.png]]
}}}
Здесь можно поменять много чего, но я сейчас опишу вкладку &quot;Локальный вход&quot;.

{{textAlignCenter{
[img[images/articles/gdm-tool-default.png]]
}}}
Вы можете поменять заставку на другую или сделать так, чтобы они менялись при каждом входе в систему. Если заставки по-умолчанию вас не устраивают, идем не следующие сайты:
http://art.gnome.org/

{{textAlignCenter{
[img[images/articles/art-gnome-org-gdm.png]]
}}}
http://www.gnome-look.org/

{{textAlignCenter{
[img[images/articles/gnome-look-org-gdm.png]]
}}}
Закачиваем заставку по душе. Обратите внимание на то, что на сайте gnome-look.org нужно быть внимательным к тому, что вы скачиваете! Например, на картинке ниже к теме относится не только заставка GDM, но также картина рабочего стола, иконки и тема GTK

{{textAlignCenter{
[img[images/articles/gdm-and-wallpapers-warning.png]]
}}}
После того, как скачали интересующую вас тему, добавляйте ее:

{{textAlignCenter{
[img[images/articles/gdm-tool-added-new.png]]
}}}
При следующем входе в систему заставка сменится. Иногда тема не сохраняется и значение сбрасывается на &quot;Менять темы при заставке&quot;! Такое было много раз и причина пока не ясна. В этом случае зайдите опять в настройки и выставьте все, как надо. Второй раз такого уже не будет.

{{textAlignCenter{
[img[images/articles/gdm-new.png]]
}}}
Заставку, указанную на картинке выше можно скачать отсюда. В комплекте идут 4 заставки разных цветов + 4 заставки для широкоформатных мониторов и такой же набор обоев рабочего стола.

!Оригинал статьи
*http://ubuntologia.ru/grub-usplash-gdm


</pre>
</div>
<div title="Настройка различных типов виртуальных хостов" modifier="Яковлев Иван" created="200906191602" modified="200906191709" tags="[[Настройка Apache]] TODO" changecount="11">
<pre>*''Описание''
*''Виртуальные сервера с идентификацией по имени''
*''Виртуальные сервера с идентификацией по ~IP-адресу''
*''Виртуальные сервера с идентификацией по порту''

!Описание
Концепция  виртуальных  хостов позволяет Apache поддерживать несколько Web-узлов.  Получается,  что  один  Web-сервер  заменяет  несколько  и пользователи  видят  отдельные  Web-узлы. Это очень удобно, если нужно организовать   персональные  Web-узлы  пользователей  или  собственные Web-узлы подразделений компании, например {{{develop.mycompany.com}}}

Apache  можно  настроить  несколькими способами: чтобы запускался один сервер,   который  будет  прослушивать  ВСЕ  обращения  к  виртуальным серверам,  или  запускать  отдельный  процесс для каждого виртуального сервера.  В  первом  случае один сервер будет одновременно обслуживать все  виртуальные. Если вас интересует такой вариант, нужно настраивать виртуальные   сервера   с  помощью  директивы  {{{VirtualHost}}}.  Настройка отдельны  процессов  для  каждого  сервера  осуществляется  с  помощью директивы {{{Listen}}} и {{{BindAddress}}}.

В  статье  я  буду  рассматривать  именно  первый случай.
{{note{
''ЗАМЕЧАНИЕ:''
Внутри блока директивы   {{{VirtualHost}}}  можно  использовать  любые  директивы,  кроме:
*{{{ServerType}}},
*{{{BindAddress}}},
*{{{Listen}}},
*{{{NameVirtualHost}}},
*{{{ServerRoot}}},
*{{{TypesConfig}}},
*{{{PidFile}}},
*{{{MinRequestPerChild}}},
*{{{MaxSpareServers}}},
*{{{MinSpareServers}}},
так  как  некоторые  из  них  относятся  к основному ~HTTP-серверу (например, {{{ServerType}}}), а некоторые -- ко второму варианту настройки виртуальных серверов и здесь неприемлемы.

Обязательно должны присутствовать   директивы:
*{{{ServerName}}},
*{{{DocumentRoot}}},
*{{{ServerAdmin}}}
*{{{ErrorLog}}}
}}}
В  зависимости  от  версии и от настроек Apache виртуальные узлы могут прописываться или в файле {{{httpd.conf}}} или в файле {{{vhosts.conf}}}. Виртуальные сервера можно идентифицировать по имени или по ~IP-адресу. 

!Виртуальные сервера с идентификацией по имени
Идентификация   по   имени   имеет   существенное  преимущество  перед идентификацией  по  ~IP-адресу:  вы  не ограничены количеством адресов, имеющемся   у   вас  в  распоряжении.  Вы  можете  использовать  любое количество   виртуальных  серверов  и  при  этом  вам  не  потребуются дополнительные   адреса.   Такое   возможно   благодаря  использованию протокола  HTTP/1.1. Данный протокол поддерживается всеми современными браузерами.

Поддержка  виртуальных хостов обеспечивается директивами {{{VirtualHost}}} и {{{NameVirtualHost}}}.  Если  ваша  система  имеет только один ~IP-адрес, его нужно   указать   в  директиве  {{{VirtualHost}}}.  Внутри  блока  директивы {{{VirtualHost}}}  записывается  директива  {{{ServerName}}}. Эта директива задает доменное  имя  для  нашего виртуального сервера. Это обязательно нужно сделать, чтобы избежать поиска службой DNS - мы же не хотим, чтобы при неудачном  поиске  виртуальный  сервер был заблокирован? Все директивы {{{VirtualHost}}}  используют  один  и  тот же ~IP-адрес, заданный директивой {{{NameVirtualHost}}}. В блоке {{{VirtualHost}}}   записываются   параметры виртуального сервера, причем они записываются для каждого виртуального сервера отдельно.

!!Пример 1: Создадим два виртуальных сервера - ''www'' и ''lib''
{{{
        ServerName den.dhsilabs.com

        &lt;NameVirtulaHost 192.168.1.1&gt;

        &lt;VirtualHost 192.168.1.1&gt;
                ServerName www.dhsilabs.com
                ServerAdmin webmaster@den.dhsilabs.com
                DocumentRoot /var/httpd/www/html
                ErrorLog /var/https/www/logs/error.log
                TransferLog logs/access.log
        &lt;/VirtualHost&gt;

        &lt;VirtualHost 192.168.1.1&gt;
                ServerName lib.dhsilabs.com
                ServerAdmin webmaster@den.dhsilabs.com
                DocumentRoot /var/httpd/lib/html
                ErrorLog /var/https/lib/logs/error.log
                TransferLog logs/access.log
        &lt;/VirtualHost&gt;
}}}
Если ваша система имеет только один ~IP-адрес, доступ к основному серверу станет невозможным, то есть вы не сможете использовать его напрямую. Можно основной сервер использовать в качестве виртуального, что я и сделал в примере 1.1.: основной сервер www является виртуальным. При наличии двух ~IP-адресов можно один присвоить основному серверу, а другой - виртуальным.

Apache позволяет использовать несколько доменных имен для доступа к одному серверу:
{{{
        ServerAlias www.dhsilabs.com www2.dhsilabs.com
}}}
Запросы, посланные по ~IP-адресам, которые присвоены нашим виртуальным хостам, должны соответствовать одному из указанных доменных имен. Чтобы зафиксировать запросы, не соотвествующие ни одному их этих имен, нужно с помощью опции {{{default:*}}} создать виртуальный хост, который будет обслуживать такие запросы:
{{{
        &lt;VitrualHost _default_:*&gt;
}}}
Обратите внимание на то, что адреса {{{www.dhsilabs.com}}} и {{{lib.dhsilabs.com}}} должны быть прописаны в DNS

!Виртуальные сервера с идентификацией по ~IP-адресу
В директиве {{{VirtualHost}}} в качестве адресов можно использовать доменные имена, но лучше указывать ~IP-адрес, причем действительный, а не виртуальный. В этом случае вы не будете зависеть от DNS при резолвинге. Также потребуется один ~IP-адрес для вашего основного сервера. Если распределить все адреса между виртуальными серверами, то нельзя будет получить доступ к основному серверу.

!!Пример 2:
{{{
        &lt;VitrualHost 192.168.1.2&gt;
                ServerName www.dhsilabs.com
                ServerAdmin webmaster@den.dhsilabs.com
                DocumentRoot /var/httpd/www/html
                ErrorLog /var/https/www/logs/error.log
        &lt;/VirtualHost&gt;

        &lt;VirtualHost lib.dhsilabs.com&gt;
                ServerName lib.dhsilabs.com
                ServerAdmin webmaster@den.dhsilabs.com
                DocumentRoot /var/httpd/lib/html
                ErrorLog /var/https/lib/logs/error.log
        &lt;/VirtualHost&gt;
}}}
В приведенном примере сконфигурированы два виртуальных сервера и идентификацией по ~IP-адресу. Один из них использует сам ~IP-адрес, а другой -- доменное имя, соответствующее ~IP-адресу.

При конфигурировании виртульных серверов можно использовать опцию ~ExeсCGI, которая разрешает выполнение ~CGI-скриптов на виртуальном сервере. Ниже приведен пример для почтового Web-интерфейса:

!!Пример 3: Подключение почтового Web-интерфейса
{{{
        # Файл httpd.conf

        &lt;Directory /home/httpd/mail&gt;
                order deny,allow
                deny from all
                allow from localhost
                allow from 192.168
                allow from 123.123.123.123
                Options ExecCGI
        &lt;/Directory&gt;

        # Файл vhosts.conf

        &lt;VirtualHost 123.123.123.123&gt;
                ServerAdmin webmaster@den.dhsilabs.com
                DocumentRoot /home/httpd/mail
                ServerPath /mail
                ServerName wwwmail.dhsilabs.com
                ErrorLog logs/error_log
                TransferLog logs/access_log
                ErrorDocument 403 http://www.dhsilabs.com/messages/error403.html
        &lt;/VirtualHost&gt;

        # Error 403 - доступ извне, то есть почтовый интерфейс будет доступен только
        # из локальной сети
}}}

!Виртуальные сервера с идентификацией по порту
!!Как разместить на одном IP несколько web-страниц, и получить доступ к ним по различным портам одного IP?
Основано на документах http://httpd.apache.org/docs/

Существует несколько вариантов решения задачи:

Легко заставить сервер слушать несколько портов для одного адреса.
{{{
     Listen 80
     Listen 2222
}}}
Это сделает сервер доступным по обоим портам.

Легко заставить сервер слушать несколько разных адресов (алиасов) на разных портах:
{{{
     Listen 202.187.1.10:80
     Listen 202.187.1.11:2222
}}}
Трудно заставить сервер слушать разные порты для одного адреса в одной инсталляции. Можно резюмировать так: директивы {{{BindAddress}}} и {{{Listen}}} могут определять использование нужных IP адресов и портов, но, не разграничивать виртуальные сервера по разным портам одного адреса. {{{ServerRoot}}} будет один.

Смотреть:
*http://httpd.apache.org/docs/vhosts/ip-based.html
*http://httpd.apache.org/docs/bind.html

!!Еще верианты
Использовать одновременно несколько демонов httpd. Это означает, что необходимо установить несколько серверов apache (в разные директории), что даст вам возможность иметь несколько конфигурационных файлов, и использовать директиву Listen для выбора необходимого порта и IP адреса. В данном случае, нас интересует только порт, т.е. во всех  httpd.conf будут одинаковые адреса, но разные порты и директории {{{ServerRoot}}}. Самое интересное, это даст вам возможность использовать различные настройки User и Group, что может очень грамотно разграничить права доступа к информации. В каждой копии httpd.conf определим разные порты и {{{ServerRoot}}}:
{{{
     Listen 212.111.22.12:80
     ServerRoot /var/www/1/

     Listen 212.111.22.12:81
     ServerRoot /var/www/2/

     Listen 212.111.22.12:82
     ServerRoot /var/www/3/

     Listen 212.111.22.12:83
     ServerRoot /var/www/4/
}}}
{{note{
''Примечание:''
Использование IP адресов вместо имен предпочтительно в данном случае.
Но, на самом деле, удобнее использовать чистые варианты ~Name-based Virtual Hosts или ~IP-based Virtual Hosts. Данный трип рассматривать как частный случай.

Смотреть:
*http://httpd.apache.org/docs/vhosts/name-based.html
*http://httpd.apache.org/docs/vhosts/ip-based.html
}}}
Удачи. Ждем Вас на форуме http://www.shelter.almnu.ru/forum/

!Ссылки
*[[Оригинал статьи|http://www.opennet.ru/base/net/virtual_ftp_http.txt.html]]
*http://www.opennet.ru/base/dev/apache_vhost.txt.html


</pre>
</div>
<div title="Настройка репозитария Medibuntu" modifier="Яковлев Иван" created="200906032323" modified="200906121526" tags="[[Репозитарии и обновление в Ubuntu]]" changecount="5">
<pre>Рассмотрим процесс добавления одного из наиболее важных сторонних репозитариев. Medibuntu - репозитарий, который содержит такие полезные вещи, как кодеки и много другого добра, но не может быть включен в официальные репозитарии Ubuntu по причине лицензий и легальности.

Заходим на сайт medibuntu: http://www.medibuntu.org/

{{textAlignCenter{
[img[images/articles/medibuntu-repository-howto.png]]
}}}
Сразу же видно ссылку Repository ~HowTo, переходим по ней. В появившемся окне прокручивам страницу, пока не дойдем до секции &quot;Adding the Repositories&quot;.

{{textAlignCenter{
[img[images/articles/medibuntu-how-to-add-page.png]]
}}}
Как вы могли заметить, здесь описан ручной способ добавления репозитария. Но вам фактически ничего не нужно делать, только копировать код в консоль и запускать.

Для начала ищем код добавления репозитария для вашей версии Ubuntu. После чего, обратите внимание на то, что в самом низу показано как добавить ключ для репозитария. Это именно то, о чем мы говорили в данной статье раньше.

Добавим репозиторий для Ubuntu 8.10:
{{{
sudo wget http://www.medibuntu.org/sources.list.d/intrepid.list --output-document=/etc/apt/sources.list.d/medibuntu.list
}}}
Посмотрим внимательней на результат команды:

{{textAlignCenter{
[img[images/articles/medibuntu-added-repository.png]]
}}}
Все, что делает команда - это создает файл /etc/apt/sources.list.d/medibuntu.list

Давайте посмотрим на его содержимое.
{{{
gedit /etc/apt/sources.list.d/medibuntu.list
}}}
Обратите внимание на то, что я открываю файл, который доступен на редактирование только суперпользователю, но я не использую команду {{{sudo}}}. Причина простая - я не собираюсь редактировать файл.

{{textAlignCenter{
[img[images/articles/medibuntu-gedit-sources.list.png]]
}}}
Структура файла точно такая же, как и у конфигурационного файла /etc/apt/sources.list. Но почему файл другой и путь к нему другой? Причина простая: все конфигурационные файлы с репозитариями, которые будут помещены в директорию /etc/apt/sources.list.d/ будут автоматически использованы. Это очень удобно, т.к. вы можете хранить в отдельных файлах настройки для разных репозитариев, что значительно облегчает их поиск и редактирование.

Теперь добавим ключ репозитория, но не выполняйте пока команду.
{{{
sudo apt-get update &amp;&amp; sudo apt-get install medibuntu-keyring &amp;&amp; sudo apt-get update
}}}
Давайте рассмотрим эту команду по частям. &amp;&amp; обозначает что следующая команда должна выполняться при успешном завершении предыдущей команды. Т.е. это список трех идущих подряд команд:
{{{
sudo apt-get update
sudo apt-get install medibuntu-keyring
sudo apt-get update
}}}
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
Первая и третья команды повторяются, но зачем?

Как уже было сказано, команда {{{sudo apt-get update}}} обновляет информацию с репозитариев. Мы только что добавили новый репозиторий и вполне естественно что надо ее обновить.
}}}

{{textAlignCenter{
[img[images/articles/medibuntu-first-apt-update.png]]
}}}
Обратите внимание на ошибку. Как я уже и говорил ранее, для сторонних репозитариев необходимо добавить ключ. Но мы его еще не добавили, поэтому ошибка и возникает. Тем не менее, мы обновили информацию о репозитариях.

Следующая команда (немного забежим вперед) - это команда установки программного обеспечения. Устанавливается ключ репозитария и фишка в том, что устанавливается он как раз из только что подключенного репозитария ubuntu.

{{textAlignCenter{
[img[images/articles/medibuntu-install-key-attention.png]]
}}}
Программа-установщик предупреждает о том, что приложение, которое мы пытаемся установить не подписано ключом. Но мы его как раз сейчас и ставим, поэтому соглашаемся.

{{textAlignCenter{
[img[images/articles/medibuntu-key-installed.png]]
}}}
Все, ключ установлен. Теперь для того, чтобы новый репозитарий был подписан и мы больше не получали предупреждений при установки нового ПО, нам нужно обновить информацию о репозитариях еще раз.

{{textAlignCenter{
[img[images/articles/medibuntu-updates-successfully.png]]
}}}
Все, сообщение об ошибке перестало появляться!

Для закрепления материала, давайте проверим, все ли мы правильно установили. Зайдем в программу &quot;Источники приложений&quot;, как это было показано выше и проверим вкладки со сторонними репозитариями и ключами.

{{textAlignCenter{
[img[images/articles/medibuntu-check-thirdparty.png]]
}}}
Репозитарий успешно добавлен.

{{textAlignCenter{
[img[images/articles/medibuntu-check-key.png]]
}}}
Ключ тоже.

!Оригинал статьи
*http://ubuntologia.ru/repositories


</pre>
</div>
<div title="Настройка своего выделенного VPS сервера на основе Ubuntu Hardy LTS" modifier="Яковлев Иван" created="200906192145" modified="200907021305" tags="[[Выделенный VPS сервер]] [[TODO - нужен перевод статьи]] slicehost" changecount="12">
<pre>{{textAlignCenter borderNone{
[img[images/articles/slicehost-logo.jpg]]
}}}
*''Описание''
*''Вход''
*''Администрирование пользователей''
*''Генерация ключа для SSH''
*''Копирование ключа SSH на сервер''
*''Настройка ограничений для доступа по SSH''
*''Конфигурирование доступа по SSH''
*''Настройка iptables''
*''Вход под новым пользователем''

*''Проверка версии ОС и ее оптимизация под наши нужды''
*''Настройка оболочки bash  -- файл &quot;{{{~/.bashrc}}}&quot;''
*''Настройка репозитариев -- файл &quot;{{{/etc/apt/sources.list}}}&quot;''
*''Обновление базы данных хранилища репозитариев пакетов''
*''Настройка локали''
*''Обновление системы''


!Описание
These Ubuntu Hardy Heron articles will take you from a 'barebones' Ubuntu Hardy Slice to a secured and up to date Slice ready for your server software (or whatever you use the Slice for).

Securing your Slice as soon as possible is a great way of starting your Slice administration.

!Вход
As soon as you have your IP address and password for your Slice, login via SSH:
{{{
ssh root@123.45.67.890
}}}
If you rebuilt your Slice, you may get a message informing you that the &quot;remote host identification has changed&quot;.

When you log into a Slice via SSH, one of the security features is matching the remote host with known keys. When you rebuild a Slice, the remote host key changes. As such, your computer thinks there is something dodgy going on.

All you need to do is remove the older entry for the Slice IP:

On your LOCAL computer, edit the SSH known_hosts file and remove any entries that point to your Slice IP address.
{{{
nano ~/.ssh/known_hosts
}}}
If you are not using Linux or a Mac on your LOCAL computer, the location of the known_hosts file will differ. Please refer to your own OS for details of where this file is kept.

!Администрирование пользователей
Once logged in to the VPS, immediately change your root password to one of your choosing.
{{{
passwd
}}}
Add an admin user (I've used the name demo here but any name will do).
{{{
adduser demo
}}}
As you know, we never log in as the root user (this initial setup is the only time you would need to log in as root). As such, the main administration user (demo) needs to have sudo (Super User) privileges so they can, with a password, complete administrative tasks.

To configure this, give the 'visudo' command:
{{{
visudo
}}}
At the end of the file add:
{{{
demo   ALL=(ALL) ALL
}}}

!Генерация ключа для SSH
One effective way of securing SSH access to your slice is to use a public/private key. This means that a 'public' key is placed on the server and the 'private' key is on our local workstation. This makes it impossible for someone to log in using just a password - they must have the private key.

The first step is to create a folder to hold your keys. On your LOCAL workstation:
{{{
mkdir ~/.ssh
}}}
That's assuming you use Linux or a Mac and the folder does not exist. I will do a separate article for key generation using Putty for Windows users.

To create the ssh keys, on your LOCAL workstation enter:
{{{
ssh-keygen -t rsa
}}}
If you do not want a passphrase then just press enter when prompted.

That created two files in the .ssh directory: id_rsa and id_rsa.pub. The pub file holds the public key. This is the file that is placed on the Slice.

The other file is your private key. Never show, give away or keep this file on a public computer.

!Копирование ключа SSH на сервер
Now we need to get the public key file onto the Slice.

We'll use the 'scp' (secure copy) command for this as it is an easy and secure means of transferring files.

Still on your LOCAL workstation enter this command: 
{{{
scp ~/.ssh/id_rsa.pub demo@123.45.67.890:/home/demo/
}}}
When prompted, enter the demo user password.

Change the IP address to your slice and the location to your admin user's home directory (remember the admin user in this example is called demo).

!Настройка ограничений для доступа по SSH
OK, so now we've created the public/private keys and we've copied the public key onto the Slice.

Now we need to sort out a few permissions for the ssh key.

On your Slice, create a directory called .ssh in the 'demo' user's home folder and move the pub key into it.
{{{
mkdir /home/demo/.ssh
mv /home/demo/id_rsa.pub /home/demo/.ssh/authorized_keys
}}}
Now we can set the correct permissions on the key:
{{{
chown -R demo:demo /home/demo/.ssh
chmod 700 /home/demo/.ssh
chmod 600 /home/demo/.ssh/authorized_keys
}}}
Again, change the 'demo' user and group to your admin user and group.

Done. It may seem a long set of steps but once you have done it once you can see the order of things: create the key on your local workstation, copy the public key to the Slice and set the correct permissions for the key.

!Конфигурирование доступа по SSH
Next we'll change the default SSH configuration to make it more secure:
{{{
nano /etc/ssh/sshd_config
}}}
Use can use this [[ssh configuration|sshd configuration file exemple]] as an example.

The main things to change (or check) are:
{{{
Port 30000                           &lt;--- change to a port of your choosing
Protocol 2
PermitRootLogin no
PasswordAuthentication no
X11Forwarding no
UsePAM no
UseDNS no
AllowUsers demo
}}}
I think the setting are fairly self explanatory but the main thing is to move it from the default port of 22 to one of your choosing, turn off root logins and define which users can log in.

~PasswordAuthentication has been turned off as we setup the public/private key earlier. Do note that if you intend to access your slice from different computers you may want leave ~PasswordAuthentication set to yes. Only use the private key if the local computer is secure (i.e. don't put the private key on a work computer).

Note that we haven't enabled the new settings - we will restart SSH in a moment but first we need to create a simple firewall using iptables.

!Настройка iptables
As said, the next thing is to set up our iptables so we have a more secure installation. To start with, we're going to have three ports open: ssh, http and https.

We're going to create two files, /etc/iptables.test.rules and {{{/etc/iptables.up.rules}}}. The first is a temporary (test) set of rules and the second the 'permanent' set of rules (this is the one iptables will use when starting up after a reboot for example).

Note that we are logged in as the root user. This is the only time we will log in as the root user. As such, if you are completing this step at a later date using the admin user, you will need to put a 'sudo' in front of the commands.

So, as the root user, save any existing rules to {{{/etc/iptables.up.rules}}}:
{{{
iptables-save &gt; /etc/iptables.up.rules

Now let's see what's running at the moment:
iptables -L

You will see something similar to this:
Chain INPUT (policy ACCEPT)
target     prot opt source               destination

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination
}}}
As you can see, we are accepting anything from anyone on any port and allowing anything to happen.

One theory is that if there are no services running then it doesn't matter. I disagree. If connections to unused (and popular) ports are blocked or dropped, then the vast majority of script kiddies will move on to another machine where ports are accepting connections. It takes two minutes to set up a firewall - is it really worth not doing?

Let's assume you've decided that you want a firewall. Create the file /etc/iptables.test.rules and add some rules to it.
{{{
nano /etc/iptables.test.rules
}}}
Look at this example [[iptables configuration file|iptables configuration file]].

The rules are very simple and it is not designed to give you the ultimate firewall. It is a simple beginning.

Hopefully you will begin to see the pattern of the configuration file. It isn't complicated and is very flexible. You can change and add ports as you see fit.

Good. Defined your rules? Then lets apply those rules to our server:
{{{
iptables-restore &lt; /etc/iptables.test.rules

Let's see if there is any difference:
iptables -L
}}}
Notice the change? (If there is no change in the output, you did something wrong. Try again from the start).

Have a look at the rules and see exactly what is being accepted, rejected and dropped. Once you are happy with the rules, it's time to save our rules permanently:
{{{
iptables-save &gt; /etc/iptables.up.rules
}}}
Now we need to ensure that the iptables rules are applied when we reboot the server. At the moment, the changes will be lost and it will go back to allowing everything from everywhere.

Open the file {{{/etc/network/interfaces}}}
{{{
nano /etc/network/interfaces
}}}
Add a single line (shown below) just after 'iface lo inet loopback':
{{{
...
auto lo
iface lo inet loopback
pre-up iptables-restore &lt; /etc/iptables.up.rules

# The primary network interface
...
}}}
As you can see, this line will restore the iptables rules from the {{{/etc/iptables.up.rules}}} file. Simple but effective.

!Вход под новым пользователем
Now we have our basic firewall humming along and we've set the ssh configuration. Now we need to test it. Reload ssh so it uses the new ports and configurations:
{{{
/etc/init.d/ssh reload
}}}
Don't logout yet...

As you have an already established connection you will not be locked out of your ssh session (look at the iptables config file: it accepts already established connections).

On your LOCAL computer, open a new terminal and log in using the administration user (in this case, demo) to the port number you configured in the sshd_config file:
{{{
ssh -p 30000 demo@123.45.67.890
}}}
The reason we use a new terminal is that if you can't login you will still have the working connection to try and fix any errors.

Slicehost also has the excellent ajax console so if it all goes horribly wrong, you can log into your slice from the Slicehost management area.

If all goes well you should login without a password to a plain terminal:
{{{
demo@yourvpsname:~$
}}}

''Success!''

We now know that the firewall and ssh_config works and we can log in.

!Проверка версии ОС и свободной памяти
First thing is to confirm what OS we're using. We know we should be using Ubuntu Hardy but let's see:
{{{
cat /etc/lsb-release
}}}
You should get an output similar to this:
{{{
DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=8.04
DISTRIB_CODENAME=hardy
DISTRIB_DESCRIPTION=&quot;Ubuntu 8.04&quot;
}}}
Good. Memory usage should be very low at this point but let's check using 'free -m' (the -m suffix displays the result in MB's which I find easier to read):
{{{
free -m
}}}
It's nice to know what is going on so let's look at that output:
{{{
.                  total       used       free     shared    buffers     cached
Mem:             254       43         211          0          3            74
-/+ buffers/cache:       26         228
Swap:            511        0           511
}}}
The line to take notice of is the second one as the first line includes cached memory - in this demo slice I have 254MB of useable memory with 26MB actually used, 228MB free and no swap used. Nice.

!Настройка оболочки bash  -- файл &quot;{{{~/.bashrc}}}&quot;
Let's make the terminal a bit more attractive and a bit more informative by adding a few lines to our . bashrc file.
{{{
nano ~/.bashrc
}}}
Add the next few lines at the end of the existing text. The following line will make the terminal show the server name in colour and display the working directory (the directory we are in) in a different colour:
{{{
export PS1='\[\033[0;35m\]\h\[\033[0;33m\] \w\[\033[00m\]: '
}}}
If you look at the existing content of the .bashrc file, you may notice some 'PS1' content already - you can change the existing content if you prefer. This method simply changes the default output.

Now we can add aliases to the file. Aliases are short cuts to commands or sequences of commands. I've included a few below but you can have as many or as few as you want.
{{{
alias free=&quot;free -m&quot;
alias update=&quot;sudo aptitude update&quot;
alias install=&quot;sudo aptitude install&quot;
alias upgrade=&quot;sudo aptitude safe-upgrade&quot;
alias remove=&quot;sudo aptitude remove&quot;
}}}
The examples above are pretty simple. Instead of typing 'free -m' every time I want to look at the memory usage, I just type 'free. Typing '{{{sudo aptitude install}}}' can get tedious, so I just type 'install'.

I still need to provide my password for the sudo command to work, but it is more productive/quicker/easier to have short cuts.

To activate the changes issue this command:
{{{
source ~/.bashrc
}}}
You should now see the slice name in purple and the working directory in brown.

To change the colours to your choosing, adjust the 0;35m and the 0;33m values in the 'export PS1' line of your {{{.bashrc}}}. For example:
{{{
export PS1='\[\033[0;32m\]\h\[\033[0;36m\] \w\[\033[00m\]: '
}}}
would give you a green and blue output.

!Настройка репозитариев -- файл &quot;{{{/etc/apt/sources.list}}}&quot;
The Ubuntu Hardy Slice comes with a basic set of repositories but let's have a check to see what sources we are using:
{{{
sudo nano /etc/apt/sources.list
}}}
You should see the default list as follows:
{{{
deb http://archive.ubuntu.com/ubuntu/ hardy main restricted universe
deb-src http://archive.ubuntu.com/ubuntu/ hardy main restricted universe

deb http://archive.ubuntu.com/ubuntu/ hardy-updates main restricted universe
deb-src http://archive.ubuntu.com/ubuntu/ hardy-updates main restricted universe

deb http://security.ubuntu.com/ubuntu hardy-security main restricted universe
deb-src http://security.ubuntu.com/ubuntu hardy-security main restricted universe
}}}
You can, of course, add more repositories whenever you want to but I would just give a word of caution: Some of the available repositories are not officially supported and may not receive any security updates should a flaw be discovered.

Keep in mind it is a server we are building and security and stability are paramount.

!Обновление базы данных хранилища репозитариев пакетов
Now we can update the sources so we have the latest list of software packages:
{{{
sudo aptitude update
}}}
{{note{
''ЗАМЕЧАНИЕ:''
If you have used the .bashrc shown above you just need to enter 'update' as the alias will use the entire command. I've put the whole thing here so you know what is happening.
}}}

!Настройка локали
Remember the Hardy Slice is a bare bones install so we need set the system locale:
{{{
sudo locale-gen en_GB.UTF-8
...
sudo /usr/sbin/update-locale LANG=en_GB.UTF-8
}}}

!Обновление системы
Now we have updated the {{{sources.list}}} repositories and set the locale, let's see if there are any upgrade options:
{{{
sudo aptitude safe-upgrade
}}}
Followed by a:
{{{
sudo aptitude full-upgrade
}}}
Once any updates have been installed, we can move on to installing some essential packages.

!Установка необходимых пакетов
Ubuntu Hardy has some handy meta-packages that include a set of pre-defined programmes needed for a single purpose.

So instead of installing a dozen different package names, you can install just one meta-package. One such package is called 'build-essential'. Issue the command:
{{{
sudo aptitude install build-essential
}}}
Notice the programmes that are to be installed include gcc, make, patch and so on. All these are needed for many other programmes to install properly. A neat system indeed.

Enter 'Y' and install them.

!Заключение
Quite a lot happening here but now we have a secured and updated Slice.
The console is now informative and less drab, locales have been configured and the meta-package build-essential has been installed.
If you do this more than once or twice it doesn't take long at all and we now have the ideal base to install the 'meat' of our server.
{{textAlignRight{
Автор: [[PickledOnion|http://articles.slicehost.com]]
}}}

!См. также
*[[Установка Nginx-PHP5-FastCGI-XCache-MySQL на Ubuntu]]
*http://articles.slicehost.com/ubuntu-hardy

!Ссылки
*[[Оригинал статьи на slicehost.com (часть 1)|http://articles.slicehost.com/2008/4/25/ubuntu-hardy-setup-page-1]]
*[[Оригинал статьи на slicehost.com (часть 2)|http://articles.slicehost.com/2008/4/25/ubuntu-hardy-setup-page-2]]


</pre>
</div>
<div title="Настройка сервиса DynDNS для Ubuntu" modifier="Яковлев Иван" created="200906171839" modified="200906171910" tags="[[Настройка DynDNS сервиса]]" changecount="3">
<pre>У многих из нас есть широкополосный интернет, для доступа к вашему вышенастроенному серверу можно использовать ваш айпи-адрес. Но мне, например, такое не нравится. Для подобных целей есть достаточно удобный сервис [[DynDNS|https://www.dyndns.com/]]. После регистрации вы можете создать свой домен и привязать его к вашему адресу. У меня адрес меняется динамически, каждый раз редактировать на сайте я его не хочу. Для этого существует небольшой клиент inadyn

устанавливаем:
{{{
sudo aptitude install inadyn
}}}

''Alt+F2'' {{{gksu gedit /etc/inadyn.conf}}} — создаем файл настройки

{{{
--username ваше_имя_в_системе_DynDNS

--password ваш_вароль

--update_period 60000

--alias название.вашего.хоста

--background
}}}
запускаем клиент:
{{{
sudo /usr/sbin/inadyn
}}}

Теперь нужно добавить его в кронтаб, чтобы запускался автоматически
{{{
export EDITOR=gedit
sudo crontab -e
}}}
добавляем строку
{{{
@reboot /usr/sbin/inadyn
}}}
сохраняем и выходим.

Проверяем, записалось ли и смотрим, запущен или нет:
{{{
sudo crontab -l
ps -A | grep inadyn
}}}


</pre>
</div>
<div title="Настройка форвординга портов (PortForwarding)" modifier="Яковлев Иван" created="200906172106" modified="200906172117" tags="[[Настройка DynDNS сервиса]] [[TODO - нужен перевод статьи]]" changecount="7">
<pre>If you are wondering where to start or what exactly needs to be done, you have come to the right place. This guide will provide a overview of what you need to do and know to forward ports to your computer. It will also provide an order to the guides on these pages, and help you avoid several pitfalls.

In order to forward properly you really need to understand what port forwarding is. This might seem like an irrelevant step, but it is not. Port forwarding is akin to driving a car. It's very difficult for most people. The more you know about port forwarding the easier it will be to get your ports from point A to point B. Imagine if you tried to go to the store without first learning how to drive your car. Well enough of this introduction, let's get to work. The very first thing you should do is to read the following guide which will explain what port forwarding is. Don't worry it's really short.
[[What is port forwarding?|http://www.portforward.com/help/portforwarding.htm]]

Now that you have some idea of what we are about, let's see if we can find your router. Your router should be some kind of box that your computer is connected to. The box might have a cable TV or phone line coming out of it. It probably has serveral flashing lights on the front of it. The cable that will run from your computer to this box is called a network cable. The ends of this cable look like the ends of a large phone cable. When you find this box, it will probably have a maker and model number on it. If you can't find the make and model number check the stickers on the bottom of the router. Write this information down. We will use it later.

Let's figure out what ports you need to forward. The first place to check is our [[Common Ports page|http://www.portforward.com/cports.htm]]. Some of the program names will be highlighted in orange. That means the name is a link, and you can click that name for further information. We have written guides for some programs. Go ahead and check the common ports page now for the program you want to forward ports for. If you find a guide for the program you are forward ports for, follow it. After you have completed that guide come back here for further information. If you did not see the program there, you will need to find that information on the internet. Usually the software manufacturer's website is the best place for that information. Sometimes it can be very hard to find out which ports you need forward for a program. Where ever you find the ports you need to forward, be sure to write that information down. There should be a series of ports listed, along with the protocol type of those ports. Usually this protocol type will be TCP or UDP.

Let's goto our [[Forwarding page|http://www.portforward.com/routers.htm]]. As you can see we have a few routers listed on that page. Go ahead and find your router on that list. If you found a guide for your router on our website, go ahead and click it to open it.

We need to setup a static ip address on the computer you are going to forward ports to. A lot of people struggle with this. Really it's not that tough, so don't worry. The first thing you need to do is to read our [[Understanding DHCP guide|http://www.portforward.com/networking/dhcp.htm]]. I'm sorry but I got a little long winded on this one. I still think it is under one page. Now that you know a bit more about dhcp, take a look in the guides we have written for your router. You will probably see a Setting up a Static IP Address with your router guide. Go ahead and follow that guide now. If you can not connect to your router, make sure you are entering your computer's gateway into the web browser. If you are sure that you are entering your computer's gateway into your web browser and it's still giving you a page can not be found, your router is probably setup as bridge. Your computer would be behind your ISP's NAT. You should contact your ISP and ask them for a public ip address. If you can not connect to the internet after following that guide, it is probably because you have the wrong DNS servers. Give your ISP a call and ask them what DNS servers to use. They should be able to tell your right off. If they can't at least you can smile, because at this point you probably know more about networking than they do. Then go back to your TCP/IP configuration and put in the correct dns servers.

Now that you have setup a static ip address, you are ready to forward ports. You can use port forwarding or port triggering to forward ports. Generally you should use port forwarding. Only use port triggering when the software manufacturer provided specific port triggering settings for the program you are forwarding ports for. Never have the same port numbers defined in the port forwarding and port triggering page. Doing that basically screws things up, and neither configuration will work. Also do not put the same port numbers in more than one configuration. Doing that will also prevent those configurations from working properly. I'm not sure why people do that, but I've seen it often enough. Alright go ahead and open up the port forwarding or port triggering guide for your router. Remember those guides can be found on our Forwarding page. Forward all the ports that need to be forwarded for the program you are running. This will probably require setting up multiple configurations in your router. When you are done creating configurations remember to save those settings, and then reboot your router for the settings to take effect.

Alright! The ports should be forwarded. Now we need to make sure that there are no firewalls blocking those ports. Now there are a couple places that ports can be blocked. Your ISP can block ports in their router. Hopefully this is not the case, because there is little we can do about that. If your ISP is blocking the ports required by the program you are forwarding ports for, check the program for a port configuration. Sometimes programs will allow you set the port that it uses. You could then set that program to use some port that is not being blocked by your ISP. How can you tell which port is not being blocked? You can't. You really need to just try different ports, until you find one that works. Your router can have a firewall that is blocking ports from coming into your network. We have written a few guides for router firewalls on our Firewalling page. Take a look there for instructions on how to open ports in your routers firewall. You could have a personal firewall installed on your computer. You need to allow those ports through that firewall. Once again take a look at our Firewalling page. The ports you have forwarded need to be allowed through every personal firewall you have on your computer.

Sometimes things just don't work out. I'll give a couple suggestions here, that will hopefully help you fix any problems you encounter. If everything was done properly above, the ports should be forwarded. That is assuming your ISP is not blocking those ports.

In your router you can DMZ your computer's ip address. Almost every router has a DMZ. The DMZ forwards all ports to the ip address that is specified in the DMZ. ~DMZs are really easy to setup, you just enter the ip address to forward the ports to. To test ports that are forwarded to your computer, you would enter your computers ip address. If the ports look like they are forwarded after you dmz your computer, you know that the ports were not forwarded properly. Disable the DMZ. Then go take another look at the port forwarding configuration in your router. If the ports are still not forwarded after you dmz your computer, there is probably a software firewall on your computer that is blocking those ports or your isp is blocking the ports. Take a really good look for a software firewall on your computer.

You can also simplify the port forwarding problem, by disabling firewalls. Turn off all firewalls on your computer and then disable the firewall on your router. NAT(Network Address Translation) will act as a pretty good temporary security system. NAT is already enabled if you are forwarding ports. If the ports are forwarded after turning off the firewalls, you know that one of the firewalls was causing the problem. Turn the firewalls on one at a time, to figure out which one was causing the problem. Then open the ports that you forwarded in that firewall.

Well I hope you found this guide helpful. Good luck! 

{{textAlignCenter{
Dave Clark
~PortForward.com
}}}

!Ссылки
*[[Оригинал статьи|http://www.portforward.com/help/pfprogression.htm]]


</pre>
</div>
<div title="Начальное конфигурирование Nginx" modifier="Яковлев Иван" created="200906200114" modified="200907021302" tags="[[Настройка Nginx]] [[TODO - нужен перевод статьи]] slicehost" changecount="5">
<pre>!Настройки по умолчанию
So why only a few changes to the default? Well, it's difficult to give a definitive configuration as there are so many variables to consider such as expected site traffic, Slice size, site type, etc.

During this article we'll discuss the main settings and you can make any decisions as to what you feel are best for your site. Any changes I do suggest are simply that: suggestions.

My advice is very simple: experiment. Find what works best on your setup.

!файл /etc/nginx/nginx.conf
Assuming you installed via the package manager, open up the main Nginx config file:
{{{
sudo nano /etc/nginx/nginx.conf
}}}
If you installed from source, the location may be different:
{{{
sudo nano /usr/local/nginx/conf/nginx.conf
}}}
The default file is very similar in both case (again, assuming you followed the articles shown above):
{{{
user www-data;
worker_processes  1;

error_log  /var/log/nginx/error.log;
pid        /var/run/nginx.pid;

events {
    worker_connections  1024;
}

http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    access_log  /var/log/nginx/access.log;

    sendfile        on;
    #tcp_nopush     on;

    #keepalive_timeout  0;
    keepalive_timeout  65;
    tcp_nodelay        on;

    gzip  on;

    include /etc/nginx/conf.d/*.conf;
    include /etc/nginx/sites-enabled/*;
}
}}}
The main difference you will see if you installed from source is the path in the 'include' setting which would be something like:
{{{
include /usr/local/nginx/sites-enabled/*;
}}}
Beyond that, any changes are minor and can be adjusted as discussed below although I won't mention some of the more obvious settings such access logs and pid's.

!user
Default:
{{{
user www-data;
}}}
As you can imagine, this sets the nginx user. I always push for consistency across servers and the default web server user on Debian based systems is www-data. As such, keep this as the www-data user.

You can also add a group to this setting and it may be an idea to do so as follows:
{{{
user www-data www-data;
}}}

!worker_processes
Default:
{{{
worker_processes  1;
}}}
Nginx can have more than one worker process running at the same time.
{{note{
''ЗАМЕЧАНИЕ:''
To take advantage of SMP and to enable good efficiency I would recommend changing this to read:
{{{
worker_processes  4;
}}}
Although you can experiment with this number (and I encourage you to do so) setting it at more than 4 processes may actually cause Nginx to be less efficienct on your Slice.
}}}

!worker_connections
Default:
{{{
events {
    worker_connections  1024;
}
}}}
Note the worker_connections setting is placed inside the 'events' module. Sets the number of connections that each worker can handle. This is a good default setting.
 
You can work out the maximum clients value from this and the worker_processes settings:
{{{
max_clients = worker_processes * worker_connections
}}}

!http module
Next comes the http module which contains base settings for http access:
{{{
include       /etc/nginx/mime.types;
default_type  application/octet-stream;
}}}
Unless you have an overwhelming desire, I would leave these settings alone (again, for those who installed via source, adjust the paths to those of your install).

You can, of course, add more includes if you want to customise it but messing with mime-types usually ends up with broken web pages and download errors.

Mind you, it is good fun to play with!

!sendfile
Default:
{{{
sendfile        on;
}}}
Sendfile is used when the server (Nginx) can actually ignore the contents of the file it is sending. It uses the kernel sendfile support instead of using it's own resources on the request.

It is generally used for larger files (such as images) which do not need use of a multiple request/confirmation system to be served -- thus freeing resources for items that do need that level of 'supervision' from Nginx.

Keep it an on unless you know why you need to turn it off.

!tcp
Default:
{{{
#tcp_nopush      on;
tcp_nodelay      on;
}}}
;tcp_nopush
:Sends the HTTP response headers in one packet. You can read more about ''tcp_nopush'' on [[this page|http://wiki.codemongers.com/NginxHttpCoreModule#tcp_nopush]].

:I would change the default here and uncomment the setting as it is useful when combined with the sendfile option we set earlier.

;tcp_nodelay
:Disables the Nagle buffering algorithm. Well, that cleared that one up! Actually, it is for use with items than do not require a response. General web use does require a response from the client and so, going against the default, I would change this to off. You can read more about tcp_nodelay [[here|http://wiki.codemongers.com/ReadMoreAboutTcpNodelay]].

So there you are. After saying I wouldn't change a lot, I have changed the two default tcp settings. Your experience may show otherwise and, again, all I can say is experiment with your site/app — what do you need?

!keepalive
Default:
{{{
#keepalive_timeout  0;
keepalive_timeout  65;
}}}
The default is very high and can easily be reduced to a few seconds (an initial setting of 2 or 3 is a good place to start and you will rarely need more than that). If no new requests are received during this time the connection is killed.

OK, but what does it mean? Well, once a connection has been established and the client has requested a file, this says &quot;sit there and ignore everyone else until the time limit is reached or you get a new request from the client.&quot;

Why would you want a higher time? In cases where there will be a lot of interactivity on the site. However, in most cases, people will go to a page, read it for a while and then click for the next page. You don't want the connection to sit there doing nothing, ignoring other users. 

!gzip
Default:
{{{
gzip  on;
}}}
Good. We like gzip. It allows for instant, real time compression.

However, I would add a few more settings as follows:
{{{
gzip_comp_level 2;
gzip_proxied any;
gzip_types      text/plain text/html text/css application/x-javascript text/xml
                application/xml application/xml+rss text/javascript;
}}}
I think those are self explanatory and simply add to the gzip setting. You can read more about the various gzip settings on [[this page|http://wiki.codemongers.com/NginxHttpGzipModule]].

!include
Default:
{{{
include /etc/nginx/sites-enabled/*;
}}}
If you installed from source, we added this line:
{{{
include /usr/local/nginx/sites-enabled/*;
}}}
Either way, it defines what files to include that are located outside of the main nginx.conf.

In this case, it points to the 'sites-enabled' directory and will include any symlinked files; thus enabling any sites linked from the 'sites-available' directory.

!Summary
There is a lot going on in this article, especially considering that 'nginx.conf' is such a small config file. However, taking one setting at a time, we can see that each one is not only essential but rather flexible. 

The [[next article|Настройка виртуальных хостов]] will take you through setting up virtual hosts and then move onto mongrel and thin integration for your Ruby on Rails applications.

!Ссылки
*[[Оригинал статьи на slicehost.com|http://articles.slicehost.com/2009/3/5/ubuntu-intrepid-nginx-configuration]]


</pre>
</div>
<div title="Ньюансы безопасности web-хостинга и режим chmod 2770" modifier="Яковлев Иван" created="200906210051" modified="200906210217" tags="Безопасность [[Настройка Apache]]" changecount="18">
<pre>Выдался свободный вечер. Давайте, попробую ответить всем интересующимся в форме вопросов и ответов. Которые, впрочем, следует воспринимать с известной долей юмора. Тем более что наступило 1-е апреля.  

!Почему вы считаете, что виртуальный совместный (shared) хостинг небезопасен с точки зрения секретности данных?
При этом виде хостинга один и тот же демон запущенного веб-сервера обслуживает несколько виртуальных хостов. В реальности их число доходит до 100-200. Программы (скрипты, сценарии), которые запускаются от имени веб-сервера на любом виртуальном хосте, по умолчанию получают права веб-сервера. То есть - если Апача может считать файл с паролями к базе данных в вашем каталоге, этот файл может точно так же прочитать скриптом любой пользователь этого хостинга. При этом в логах не останется никаких следов.
{{note{
''ЗАМЕЧАНИЕ:''
В классическом Юниксе на файл предусмотрено 3 группы прав: User (владелец), Group (группа), Others (Прочие). Веб-сервер получает доступ к файлам через права группы, потому что других способов при совместном хостинге, к сожалению, просто нет (другие способы возможны только на более современных файловых системах, в частности, NTFS).
}}}
Обычно делается отдельный каталог, например, public_html, в котором создаются подкаталоги пользователей с правами 2750:
{{{
public_html/ivanov drwxr-s--- ivanov.apache
public_html/petrov drwxr-s--- petrov.apache
public_html/sidorov drwxr-s--- sidorov.apache
}}}
Аpache получает права на каталоги с дополнительным битом setGID, поэтому все файлы и каталоги, которые создаются средствами веб-сервера, будут также принадлежать группе apache и apache сможет с ними работать. Такой способ организации файлов и каталогов иногда называют способом BSD.

Таким образом, пользователь ivanov, зайдя по FTP, увидит содержимое только своего каталога, на который он имеет полные права, и сможет выгрузить туда нужные файлы, а к соседям petrov, sidorov и тп. зайти не сможет. 

В то же время пользователь apache по умолчанию имеет права на чтение всех подкаталогов {{{public_html/}}} - он сможет прочитать любые файлы в этих подкаталогах, однако ничего записать туда не сможет. Если веб-серверу нужно что-то писать, то на нужные каталоги следует вручную установить права 2770. Кстати, эта операция проделывается при каждой установке IPB.

Поэтому для чтения ваших файлов с конфиденциальной информацией злоумышленнику бывает достаточно взломать любой из 100-200 виртуальных хостов, или даже просто купить на время хостинг - стоит это недорого, к тому же многие интернет-провайдеры предлагают бесплатный тестовый период или гарантию возврата денег. 

!Какой ужас! И что же можно сделать, чтобы скрипты PHP не могли &quot;ходить к соседям&quot;?
Существует два принципиально разных способа. 

!!Первый способ
Первый - ограничивать права внутри самого mod_php. Это safe mode и open_basedir. При safe mode по умолчанию проверяются права владельца на скрипт и сравниваются с правами владельца файла, который этот скрипт пытается открыть. Например, если скрипт из каталога petrov пытается открыть файл в каталоге ivanov, в доступе будет отказано. Также может быть ограничен список программ, которые могут быть запущены скриптами php. При open_basedir ограничивается &quot;сверху&quot; каталог, внутри которого может открывать файлы скрипт данного пользователя. 

Недостатки safe mode: 
#Целый ряд сложных скриптов, написанных на PHP, перестает работать.
#Возможно создание файлов, которые сам пользователь не сможет удалить.
#Адекватная настройка safe mode достаточна сложна для хостинг-провайдера: запретишь слишком много - будут недовольны пользователи, запретишь слишком мало - а зачем оно тогда надо? 
#Поддержка safe mode после долгих дебатов была полностью удалена из PHP 6. Главный аргумент: порождает в пользователях ложное чувство, что PHP работает &quot;безопасно&quot;, а это не так. Читать здесь: http://www.php.net/~derick/meeting-notes.html

Хорошо также сказано в мануале PHP:
&lt;&lt;&lt;
Chapter 42. Safe Mode
The PHP safe mode is an attempt to solve the shared-server security problem. It is architecturally incorrect to try to solve this problem at the PHP level, but since the alternatives at the web server and OS levels aren't very realistic, many people, especially ISP's, use safe mode for now. 
&lt;&lt;&lt;

Недостатки open_basedir:
Не ограничивает функции exec(), system() и другие. Без safe mode директива почти бесполезна, в частности, прекрасно сработает такая строчка:
{{{
system('cat /path_to/conf_global.php')
}}}

!!Второй способ
Второй способ - динамически менять права веб-сервера на права пользователя в момент исполнения скрипта. 

Наиболее известные реализации - suphp и запуск PHP в виде модуля CGI. 

Недостаток: чудовищный расход ресурсов процессора. Производительность падает не в 2-3, а в 20-30 раз. Это связано с архитектурой Юникса, в которой никогда не предполагалось, что переключение контекста пользователя будет производиться динамически, для промышленных задач. Такие сложные скрипты, как IPB, ~OpenCommerce или Bitrix могут запросто повесить машину.

!А если хорошо отладить safe mode? Решит ли это проблему совместного хостинга?
Ладно, пускай вы отладили safe mode. Но кроме php, существует еще целый ряд языков и интерфейсов. Это:
#SSI (~Server-Side Includes), появившийся в незапамятные времена. Если в ваш хостинг-план входит &quot;поддержка shtml&quot; - знайте, это оно и есть. SSI запускаются с правами веб-сервера и содержат замечательную инструкцию exec. Ее надо отключать (~IncludesNoExec).
#CGI (Common Gateway Interface) - общее название для скриптов на любом языке, которые читают со stdin и отдают поток на stdout. Чаще всего скрипты пишутся на Perl, Python, Tcl/Tk, Java, на Си и языке командного интерпретатора. По умолчанию все эти скрипты также запускаются с правами веб-сервера. 

Наиболее распространенный способ решить проблему в CGI - запуск под suexec.

Недостаток: снова - чудовищный расход ресурсов и падение производительности во много раз. Для увеличения производительности, в частности, ставят такую среду, как mod_perl. Однако mod_perl по определению не способен к переключению контекстов и всегда выполняется с правами веб-сервера (говорят, что-то придумали в 2-й Апаче и 2-м mod_perl, но до промышленного использования когда еще дойдет).

!И все-таки - если хостер все сделал правильно, можно ли быть уверенным в конфиденциальности моих данных на совместном хостинге?
Послушайте, любезный, я повторю еще раз: по умолчанию любой из 100-200 соседей по хостингу может забраться в веб-каталог к вам, как в свой собственный, потому что такова архитектура совместного виртуального хостинга. Чтобы клиенты не лазили друг к другу, администратор хостера должен индивидуально настроить ограничения для каждого языка и для каждой среды исполнения - отдельно для PHP, отдельно для SSI, отдельно для CGI, отдельно для mod_perl и т.п.. Это требует высокой квалификации и большого опыта администраторов. А можно и ничего не настраивать, при этом вопросов в техподдержку пользователи будут писать меньше. И сервера будут работать быстрее. А главное - ответственности хостера за взлом ваших данных ни-ка-кой. Ни юридической, ни моральной.

Добавьте к этому специфические дыры, которые могут быть в библиотеках любого скриптового языка. Например, не так давно прошла информация об эксплойте в PHP конкретных версий, который позволял отправлять на почту произвольный текстовый файл. Вы что, собираетесь следить за всеми библиотеками, которые стоят на хостинге?..

!Я не верю, что совместный хостинг такой дырявый - вот мой сайт за много лет не сломали ни разу!
Как известно, оптимист - плохо информированный пессимист. Скорее всего, по вашему каталогу уже не раз гуляли разные кракеры, просто они вам в этом не признавались.  Ну, стянул сопливый кракер вашу базу данных, и дальше чего с ней делать? Чтобы войти в форум, нужен пароль администратора. А для этого надо подобрать его по хэшу, что требует уже определенных познаний. И даже если он войдет в форум как админ - интереса в этом немного. Форум - не интернет-магазин с номерами кредиток. Такие взломы обычно остаются вообще незамеченными. 

!Если совместный хостинг такой небезопасный, зачем он вообще нужен?
Видите ли, 95-98% всех сайтов - это статические страницы. Максимум - к ним добавляется счетчик посещений, почтовая форма обратной связи и гостевая книга. Такой сайт клиенты разово заказывают у веб-дизайнеров или сами делают по шаблону, после чего ничего в них серьезно не меняют годами. 

Так вот, если даже злоумышленник заберется в каталог такого сайта через локальную файловую систему - он не увидит там ничего нового, кроме того, что и так можно увидеть через веб-браузер. А записать туда свои скрипты он не сможет, потому что каталоги для веб-сервера доступны только для чтения, но не для записи. Так что этим клиентам фиолетово, ходит по ним кракер или нет.

Если же вы создаете динамический сайт с использованием базы данных, то у вас в веб-каталоге неизбежно появляются некие конфиденциальные данные, тот же логин/пароль для базы данных, конфиденциальные данные покупателей интернет-магазина, участников форума и т.п. Это может представлять для злоумышленника потенциальный интерес и вам следует позаботиться о более адекватном хостинге. 

!Так какой же хостинг мне нужен??
!!Вариант 1
Сейчас многие провайдеры предлагают тарифный план с отдельной Апачей и на отдельном адресе IP. Например, caravan.ru - всего около 400 рублей в месяц. В этом случае веб-сервер запускается под вашей учетной записью или учетной записью специального пользователя, типа apache_petrovи взлом его по локальной файловой системе становится невозможен. Только не забудьте убрать права на чтение для &quot;всех&quot;, т.е. права на каталоги должны быть 750, а не 755. Дополнительный бонус - можете организовать к форуму полноценный доступ по https.

!!Вариант 2
VPS - Virtual Private Server. Фактически в рамках провайдерской машины вы получаете собственный сервер с правами root, который можете настраивать по своему разумению, заводить пользователей Unix, устанавливать свое программное обеспечение и т.п. Цены - от 500-700 рублей в месяц.

!!Вариант 3
Арендованный сервер. На зарубежных площадках - от 50-70 долларов в месяц, на российских - где-то от 150-200. 

!Я не верю ничему, что вы тут написали! Жил я прекрасно под совместным хостингом и ничего не происходило!
Я тоже ничему этому не верю. Я это знаю. 
{{textAlignRight{
//alexei1966//
}}}

!Ссылки
*[[Оригинал темы|http://forums.ibresource.ru/lofiversion/index.php/t57297-0.html]]

!Комменатрии
{{note{
;~MiksIr
А по мне, так бред. Т.е. все сказано правильно, но свалено в полную кашу совершенно непонятно кому адресованную и несет таким стилем... м.. знаете, &quot;а в интернете есть сайты, а там страшные веши! Даже людей голых показывают, а еще любой хакер может узнать какого цвета у вас трусы&quot;. Ощущение, что навалено все, что человек слышал без осознания - к месту ли это сказано вообще. Особо рассуждения про mod_perl порадовали =) Очень поможет тут всем =)

Хотя проблему понять можно, человек сам ее обрисовал. Да, ламеров много, кто думает &quot;ща хостинг сбацаю&quot;, только большинство из них дальше слов не уходят, вторая часть быстро сливается, третья в итоге пользуется готовыми панелями в которых, к счастью, за них подумали. Но если сидеть на сисадминских форумах, особо куда они стекаются - то и правда покажется, что шаред это такая жуть, а VPS - единственный выход. Особо если самому в этой каше не вариться - а по некоторым заявлениям видно это так и есть.

А &quot;успокоительных&quot; тут есть. Первая - есть отличные решения в виде готовых панелей. Для новичков. Где нормально все настроено включая safe mode. Второе - есть живучие решения без safe mod. Это и mod_fastcgi, это php-fpm (особо если его доделают), это патчи на апач, которые переключают uid чайлда....

В общем, выбирайте или хостинг где php от вашего же юзера бегает (а уж сколько проблем с правами, масками, записью тут избежите...) или просто хостера с именем и стажем - кто будет следить за php дырками, которые вдруг поломать могут safe mode (и которые частенько сами доводят его до ума смоими патчами)
----

;G*g
Имхо, ни в коем случае в фак. написано так, как будто php - сплошная дыра. уже устал повторять в этой теме, что это не так.
Из всего этого можно только вынести, что IPB требует выделенного хостинга спешиал для него - это уже давно всем известно, только не из-за безопасности, а из-за его громоздкости.
Для общего блага в продвижении php тут нет ничего нового. По словам алексея perl - вообще тогда одна сплошная дыра.
в общем без комментариев... бред...
----

;alexei1966
Уважаемый ''G*g'', &quot;дыра&quot; в общем понимании - это когда программа неожиданно ведет себя не так, как было запланировано. А в данном случае скриптовые языки ведут себя именно так, как им положено, просто не все знают, как это должно быть.  

Давайте я для ясности переведу на русский два текста:

The PHP safe mode is an attempt to solve the shared-server security problem. It is architecturally incorrect to try to solve this problem at the PHP level, but since the alternatives at the web server and OS levels aren't very realistic, many people, especially ISP's, use safe mode for now.
&lt;&lt;&lt;
&quot;Безопасный режим&quot; PHP - это попытка решить проблему безопасности на совместном виртуальном хостинге. С точки зрения архитектуры решать эту проблему на уровне PHP неправильно, однако, поскольку альтернативы на уровне веб-сервера и операционной системы не очень реальны, многие люди, особенно хостинг-провайдеры, пока используют &quot;безопасный режим&quot;.
Мануал PHP, 42-я глава
&lt;&lt;&lt;

As safe_mode is a name that gives the wrong signals as making PHP safe, we all agreed that we should remove this function. It can never be made totally safe as there will always be ways to circumvent safe_mode through libraries. This kind of functionality also better belongs in the web server or other security scheme.
&lt;&lt;&lt;
Поскольку слова &quot;безопасный режим&quot; могут вызвать неправильное представление, будто он делает PHP безопасным, мы все решили, что нам следует удалить эту функцию. Он никогда не может быть полностью безопасным, так как всегда остаются способы обойти safe_mode через библиотеки. Этот вид функциональности лучше реализовывать на уровне веб-сервера или по другой схеме безопасности.
Совещание разработчиков PHP в 2005 году,
http://www.php.net/~derick/meeting-notes.html#safe-mode
&lt;&lt;&lt;

Как видите, разработчики PHP после многолетних попыток ограничить скрипты в лазании по серверу плюнули и сдались. В отличие от отдельных товарищей, которые все еще верят, что &quot;хостер с именем и стажем&quot; или &quot;готовая панель для новичков&quot; могут перебороть архитектуру Юникса и его файловую систему.  Впрочем, это действительно - скорее из области психологии и &quot;успокоительных для чайников&quot;. 

Если коротко, на основании своего опыта и здравого смысла резюме я бы предложил такое:

*Совместный виртуальный (shared) хостинг предполагает, что в каталогах public_html находятся файлы, которые не содержат конфиденциальной информации - например, статические файлы html. В этом виде он удовлетворяет потребности 95-98% клиентов. 

*Если же вы предполагаете размещать в каталогах public_html конфиденциальную информацию, либо открываете каталоги для записи со стороны веб-сервера, вам следует подумать о других альтернативах - хостинг с выделенной Апачей, VPS и т.п.
----

;~MiksIr
О правах там как и везде - вроде понимает что пишет с одной стороны... а вроде и нет. Средств организации прав есть несколько и приведенная им далеко не самая оптимальная и описана с ошибками. И ACL на юниксе уже не что-то &quot;новенькое&quot;, а давно в ядре и работает (и не только для NTFS).

А основную идею можно передать кратко - не ходите к неизвестным хостерам. Я бы выдвинул еще свой лозунг - ходите только к тем, у кого php работает под вашим юзером, но это скорее попытка двигать прогресс =)


Самое главное - не верить всем подряд, включая и тех, что утверждает &quot;я знаю&quot; =)
Как правило, между тем, кто говорит &quot;я знаю&quot; и тем, кто действительно знает, ибо делал все это - огромная разница =)
----

;~MiksIr
Ок, если по существу, попробую сформулировать свои знания (занимался хостингом от админа до менджера, сейчас уже совсем в другой области, так что ни с кем не аффилирован =))) и дополнить/поправить Алексея и вообще начать с того, как все начиналось =)

Изначальный посыл у Алексея правильный. В юниксе права разграничиваются на основе uid - т.е. индентификатора пользователя. Так же в юниксе рождение нового процесса с нуля (exec) - очень долгая и затратная операция. Граздо более веселая операция - &quot;деление&quot; процесса (fork).

Изначально, когда веб рождался, был только CGI - или сишные программы или чаще всего - perl. Тут принцип простой - был вебсервер, который работает от юзера, допустим, www. Есть скрипт CGI. Если запрос приходил на скрипт - вебсервер его запускал. Так как скрипты тогда были не так уж часты, все были довольны - вебсервер жил постоянно в памяти и делал fork-и для новых клиентов, а для CGI делался тяжелый exec, но это было не очень часто. 

Так как www должен был читать файлы у юзера - он по определению имел туда доступ, но вебсервер неподконтролен юзеру, так что если не брать во внимание возможные дыры в веб-сервере, такой доступ безопасен. А вот о CGI такого не скажешь - и придумали suexec. Это прослойка между вебсервером и CGI скриптом которая умеет менять юзера, от которого она запущена (эта возможность заложена в юниксе) - вебсервер делал exec на suexec, тот менял права на указанного юзера и делал exec на CGI скрипт пользователя, который запускался от имени юзера уже и не имел соответственно доступа к другим.

Потом появился PHP. Его огромным плюсом, за который его полюбили, была возможность работы как модуль апача (вебсервера), а значит хорошее быстродействие (exec-ов там не делается вообще). ИМХО, это во многом и определил его торжественно развитие и задвигание Perl-a. Для перла были тоже решения как модуль апача, самое известное это mod_perl, но там никто и не думал о безопасности - задачи были другие. А разработчики PHP думали.

Думали они о чем - раз скрипт выполняется по сути веб сервером, то работает он от юзера вебсервера и может залезть куда не надо. Но, думали они дальше, раз скрипт выполняем мы, и знаем все, что с его помощью можно делать, давайте ка насажаем проверок всяких кучу, что бы как бы ты не пытался написать скрипт - только с своими файлами мог работать. Далее следует мыльная опера о борьбе щита и меча - конечно же дыр преодалеть то ограничение была куча. Но время шло, дыры прикрывались... и в общем, в какой-то момент все устаканилось и лишь программные ошибки безопасности иногда намекали о том, что было.

Опять ИМХО - этот дурацкий сейф мод в угоду непонятно кому был тормозящий прогресс ошибкой =) Но что случилось, уже не исправить. 

Итак, имеется mod_php имеющий доступ ко всем файлам системы (совершенно не важно как это реализовано - есть куча способов сделать это от обычных user/group/other до продвинутых ACL и еще более продвинутых RBAC), но программно все возможные варианты досупа к чужим файлам прикрыты. 

Звучит, конечно, страшно пока не вспомнишь, что и разделение прав у пользователей в юниксе - это тоже в общем программное разделение, заложенное в ядре, а уж сколько локальных эксплойтов (позволяющих получить права любого юзера) было во времена развития линукса... жуть =) Но все же доверия к разработчиком ядра больше, чем к разработчика PHP, соглашусь, так что попытки перевести рельсы на uid не оставлялись.

Первое, конечно, это запускать PHP как обычный CGI под управлением suexec. Правда, тут выплыли некторые косяки с авторизацией и был изобретен suphp. Кстати, алексей, suphp - это всего лишь сервисная надстройка над suexec - именно его она и использует, так что выигрыша быстродействия suphp не дает никакого.

Какие еще решения?

*запуск кучи вебсерверов по одному для каждого юзера - очень накладно, так как огромное число процессов работает вхолостую занимая память. Это единственная проблема, остальные (типа расходв на администрирование, отдельные адреса и т.д.) - это не проблема, это так, сгущение красок.

*попытка научить апач менять пользователя - есть кустарное решение в виде модуля которое меняет uid поняв к кому пришел запрос (минус - после отработки запроса процесс умирает и нужно fork-ать новый, тогда как в обычном режиме один процесс может отработать большую очередь запросов) - встречался, изпользут такое. Есть решение от разработчиков в апаче 2, но в общем ничего хорошего о его стабильности не слышал (хотя в свое время кто-то вроде говорил, что и его используют)

*самое удачное и перспективное решение, как мне кажется - mod_fastcgi. Тут разделяется вебсервер и PHP, последний работает от своего пользователя, а счастье привносит менеджер запуска этого PHP - он умеет рождать (exec) новые процессы PHP, протокол fastcgi позволяет прогонять через один PHP процесс множество запросов, а менеджер следит - если какой-то процесс PHP долго неактивен - он его убивает, а у другого юзера если приходится должно ждать в очереди - открывает &quot;вторую кассу&quot; =) В общем, работает очень похоже на то, как работает Апач при обслуживании запросов. Т.е. решение, конечно, хуже чистого mod_php по производительности, но значительно лучше CGI режима при той же безопасности. Однако, рещение широкого распространения не получило опять же из-за разработчиков PHP - реализация fastcgi режима ими далека от совершенства и возникают неприятные моменты (с которыми можно бороться, но это уже опыт).

*а будущее тут - php-fpm патч. Это замена ~PHP-ной реализации fastcgi, которое имеет много вкустностей (кстати, рано или поздно этот патч войдет в основную ветку PHP). Будущее - потому что основная вкусность не реализована - это менеджер процессов для множества юзеров почти так, как описано выше, но без косяков так как уже внутри PHP =) Прелесть тут еще одна - fastcgi протокол открытый, и PHP может напрямую получать запросы уже не от апача, а от популярных нынче легких веб-сереров (nginx, lighttpd).

Резюмируя

Есть два подхода - програмное разделение прав и перекладывание разделение прав на ядро юникса. Второй подход выглядит более безопасным, но кушает ресурсы более чем первых. Первый подход используется достаточно давно, большинство косяков выловлено, опасность представляет:
#люди не умеющие настраивать безопасность, 
#дыры в самом PHP. 

Среди профессиональных хостеров первое не встречается, второе фиксится сразу же (и случается не часто)

Все остальные настройки - они известны всем и каждому. Прочие отличные от PHP скрипты запускаются как CGI через врапер ключая exec cmd для SSI. Это уже ответственность безопасности разработчиков Apache.

Теперь про квалификацию и ответственность. Хостеры есть разные. Есть вася_купивший_сервер, есть его разновидность - вася_считающий_себя_знатоком. Есть начинающие хостеры с головой. Есть профессионалы. Возможно Алексей общался только с первыми (они в общем в большинстве своем и сидят на форумах) - ибо всякие душещипательные истории &quot;Хостеру пофиг&quot;, &quot;хостер из вредности отключит safe mod&quot; и т.д. - это вот к ним относится. Выбирая левого хостера - скорее всего получите кучу проблем и без пресловутого safe mode. У второй категории в принципе все лучше, люди там умнее, с пользователями разговаривать уже учаться на их языке... но в общем ясно дело, что &quot;в семье не без урода&quot;. Читайте хостниг-форумы, как ведут себя представители хостера, какие о нем отзывы и т.д. Третий вариант - профессионалы, которые в принципе не допустят примитивных ошибок начинающих и которые умеют внятно говорит... но и стоят подороже, конечно.

Резюмируя-2

Можно ли получит хак через хостера? - да, можно, чем &quot;левее&quot; хостер, тем выше вероятность (но может и кирпич упасть на голову и уже будет проблема не актуальна). Зависит ли это от того - как запущен PHP - да, но слабо, очень слабо - как правило зависит лишь от дураков, а дураку все равно, что неправильно настраивать - права и группы или PHP.
----

;alexei1966
Надо же, мои посты уже не считают &quot;бредом&quot;.  

Давайте еще раз повторю свою мысль в другой редакции. Есть два вида организации взаимодействия пользователь - веб-сервер.

При первом (веб-сервер запускается под пользователем или специальным отдельным пользователем вида apache_petrov) ваша конфиденциальность по умолчанию защищена архитектурой Юникса. Взломщик может добраться до вашей БД только через &quot;парадный ход&quot;, а он обычно защищен.

При втором способе (виртуальный совместный хостинг) ваши данные по умолчанию полностью открыты той же самой архитектурой Юникса, к ним имеют доступ еще 100-200 пользователей. Администраторы хостера должны закрыть доступ со стороны &quot;чужих&quot; пользователей для каждого интерфейса отдельно, вручную. При этом любая дыра в любой библиотеке, используемой Апачей (а их несколько десятков!), мгновенно сведет усилия администраторов на нет (именно об этом писали разработчики PHP, когда обосновывали прекращение работы над safe mode). Следует также помнить, что сведения о дырах в библиотеках обычно поступают к разработчикам с большим опозданием, когда кракеры уже успели вовсю этой дырой попользоваться.

Далее - каждый выбирает по себе женщину, религию и хостинг.  Я вот предпочел бы иметь защиту архитектурой Юникса. Кому-то ближе руки народных умельцев от хостинга и сэкономленные 5 долларов в месяц. 
----

;~MiksIr
Бред был в сторону попытки описания технической стороны - а косяков там было очень много.
И опять же вы играете пугалками. Давайте, напугаем еще больше - нет никакой защиты &quot;по умолчанию&quot; архитектурой юникс - криворукрий админ допустивший 755 на домашних каталогах это быстро докажет.

Т.е. для любой защиты нужены прямые руки. Кривые руки сводят защиту на нет. Это же относится к дестякам дыр в апаче - прямые руки не ставят неизвестные модули &quot;просто так&quot;. Основные же стабильны и безопасны приблизительно настолько же, насколько безопасен сам юникс. Для большей безопасности существуют опять же дополнительные меры, как неисполняемые стеки и тому подобное.

Т.е. процент нахожения дыры в апаче выше, чем в юниксе, но остается ничтожно мал с вероятностью косяков админа. Так что пугать людей &quot;ацкими дырами&quot; - лоховство, уж извините.
Подавляющее большинство хаков - это или сами дырявые PHP скрипты или, что еще чаще - трояны и соц. инженерия. Об этом стоит беспокоиться пользователям в первую очередь, а не о том, что их хостинг &quot;стопудова дырявый&quot;

;alexei1966
Остается прояснить анатомические детали: как клиенту определять прямизну рук сисадминов хостера, которых он в глаза не видел и не увидит. Определить прямизну ног сотрудницы, заключающей договор о хостинге как-то легче.  

Верить &quot;имени&quot; провайдера? Загляните в статистику по российским веб-хостерам:

http://internet.cnews.ru/hosting/stat/

Возьмем для примера Вальюхост, в просторечии - Валуй. Реально крупнейший российский провайдер. А вот в прямизне рук валуйских админов я (и не только я) сильно не уверен. Тем не менее лично знаю одну даму, которая валуйскими услугами крайне довольна. В общем, сколько людей, столько и мнений.  

Если конкретно про историю, с которой началось обсуждение - с вероятностью 99% кракеры получили доступ к базе потому, что физически находились на том же виртуальном хостинге. Они подсмотрели логин/пароль, который лежит в явном виде, и дальше через какой-нибудь phpMyAdmin слили БД. А что делать дальше - не знали, даже простой пароль не смогли подобрать. Были бы трояны/соц.инженерия - в руки к кракерам попал бы пароль админа. &quot;Дырявые скрипты&quot; - это об чем? Хостинг и еще раз хостинг...
----

;~MiksIr
В исходном посте недостаточно информации, что бы вынести суждение &quot;показали мой пароль&quot; - это пароль на форум или на MySQL.

И вероятностями тут глупо оперировать не узнав, хотя бы, хостинг. 

О выборе хостинга - отельная песня, и я уже писал про это. К слову, сколько всякого г-на на валуй я не слышал, но о том, что через них что-то у кого-то легко крали -- такого не встречал.
----

;~WildRAID
Риск есть в любом деле. Вы можете умереть в любую секунду с небольшой вероятностью. Утрата каких-то жалких файлов -- это мелочи. В сравнении со многими и многими вещами.

Приобретая услуги любого хостинга, вы всегда рискуете потерять информацию. Shared, не shared who cares. Там работают люди, которые ошибаются. Везде работают люди, которые ошибаются.

Если хотите полностью взять ответственность на себя -- поставьте сервер дома и настройте самостоятельно. И все равно -- никаких гарантий.

По-моему, это очевидные вещи. О чем тема?
----

;alexei1966
Двумя руками &quot;за&quot; выступление ~WildRAID! Если вы выставляете свой сайт в Интернет, то должны быть готовы к тому, что однажды до него кто-то доберется с &quot;черного хода&quot;. Это как вождение автомобиля - за 10 лет вождения непременно будут и вмятины, и столкновения -- не ты, так в тебя... 

Надо к этому относиться по-философски. Быть психологически готовым к взлому, а при обнаружении следов взлома -- спокойно действовать. 

Я тут просмотрел структуру IPB 2.3.6 -- она, увы, не модульная. И она предполагает существование каталогов с возможностью записи внутри этого дерева. Тем не менее некоторую пакость кракерам можно сделать -- конечно, если хостер поможет.  Сразу говорю -- не панацея, но хоть что-то.

================
1. Обычно в тарифном плане есть возможность заводить несколько виртуальных хостов. Заводим кроме основного ''forumtest.domain.ru'' хост ''forumtestuploads.domain.ru''. 

2. Передвигаем (mv) туда каталог uploads - это единственный каталог IPB, который должен быть постоянно открыт на запись веб-сервером.

3. Заходим в админку - &quot;Утилиты и настройки&quot; - &quot;Общие настройки&quot;. Меняем &quot;URL к директории для загрузок&quot; и &quot;Путь к директории 'upload'&quot; на новые -- ''forumtestuploads.domain.ru'' и что-то вроде {{{/www/petrov/forumtestuploads.domain.ru/html/uploads}}}.

4. Теперь все файлы и каталоги, оставшиеся в каталоге IPB, делаем доступными только для чтения. С этим могут быть проблемы, поэтому лучше попросить хостера сделать из корневого каталога вашего виртуального хоста что-то вроде:
{{{
find ./ -type d -exec chmod 550 '{}' \;
find ./ -type f -exec chmod 440 '{}' \;
}}}

5. Далее просим хостера внести в конфигурационный файл Апачи для основного виртуального хоста форума строчку:
{{{
&lt;VirtualHost 1.1.1.1:80&gt;
SetEnv DBPassword mypass
}}}

6. В файл conf_global.php меняем строчку:
{{{
$INFO['sql_pass'] = $_SERVER[&quot;DBPassword&quot;];
}}}

7. Просим хостера поменять владельца всех файлов в каталоге обоих виртуальных хостов на вашего пользователя, т.к. некоторые каталоги и файлы имеют по умолчанию владельцем apache, что-то вроде:
{{{
chown petrov ./* -R
}}}
================

Что получаем в итоге.
1. Основные скрипты форума отделены от подгружаемых данных и имеют права только на чтение. Поэтому кракер не сможет их модифицировать. Это имеет и обратную сторону -- вы не сможете подгрузить через админку новые языковые файлы, рисунки для оформления и т.п., пока не измените атрибуты у каталогов. С другой стороны -- это не каждый день надо. Зато спать будете спокойно.  

2. Пароль к базе данных берется из переменной для данного виртуального хоста. Чтобы получить эту переменную, кракер должен запустить свой скрипт из каталога вашего основного виртуального хоста, а сделать это он не может, т.к. каталоги закрыты для записи. Значит, и пароль к базе просто так не стянет.

В общем, если хостер пойдет навстречу, такую простенькую защиту сделать можно; я проверил -- работает. Главное, чтобы конфигурационный файл Апачи у хостера не был открыт для чтения &quot;прочими&quot;, а по умолчанию он как раз открыт. 
----

;~MiksIr
А что помешает человеку, загрузившему что-то свое сделать chmod 777 на файлы форума?
----

;alexei1966
Поконкретнее, пожалуйста. А то много догадок приходится делать насчет вашего &quot;человека, загрузившего что-то свое&quot;.  Что за &quot;человек&quot;, какие у него права, что именно и в какой каталог он грузит? И каким образом он потом меняет права у чужих файлов?
----

;~MiksIr
Это вы по подробнее, что своим шаманством с атрибутами на чтение хотите сделать -- защита от чего именно это?
{{{
find ./ -type d -exec chmod 550 '{}' \;
find ./ -type f -exec chmod 440 '{}' \;
}}}

Кстати, {{{chmod -R a-w *}}} - так, пожалуй, пишется правильно
----

;alexei1966
Извините, мое терпение не беспредельно -- на этом уровне диалог с вами считаю бессмысленным. Я свою точку зрения изложил абсолютно ясно и предложил конкретные рекомендации по улучшению безопасности IPB на виртуальном хостинге.

Желаю вам также излагать мысли конкретно, а не рассказывать нечто про &quot;человека, загрузившего что-то свое&quot; и &quot;админов с прямыми руками&quot;.
----

;~MiksIr
Вы изложили &quot;что нужно сделать&quot;, а я спрашиваю -- &quot;зачем и как это поможет&quot;.
----

;alexei1966
По-моему, я один раз уже объяснил. Но если вы не поняли - объясняю лично вам еще раз другими словами.  

*Злоумышленник, получивший права веб-сервера, более не может просто так &quot;подсмотреть&quot; пароль к базе данных, так как пароль отныне находится за пределами виртуального хоста и передается только этому хосту. А каталог виртуального хоста закрыт от записи, и записать туда свой скрипт, чтобы подсмотреть переменную, кракер не может.

*Кракер не может более ничего испортить в каталогах {{{cache/}}}, так как они также закрыты от записи.

*Фактически все, что теперь доступно злоумышленнику с правами веб-сервера - это потереть или заменить файлы, выгруженные пользователями в виде вложений в каталог {{{uploads/}}}. Но это беда уже относительно небольшая. Ни писать на форуме, ни рушить его структуру, он не может - необходимы другие права.
}}}



</pre>
</div>
<div title="Обновление системы" modifier="Яковлев Иван" created="200906032301" modified="200906040915" tags="[[Репозитарии и обновление в Ubuntu]]" changecount="2">
<pre>После того как вы обновили список репозиториев, вы скорее всего увидите вот такой значок в трее.

{{textAlignCenter{
[img[images/articles/update-required.png]]
}}}
Это означает что появились новые обновления для имеющего у вас ПО, либо для системы.
Нажмите левой кнопкой мыши на этом значке.

{{textAlignCenter{
[img[images/articles/update-window.png]]
}}}
Перед вами менеджер обновлений. Первый раз после установки обновлений может быть очень много (а в принципе может и не быть вообще, смотря какие репозитории вы подключили и как настроили обновления).

Обратите внимание на размер скачиваемых пакетов, если у вас интернет ограничен. Для каждого обновления можно посмотреть описание. Чтобы установить обновления - жмем Install Updates.

{{textAlignCenter{
[img[images/articles/downloading-packages.png]]
}}}
Началась закачка пакетов обновлений. Чтобы увидеть подробности - нажмите на соответствующий значок.

{{textAlignCenter{
[img[images/articles/download-details.png]]
}}}
Вы увидите статус закачки конкретного пакета, а также скорость загрузки и приблизительное время до конца закачки. После того как закачка закончится - начнется установка ПО. Этот процесс может занять долгое время.

{{textAlignCenter{
[img[images/articles/no-updates.png]]
}}}
Ну вот и все, обновления загружены и установлены. Обратите внимание на значок в трее. Если вы его видите - это означает что вам надо перезагрузить систему. Нажмите левой кнопкой мыши на нем.

{{textAlignCenter{
[img[images/articles/restart-required.png]]
}}}
Жмем Restart Now и перегружаемся.

{{textAlignCenter{
[img[images/articles/restart-now.png]]
}}}
Все, система обновлена.

Если вы убрали автопроверку обновлений или если хотите проверить обновления немедленно, то можно вызвать менеджер обновлений из меню: System (Система) - Администрирование - Менеджер обновлений. Только не забудьте потом в нем нажать кнопку проверки обновлений.

{{textAlignCenter{
[img[images/articles/menu-update-manager.png]]
}}}

!См. далее
*[[Ручное обновление системы]]


</pre>
</div>
<div title="Обо мне" modifier="Яковлев Иван" created="200911261251" modified="200911261255" changecount="2">
<pre>&lt;&lt;tiddler [[Яковлев Иван]]&gt;&gt;</pre>
</div>
<div title="Описание окружения Apache применительно к Ubuntu" modifier="Яковлев Иван" created="200906200135" modified="200907021256" tags="[[Настройка Apache]] [[TODO - нужен перевод статьи]] TODO slicehost" changecount="10">
<pre>!Описание
Ubuntu uses a different Apache layout than you may have encountered if you have used Apache with non-Debian based Operating Systems. The differences are not huge and, indeed, help in configuring and deploying websites.

!Обзор
Assuming you have used aptitude to install Apache (see the [[Установка Apache и PHP]]), move into the config folder and have a look:
{{{
cd /etc/apache2
ls
}}}
You will see this:

{{textAlignCenter{
[img[images/articles/intrepid-apache-layout.jpg]]
}}}
The folders are highlighted in blue. Let's look at those first:

!sites-available
Inside sites-available will be files containing the configurations for each site you want to serve - these are known as vhosts or virtual hosts.

Have a look now and see that there is one site (default) available:
{{{
ls sites-available/
...
default  default-ssl
}}}
The apache install has a '''default''' and a '''default-ssl''' vhost available - when we navigated to the Slice IP and got the 'It works!&quot; message, it was the 'default' file that told Apache what to do and where the files where located.

We'll look at vhosts in more detail and create our own in a later article.

Do note that a file in sites-available does not mean they are active. They are simply available for serving if you enable them. Which brings us to...

!sites-enabled
This folder contains symlinks to the sites you actually want to serve.

For example, you could have two vhosts configured and ready to use in the sites-available folder, but only one of them enabled. Only the one symlinked from the sites-enabled folder would be served.

Have a look at the default contents:
{{{
ls -l sites-enabled
...
lrwxrwxrwx 1 root root 26 Nov 28 22:38 000-default -&gt; ../sites-available/default
}}}
This means that the 'default' site has been enabled - the symlink named '''000-default''' links to the '''default''' file in the sites-available folder.

Without the symlink in this folder it would remain available (in the sites-available folder) but not active.

The other thing to note is the naming. It's possible for a domain to point to your Slice IP but have no site configuration file. In these cases, the first enabled site (alphabetically) will be displayed, i.e. 000-default's config will be used.

!mods-available
Well, I guess you get the idea already but this folder holds the modules that are available to be loaded.

Have a look:
{{{
ls mods-available
}}}
A fair list is available from our base install but remember that they are not all enabled, merely available for use. Just as with the vhosts files, any modules that we want to use must be enabled.

!mods-enabled
This folder contains symlinks to the modules that we want enabled. Have a look and compare it to the list of modules available:
{{{
ls mods-enabled 
}}}
This list is a lot shorter than the list of available modules (meaning not all the available modules are enabled) and includes {{{php5.conf}}} - which is handy as we installed ~PHP5 earlier.

!a2en... and a2dis...
Being good sysadmins, we like to get hands on and create our vhosts, and now that we know how the symlinks work we could go ahead and 'ln -s' until all our sites are enabled.

However, there are some commands that make this process much easier. They are ''a2dissite'', ''a2ensite'', ''a2dismod'' and ''a2enmod''.
{{{
a2dissite
}}}
This will delete the symlink to a site you have previously enabled.

For example, let's disable the default site:
{{{
sudo a2dissite default
}}}
The symlink in sites-enabled has been deleted and the output is as follows:
Site default disabled.
Run '{{{/etc/init.d/apache2 reload}}}' to activate new configuration!

Reload Apache as indicated to ensure the site is fully disabled:
{{{
sudo /etc/init.d/apache2 reload
}}}
When you now visit your Slice IP, instead of the nice 'It Works!' page, you will get a 404 Not Found message:

{{textAlignCenter{
[img[images/articles/no-default-vhost-404.jpg]]
}}}
Note the main vhosts file in sites-available is still there - all the a2dissite command did was remove the symlink in the sites-enabled folder.

a2ensite

Let's enable the default site again:
{{{
sudo a2ensite default
}}}
The output:
{{{
Enabling site default.
Run '/etc/init.d/apache2 reload' to activate new configuration!
}}}
Reload Apache:
{{{
sudo /etc/init.d/apache2 reload
}}}
Visit your Slice IP - the default 'It works!' page is being served again.

a2dismod

In the same way as just shown, a2dismod will disable any modules you have previously enabled:
{{{
sudo a2dismod php5
}}}
The output:
{{{
Module php5 disabled.
Run '/etc/init.d/apache2 restart' to activate new configuration!
}}}
That will disable the php5 module and if you look in the mods-enabled folder, you will see that the symlinks php5.conf and php5.load have been deleted.

a2enmod

I reckon you've got it now, but to enable the php5 module simply enter:
{{{
sudo a2enmod php5
}}}
The output:
{{{
Enabling module php5.
Run '/etc/init.d/apache2 restart' to activate new configuration!
}}}
And a quick check will show that indeed, the php5.conf and php5.load symlinks are back in the mods-enabled folder.

!Заключение
Don't forget to reload Apache after each site or module change. The next article [[Конфигурирование сервера Apache в Ubuntu]] we'll discuss the main apache2.conf file and look at what changes can be made to optimise the install.

!Ссылки
*[[Оригинал статьи на slicehost.com|http://articles.slicehost.com/2008/12/11/ubuntu-intrepid-apache-config-layout]]


</pre>
</div>
<div title="Организация хостинга на VPS" modifier="Яковлев Иван" created="200906051214" modified="200906192155" tags="Хостинг [[Выделенный VPS сервер]] TODO" changecount="5">
<pre>!Описание
VPS (англ. Virtual Private Server), также VDS (англ. Virtual Dedicated Server) -- услуга, в рамках которой пользователю предоставляется т. н. виртуальный выделенный сервер. В плане управления операционной системой по большей части она соответствует физическому выделенному серверу.

В частности: root-доступ, собственные ~IP-адреса, порты, правила фильтрования и таблицы маршрутизации. Внутри виртуального сервера можно создавать собственные версии системных библиотек или изменять существующие, владелец VPS может удалять, добавлять, изменять любые файлы, включая файлы в корневой и других служебных директориях, а также устанавливать собственные приложения или настраивать/изменять любое доступное ему прикладное программное обеспечение.

В некоторых системах виртуализации (к примеру -- ~VMWare и Xen) также доступны для редактирования настройки ядра операционной системы и драйверов устройств.

!См. также
TODO

!Ссылки
*http://ru.wikipedia.org/wiki/VPS -- описание VPS на Википедии


</pre>
</div>
<div title="Переменные окружения командной оболочки bash" modifier="Яковлев Иван" created="200906121709" modified="200906121832" tags="[[Командная оболочка bash]]" changecount="10">
<pre>Переменные окружения могут быть использованы вами при вызове команд. Например:
{{{
echo $BASH_VERSION
}}}
выведет текущую версию оболочки bash.

!Список встроенных переменных окружения
;{{{BASH}}}
:Содержит путь к текущему командному интерпретатору bash ({{{/bin/bash}}}).

;{{{BASH_COMMAND}}}
:Команда, которая только что была выполнена

;{{{BASH_VERSION}}}
:Версия текущего командного интерпретатора bash.

;{{{COLORS}}}
:Пenm к конфигурационному файлу задания цветового оформления для команды ls.

;{{{COLUMNS}}}
:Ширина терминала в символах (обычно равна 80 символам).

;{{{DISPLAY}}}
:Identifies the X display where commands launched from the current shell will be displayed (such as :0.0).

;{{{EUID}}}
:Effective user ID number of the current user. It is based on the user entry in {{{/etc/passwd}}} for the user that is logged in.

;{{{FCEDIT}}}
:Determines the text editor used by the {{{fc}}} command to edit history commands. The vi command is used by default.

;{{{GROUPS}}}
:Список групп к которым относится текущий пользователь.

;{{{HISTCMD}}}
:Номер текущей команды в списке истории команд.

;{{{HISTFILE}}}
:Содержит путь к файлу истории оболочки для текущего пользователя (обычно это {{{$HOME/.bash_history}}}).

;{{{HISTFILESIZE}}}
:Общее количество допустимых записей в файле истории (обычно 1000 записей).

;{{{HOME}}}
:Содержит местоположение домашнего каталога текущего пользователя.

;{{{HOSTNAME}}}
:Имя хоста текущей машины (имя компьютера).

;{{{HOSTTYPE}}}
:Тип архитектуры текущей машины (i386, i486, i586, i686, x86_64, ppc, ppc64).

;{{{LESSOPEN}}}
:Set to a command that converts content other than plain text (images, ~RPMs, zip files, and so on) so it can be piped through the less command.

;{{{LINES}}}
:Содержит количество линий (строк) в текущем терминале.

;{{{LOGNAME}}}
:Имя текущего пользователя.

;{{{LS_COLORS}}}
:Maps colors to file extensions to indicate the colors the ls command displays when encountering those file types.

;{{{MACHTYPE}}}
:Displays information about the machine architecture, company, and operating system (such as i686-redhat-linux-gnu)

;{{{MAIL}}}
:Indicates the location of your mailbox file (typically the user name in the {{{/var/spool/mail}}} directory).

;{{{MAILCHECK}}}
:Checks for mail in the number of seconds specified (default is 60).

;{{{OLDPWD}}}
:Directory that was the working directory before changing to the current working directory.

;{{{OSTYPE}}}
:Name identifying the current operating system (such as linux or linux-gnu)

;{{{PATH}}}
:Colon-separated list of directories used to locate commands that you type ({{{/bin}}}, {{{/usr/bin}}}, and {{{$HOME/bin}}} are usually in the ''PATH'').

;{{{PPID}}}
:Идентификатор процесса запустившего текущую командную оболочку.

;{{{PRINTER}}}
:Sets the default printer, which is used by printing commands such as {{{lpr}}} and {{{lpq}}}.

;{{{PROMT_COMMAND}}}
:Set to a command name to run that command each time before your shell prompt is displayed. (For example, {{{PROMPT_COMMAND=ls}}} lists commands in the current directory before showing the prompt). 

;{{{PS1}}}
:Sets the shell prompt. Items in the prompt can include date, time, user name, hostname, and others. Additional prompts can be set with ~PS2, ~PS3, and so on.

;{{{PWD}}}
:Содержит текущий каталог, в которм находится текущий пользователь.

;{{{RANDOM}}}
:Accessing this variable generates a random number between 0 and 32767.

;{{{SECONDS}}}
:Количество секунд с момента запуска текущей командной оболочки.

;{{{SHELL}}}
:Содержит полный путь к текущей командной оболочке (обычно {{{/bin/bash}}}).

;{{{SHELLOPTS}}}
:Lists enabled shell options (those set to on)



</pre>
</div>
<div title="Подключение и отключение от сервера MySQL" modifier="Яковлев Иван" created="200907181059" modified="200907181106" tags="[[Команды MySQL]]" changecount="5">
<pre>!Подключение
Наберите в командной строке:
{{{
mysql -h localhost -u user -p
}}}
Появится запрос пароля, введите пароль к вашему серверу ~MySQL:
{{terminal{
{{{
Enter password: ********
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 25338 to server version: 5.1.21-beta-standard

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql&gt;
}}}
}}}
{{note{
''ЗАМЕЧАНИЕ:''
Если вы подключаетесь с той же машины, на которой запущен ~MySQL сервер, то {{{-h localhost}}} можно не указывать.
}}}

!Отключение
Чтобы отключиться от сервера, наберите:
{{{
mysql&gt; quit
}}}
или 
{{{
mysql&gt; \q
}}}


</pre>
</div>
<div title="Подключение к рабочему столу через VNC" modifier="Яковлев Иван" created="200906061408" modified="200906191421" tags="[[Удаленное подключение]] VNC slider" changecount="7">
<pre>#[[Стандартный способ|Стандартный способ подключения в Ubuntu]]
#[[Использование x11vnc|Использование x11vnc]]</pre>
</div>
<div title="Подмена time.windows.com локальным ntp-сервером" modifier="Яковлев Иван" created="200906052358" tags="Статьи [[Администрирование сервера]] TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*http://habrahabr.ru/blogs/sysadm/60319/#habracut



</pre>
</div>
<div title="Потоковое видео" modifier="Яковлев Иван" created="200906191535" modified="200906191538" tags="[[Установка/настройка Web-сервера]] slider" changecount="2">
<pre>#[[Раздача FlashVideo|Использование lighttpd, Mplayer/Mencoder и Flvtool2 для реализации потоковой раздачи Flash Video]]
#[[Стриминг на Nginx|Стриминг Flash Video при помощи Nginx]]</pre>
</div>
<div title="Правильный бекап MySQL" modifier="Яковлев Иван" created="200906041616" modified="200906041641" tags="[[Администрирование сервера]]" changecount="8">
<pre>!Задача
Орагнизовать резервное копирование базы данных на Windows машину не имея непосредственного доступа к серверу ~MySQL.

{{textAlignCenter{
[img[images/articles/scheme.png]]
}}}

!Решение
Для бекапа будут использоваться две утилиты:
[[Putty|http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html]] - лучший консольный SSH клиент для Windows.
~MySQL Administrator - входт в состав ~MySQL GUI Tools и доступен на сайте http://dev.mysql.com
Основная функция putty - предоставить доступ к командной строке сервера. Второй предоставляемой им возможностью, которую я буду использовать, является тунелирование соединений. Не буду вдаваться в подробности этого понятия. Скажу, что тунелирование поможет мне перенести интерфейс к базе данных на Windows машину так, что мне останется только сделать бекап с локальной машины. Для непосредственного бекапа я буду использовать ~MySQL Administrator.

Запускаю putty, в разделе Session указываю адрес ~ApacheSrv. В разделе Tunnels указываю порт источник 5000 и назначение mysql.host.com:3306. Нажимаю кнопку Open, ввожу запрашиваемые логин и пароль. С этого момента начинает действовать тунелирование. Другими словами, на 5000 порту Windows машины теперь действует точная копия ~MySQL сервера, которая будет считать, что к ней присоединяется ~ApacheSrv.

{{textAlignCenter{
[img[images/articles/backup1.PNG]]
}}}
{{textAlignCenter{
[img[images/articles/backup2.PNG]]
}}}
{{textAlignCenter{
[img[images/articles/backup3.PNG]]
}}}
Запускаю ~MySQL Administartor, указываю имя хоста localhost (Windows машина) , порт 5000, а также имя пользователя и пароль к БД. После соединения с базой данных выбираю Backup, New Project. Ввожу имя проекта My backup, выбираю базу данных для бекапа и нажимаю на кнопку &quot;{{{&gt;}}}&quot;, для того чтобы ~MySQL Administrator получил список таблиц в базе.

{{textAlignCenter{
&lt;html&gt;&lt;a class=&quot;imgLink&quot; href=&quot;images/articles/backup4.PNG&quot; target=&quot;_blank&quot; title=&quot;&quot;&gt;&lt;img src=&quot;images/articles/backup4.PNG&quot; width=&quot;550&quot; alt=&quot;backup4.PNG&quot; /&gt;&lt;/a&gt;&lt;/html&gt;
}}}
Нажимаю Execute Backup Now и указываю, куда мне сохранить бекап. Процесс может занять несколько часов. По окончании должно высветиться окно The Backup was finished successfully.
Для восстановления вместо Backup надо выбрать Restore и указать на сохранённый файл.

!Заметки
*Имя SSH сервера, а также, логин и пароль часто совпадают с параметрами доступа по FTP.
*Адрес ~MySQL сервера, имя пользователя и пароль можно посмотреть в конфигурационных файлах ваших скриптов, или же обратиться к хостеру.
*Перед бекапом надо обязательно остановить сервис, который работает с базой данных. Иначе восстановление данных не гарантировано.
*Файлы бекапа базы данных, как правило, хорошо поддаются сжатию, так что хранить их удобнее в сжатом виде.
*Бекап необходимо проводить регулярно, и копии хранить в безопасном месте. Хранить копии на рабочей машине небезопасно. *Лучше использовать внешние носители.
*Использование Web интерфейсов, таких кaк phpMyAdmin, позволяет орагнизовать бекап и восстановление только маленьких баз данных. Предложенный мной способ прекрасно справляется с гигабайтными объёмами.
*Не имеет значения сколько место вам предоставляет хостер. Для такого бекапа не портебуется дополнительного места.
{{textAlignRight{
//Автор: Alexxz//
}}}

{{note{
@@font-weight: bold;КОММЕНТАРИИ:@@
Если бекап занимает гигабайты и часы, то по уму надо делать slave и бекапится с него. Вы же не будете останавливать рабочую базу на несколько часов для ежедневного бекапа?
----
Да, согласен, если проект действительно серьёзный. На практике, если идут такие объёмы данных, то и прямой доступ к базе данных тоже, как правило, есть.
Данная заметка предназначается больше для владельцев мелких частных сайтов и форумов, которые просто не знают как сделать бекап в таком случае.
Лично я тоже не знал, потому потратил своё время, чтобы найти решение.

Сейчас я делаю такие бекапы с девелоперской версии проекта, чтоб не пинать лишний раз админов.
}}}

!См. также
TODO

!Оригинал статьи
*http://aztips.blogspot.com/2008/01/mysql.html



</pre>
</div>
<div title="Приложения" modifier="Яковлев Иван" created="200906191935" modified="200906191935" tags="[[Дополнительные материалы]] TODO" changecount="2">
<pre>TODO</pre>
</div>
<div title="Пример конфигурации nginix сервера" modifier="Яковлев Иван" created="200906201950" modified="200906201951" tags="[[Примеры конфигурационных файлов]] [[Настройка Nginx]]" changecount="2">
<pre>Пример конфигурации сайта, который передаёт все запросы бэкенду, кроме картинок и запросов, начинающихся с &quot;/download/&quot;.
{{{
user  www www;

worker_processes  2;

pid /var/run/nginx.pid;

# [ debug | info | notice | warn | error | crit ] 

error_log  /var/log/nginx.error_log  info;

events {
    connections   2000;

    # use [ kqueue | rtsig | epoll | /dev/poll | select | poll ] ;
    use kqueue;
}

http {

    include       conf/mime.types;
    default_type  application/octet-stream;


    log_format main      '$remote_addr - $remote_user [$time_local]  '
    '&quot;$request&quot; $status $bytes_sent '
    '&quot;$http_referer&quot; &quot;$http_user_agent&quot; '
    '&quot;$gzip_ratio&quot;';

    log_format download  '$remote_addr - $remote_user [$time_local]  '
    '&quot;$request&quot; $status $bytes_sent '
    '&quot;$http_referer&quot; &quot;$http_user_agent&quot; '
    '&quot;$http_range&quot; &quot;$sent_http_content_range&quot;';

    client_header_timeout  3m;
    client_body_timeout    3m;
    send_timeout           3m;

    client_header_buffer_size    1k;
    large_client_header_buffers  4 4k;

    gzip on;
    gzip_min_length  1100;
    gzip_buffers     4 8k;
    gzip_types       text/plain;

    output_buffers   1 32k;
    postpone_output  1460;

    sendfile         on;
    tcp_nopush       on;
    tcp_nodelay      on;
    send_lowat       12000;

    keepalive_timeout  75 20;

    #lingering_time     30;
    #lingering_timeout  10;
    #reset_timedout_connection  on;


    server {
        listen        one.example.com;
        server_name   one.example.com  www.one.example.com;

        access_log   /var/log/nginx.access_log  main;

        location / {
            proxy_pass         http://127.0.0.1/;
            proxy_redirect     off;

            proxy_set_header   Host             $host;
            proxy_set_header   X-Real-IP        $remote_addr;
            #proxy_set_header  X-Forwarded-For  $proxy_add_x_forwarded_for;

            client_max_body_size       10m;
            client_body_buffer_size    128k;

            client_body_temp_path      /var/nginx/client_body_temp;

            proxy_connect_timeout      90;
            proxy_send_timeout         90;
            proxy_read_timeout         90;
            proxy_send_lowat           12000;

            proxy_buffer_size          4k;
            proxy_buffers              4 32k;
            proxy_busy_buffers_size    64k;
            proxy_temp_file_write_size 64k;

            proxy_temp_path            /var/nginx/proxy_temp;

            charset  koi8-r;
       }

        error_page  404  /404.html;

        location /404.html {
            root  /spool/www;

            charset         on;
            source_charset  koi8-r;
        }

        location /old_stuff/ {
            rewrite   ^/old_stuff/(.*)$  /new_stuff/$1  permanent;
        }

        location /download/ {

            valid_referers  none  blocked  server_names  *.example.com;

            if ($invalid_referer) {
                #rewrite   ^/   http://www.example.com/;
                return   403;
            }

            #rewrite_log  on;

            # rewrite /download/*/mp3/*.any_ext to /download/*/mp3/*.mp3
            rewrite ^/(download/.*)/mp3/(.*)\..*$
            /$1/mp3/$2.mp3                   break;

            root         /spool/www;
            #autoindex    on;
            access_log   /var/log/nginx-download.access_log  download;
        }

        location ~* ^.+\.(jpg|jpeg|gif)$ {
            root         /spool/www;
            access_log   off;
            expires      30d;
        }
    }
}
}}}

{{textAlignRight{
Ссылка: http://wiki.nginx.org/NginxRuExample
}}}




</pre>
</div>
<div title="Примеры конфигурационных файлов" modifier="Яковлев Иван" created="200906192245" modified="200906201953" tags="slider MainMenu Описания" changecount="10">
<pre>*[[Пример конфига nginix сервера|Пример конфигурации nginix сервера]]
*[[sshd сonfig file exemple|sshd configuration file exemple]]
*[[iptables config file exemple|iptables configuration file exemple]]
</pre>
</div>
<div title="Проверка работы вкладок" modifier="Яковлев Иван" created="200907121059" modified="200907251419" tags="CodeSnippets" changecount="6">
<pre>&lt;&lt;tabs tabcookie
    &quot;Заголовок1&quot; &quot;Описание заголовка1&quot; [[Специальные символы bash]]
    &quot;Заголовок2&quot; &quot;Описание заголовка2&quot; [[/etc/group - список групп]]
&gt;&gt;


</pre>
</div>
<div title="Просмотр свойств установленного пакета с помощью Synaptic" modifier="Яковлев Иван" created="200906032342" modified="200906040919" tags="[[Установка ПО в Ubuntu]]" changecount="4">
<pre>Зайдем в Sypantic и опять найдем уже установленный Krusader.

{{textAlignCenter{
[img[images/articles/sypantic-krusader-installed.png]]
}}}
Нажмите правой кнопкой мыши на установленном пакете.

{{textAlignCenter{
[img[images/articles/synaptic-right-click-menu.png]]
}}}
С помощью двух пунктов меню пакет можно удалить. Замечу, что если от этого пакета зависят другие пакеты - они тоже будут удалены. Разница между обычным удалением и полным удалением состоит в том, что при полном удалении вместе с самой программой также будут удалены все конфигурационные файлы приложения.

Зайдем в свойства пакета. На закладке &quot;Общее&quot; в основном общая информация (ну это и логично ). Здесь можно посмотреть какую версию вы используете, какая версия последняя, сколько нужно скачать, чтобы обновиться, категория этого ПО и другое.

{{textAlignCenter{
[img[images/articles/krusader-settings-basic.png]]
}}}
Следующая закладка уже интересней. Зависимости навряд ли нас заинтересуют, а вот другая информация может быть полезной. Обратите внимание на то, что krusader предлагает установить дополнительное ПО, а именно: архиваторы, утилиты для сравнения, текстовый редактор и другое.. После установки архиваторов (если они уже не установлены) вы сможете открывать архивы в Krusader. Думаю, это полезная информация.

{{textAlignCenter{
[img[images/articles/krusader-settings-depends.png]]
}}}
Переходим на следующую закладку. Иногда бывают такие ситуации, что нужно найти какие-то файлы, относящиеся к приложению и не знаешь откуда начинать искать. Эта закладка поможет вам в этом.

{{textAlignCenter{
[img[images/articles/krusader-settings-installed-files.png]]
}}}
На следующей вкладке можно посмотреть доступные версии приложения. Как подсказывает замечание ниже, можно установить определенную версию приложения, например более старую, если в новой какой-то дефект.

{{textAlignCenter{
[img[images/articles/krusader-settings-versions.png]]
}}}
Ну и последняя вкладка показывает расширенное описание пакета, которое поможет вам понять, то ли это, что вы ищите, или нет.

{{textAlignCenter{
[img[images/articles/krusader-settings-description.png]]
}}}

!См. далее
*[[Кэш установленных пакетов]]


</pre>
</div>
<div title="Пункт меню УстановкаУдаление приложений" modifier="Яковлев Иван" created="200906032342" modified="200906040923" tags="[[Установка ПО в Ubuntu]]" changecount="4">
<pre>Synaptic хорош для тех случаев, когда вы знаете что устанавливать или хотя бы приблизительно догадываетесь об этом. 
Но иногда хочется просто поэкспериментировать, попробовать разные приложения, сравнить их..
Для этих целей есть другое приложение.
Заходим в пункт меню Приложения - Установка/удаление приложений.

{{textAlignCenter{
[img[images/articles/menu-install-application.png]]
}}}
Перед вами приложение, с помощью которого можно сделать обзор ПО. Слева находятся категории.

{{textAlignCenter{
[img[images/articles/add-install-application.png]]
}}}
Обратите внимание на краткое вступление, которое показывается при запуске программы. Установка/удаление программ делается очень просто, также как и в Synaptic. Особое внимание обратите на то, что по умолчанию показываются не все приложения, а только поддерживаемые! Я специально выделил это на рисунке выше. Чтобы увидеть все приложения, которые можно установить, выберите соответствующий пункт меню. Также приложения можно сортировать по их популярности. На первом месте окажется то, что пользователи устанавливают чаще всего. Хотя не стоит доверять этому, иногда очень хорошие программы стоят не в первых рядах.

!См. далее
*[[Установка, удаление, поиск и другие операции вручную]]


</pre>
</div>
<div title="Пути (Paths)" modifier="Яковлев Иван" created="200906111528" modified="200906121407" tags="[[Навигация по каталогам]] [[TODO - нужен перевод статьи]]" changecount="4">
<pre>!Описание
There are two path concepts associated with Linux directories: absolute paths and relative paths. An absolute path describes the complete directory structure based on the top level root directory ({{{/}}}). A relative path is based on the current directory and does not include the slash in front.

The difference between an absolute path and a relative path is important. Especially when creating a script, absolute paths are essential. Otherwise, scripts executed from directories other than those designed for that script can lead to unintended consequences.

!См. также
*[[Шпоргалка по продвинутому использованию оболочки bash]]


</pre>
</div>
<div title="Работа с MySQL из командной строки" modifier="Яковлев Иван" created="200906041924" modified="200906041941" tags="Статьи [[Администрирование MySQL]]" changecount="4">
<pre>Будем считать что все у нас уже установленно и теперь приступаем непосредственно к работе.
Подключаемся:
{{{
ceval@srv:~$ mysql -pПАРОЛЬ
}}}
{{{-p, –password=[password]}}} - Пароль пользователя, для соединения с сервером ~MySQL. Не должно быть пробела между {{{-p}}} и паролем.
{{{-u, –user=[user]}}} Имя пользователя для соединения с сервером ~MySQL. Необязательно, по умолчанию используется такое же, как ваш логин. Используется если логин отличаться от имени пользователя для соединения с сервером ~MySQL.
{{{
mysql -u ceval_ -pПАРОЛЬ
}}}
Если мы ввели свой пароль правельно, то увидим такие строки и приглашения:
{{{
Welcome to the MySQL monitor.  Commands end with ; or \g.
Server version: 5.0.45-Debian
Type ‘help;’ or ‘\h’ for help. Type ‘\c’ to clear the buffer.

mysql&gt; 
}}}
Создаем нужную нам базу, с кодировкой ''cp1251'', указанную кодировку можно заменить на требуемую:
{{{
CREATE DATABASE db_name DEFAULT CHARACTER SET cp1251 DEFAULT COLLATE cp1251_general_ci;
}}}
Удаления базы:
{{{
DROP DATABASE db_name;
}}}
Смена базы
{{{
USE `mydatabase`;
}}}
Удаления таблицы из базы
{{{
DROP TABLE `db_table`;
}}}
Еще немного:
{{{
    -&gt;\g show databases; // смотрим какие базы есть
    -&gt;\g create database sputnik;  // создаем новую базу
    -&gt;\g show databases; // проверяем создалась ли она
    -&gt;\q // Выходим
}}}
В разных версиях ~MySQL могут быть разные команды (4 и 5) в данном случае {{{\g}}}  - дает команду серверу выполнить скрипт SQL

Загрузка, сохранение базы данных ~MySQL (backup, restore)

Загрузить базу сохраненными данными (если делалось сохранение данных). Они сохранены например в файле {{{baza.sql}}}
{{{
mysql
                -&gt;\g show databases;
                -&gt;\u baza;
                -&gt;\. /home/backup/baza.sql
                -&gt;\q
}}}
{{{/home/backup/baza.sql}}} - путь к файлу бекапа

Сохранить базу с данными в файл {{{baza.sql}}}
{{{
  mysqldump baza &gt; /home/backup/baza.sql;
}}}
База хранится:   {{{/var/lib/mysql/baza}}}  -  для удаления всей базы данных достаточно удалить данный каталог.

Можно осуществлять различными способами:
*подключиться по ''ssh'' и работать через командную строку;
*использовать ''phpmyadmin'', описанно немного [[здесь|http://www.itword.net/smf/index.php?topic=120.msg192#msg192]];
*использовать пакет ''mysql-admin'' - это графическая утилита администрирования ~MySQL (GUI tool for intuitive ~MySQL administration
~MySQL)
Теперь устанавливаем себе пакет ''mysql-admin'' на машину
{{{
sudo aptitude install mysql-admin
}}}
Дальше идем на удаленную машину и правим конфиг {{{my.cnf}}}
{{{
sudo nano /etc/mysql/my.cnf
}}}

Для начало можно проверить:
{{{
netstat -an | grep 3306
}}}
{{{
   tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN 
}}}
Как видно из вывода пока ~MySQL слушает на localhost'e, а нам нужно, чтобы ~MySQL слушал на всех интерфейсах, а не только на localhost, поэтому находим и редактируем такую запись: 
{{{
[...]
# Instead of skip-networking the default is now to listen only on
# localhost which is more compatible and is not less secure.
bind-address           = 127.0.0.1
#
[...]

и что б MySQL слушал на всех интерфейсах, закомментируем эту строчку:
[...]

#bind-address = 127.0.0.1:

[...]
}}}
Рестартнем ~MySQL:
{{{
sudo /etc/init.d/mysql restart
}}}
И посмотрем снова вывод команды:
{{{
netstat -an | grep 3306
}}}
Вывод должен выглядеть следующим образом:
{{{
  tcp        0      0 0.0.0.0:3306            0.0.0.0:*               LISTEN
}}}
и теперь можно запускать ''mysql-admin'' для удаленной работы с ~MySQL - ''Alt+F2'' {{{mysql-admin}}}
или
{{{
mysql-admin
}}}

!См. также
*[[Команды MySQL]]

!Оригинал статьи
*http://www.linuxjournal.su/?p=113



</pre>
</div>
<div title="Рабочий стол GNOME" modifier="Яковлев Иван" created="200906051612" modified="200906051618" tags="[[Настройка Ubuntu]] TODO" changecount="3">
<pre>!Описание
TODO

!См. также
*http://www.nongnu.org/gcmd/ss/gnome-commander_window.png -- gnome commander

!Ссылки
*http://www.gnome.org/ -- официальный сайт
*http://ru.wikipedia.org/wiki/GNOME -- описание на Википедии


</pre>
</div>
<div title="Разгоняем веб-сервер ngnix + Apache + mod_praf" modifier="Яковлев Иван" created="200906181746" modified="200906181800" tags="[[Nginx + Apache]]" changecount="3">
<pre>!Начало
С течением времени и все более плотным проникновением IT в нашу жизнь, веб-разработка давно перестала быть уделом избранных. Теперь любой желающий может легко обзавестись недорогим хостингом и разработать свой проект. Однако, недальновидность при выборе веб-платформы на недорогом (значит не очень мощном) сервере со временем приводит к страшной его загрузке, сбоям при передаче контента, постоянному юзанию свопа и т.д., в результате чего проект тихо загнивает на корню.
Конечно же, имеется в виду стандартно используемая всеми связка LAMP (Linux+Apache+~MySQL+PHP), которая хоть и функциональна, но и ресурсов под себя требует втрое, что не всегда оправдано.
Оптимизацией всего этого хозяйства мы сегодня и займемся.

Первое и главное: при отдаче контента apache занимается и его динамической (скрипты на php например) и статической (html, графика) составляющей. Обработка запросов производится параллельно, и при большом их количестве со временем наступает коллапс, когда из-за недостаточного объема свободной памяти и мощности процессора, апач (а если используется еще и ~MySQL, что типично для форумов например) лезет в своп и вся система становится в ступор. Описание проблемы несколько поверхностное, но суть отражает.
Второе – задайтесь вопросом – нужен ли для Вашего проекта весь необъятный функционал апача? Используется ли он на 100%? Вряд ли. Но ведь отрезать ненужное от него невозможно, поэтому все апачевские процессы тупо сидят в памяти, занимая ее порядочно.
Третье – PHP на Вашем хостинге скорей всего отдается апачевским модом, т.е. задействует тот же апач, отсюда эффект «снежного кома» при увеличении числа внешних запросов.

!Что можно сделать?
Многое. Например избрать один из следующих путей оптимизации (в порядке ее увеличения) :
#Перед apache поставить легкий веб-сервер, который будет заниматься отдачей статики, тем самым разгрузив апач и передав ему только обязанности по динамическому контенту. (оптимизация будет, но большого эффекта не дождетесь, тем более, память теперь будут занимать и апач и другой веб сервер.
#Выбросить апач вообще (не пугайтесь, ничего страшного в этом нет). Вместо него статикой все так же будет заниматься наш легкий сервер, а для php -- собственно соберем php, но не модулем апача, а как полноценное приложение. (тут с оптимизацией получше, особенно если собирать только то, что нужно для работы).
#Максимальная оптимизация -- php собираем с поддержкой ''fast-CGI'' и подключаем к серверу через unix (а не tcp) socket. (в таком вот режиме сейчас работает данный форум )

!Теперь обо всем подробно:
В качестве «легкого веб-сервера» можно использовать распространенные ''lightppd'' или ''nginx''. Я в силу лучшей конфигурируемости и гибкости nginx – про него и расскажу.

!!1. Nginx -- frontend, Apache -- backend
(т.е. nginx ставим перед апачем и настраиваем для отдачи статического контента).
{{{
sudo aptitude install nginx
}}}
конфигурация nginx (пример. полный обзор возможностей выходит за рамки этой статьи и доступен тут - http://sysoev.ru/nginx/:
Правим файл {{{/etc/nginx/nginx.conf}}}
{{{
user www-data; #от имени какого юзера в системе будет работать nginx
worker_processes 2; #количество рабочих процессов nginx сидящих в памяти постоянно

events {
    worker_connections 1024; #сколько коннектов обрабатывает каждый процесс
}

http {
    include /usr/local/etc/mime.types;
    default_type application/octet-stream;

    log_format main ‘$remote_addr - $remote_user [$time_local] $status ‘ \
    ‘”$request” $body_bytes_sent “$http_referer” ‘ \
    ‘”$http_user_agent” “http_x_forwarded_for”‘; #формат ведения логов

    access_log /var/log/nginx/access.log main; #куда писать лог доступа к серверу

    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;

server {
    listen 80; #какой порт слушать (можно указывать и ip/домен, если виртхостинг
    server_name mysite.ru www.mysite.ru; #как обозвали свой сайтец, нужно для работы «localtion»
    access_log /home/mysite/log/access.log main; #куда пишем лог доступа к данному сайту

# Сразу оговорим, что все кроме статич. контента пойдет через бекенд (т.е. апач)
    location / {
        proxy_pass http://127.0.0.1:8080/; #тут указываем ip/порт, на который будет завязан отныне апач. nginx будет пересылать запросы туда, выступая в качестве прокси
        proxy_redirect off;

        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; #настройка заголовков при проксировании

        client_max_body_size 10m;
        client_body_buffer_size 128k;

        proxy_connect_timeout 90;
        proxy_send_timeout 90;
        proxy_read_timeout 90; #всяческие таймауты, чтобы зависшие запросы к апачу убивались

        proxy_buffer_size 4k;
        proxy_buffers 4 32k;
        proxy_busy_buffers_size 64k;
        proxy_temp_file_write_size 64k;
    }

# Зона отдачи статического контента – работает при совпадении расширения запрошенного файла
    location ~* ^.+\.(htm|html|jpg|jpeg|gif|png|ico|css|zip|tgz|gz|rar|bz2|doc|xls|exe|pdf|ppt|txt|tar|wav|bmp|rtf|js)$ {
        root /home/mysite/html; #корневой каталог вашего сайта
    }
}
}}}
Объясню как это работает:
#При поступлении запроса на 80й порт вашего сервера, его принимает nginx и обрабатывает согласно правил в location.
#Если запрос статического контента – nginx сам его и отдает.
#Если запрос динамического контента (все остальные расширения файлов), запрос проксируется на apache с соответствующими правками заголовков через указанный порт 8080.
Чтобы все это заработало, не забудьте настроить apache слушать уже не 80й порт, а указанный нами 8080.Например вот так:
{{{
# в рабочем конфиге apache
…
Listen 8080
…
NameVirtualHost *:8080
…

ServerName mysite.ru
ServerAlias www.mysite.ru
ServerAdmin admin@mysite.ru
DocumentRoot /home/mysite/html
ErrorLog /home/mysite/log/error_log
CustomLog /home/mysite/log/access_log common
}}}
Если 8080-й порт уже занят в системе – вам никто не мешает использовать любой другой..
Один момент – порт должен быть открыт в файрволе сервера.. иначе соединению nginx-apache заработать не суждено.
Теперь просто делаем
{{{
/etc/init.d/apache2 restart        #если ошибок нет, то апач уже будет слушать порт 8080
/etc/init.d/nginx start                        #а вот nginx наоборот, вешается на 80й
}}}
Однако.. при использовании такой схемы может возникнуть проблема: ведь на апач запрос поступает уже не с фактического хоста.. а с 127.0.0.1, и для некоторых веб-проектов (форумы, торрент-трекеры, учет ip/биллинг и т.п.) такая подмена IPшника не катит. Не вопрос.. ставим апачу мод rpaf, который и занимается восстановлением ip:
{{{
aptitude install libapache2-mod-rpaf
}}}
кстати.. для debian etch его вроде не существует официально.. но нет ничего невозможного:
{{{
echo “deb http://gq.net.ru/debian etch main xneur kdebase backports” &gt;&gt; /etc/apt/sources.list
aptitude update
aptitude install libapache2-mod-rpaf
}}}
не забудьте подключить мод к апачу:
{{{
ln –s /etc/apache2/mods-available/rpaf.conf /etc/apache2/mods-enabled/rpaf.conf
ln –s /etc/apache2/mods-available/rpaf.load /etc/apache2/mods-enabled/rpaf.load
/etc/init.d/apache2 restart
}}}
ну вот… первую часть марлезонского балета станцевали.

!См. также
*[[Установка и настройка Nginx. Nginx frontend + Apache backend. Установка mod_rpaf]]

!Ссылки
*[[Оригинал статьи|http://ubuntu200807.blog.tut.by/index/2008/razgonyaem-veb-server.html]]


</pre>
</div>
<div title="Резервное копирование с помощью rsync" modifier="Яковлев Иван" created="200906202200" modified="200906202203" tags="[[Администрирование сервера]] [[TODO - нужен перевод статьи]] TODO" changecount="2">
<pre>!Описание
TODO

!Ссылки
*[[Оригинал статьи|http://articles.slicehost.com/2007/10/9/backing-up-your-files-with-rsync]]
*http://articles.slicehost.com/2007/10/10/rsync-exclude-files-and-folders -- дополнительно

</pre>
</div>
<div title="Рекомендации по созданию больших web-проектов" modifier="Яковлев Иван" created="200906191728" modified="200906191834" tags="[[Установка/настройка Web-сервера]] [[Народные советы]]" changecount="19">
<pre>*''Описание''
*''Большие скорости''
*''Создание модулей''
*''Использование конвейеров''
*''Базы данных''
*''Большие объемы''
*''Объектно-ориентированное программирование''
*''Шаблонирование''
*''Заключение''

!Описание
У любого успешного web-проекта рано или поздно возникает проблема роста. Существующие программно-аппаратные ресурсы перестают справляться с растущей нагрузкой. Универсальных рецептов, к сожалению не существует. В каждом проекте хороший программист будет программировать по-разному.

Тем не менее, в этой статье я попробую дать несколько типичных рекомендаций по созданию больших web-проектов. Такие проекты в процессе создания и развития сталкиваются, как правило, с двумя почти противоположными по способам решения проблемами -- большими скоростями и большими объемами данных.

!Большие скорости
В качестве идеального примера сайта, для которого жизненно важна скорость, можно взять баннерную сеть. Итак, несколько приемов для ускорения работы баннерных сетей и других серверов, критичных к скорости работы.

!Создание модулей
Смысл этого приема - вкомпилировать наиболее важные функции в сервер. Идея очень проста. Если мы посмотрим на соотношение времени, которое тратится на различные стадии выполнения запроса, то увидим интересную картину. Например, при выполнении простейшего perl-скрипта последовательно происходит следующее:
#сервер Apache определяет perl-скрипт для запуска, подготавливает и запускает его;
#запуск скрипта фактически начинается с запуска perl-интерпретатора (это файл, размером около полумегабайта). Perl-интерпретатор, запустившись, размещается на 2-х мегабайтах в памяти машины, и только после этого приступает к работе с пользовательским скриптом;
#эта работа начинается с компиляции программы. Компиляция программы -- это, как правило, один из самых длительных этапов обработки программы;
#только после предварительной компиляции (в байткод) скрипт начнет выполняться.

Статистика удручает: время, которое тратится на запуск perl-интерпретатора и компиляцию скрипта, как правило, на порядок больше времени, за которое он выполняется. 

На каждом сайте существуют узкие места - программы, которые вызываются очень часто. Например, баннерный движок. Как правило, на один просмотр страницы приходится два-три баннера, а значит и вызова программы. Понятно, что если избавиться от накладных расходов (пункты 2 и 3), работа сервера значительно ускорится. Это можно сделать двумя похожими способами.

Первый - написать модуль к Apache и вкомпилировать его в сервер. Именно так в баннерной сети Фламинго-2 (http://www.f2.ru), в создании которой я принимал участие, была реализована часть системы, которая раздавала баннеры пользователям. Это был модуль, написанный на языке C, который функционировал как часть сервера Apache и поэтому работал очень быстро.

Второй способ - использовать технологии предкомпиляции программ. Таких технологий достаточно много. Например, для perl-скриптов это могут быть ~FastCGI и mod_perl. Расскажу подробней о mod_perl. Это вкомпилированный (опять же в виде модуля) в Apache perl-компилятор. Во-первых, даже для простых скриптов (при надлежащей настройке) это исключает вторую стадию выполнения. Но кроме этого mod_perl дает возможность писать хэндлеры - обработчики определенных стадий выполнения запроса. Это очень мощная технология, поэтому рассмотрим ее подробнее.

Можно, например, написать хэндлер, который будет вызываться при запросе определенного URL. Делается это так. В файл httpd.conf вы прописываете следующие строки:
{{{
&lt;Perl&gt;
       unshift(@INC, 'Путь к Вашему модулю');
       @PerlModule = qw(MyHandler);
       %Location = (
           '/myhandler' =&gt; {
               'PerlHandler' =&gt; 'MyHandler::view',
               'SetHandler' =&gt; 'perl-script',
               'PerlSendHeader' =&gt; 'on'
           },
       );
&lt;/Perl&gt;
}}}
Тем самым вы указываете Apache и модулю mod_perl, что если пользователь запросит URL {{{/myhandler}}}, то для его обработки должен запуститься модуль ~MyHandler, а в нем процедура view. После изменения {{{httpd.conf}}} надо перезагрузить Apache. Кстати, все указанные в конфигурационном модуле файлы будут компилироваться при загрузке сервера, а не при первом запросе. Это в несколько раз увеличит скорость работы сервера.

Модуль ~MyHandler.pm может выглядеть, например, так:
{{{
       package MyHandler;
       use strict;
       # Процедура view
       sub view {
           print &quot;&lt;HTML&gt;\n&lt;BODY&gt;\nУра! Это отработал наш хэндлер!&lt;/BODY&gt;\n&lt;/HTML&gt;\n&quot;;
       }
       1;
}}}
Механизм хэндлеров обладает мощными возможностями. Фактически вы можете заменить любую стадию обработки запросов. Рассмотрим для примера создание собственного механизма проверки пароля:
{{{
       package MyAuthorization;
       use strict;
       # Обработчик, запрашивающий пароль
       sub handler {
           my $r = shift;
           return AUTH_REQUIRED unless $r;
           my (undef, $password) = $r-&gt;get_basic_auth_pw;
           my ($login) = $r-&gt;connection-&gt;user;
           return AUTH_REQUIRED unless $password;
           # Проверяем, все ли в порядке
           # Проверка может быть любой
           # Можно свериться с базой данных, а мы будем считать, что пароль должен быть
           # равен логину, прочитанному задом наперед.
           my $rev_login = reverse($login);
           # Проверка пароля
           if ($rev_login ne $passwd_sent)
           {
               return AUTH_REQUIRED;
           } else {
               return OK;
           }
        };
        1;
}}}
В файле настроек сервера httpd.conf необходимо указать, что авторизовать пользователя мы будем сами:
{{{
       %Location = (
           '/myhandler' =&gt; {
               'PerlHandler' =&gt; 'MyHandler::view',
               'SetHandler' =&gt; 'perl-script',
               'PerlSendHeader' =&gt; 'on',
               'require' =&gt; 'valid-user',
               'Limit' =&gt; {
                   'METHODS' =&gt; 'GET POST'
               },
               'AuthType' =&gt; 'Basic',
               'AuthName' =&gt; 'PersonaUser',
               'PerlAuthenHandler' =&gt; 'MyAuthorization -&gt;handler()'
           },
       );
}}}
Теперь доступ к {{{/myhandler}}} защищен - браузер выведет пользователю стандартное окно для ввода пароля.
Более подробно с технологией mod_perl можно познакомиться на сайте http://perl.apache.org/

!Использование конвейеров
Старайтесь не производить обработку данных в интерактивных скриптах. Записывайте их в лог-файлы, а затем агрегируйте и обрабатывайте уже отдельным процессом. Например, ответ пользователя в интерактивном голосовании может вызывать у вас изменения в десятке различных параметров статистики (распределение ответов, активность пользователей, общее число проголосовавших и так далее). Не проводите их сразу. Вместо этого разбейте процедуру на две части. Первая - непосредственно голосование, запись результата и вывод ответной страницы пользователю. Вторая - обработка голосования, изменение статистики и т.д.

Вообще надо стараться минимизировать количество интерактивных операций. В идеальном случае скрипт для учета голосования вообще ничего не делает, кроме записи информации в лог-файл. А для обработки данных из лог-файла можно запускать отдельный процесс-демон.

Для примера рассмотрим механизм обработки статистики в баннерной сети Фламинго-2. В ней был реализован 4-х ступенчатый конвейер:
#Информация о каждом запросе записывалась в полный лог. Это была очень подробная информация и записывалась она без всякого сжатия, на которое потратилось бы много времени. Размер этого лога очень велик - одна запись в нем занимала 250 байт. Данные в этом логе не хранились дольше нескольких часов.
#С периодичностью раз в 10 минут запускалась программа, которая обрабатывала полный лог и в компактном виде писала информацию в таблицы базы данных. На этой же стадии учитывались показы, изменялись временные таблицы, используемые для выдачи баннеров пользователю и для работы следующих стадий.
#Часовой демон, который строил почасовую статистику, производил сложные географические расчеты и многое другое, запускался в конвейере один раз в час. Он уже не имел доступа к полному логу и использовал информацию исключительно из второй стадии.
#В задачи последней стадии входила дневная ротация файлов, статистика, подведение балансов и рассылка почтовых предупреждений. Эта стадия работала каждые сутки поздно ночью, когда нагрузка на сервер была минимальной.

Как видите, механизм достаточно сложный, и наладить его корректную работу было нелегко. Чем больше стадий, тем больше проблем при их сопряжении друг с другом. Тем не менее, такая система позволяла достаточно эффективно распределять нагрузку и шустро работала на простом ~IDE-диске (расчетная пропускная способность была около 2-3 миллионов обращений в день при пиковой нагрузке 200 обращений в секунду). При этом система вела большое количество статистики.

Итак, резюмируем: для увеличения скорости работы программ, взаимодействующих с пользователем, разбиваем их работу на части, причем интерактивная часть должна содержать минимум расче тов и операций записи. Все необходимые расчеты можно произвести позднее, в более благоприятное с точки зрения нагрузки время и более эффективно.

!Базы данных
Используйте хорошую базу данных. Какую выбрать? Единого рецепта нет. Все зависит от решаемой задачи. Если она достаточно простая и вам не требуется выполнять сложные ~SQL-запросы (например, вложенные), то наилучшим решением будет, пожалуй, база данных ~MySQL.

~MySQL - один из самых простых серверов БД. Но даже в этой простой базе есть свои способы оптимизации для ускорения запросов. Например, не секрет, что {{{INSERT}}} -- одна из самых длительных операций (вычисление физического адреса для вставки, вставка, решение проблемы фрагментации, изменение индексов и служебных таблиц). Хороший прием для ускорения работы скрипта, который вставляет данные в БД - замена операции {{{INSERT}}} операцией {{{INSERT DELAYED}}} (отложенная вставка). Обновление данных будет выполнено только тогда, когда это не приведет к замедлению работы сервера.
   
Другой пример: если внимательно почитать документацию ~MySQL, можно найти упоминание о таблицах, расположенных в памяти (HEAP tables). Очевидно, что операции с такими таблицами совершаются значительно быстрее. Heap-таблицы можно использовать для решения некоторых задач. Существует большое количество параметров запуска сервера БД, оптимизирующих буферы сортировки, вычислений, количество детей и другие параметры. Как правило, вам заранее известно, что вы будете делать с базой, и для повышения быстродействия можно задать соответствующие параметры. 
   
Например, возьмем вполне реальную задачу:
построение какого-нибудь каталога. Ясно, что это будет одна большая таблица с большим количеством индексов. Вы знаете, что будете использовать представления. Работа с этой таблицей будет заключаться в запросах по индексу без использования сортировки. Посмотрим, как можно настроить сервер БД на выполнение такой задачи (пример из ~MySQL 3.23.25):
*join_buffer_size - буфер для создания представлений, по умолчанию равен 131072 байта;
*key_buffer_size - буфер для работы с ключами и индексами. Размер по умолчанию - 1048540;
*sort_buffer - буфер для сортировки. По умолчанию - 2097116 байт.

Скорее всего, при увеличении какого-то буфера, скорость выполнения связанной с ним задачи увеличится. Исходя из нашей задачи, мы увеличим буфер для работы с ключами (скорость выборки значений из таблицы увеличится), уменьшим буфер сортировки (уменьшится скорость сортировки) и буфер представлений (уменьшится скорость работы с представлениями).

Строка запуска демона ~MySQL будет выглядеть примерно так (конкретные значения зависят от количества памяти в системе):
{{{
       shell&gt;safe_mysqld -O key_buffer=8M -O sort_buffer=1M -O join_buffer=16K
}}}
Резюмируем. При использовании базы данных работу скрипта можно значительно ускорить правильной настройкой сервера БД. В руководстве базы данных ~MySQL есть специальный раздел, посвященный оптимизации. За более подробной информацией можно обратиться на сайты:
*Разработчики ~MySQL - http://www.mysql.com
*Разработчики ~PostgreSQL - http://www.PostgreSQL.org/
*Оптимизация ~MySQL - http://www.mysql.cz/information/presentations/presentation-oscon2000-20000719/index.html и http://support.ultrahost.ru/mysql_opt.php

!Большие объемы
Еще одна проблема больших сайтов - большой объем информации. Если не применять никаких ухищрений, то поддержка простого html-сайта в какой-то момент потребует слишком много времени.

!Объектно-ориентированное программирование
О пользе объектно-ориентированного подхода я уже рассказывал. Повторю вкратце. Каждый, кто хоть раз пробовал создавать динамические сайты, знает, что во многом это - очень однообразная задача. Гостевая книга, конференция, форма для отправления комментариев, подписка, регистрация. Как правило, эти скрипты слабо интегрированы и, в лучшем случае, используют общую библиотеку с константами и общими процедурами.

Однако если перечислить сущности, с которыми имеют дело вышеперечисленные скрипты, мы получим очень интересные результаты:

*Сущность &quot;пользователь&quot;. Имеет свое имя, фамилию, ник, пароль, электронный адрес... Используется практически во всех скриптах в разных ипостасях.

*Сущность &quot;сообщение&quot;. Вы можете возразить, что сообщения везде разные. Ничего подобного! Различаются формы представления сообщений, а данные, структура полей и методы обработки -- одни. Автор, заголовок, тело -- и так во всех проектах.

Вот фактически и все сущности, с которыми оперирует большинство скриптов на сайте. Гостевая книга (она, кстати, сама может быть объектом в более сложных проектах) представляет собой цепочку объектов класса &quot;сообщение&quot;. Форум или конференция - те же сообщения, организованные иерархически. Отправка письма владельцу сайта -- сообщение. Рассылка анонсов - перебор объектов класса &quot;пользователь&quot; и отправка каждому объекта класса &quot;сообщение&quot;.

Было бы эффективно описать все эти объекты в одном месте, а потом строить из них, как из кирпичиков, программы и скрипты, просто вставляя вызовы объектов в код. К тому же, единое пространство сообщений, пользователей и других объектов значительно  расширяет поле для творчества.

В этом и есть сущность объектного подхода. Вы создаете множество объектов - кирпичиков будущих программ - и из них строите свои сайты. Кроме того, вы можете использовать такие мощные методы ООП как наследование и полиформизм, без которых уже немыслимо построение крупных проектов.

!Шаблонирование
Вернемся к системе Фламинго. Как был организован интерфейс этой баннерной сети? 400 видов статистики соответствуют 400 страницам? Нет. Один скрипт-шаблонизатор, которому передаются параметры - номер статистики и другие данные: даты, ограничения и т.д.

По уникальному номеру статистики скрипт считывал описание, которое состояло из имени файла с псевдо-html и имен файлов с ~SQL-запросами. Файл с описанием выглядел так:
{{{
2:data/html/2.htx,data/queries/info.sql
9:data/html/9.htx,data/queries/ban-list-one.sql,data/queries/get-banners-list.sql
12:data/html/12.htx,data/queries/ban-getinfo.sql
38:data/html/38.htx,data/queries/acc-hosts-hits.sql
44:data/html/44.htx,data/queries/acc-getsites-today.sql
}}}
Общая схема очень проста - выполнить все ~SQL-запросы и вставить результаты в псевдо-html, получив таким образом полноценную страничку, и выдать ее пользователю. Например, для вывода статистики с номером 2 (информация об аккаунте), требовалось выполнить ~SQL-запрос {{{data/queries/info.sql}}}, результаты вставить в {{{data/html/2.htx}}}. Результат вывести на экран.

А вот как обстояло дело подробнее. Первая задача - формирование ~SQL-запроса. В него нужно вставить идентификатор пользователя и другие параметры, которые переданы скрипту. Типичный пример ~SQL-запроса (data/queries/info.sql):
{{{
select AccountName, OwnerName, OwnerEmail, MainSite, SiteName
    from Accounts where AccountId = &lt;--AccountId--&gt;
}}}
При разборе такого запроса значение параметра вставлялось на место строки {{{&lt;--ИмяПараметра--&gt;}}}. Существовали и специальные параметры, например - {{{&lt;--UserName--&gt;}}} - имя пользователя и {{{&lt;--AccountId--&gt;}}} - вычисленный по имени идентификатор аккаунта.

Результат выполнения полученного запроса заносился в html следующим образом. Каждое полученное из базы данных значение получало &quot;имя&quot;, с помощью которого обозначалось его местоположение в html-шаблоне. Имя было составным. Первая часть - порядковый номер ~SQL-запроса, вторая часть - индекс значения в массиве результатов.

Допустим, выполнялся ~SQL-запрос с порядковым номером 1 (для примера рассмотрим запрос data/queries/info.sql). Запрос возвращал массив значений. Соответственно, значение {{{AccountName}}}, возвращенное базой данных, имело порядковый номер 0 в этом массиве. В html-шаблоне место, куда необходимо было вставить {{{AccountName}}} обозначалось как {{{&lt;--1.1--&gt;}}}. Кусочек ~HTML-шаблона data/html/2.htx из нашего примера:
{{{
   &lt;TABLE BORDER=0 WIDTH=460&gt;
   &lt;TR&gt;
   &lt;TD WIDTH=&quot;50%&quot;&gt;
   &lt;FONT SIZE=&quot;-1&quot;&gt;
   Имя, фамилия ответственного:
   &lt;/FONT&gt;
   &lt;/TD&gt;&lt;TD&gt;
   &lt;INPUT type=&quot;text&quot; name=&quot;OwnerName&quot; size=33 value=&quot;&lt;--1.1--&gt;&quot;&gt;
   &lt;/TD&gt;
   &lt;/TR&gt;
   &lt;TR&gt;
   &lt;TD&gt;
   &lt;FONT SIZE=&quot;-1&quot;&gt;
   Электронный адрес:
   &lt;/TD&gt;&lt;TD&gt;
   &lt;INPUT type=&quot;text&quot; name=&quot;OwnerEmail&quot; size=33 value=&quot;&lt;--1.2--&gt;&quot;&gt;
   &lt;/TD&gt;
   &lt;/TR&gt;
}}}
Несмотря на кажущуюся сложность схемы, она имеет ряд преимуществ. С ее помощью мы смогли за короткое время построить систему с более чем 400 видами различных статистик. Впоследствии для добавления новой статистики надо было только написать ~SQL-запросы, нарисовать ~HTML-шаблон и изменить конфигурацию скрипта-шаблонизатора. Новая страница статистики появлялась в системе автоматически. 

!Заключение
Я хотел бы еще раз повторить: нет решений на все случаи жизни. Каждый раз, в каждом проекте вам придется придумывать собственные методы оптимизации быстродействия и удобства работы. Я надеюсь, что приемы, о которых я рассказал, пригодятся вам. Если у вас возникнут какие-нибудь вопросы или уточнения, я готов обсудить их с вами - vbob@aha.ru

!Ссылки
*[[Оригинал статьи|http://www.opennet.ru/base/dev/big_web_project.txt.html]]


</pre>
</div>
<div title="Рекомендуемые права доступа к важным системным файлам/каталогам" modifier="Яковлев Иван" created="200906211406" modified="200906211634" tags="Важное Безопасность [[TODO - нужен перевод статьи]]" changecount="28">
<pre>|!Файл/Каталог|!Права:|!Владелец|!Группа|!Остальные|!Описание|
|{{{/var/log}}}| ''751'' | ''{{{rwx}}}'' | ''{{{r-x}}}'' | ''{{{--x}}}'' |Каталог для системных логов|
|{{{/var/log/messages}}}| ''644'' | ''{{{rw-}}}'' | ''{{{r--}}}'' | ''{{{r--}}}'' |Системные сообщения|
|{{{/etc/crontab}}}| ''600'' | ''{{{rw-}}}'' | ''{{{---}}}'' | ''{{{---}}}'' |Файл планировщика заданий|
|{{{/etc/syslog.conf}}}| ''640'' | ''{{{rw-}}}'' | ''{{{r--}}}'' | ''{{{---}}}'' |Конфигурационный файл демона Syslog daemon|
|{{{/etc/logrotate.conf}}}| ''640'' | ''{{{rw-}}}'' | ''{{{r--}}}'' | ''{{{---}}}'' |Конфигурационный файл с настройками ротации системных логов|
|{{{/var/log/wtmp}}}| ''660'' | ''{{{rw-}}}'' | ''{{{rw-}}}'' | ''{{{---}}}'' |Хранит сведения кто сейчас залогинен в системе. Используется командой ''who''|
|{{{/var/log/lastlog}}}| ''640'' | ''{{{rw-}}}'' | ''{{{r--}}}'' | ''{{{---}}}'' |Содержит список пользователей, зарегистрировавшихся в системе последними. Используется командой ''last''|
|{{{/etc/ftpusers}}}| ''600'' | ''{{{rw-}}}'' | ''{{{---}}}'' | ''{{{---}}}'' |Список пользователей, которым запрещено пользоваться FTP службой|
|{{{/etc/passwd}}}| ''644'' | ''{{{rw-}}}'' | ''{{{r--}}}'' | ''{{{r--}}}'' |Список пользователей системы|
|{{{/etc/shadow}}}| ''600'' | ''{{{rw-}}}'' | ''{{{---}}}'' | ''{{{---}}}'' |Список зашифрованных паролей пользователей системы|
|{{{/etc/pam.d}}}| ''750'' | ''{{{rwx}}}'' | ''{{{r-x}}}'' | ''{{{---}}}'' |Конфигурационный файл [[PAM|http://www.opennet.ru/man.shtml?topic=PAM&amp;russian=0&amp;category=&amp;submit=%F0%CF%CB%C1%DA%C1%D4%D8+man]] (Pluggable Authentication Modules for Linux)|
|{{{/etc/hosts.allow}}}| ''600'' | ''{{{rw-}}}'' | ''{{{---}}}'' | ''{{{---}}}'' |Файл контроля доступа -- содержит список хостов, которым разрешен доступ в данную систему|
|{{{/etc/hosts.deny}}}| ''600'' | ''{{{rw-}}}'' | ''{{{---}}}'' | ''{{{---}}}'' |Файл контроля доступа -- содержит список хостов, которым запрещен доступ в данную систему|
|{{{/etc/lilo.conf}}}| ''600'' | ''{{{rw-}}}'' | ''{{{---}}}'' | ''{{{---}}}'' |Конфигурационный файл загрузчика операционной системы|
|{{{/etc/securetty}}}| ''600'' | ''{{{rw-}}}'' | ''{{{---}}}'' | ''{{{---}}}'' |TTY интерфейс, который позволяет входить root'y|
|{{{/etc/shutdown.allow}}}| ''400'' | ''{{{r--}}}'' | ''{{{---}}}'' | ''{{{---}}}'' |Пользователи допущенные к операции выключения системы &quot;''Ctr+Alt+Del''&quot;|
|{{{etc/security}}}| ''700'' | ''{{{rwx}}}'' | ''{{{---}}}'' | ''{{{---}}}'' |System access security policy files|
|{{{/etc/rc.d/init.d}}}| ''750'' | ''{{{rwx}}}'' | ''{{{r-x}}}'' | ''{{{---}}}'' |Program start-up files on Red Hat systems|
|{{{/etc/init.d}}}| ''750'' | ''{{{rwx}}}'' | ''{{{r-x}}}'' | ''{{{---}}}'' |Program start-up files on Debian/Ubuntu systems|
|{{{/etc/sysconfig}}}| ''751'' | ''{{{rwx}}}'' | ''{{{r-x}}}'' | ''{{{--x}}}'' |Содержит конфигурационный файлы для настройки системы и сети в Red Hat|
|{{{/etc/inet.conf}}}| ''600'' | ''{{{rw-}}}'' | ''{{{---}}}'' | ''{{{---}}}'' |Internet ~SuperServer configuration file|
|{{{/etc/cron.allow}}}| ''400'' | ''{{{r--}}}'' | ''{{{---}}}'' | ''{{{---}}}'' |Список пользователей, которым разрешено использовать планировщик cron|
|{{{/etc/cron.deny}}}| ''400'' | ''{{{r--}}}'' | ''{{{---}}}'' | ''{{{---}}}'' |Список пользователей, которым запрещено использовать планировщик cron|
|{{{/etc/ssh}}}| ''750'' | ''{{{rwx}}}'' | ''{{{r-x}}}'' | ''{{{---}}}'' |Содержит Конфигурационные файлы для настройки SSH (Secure Shell)|
|{{{/etc/sysctl.conf}}}| ''400'' | ''{{{r--}}}'' | ''{{{---}}}'' | ''{{{---}}}'' |Contains kernel tunable options on recent Red Hat|


</pre>
</div>
<div title="Репозитарии и обновление в Ubuntu" modifier="Яковлев Иван" created="200906032231" modified="200906040913" tags="[[Настройка Ubuntu]]" changecount="10">
<pre>*[[Графическая настройка|Список используемых репозитариев - источники приложений]]
*[[Ручная настройка|Список используемых репозитариев - ручной метод]]
*[[Обновление системы]]
*[[Обновление вручную|Ручное обновление системы]]
*[[Репозитарий Medibuntu|Настройка репозитария Medibuntu]]</pre>
</div>
<div title="Ручное обновление системы" modifier="Яковлев Иван" created="200906032307" modified="200906040915" tags="[[Репозитарии и обновление в Ubuntu]]" changecount="7">
<pre>Все то, что я описал выше можно сделать вручную в консоли. Я надеюсь уже стало понятно, что каждый раз перед тем как сделать обновление системы, нужно обновить кэш, базу знания о том, что находится в репозиториях. Делается это командой:
{{{
sudo apt-get update
}}}
Аналогом обновления через графический менеджер обновлений в консоли являются две команды:
{{{
sudo apt-get upgrade
}}}
обновление без проверки устаревших зависимостей
и
{{{
sudo apt-get dist-upgrade
}}}
интеллектуальное обновление (более предпочтительно)
{{note{
@@color: red;font-weight: bold;ВНИМАНИЕ:@@
Обязательно перед обновлением программ необходимо обновить кеш локальной базы данных репозитариев, т.е. выполнить команду:
{{{
sudo apt-get update
}}}
}}}

Вывод обеих команд одинаковые, рассмотрим любую из них, например sudo apt-get update:

{{textAlignCenter{
[img[images/articles/manual-update-attention.png]]
}}}
Прежде чем продолжить, программа рассчитывает размер архивов, которые необходимо скачать. Если интернет позволяет - пишите ''y'' английское (или ''Д'') и жмите ввод.

{{textAlignCenter{
[img[images/articles/manual-update-installing.png]]
}}}
Процесс пошел. Вам решать какой способ вам лучше.

!См. далее
*[[Настройка репозитария Medibuntu]]


</pre>
</div>
<div title="Сервисы" modifier="Яковлев Иван" created="200906091650" modified="200906191421" tags="MainMenu slider" changecount="2">
<pre>#[[Ubuntu/Linux|Запуск/Остановка сервисов в Ubuntu]]
#[[Windows|Запуск/Остановка сервисов в Windows]]</pre>
</div>
<div title="Сертификаты безопасности" modifier="Яковлев Иван" created="200906042321" modified="200906191238" tags="[[SSL и сертификаты]] [[TODO - нужен перевод статьи]]" changecount="10">
<pre>!Описание
One of the most common forms of cryptography today is public-key cryptography. Public-key cryptography utilizes a public key and a private key. The system works by encrypting information using the public key. The information can then only be decrypted using the private key. 

A common use for public-key cryptography is encrypting application traffic using a Secure Socket Layer (SSL) or Transport Layer Security (TLS) connection. For example, configuring Apache to provide HTTPS, the HTTP protocol over SSL. This allows a way to encrypt traffic using a protocol that does not itself provide encryption. 

A Certificate is a method used to distribute a public key and other information about a server and the organization who is responsible for it. Certificates can be digitally signed by a Certification Authority or CA. A CA is a trusted third party that has confirmed that the information contained in the certificate is accurate.

!Типы сертификатов
To set up a secure server using public-key cryptography, in most cases, you send your certificate request (including your public key), proof of your company's identity, and payment to a CA. The CA verifies the certificate request and your identity, and then sends back a certificate for your secure server. Alternatively, you can create your own self-signed certificate.  	
{{note{
''ЗАМЕЧАНИЕ:''
Note, that self-signed certificates should not be used in most production environments. 
}}}
Continuing the HTTPS example, a ~CA-signed certificate provides two important capabilities that a self-signed certificate does not: 
*Browsers (usually) automatically recognize the certificate and allow a secure connection to be made without prompting the user. 
*When a CA issues a signed certificate, it is guaranteeing the identity of the organization that is providing the web pages to the browser. 

Most Web browsers, and computers, that support SSL have a list of ~CAs whose certificates they automatically accept. If a browser encounters a certificate whose authorizing CA is not in the list, the browser asks the user to either accept or decline the connection. Also, other applications may generate an error message when using a self-singed certificate. 

The process of getting a certificate from a CA is fairly easy. A quick overview is as follows: 
#Create a private and public encryption key pair.
#Create a certificate request based on the public key. The certificate request contains information about your server and the company hosting it.
#Send the certificate request, along with documents proving your identity, to a CA. We cannot tell you which certificate authority to choose. Your decision may be based on your past experiences, or on the experiences of your friends or colleagues, or purely on monetary factors. Once you have decided upon a CA, you need to follow the instructions they provide on how to obtain a certificate from them.
#When the CA is satisfied that you are indeed who you claim to be, they send you a digital certificate.
#Install this certificate on your secure server, and configure the appropriate applications to use the certificate.

!Generating a Certificate Signing Request (CSR)
Whether you are getting a certificate from a CA or generating your own self-signed certificate, the first step is to generate a key. 

If the certificate will be used by service daemons, such as Apache, Postfix, Dovecot, etc, a key without a passphrase is often appropriate. Not having a passphrase allows the services to start without manual intervention, usually the preferred way to start a daemon. 

This section will cover generating a key with a passphrase, and one without. The non-passphrase key will then be used to generate a certificate that can be used with various service daemons.  	
{{note{
@@font-weight: bold;color: red;ВНИМАНИЕ:@@
Running your secure service without a passphrase is convenient because you will not need to enter the passphrase every time you start your secure service. But it is insecure and a compromise of the key means a compromise of the server as well. 
}}}
To generate the keys for the Certificate Signing Request (CSR) run the following command from a terminal prompt: 
{{{
openssl genrsa -des3 -out server.key 1024
Generating RSA private key, 1024 bit long modulus
.....................++++++
.................++++++
unable to write 'random state'
e is 65537 (0x10001)
Enter pass phrase for server.key:
}}}
You can now enter your passphrase. For best security, it should at least contain eight characters. The minimum length when specifying {{{-des3}}} is four characters. It should include numbers and/or punctuation and not be a word in a dictionary. Also remember that your passphrase is case-sensitive. 

Re-type the passphrase to verify. Once you have re-typed it correctly, the server key is generated and stored in the server.key file. 

Now create the insecure key, the one without a passphrase, and shuffle the key names: 
{{{
openssl rsa -in server.key -out server.key.insecure
mv server.key server.key.secure
mv server.key.insecure server.key
}}}
The insecure key is now named server.key, and you can use this file to generate the CSR without passphrase. 

To create the CSR, run the following command at a terminal prompt: 
{{{
openssl req -new -key server.key -out server.csr
}}}
It will prompt you enter the passphrase. If you enter the correct passphrase, it will prompt you to enter Company Name, Once you enter all these details, your CSR will be created and it will be stored in the server.csr file. Site Name, Email Id, etc. 

You can now submit this CSR file to a CA for processing. The CA will use this CSR file and issue the certificate. On the other hand, you can create self-signed certificate using this CSR.

!Creating a ~Self-Signed Certificate
To create the self-signed certificate, run the following command at a terminal prompt: 
{{{
openssl x509 -req -days 365 -in server.csr -signkey server.key -out server.crt
}}}
The above command will prompt you to enter the passphrase. Once you enter the correct passphrase, your certificate will be created and it will be stored in the server.crt file.  	
{{note{
@@font-weight: bold;color: red;ВНИМАНИЕ:@@
If your secure server is to be used in a production environment, you probably need a ~CA-signed certificate. It is not recommended to use self-signed certificate. 
}}}
Installing the Certificate

You can install the key file server.key and certificate file server.crt, or the certificate file issued by your CA, by running following commands at a terminal prompt: 
{{{
sudo cp server.crt /etc/ssl/certs
sudo cp server.key /etc/ssl/private
}}}
Now simply configure any applications, with the ability to use public-key cryptography, to use the certificate and key files. For example, Apache can provide HTTPS, Dovecot can provide IMAPS and ~POP3S, etc.

!Certification Authority
If the services on your network require more than a few self-signed certificates it may be worth the additional effort to setup your own internal Certification Authority (CA). Using certificates signed by your own CA, allows the various services using the certificates to easily trust other services using certificates issued from the same CA. 

1. First, create the directories to hold the CA certificate and related files: 
{{{
sudo mkdir /etc/ssl/CA
sudo mkdir /etc/ssl/newcerts
}}}

2. The CA needs a few additional files to operate, one to keep track of the last serial number used by the CA, each certificate must have a unique serial number, and another file to record which certificates have been issued: 
{{{
sudo sh -c &quot;echo '01' &gt; /etc/ssl/CA/serial&quot;
sudo touch /etc/ssl/CA/index.txt
}}}

3. The third file is a CA configuration file. Though not strictly necessary, it is very convenient when issuing multiple certificates. Edit {{{/etc/ssl/openssl.cnf}}}, and in the {{{[ CA_default ]}}} change: 
{{{
dir             = /etc/ssl/             # Where everything is kept
database        = $dir/CA/index.txt     # database index file.
certificate     = $dir/certs/cacert.pem # The CA certificate
serial          = $dir/CA/serial        # The current serial number
private_key     = $dir/private/cakey.pem# The private key
}}}

4. Next, create the self-singed root certificate: 
{{{
openssl req -new -x509 -extensions v3_ca -keyout cakey.pem -out cacert.pem -days 3650
}}}
You will then be asked to enter the details about the certificate. 

5. Now install the root certificate and key: 
{{{
sudo mv cakey.pem /etc/ssl/private/
sudo mv cacert.pem /etc/ssl/certs/
}}}

6. You are now ready to start signing certificates. The first item needed is a Certificate Signing Request (CSR), see the section called “[[Generating a Certificate Signing Request (CSR)|https://help.ubuntu.com/9.04/serverguide/C/certificates-and-security.html#generating-a-csr]]” for details. Once you have a CSR, enter the following to generate a certificate signed by the CA: 
{{{
sudo openssl ca -in server.csr -config /etc/ssl/openssl.cnf
}}}
After entering the password for the CA key, you will be prompted to sign the certificate, and again to commit the new certificate. You should then see a somewhat large amount of output related to the certificate creation. 

7. There should now be a new file, {{{/etc/ssl/newcerts/01.pem}}}, containing the same output. Copy and paste everything between the {{{-----BEGIN CERTIFICATE-----}}} and {{{----END CERTIFICATE-----}}} lines to a file named after the hostname of the server where the certificate will be installed. For example mail.example.com.crt, is a nice descriptive name. 

Subsequent certificates will be named 02.pem, 03.pem, etc.  	
{{note{
''ЗАМЕЧАНИЕ:''
Replace mail.example.com.crt with your own descriptive name. 
}}}

8. Finally, copy the new certificate to the host that needs it, and configure the appropriate applications to use it. The default location to install certificates is {{{/etc/ssl/certs}}}. This enables multiple services to use the same certificate without overly complicated file permissions. 

For applications that can be configured to use a CA certificate, you should also copy the {{{/etc/ssl/certs/cacert.pem}}} file to the {{{/etc/ssl/certs/}}} directory on each server.

!См. также
*For more detailed instructions on using cryptography see the [[SSL Certificates HOWTO|http://tldp.org/HOWTO/SSL-Certificates-HOWTO/index.html]] by tlpd.org 
*[[The PKI Page|http://www.pki-page.org/]] contains a list of Certificate Authorities. 
*http://ru.wikipedia.org/wiki/HTTPS -- описание на Википедии
*For more information on ~OpenSSL see the [[OpenSSL|http://www.openssl.org/]] Home Page. 
*Also, [[O'Reilly's Network Security with OpenSSL|http://oreilly.com/catalog/9780596002701/]] is a good in depth reference.

!Ссылки
*[[Описание на ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/certificates-and-security.html]]
*[[Установка и настройка LAMP+SSL+SVN+Trac]]



</pre>
</div>
<div title="Сетевые префиксы (NetPreffix)" modifier="Яковлев Иван" created="200906031906" modified="200906031908" tags="Приложения" changecount="4">
<pre>{{{
                  +----------------------------------------------+

                  |addrs   bits   pref   class   mask            |

                  +----------------------------------------------+

                  |    1      0    /32           255.255.255.255 |

                  |    2      1    /31           255.255.255.254 |

                  |    4      2    /30           255.255.255.252 |

                  |    8      3    /29           255.255.255.248 |

                  |   16      4    /28           255.255.255.240 |

                  |   32      5    /27           255.255.255.224 |

                  |   64      6    /26           255.255.255.192 |

                  |  128      7    /25           255.255.255.128 |

                  |  256      8    /24      1C   255.255.255     |

                  |  512      9    /23      2C   255.255.254     |

                  |   1K     10    /22      4C   255.255.252     |

                  |   2K     11    /21      8C   255.255.248     |

                  |   4K     12    /20     16C   255.255.240     |

                  |   8K     13    /19     32C   255.255.224     |

                  |  16K     14    /18     64C   255.255.192     |

                  |  32K     15    /17    128C   255.255.128     |

                  |  64K     16    /16      1B   255.255         |

                  | 128K     17    /15      2B   255.254         |

                  | 256K     18    /14      4B   255.252         |

                  | 512K     19    /13      8B   255.248         |

                  |   1M     20    /12     16B   255.240         |

                  |   2M     21    /11     32B   255.224         |

                  |   4M     22    /10     64B   255.192         |

                  |   8M     23     /9    128B   255.128         |

                  |  16M     24     /8      1A   255             |

                  |  32M     25     /7      2A   254             |

                  |  64M     26     /6      4A   252             |

                  | 128M     27     /5      8A   248             |

                  | 256M     28     /4     16A   240             |

                  | 512M     29     /3     32A   224             |

                  |1024M     30     /2     64A   192             |

                  +----------------------------------------------+
}}}</pre>
</div>
<div title="Система багтрекинга Redmine" modifier="Яковлев Иван" created="200906271247" modified="200906271325" tags="[[Системы багтрекинга (Bugtracking)]] slider TODO" changecount="5">
<pre>''Установка''
*[[Установка Redmine в дом...|Установка Redmine в домашний каталог DebianUbuntu]]
''Настройка''
*[[TODO|TODO]]
*[[TODO|TODO]]
''Ссылки''
*[[Различные HowTo|http://www.redmine.org/wiki/redmine/HowTos]]</pre>
</div>
<div title="Система багтрекинга Trac" modifier="Яковлев Иван" created="200906271254" tags="[[Системы багтрекинга (Bugtracking)]] slider" changecount="1">
<pre>*[[Установка Trac]]</pre>
</div>
<div title="Системы багтрекинга (Bugtracking)" modifier="Яковлев Иван" created="200906271241" modified="200906271329" tags="[[Установка/настройка Web-сервера]] slider" changecount="4">
<pre>*&lt;&lt;slider &quot;chk-trac&quot; [[Система багтрекинга Trac]] &quot;Система багтрекинга Trac&quot; &quot;Показать/Скрыть раздел Система багтрекинга Trac&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-redmine&quot; [[Система багтрекинга Redmine]] &quot;Система багтрекинга Redmine&quot; &quot;Показать/Скрыть раздел Система багтрекинга Redmine&quot;&gt;&gt;
*[[Сравнение систем багтрекинга|http://romanvbabenko.blogspot.com/2008/05/redmine-trac-mantis.html]]</pre>
</div>
<div title="Скрытые возможности IPTables" modifier="Яковлев Иван" created="200906052327" tags="Безопасность Статьи TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/skrytye-vozmozhnosti-iptables.html#more-64]]



</pre>
</div>
<div title="Советы по MySQL" modifier="Яковлев Иван" created="200906041555" modified="200906041555" tags="[[Народные советы]]" changecount="3">
<pre>!Q
установил ~MySQL5, но не могу подключиться к нему с Windows-машины. Локально на Ubuntu (через шелл), подключается. 
!A
Наверно в {{{/etc/mysql/my.cnf}}} стоит закомментировать строчку {{{bind-address = 127.0.0.1}}}
Тогда мускул будет слушать не только локалхост. Ну и + к этому добавить пользователя для доступа с нужного ип адреса к БД.

</pre>
</div>
<div title="Советы по SSH" modifier="Яковлев Иван" created="200906041601" modified="200906041603" tags="[[Народные советы]]" changecount="3">
<pre>!Q
Какой лучший консольный SSH клиент для Windows.
!A
[[Putty|http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html]] -- он обеспечивает доступ к командной строке сервера. Второй предоставляемой им возможностью является туннелирование соединений.

!Q</pre>
</div>
<div title="Советы по Ubuntu" modifier="Яковлев Иван" created="200906191833" tags="[[Народные советы]]" changecount="1">
<pre>Здесь мог бы быть осмысленный текст на тему 'Советы по Ubuntu'</pre>
</div>
<div title="Создание SSL сертификатов для связки Apache и mod_ssl" modifier="Яковлев Иван" created="200906191224" modified="200906191303" tags="[[SSL и сертификаты]] [[Настройка Apache]]" changecount="9">
<pre>!Начало
Предполагается, что этот документ будет кратким пособием по генерации и установке SSL сертификатов на сервер Apache с установленным модулем mod_ssl. Хотя это не очень сложный процесс, он сопровождается запуском нескольких длинных команд с большим количеством ключей. Этого документа должно быть достаточно для того, чтобы вы могли сгенерировать и установить сертификаты для вашего сервера.

Этот документ не предназначен для обсуждения процессов компиляции и установки сервера Apache и модуля mod_ssl. Для подробных инструкций смотрите &quot;Сборка Apache с mod_ssl и другими модулями.&quot; - http://slacksite.com/apache/webserver.html  Так же этот документ не предназначен для подробного обсуждения конфигурирования SSL на серверах Apache. Будут представлены примеры конфигурации
простого виртуального хоста с использованием SSL, который должен работать в практически любой стандартной ситуации. 

Ralf Engelschall, автор модуля mod_ssl, поддерживает замечательную документацию на http://www.modssl.org. Для того чтобы более подробно узнать о конфигурировании SSL или особых случаях смотрите полную документацию на http://www.openssl.org/docs/. В дополнение дистрибутив содержит подробные страницы мануалов, которые доступны так же и в формате HTML на http://www.openssl.org/docs/.

!Короткий рассказ об SSL
Эта глава будет очень коротким введением в SSL, Secure Socket Layer. Криптография очень обширная тема, которая составляет буквально тома материалов. Последующий материал -- это очень упрощенный взгляд на то, как реализован SSL и какую роль сертификаты играют в рассматриваемом нами случае. В силу того, что информация намеренно упрощена, возможны небольшие неточности.

Обычный веб-траффик идет через Интернет незашифрованным. Таким образом, любой, кто имеет доступ к нужным инструментам, может
наблюдать за нужным ему трафиком. Очевидно, что это может привести к проблемам, особенно в тех случаях, когда необходимы безопасность и приватность, например при работе с кредитками или в банковских транзакциях. Протокол SSL используется для шифрования трафика между веб-сервером и веб-клиентом (браузером).

SSL использует асимметричную криптографию, обычно известную как криптография с открытым ключом. В криптографии с открытым ключом создаются два ключа, одни публичный -- другой секретный. Все зашифрованное с помощью одного ключа может быть  расшифровано только с помощью другого. То есть данные, которые были зашифрованы секретным ключом сервера могут быть дешифрованы только с помощью публичного ключа этого же сервера, давая уверенность что, данные пришли оттуда откуда надо.

Если SSL использует криптографию с открытым ключом, для того чтобы шифровать поток данных идущих через Интернет, зачем же тогда нужен сертификат? Технический ответ на этот вопрос, такой, что сертификат на самом деле не нужен -- данные зашифрованы и вряд ли могут быть дешифрованы третьей стороной. Однако сертификаты играют важную роль в коммуникационном процессе. 

Сертификат, подписанный доверенным СА (Certificate Authority), дает гарантию, что владелец сертификата -- тот за кого он себя выдает. Без подписанного сертификата ваши данные будут зашифрованы, однако, сервер, с которым вы контактируете может быть не тем о котором вы думаете. Без сертификатов такие нарушения могут быть часты.

!Генерация частного ключа и CSR
Программный пакет openssl может быть использован для генерации приватного RSA ключа и создания CSR. Он так же может быть использован для создания самоподписных сертификатов которые могут быть использованы для тестовых целей или внутреннего пользования. Программа, которая обычно используется для решения этих задач, известна как openssl. Она должна быть установлена в директории {{{/usr/local/ssl}}}. Может быть, вам придется добавить эту директорию в переменную PATH или же переместить эту программу в директорию, которая уже прописана в переменной PATH, для того чтобы не писать полный путь. Дальнейшие примеры полагают, что openssl доступен вам без необходимости писать полный путь.

В первую очередь надо создать ваш приватный ключ. Это будет 1024 битный ключ стандарта RSA зашифрованный с использованием алгоритма ''~TripleDES'' и хранящийся в формате ''PEM'', так что его можно будет читать как простой текст. Мы будем использовать несколько файлов для усиления случайности и для того чтобы сделать наш ключ более секретным. Текстовые файлы, которые были сжаты утилитой типа gzip -- станут хорошим выбором. Ключ генерируется следующей командой, где {{{file1:file2:etc}}} представляют собой случайные сжатые файлы.
{{{
sudo openssl genrsa -des3 -rand file1:file2:file3 -out server.key
}}}
Программа предложит вам ввести пароль и сохранит ключ в файле server.key. Очень важно не забыть пароль. Если ключ будет утерян или пароль будет забыт сертификат станет бесполезен. Невозможно выразить как важен приватный ключ для сертификата. Если приватный ключ или пароль скомпрометированы сертификат должен быть отменен. Как минимум это будет стоить вам денег заплаченных за сертификат. Было бы хорошей идеей сделать резервную копию на безопасном носителе, таком как кассета или дискета.

Один неприятный сторонний эффект ключа с паролем это то что Apache будет всякий раз спрашивать пароль при старте. Понятно что это не очень удобно если только кто-то не находится постоянно рядом на случай перезагрузки или аварийной остановки. mod_ssl включает в себя возможность использования внешней программы вместо встроенного парольного диалога. Возможно убрать пароль из ключа. Если приватный ключ более не зашифрован, важно чтобы файл его содержащий, был доступен на чтение только пользователю root. Если ваша система скомпрометирована и третья сторона получила ваш незашифрованный приватный ключ, производный сертификат должен быть отменен. После того что мы сказали, используйте следующую команду для того чтобы убрать
пароль из ключа.
{{{
$ openssl rsa -in server.key -out server.pem
}}}
После того как приватный ключ сгенерирован может быть сгенерирован запрос на подпись сертификатов({{{CSR ---}}}). CSR может быть использован двояко. В идеале CSR должен быть послан к CA такому как Tawte или ~VeriSign, которые проверят подлинность запрашивающего и выдадут подписанный сертификат. Другой путь - подписать CSR самостоятельно, что будет продемонстрировано в следующей главе.
{{note{
@@font-weight: bold;color: red;ВНИМАНИЕ:@@
Во время генерации CSR вас попросят ввести некоторое количество информации. Один из вопросов будет Common Name (eg, YOUR name) []:
Важно чтобы это поле содержало полностью квалифицированное имя домена вашего сервера. Если вебсайт имеет адрес {{{www.domain.com}}} -- то вы должны написать именно {{{www.domain.com}}}.
}}}
Команда для генерации CSR выглядит так.
{{{
sudo openssl req -new -key server.key -out server.csr
}}}
Пример сессии показан ниже.
{{{
sudo openssl req -new -key server.key -out server.csr

Using configuration from /usr/local/ssl/openssl.cnf
Enter PEM pass phrase:Enter pass phrase here
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:US
State or Province Name (full name) [Some-State]:New Hampshire
Locality Name (eg, city) []:Nashua
Organization Name (eg, company) [Internet Widgits Pty Ltd]:Domain.com, Inc.
Organizational Unit Name (eg, section) []:.
Common Name (eg, YOUR name) []:www.domain.com
Email Address []:webmaster@domain.com

Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []:
An optional company name []:
}}}

!Генерация самоподписанного сертификата
На этом этапе вам необходимо сгенерировать самоподписанный сертификат потому что вы или не планируете заводить сертификат подписанный CA, или хотите потестировать новую реализацию SSL пока CA подписывает ваш сертификат. Мой опыт общения с Tawte показывает, что получение сертификата занимает неделю и больше. Время которое занимает получение сертификата варьируется от того как быстро CA получит необходимые документы. Временный сертификат будет выдавать ошибку в клиентском броузере от того, что CA неизвестен и не проверен.

Для того чтобы сгенерировать сертификат годный в течение 60 дней введите следующую команду.
{{{
sudo openssl x509 -req -days 60 -in server.csr -signkey server.key -out server.crt
}}}

!Установка ключа и сертификата
Когда Apache и mod_ssl установлены - создаются несколько поддиректорий в конфигурационной директории Apache. Их расположение зависит от того, как компилировался Apache. Если использовать мои инструкции, компилируя Apache, конфигурационная директория будет {{{/usr/local/apache/etc}}} Директории, которые создает mod_ssl содержат в себе файлы {{{ssl.crt}}}, {{{ssl.csr}}}, и {{{ssl.key}}} Это хорошее место для хранения сертификатов, запросов на подпись и приватных ключей. Если у вас будет несколько хостов с SSL хорошей практикой стать включение в имена этих файлов имен защищаемых хостов.

Добавляя виртуальные хосты к веб-серверу, я обычно предпочитаю хранить их конфигурации в отдельном файле. Это дает уверенность, что все конфигурации могут быть быстро найдены, и, заодно, не позволяет основному конфигурационному файлу разрастаться. Если все виртуальные хосты сохранены в файле {{{ssl.conf}}}, то для того чтобы Apache нашел его и прочитал надо включить в основной конфиг следующюю строку:
{{{
Include /usr/local/apache/etc/ssl.conf
}}}

!Конфигурирование виртуального хоста, использующего SSL.
Обширные примеры конфигурации SSL для виртуальных хостов включены в файл {{{/usr/local/apache/etc/httpd.conf.default}}}, который устанавливается вместе с mod_ssl. Ознакомьтесь с документацией на mod_ssl для того чтобы получить более подробную информацию о возможностях конфигурации. Простой хост использующий SSL в конфигурационном файле может быть прописан так. SSL Virtual Hosts
{{{
&lt;IfDefine SSL&gt;

&lt;VirtualHost _default_:443&gt;
ServerAdmin webmaster@domain.com
DocumentRoot /usr/local/apache/share/htdocs
ServerName www.domain.com
ScriptAlias /cgi-bin/ /usr/local/apache/share/htdocs/cgi-bin/
SSLEngine on
SSLCertificateFile    /usr/local/apache/etc/ssl.crt/server.crt
SSLCertificateKeyFile /usr/local/apache/etc/ssl.key/server.pem
SetEnvIf User-Agent &quot;.*MSIE.*&quot; nokeepalive ssl-unclean-shutdown
CustomLog /usr/local/apache/var/log/ssl_request_log \
        &quot;%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \&quot;%r\&quot; %b&quot;
&lt;VirtualHost&gt;

&lt;IfDefine&gt;
}}}
Этот пример создаст виртуальный хост с именем. который доступен через порт 443 (стандартный порт для протокола https) сайты с IP адресом вашего сервера. Можно создать столько дополнительных виртуальных хостов для вашего сервера сколько IP адресов он обслуживает. Просто добавьте дополнительные конфигурационные блоки {{{&lt;virtualhost&gt;}}} между дерективами {{{&lt;IfDefine SSL&gt;}}} и {{{&lt;/IfDefine&gt;}}}. По архитектурным причинам протокол SSL не позволяет создавать name-based (HTTPS 1.1) виртуальные хосты. Для того чтобы создать новый виртуальный хост с поддержкой SSL на другом IP адресе просто замените _default_на новый IP.

Посте добавления виртуального хоста к конфигурационному файлу Apache должен быть остановлен и вновь запущен для того чтобы новый виртуальный хост заработал. К несчастью это один из тех случаев когда простая отправка сигнала HUP не сработает. После перезапуска в зависимости от того какой (шифрованный или нет ) ключ был использован Apache может спросить у вас пароль или пароли. Введите пароль, и всё заработает.

Теперь вы можете использовать ваш любимый броузер для просмотра содержимого только что созданного виртуального хоста защищённого SSL. Не забудьте использовать префикс {{{https://}}} вместо {{{http://}}}. Вы получите окно с предупреждением, если вы использовали самоподписанный сертификат. Подтвердите согласие и страница продолжит загружаться уже защищенная с помощью SSL . Статусная строка вашего броузера должна содержать иконку в виде замка которая показывает что страница защищена. 

Вот и всё.

!См. также
*[[Сертификаты безопасности]]
*[[Настройка ssl (https) в nginx]]

!Ссылки
*[[Оригинал статьи (англ.)|http://slacksite.com/apache/certificate.html]]
*[[Перевод оригинала статьи|http://www.opennet.ru/base/dev/apache_mod_ssl.txt.html]]

*[[SSL и виртуальный хостинг на одном IP|http://wiki.cacert.org/wiki/VhostTaskForce#head-7d37978fcbd8b2b2ebea2e467f83995c34b62142]]


</pre>
</div>
<div title="Создание групп томов" modifier="Яковлев Иван" created="200906122029" modified="200906122131" tags="LVM [[TODO - нужен перевод статьи]]" changecount="6">
<pre>You can create a VG from two or more ~PVs using a straightforward command: just substitute the name of your choice for ''volgroup1'':
{{{
sudo vgcreate volgroup1 /dev/sdc1 /dev/sdd1
}}}
Once a VG is available, it’s easy to add more room. In this example, I’ve created a PV on {{{/dev/sdb1}}} for this purpose and want to add more room to the VG named ''volgroup1''. To that end, I created a {{{/dev/sdb1}}} partition, configured with the Linux LVM partition type, and applied the {{{pvcreate}}} command to that partition. I then add that partition to the existing VG ''volgroup1'' as follows:
{{{
sudo vgextend volgroup1 /dev/sdb1
}}}
To take full advantage of logical volumes, you need to understand the commands used to configure a VG and are available in the {{{/sbin}}} directory; these are summarized in Table. As these commands require administrative privileges, they should generally be preceded with the {{{sudo}}} command.

|!VG Command|!Description|
|{{{vgcfgbackup}}}, {{{vgcfgrestore}}}|Backs up and restores the configuration files associated with LVM; default backups are from the {{{/etc/lvm}}} directory to {{{/etc/lvm/}}} backup.|
|{{{vgchange}}}|Allows you to activate or deactivate a VG. For example, the vgchange -a y command enables all local ~VGs. Similar to pvchange.|
|{{{Vgck}}}|Checks the metadata associated with a VG after an LV is created.|
|{{{vgconvert}}}|Supports conversions from ~LVM1 systems to ~LVM2: {{{vgconvert -M2 volgroup1}}} converts that VG.|
|{{{vgcreate}}}|Creates a VG from two or more configured ~PVs: for example, {{{vgcreate volgroup1 /dev/sdc1 /dev/sdd1}}} creates volgroup1.|
|{{{vgdisplay}}}|Displays characteristics of currently configured ~VGs.|
|{{{vgexport}}}, {{{vgimport}}}|Exports and imports unused ~VGs from those available for ~LVs; the {{{vgexport -a}}} command exports and inactivates all inactive ~VGs.|
|{{{vgextend}}}|Extends the size of a VG; {{{vgextend volgroup1 /dev/sdb1}}} adds the space from a PV on {{{/dev/sdb1}}} to ''volgroup1''.|
|{{{vgmerge}}}|Merges unused ~VGs: if you have an unused VG ''volgroup2'', for example, you can merge it into ''volgroup1'': {{{vgmerge volgroup1 volgroup2}}}.|
|{{{vgmknodes}}}|Checks problems with VG device files, and recreates the devices as needed.|
|{{{vgreduce}}}|Removes a PV; for example: {{{vgreduce volgroup1 /dev/sdb1}}} command removes the PV from ''volgroup1'' if free space is available.|
|{{{vgremove}}}|Removes a LV; for example: {{{vgremove volgroup1}}} command removes ''volgroup1'', assuming it is not used by any LV.|
|{{{vgrename}}}|Allows renaming of ~LVs; for example: {{{vgrename volgroup1 volgroup2}}}.|
|{{{Vgs}}}|Displays basic information on configured ~VGs.|
|{{{vgscan}}}|Scans and displays basic information on configured ~VGs.|
|{{{vgsplit}}}|Splits an existing volume group, based on specified ~PVs.|



!См. далее
*[[Создание логических томов]]



</pre>
</div>
<div title="Создание загрузочной флэшки с Ubuntu 8.04 Live или Server" modifier="Яковлев Иван" created="200906052340" tags="Статьи TODO Приложения" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/sozdanie-zagruzochnoj-fleshki-s-ubuntu-804-live-ili-server.html#more-100]]



</pre>
</div>
<div title="Создание и обслуживание нескольки доменов на одном выделенном сервере VPS" modifier="Яковлев Иван" created="200906200017" modified="200907021306" tags="[[Установка/настройка Web-сервера]] [[TODO - нужен перевод статьи]] slicehost [[Выделенный VPS сервер]]" changecount="4">
<pre>!Описание
Most people serve more than one domain on their Slice(s). Whether for different domain names or different subdomains of the same domain, the procedure is the same.

!Вопрос
I am often asked by people how to use their Slice to serve multiple domains.

The question often surprises me as they may have setup their Slice, installed a web server (Apache, Nginx, etc) and even created a virtual host to serve their main domain.

Don't get me wrong, the question itself is good (I like questions as it makes me feel useful!), but the answer is always so simple:

Create another vhost.

!Планирование
There may not be a great deal I can add to the answer but let me outline the process of setting up a Slice and creating a virtual host (I won't go into any details of the installation and creation process - please see the relevant articles for detailed help).

When your Slice is first created it is a minimal Linux install (it doesn't matter what OS you choose).

You SSH into the Slice and update and secure it.

Then you install your preferred web server (Apache, Nginx, Litespeed, etc).

Then the detailed stuff begins. It doesn't matter if your site is PHP based or Rails based or something else entirely. You install the language and framework basics (say Ruby and rubygems or mod_php and so on).

Once that is all done, you come to the part that allows you to server your site: creating virtual hosts.

!Процедура
Greatly simplified the procedure for serving a website is as follows:

A browser send a request to your Slice IP asking for the contents of 'domain.com' (your domain name).

Your web server jumps into action and says 'yes! I have something for you'. The web server does its 'thing' and serves up an http representation of your site which is sent to the browser.

The browser then translates the http and parses it to a human form of the web site (something like this one).

All jolly good but how does your web server know what to send?

!Виртуальные хосты
This is where name based virtual hosts come in.

One of the first lines in any virtual host contains the domain name that is related to the vhost.

Something like this for Apache:
{{{
&lt;VirtualHost *:80&gt;

  ServerName  domain1.com
  ServerAlias www.domain1.com

and something like this for Nginx:
server {

  server_name  www.domain1.com;
  rewrite ^/(.*) http://domain1.com/$1 permanent;

  ...

}}}
Each one starts slightly differently but the same principle applies - that particular virtual host will respond to queries for 'domain1.com' and 'www.domain1.com'.

!Домены
So, to serve different content for different domains is as simple as adding another virtual host.

Let's say you have a subdomain called 'blog.domain1.com' serving a blog (I know, shocking originality!).

The basic creation process would be to create a folder in your public_html folder with the relevant files (let's say a Wordpress install).

A virtual host would be created with the {{{server_name}}} or {{{ServerName}}} as '{{{blog.domain1.com}}}' which would be configured to point to the blog files and folders in your public_html folder.

Done.

!Языки и фремворки
It doesn't matter what language or framework your domain uses.

To serve multiple Rails applications for example requires the same setup for each application.

Of course, there would be some differences such as port numbers for the mongrel or thin instances. Virtual hosts can't share ports.

For example, you may create a mongrel cluster to run from port 8000 - 8002 for one domain and another running from 8010 - 8012 for your blog and so on.

!Заключение
Once the Slice has been setup and the web server has been installed, serving multiple domains is very easy:

Simply create more vhosts...

!Ссылки
*[[Оригинал статьи|http://articles.slicehost.com/2008/5/28/how-to-serve-multiple-domains]]


</pre>
</div>
<div title="Создание логических томов" modifier="Яковлев Иван" created="200906122134" modified="200906122141" tags="LVM [[TODO - нужен перевод статьи]]" changecount="5">
<pre>You can create a LV from the space configured for a VG using the lvcreate command. It’s a straightforward command. The following command creates an LV on device {{{/dev/volgroup1/logvol1}}}: just substitute the name of your choice for ''volgroup1''.
{{{
sudo lvcreate -L 200M volgroup1 -n logvol1
}}}
There are many variations on the {{{lvcreate}}} command; however, this usage is the most straightforward, as it specifies the size and name of the LV to be created. If you’re in doubt about the space available in the VG, run the vgs command. ~LVs are popular because they’re easy to expand. If the vgs command confirms that space is available in the VG, more space can be allocated with the lvextend command. 

For example, the following command expands the size of the LV just created to 1GB:
{{{
sudo lvextend -L 1000M /dev/volgroup1/logvol1
}}}
There are a number of other ~LV-related commands available in the {{{/sbin}}} directory, summarized in Table. As these commands require  administrative privileges, these commands should generally be preceded with the sudo command. In addition, there are also a series of {{{/sbin/lvm}}}* commands, most of which are not yet active for the current Linux logical volume packages.

|!LV&amp;nbsp;Command|!Description|
|{{{lvchange}}}|Changes the attributes of a LV; similar to {{{pvchange}}} and {{{vgchange}}}; {{{lvchange -a n /dev/volgroup1/logvol1}}} deactivates that LV.|
|{{{lvconvert}}}|Converts an LV, if there are sufficient ~PVs, for example: {{{lvconvert -m 1 volgroup1/logvol1}}} command converts a regular LV to a mirror LV.|
|{{{lvcreate}}}|Creates a new LV in an existing VG; for example: {{{lvcreate -L 200M volgroup1 -n logvol1}}} creates a ''logvol01'' of 200 M.|
|{{{lvdisplay}}}|Displays currently configured ~LVs.|
|{{{lvextend}}}|Adds space to a LV: for example: {{{lvextend -L4G /dev/volgroup1/logvol01}}} command extends ''lvol01'' to 4GB, assuming space is available.|
|{{{lvreduce}}}|Reduces the size of a LV; if data exists in the reduced area, it is lost.|
|{{{lvremove}}}|Removes an active LV.|
|{{{lvrename}}}|Renames a LV.|
|{{{lvresize}}}|Resizes a LV; can be done by {{{-L}}} for size, as with {{{lvcreate}}}.|
|{{{Lvs}}}|Lists all configured ~LVs.|

!См. далее
*[[Активация логических томов]]


</pre>
</div>
<div title="Создание своего дистрибутива Ubuntu" modifier="Яковлев Иван" created="200906052354" tags="Статьи Приложения TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/sozdanie-svoego-distributiva-ubuntu.html]]



</pre>
</div>
<div title="Создание физических томов" modifier="Яковлев Иван" created="200906122010" modified="200906122130" tags="LVM [[TODO - нужен перевод статьи]]" changecount="6">
<pre>The first step to create a logical volume is to identify the available space on a physical disk. If you have just added an empty hard disk, you can create a PV on the entire disk. For example, if you’ve just added a fourth SATA hard disk ({{{/dev/sdd}}}), you could set up a PV on that disk with the following command:
{{{
sudo pvcreate /dev/sdd
}}}
You can also configure a new PV on a properly configured partition, using the fdisk and parted utilities discussed earlier in this chapter. If you’ve added a new partition called {{{/dev/sdd1}}}, for example, you’d follow this sequence of commands (in bold) to change the file type to Linux LVM:
{{{
sudo fdisk /dev/sdd
}}}
Выдаст:

Command (m for help) : ''t''
Partition number (1-4): ''1''
Hex code (type L to list codes): ''8e''
Command (m for help) : ''w''

Next, confirm the results with the sudo fdisk -l /dev/sdd command; the output
should be similar to the following:
{{{
Device Boot Start End Blocks Id System
/dev/sdd1 1 100 803218+ 8e Linux LVM
}}}
Alternatively, if you’ve created a partition with the parted utility, the following sequence
of commands changes the file type with the same result:
{{{
sudo parted /dev/sdd
}}}
Выдаст:

GNU Parted 1.7.1
Using /dev/sdd
Welcome to GNU Parted! Type 'help' to view a list of commands.
(parted) ''set 1 lvm on''
(parted) ''quit''

After the partition is ready, you can run the following command to create a new PV on that partition ({{{/dev/sdd1}}}):
{{{
sudo pvcreate /dev/sdd1
}}}
To take full advantage of logical volumes, you should create such partitions and ~PVs on all available free space. There are a number of other ~PV-related commands available in the {{{/sbin}}} directory, summarized in Table. Because these commands require administrative privileges, they should generally be preceded with the {{{sudo}}} command.

|!PV&amp;nbsp;Команда|!Описание|
|{{{pvchange}}}|Changes attributes of a PV: {{{sudo pvchange -x n /dev/sdb1}}} command disables the use of ~PEs from the {{{/dev/sdb1}}} partition.|
|{{{pvck}}}|Checks the metadata associated with a PV.|
|{{{pvcreate}}}|Initializes a disk or partition as a PV. If it’s a partition, it should be configured with the logical volume filesystem.|
|{{{pvdisplay}}}|Displays currently configured ~PVs.|
|{{{pvmove}}}|Moves ~PVs in a VG from the specified partition to free locations on other partitions; prerequisite to disabling a PE.|
|{{{pvremove}}}|Removes a given PV from a list of recognized volume: for example, pvremove {{{/dev/sda10}}}.|
|{{{pvresize}}}|Changes the amount of a partition allocated to a PV. If you’ve expanded partition {{{/dev/sda10}}}, {{{pvresize /dev/sda10}}} takes advantage of the additional space.|
|{{{pvs}}}|Lists configured ~PVs and the associated ~VGs, if so assigned.|
|{{{pvscan}}}|Similar to {{{pvs}}}; provides a baseline of ~PVs, ~VGs, and sizes.|

!См. далее
*[[Создание групп томов]]


</pre>
</div>
<div title="Специальные символы bash" modifier="Яковлев Иван" created="200906121712" modified="200906121802" tags="[[Командная оболочка bash]]" changecount="7">
<pre>;{{{*}}}
:Любой символ.

;{{{?}}}
:Любой один символ.

;{{{[ ... ]}}}
:Любой из символов перечисленных в квадратных скобках, например: name[123] будет соответствовать name1, name2 и name3.

;{{{' ... '}}}
:Переменные и команды заключенные в одинарные кавычки не обрабатываются bash и рассматриваются как набор символов.

;{{{&quot; ... &quot;}}}
:Аналогично вышеприведенному примеру, за исключением что символы {{{$}}}, {{{`}}}, {{{\}}} не теряют своего специального значения при обработке.

;{{{` ... `}}}
: каждое выражение заключенное в такие кавычки обрабатывается так, как будто это команда.
{{note{
{{{
команда1 `команда2`
}}}
равнозначно
{{{
команда1 $(команда2)
}}}
Здесь сначала выполняется команда2, затем вызов команды2 заменяется ее результатом и выполняется команда1.
}}}

;{{{\}}}
:экранирующий символ, убирает специальное значение любого следующего за ним символа.

;{{{~}}}
:Указывает на домашний каталог текущего пользователя, соответствует {{{$HOME}}}. Если предположить, что имя текущего пользователя ''uran'', то {{{~}}} будет указывать на домашний каталог пользователя: {{{/home/uran}}}.

;{{{~+}}}
:Соответствует значению переменной окрцжения {{{$PWD}}} -- текущий рабочий каталог пользователя.

;{{{~-}}}
:Содержит значение преддыдущего рабочего каталога пользователя.

;{{{.}}}
:ссылка на текущий каталог, используется при задании относительных путей

;{{{..}}}
:ссылка на родительский каталог для текущего каталога, в котором находится пользователь. Может использоваться несколько раз для перехода на уровень выше по дереву каталогов файловой системы: {{{../../../some_dir}}}

;{{{$param}}}
:используется для расширения параметров окружения командной оболочки bash.

;{{{команда1 `команда2`}}}
:Здесь сначала выполняется команда2, затем вызов команды2 заменяется ее результатом и выполняется команда1.

;{{{команда1 &gt;}}}
:Перенаправляет стандартный вывод из команды

;{{{команда1 &lt;}}}
:перенаправляет стандартный ввод в команду

;{{{команда1 &gt;&gt;}}}
:Добавляет стандартный вывод в файл из команды, добавляя вывод после уже имеющегося контента файла

;{{{команда1 ; команда2}}}
:Выполняет первую команду, затем после ее завершения выполняет вторую команду

;{{{команда1 | команда2}}}
:Результат выполнения первой команды является входным потоком для второй команды.

;{{{команда &amp;}}}
:Запуск выполнения команды в фоновом режиме

;{{{команда1 &amp;&amp; команда2}}}
:Запуск выполнения первой команды и, если она завершает свое выполнение без ошибок -- возвращает нулевой статус выполнения (''zero exit status''), т.е. ничего не возвращает, то затем выполняется вторая команда.

;{{{команда1 || команда2}}}
:Запуск выполнения первой команды и, если она завершает свое выполнение с ошибкой -- возвращает не нулевой статус выполнения (''non-zero exit status''), то затем выполняется вторая команда.


</pre>
</div>
<div title="Список используемых репозитариев - источники приложений" modifier="Яковлев Иван" created="200906032240" modified="200906040915" tags="[[Репозитарии и обновление в Ubuntu]]" changecount="4">
<pre>Заходим в меню System (Система)  - Администрирование - Источники приложений

{{textAlignCenter{
[img[images/articles/menu-source-list.png]]
}}}
Перед нами приложение, которое позволяет вам модифицировать список репозитариев.
На первой вкладке перечислены официальные репозитарии Ubuntu.

{{textAlignCenter{
[img[images/articles/sources-ubuntu-software.png]]
}}}
Первые два содержат Open Source приложения. Следующие два пункта содержат драйвера для устройств и другое программное обеспечение, которое Open Source уже считаться не может. Выделяйте все четыре пункта, если у вас нет с этим каких-либо ограничений.
Последний пункт в списке - это исходный код приложений.

Обратите внимание на то, что диск, с которого вы устанавливали Ubuntu также может использоваться в качестве репозитария. Естественно никаких обновлений там не появится со временем, но установить ПО, находящееся на нем можно. Это может пригодиться на случай, если у вас нет интернета.
Тут все понятно, переключаемся на следующую вкладку.

{{textAlignCenter{
[img[images/articles/sources-third-party.png]]
}}}
Тут уже немного интересней. Сюда можно добавить любой существующий репозитарий. Например, у Google есть свой репозитарий для установки и обновления таких программ как Picasa и другой продукции. Как вы можете видеть, здесь уже установлен один из сторонних репозитариев, &quot;партнер&quot; Ubuntu. Здесь находится много вкусностей, ставьте галочку. На этой же вкладке можно добавить CD/DVD, который предварительно можно скачать где-нибудь, если, например, дома нет интернета.

{{textAlignCenter{
[img[images/articles/sources-partner.png]]
}}}
Включили репозиторий Ubuntu partner. Хочу обратить внимание на то, что после того, как вы сделаете какие-либо изменения, становится активной кнопка &quot;Revert&quot; и многие случайно или преднамеренно нажимают ее, думая что это аналог &quot;Обновить&quot;. Эта кнопка отменяет все ваши изменения!
Переключаемся на следующую вкладку.

{{textAlignCenter{
[img[images/articles/sources-updates.png]]
}}}
Здесь вы видите настройку обновления системы.

Первые два пункта выделяйте в любом случае, это обновления безопасности системы и рекомендуемые обновления приложений.

Насчет следующих двух пунктов вам придется думать самим. Там находятся обновления, которые не были до конца протестированы. Здесь палка о двух концах. Если вам нужна абсолютная надежность - не выделяйте их. Если вам интересно пользоваться самыми последними версиями - то выделяйте. Это дело выбора каждого. Для того чтобы применить все изменения - нажмите Close. Но если вы добавили сторонний репозитарий (Ubuntu partner не в счет) - то вам нужно перейти на следующую вкладку.

{{textAlignCenter{
[img[images/articles/sources-close.png]]
}}}
Каждый репозитарий должен быть подписан ключом. При добавлении сторонних репозитариев, которые не поддерживаются Ubuntu, вам также нужно скачать ключ для этого репозитария и установить его.

{{textAlignCenter{
[img[images/articles/sources-keys.png]]
}}}
Ну собственно все. После того как вы нажмете Close, если вы сделали какие-либо изменения, у вас появится вот такое окно.

{{textAlignCenter{
[img[images/articles/sources-apt-update.png]]
}}}
Напомню еще раз принцип работы с репозиториями. В интернете хранится список ПО и вашей программе-установщику необходимо знать о том, что же именно оттуда можно скачать и какая версия приложений. Если вы изменили список репозитариев - то эти знания необходимо обновить, что собственно говоря, вам и предлагается сделать. Жмите Reload.

{{textAlignCenter{
[img[images/articles/sources-apt-updating.png]]
}}}
Список обновляется, по завершении окно просто закроется. И на этом все, мы обновили список репозитариев.

!См. далее
*[[Список используемых репозитариев - ручной метод]]
</pre>
</div>
<div title="Список используемых репозитариев - ручной метод" modifier="Яковлев Иван" created="200906032248" modified="200906040914" tags="[[Репозитарии и обновление в Ubuntu]]" changecount="4">
<pre>Все то, что было описано выше можно сделать самостоятельно с помощью консоли и редактора gedit (или любого другого, если у вас только консоль и нет графической оболочки, например - nano).

Файл, который содержит список всех репозитариев: {{{/etc/apt/sources.list}}}. Откроем его на редактирование. Замечу, что файл доступен на редактирование только суперпользователю.
{{{
gksu gedit /etc/apt/sources.list
}}}
Вы увидите список с комментариями. Некоторые репозитарии будут уже доступны, некоторые будут закомментированы.

{{textAlignCenter{
[img[images/articles/sources-list-old.png]]
}}}
Все что нужно сделать - это раскомментировать те репозитарии, которые вы хотите использовать и сохранить файл. На рисунке выше я выделил две области. В первой репозитарий закомментирован и не используется, во второй - используется. Для комментирования используется символ {{{#}}} перед репозиторием.

Все что начинается с {{{deb}}} - это обычные приложения, все что начинается с {{{deb-src}}} - это исходный код приложений.

Вот содержимое моего файла {{{/etc/apt/sources.list}}} после того, как я включил все стандартные репозитарии (включая Ubuntu partner) и все обновления, включая самые свежие. Вы можете использовать это содержимое, если вдруг испортили свой файл. 
''Ubuntu 8.10'':
{{{
# deb cdrom:[Ubuntu 8.10 _Intrepid Ibex_ - Release i386 (20081029.5)]/ intrepid main restricted
# See http://help.ubuntu.com/community/UpgradeNotes for how to upgrade to
# newer versions of the distribution.

deb http://ru.archive.ubuntu.com/ubuntu/ intrepid main restricted
deb-src http://ru.archive.ubuntu.com/ubuntu/ intrepid main restricted

## Major bug fix updates produced after the final release of the
## distribution.
deb http://ru.archive.ubuntu.com/ubuntu/ intrepid-updates main restricted
deb-src http://ru.archive.ubuntu.com/ubuntu/ intrepid-updates main restricted

## N.B. software from this repository is ENTIRELY UNSUPPORTED by the Ubuntu
## team. Also, please note that software in universe WILL NOT receive any
## review or updates from the Ubuntu security team.
deb http://ru.archive.ubuntu.com/ubuntu/ intrepid universe
deb-src http://ru.archive.ubuntu.com/ubuntu/ intrepid universe
deb http://ru.archive.ubuntu.com/ubuntu/ intrepid-updates universe
deb-src http://ru.archive.ubuntu.com/ubuntu/ intrepid-updates universe

## N.B. software from this repository is ENTIRELY UNSUPPORTED by the Ubuntu 
## team, and may not be under a free licence. Please satisfy yourself as to 
## your rights to use the software. Also, please note that software in 
## multiverse WILL NOT receive any review or updates from the Ubuntu
## security team.
deb http://ru.archive.ubuntu.com/ubuntu/ intrepid multiverse
deb-src http://ru.archive.ubuntu.com/ubuntu/ intrepid multiverse
deb http://ru.archive.ubuntu.com/ubuntu/ intrepid-updates multiverse
deb-src http://ru.archive.ubuntu.com/ubuntu/ intrepid-updates multiverse

## Uncomment the following two lines to add software from the 'backports'
## repository.
## N.B. software from this repository may not have been tested as
## extensively as that contained in the main release, although it includes
## newer versions of some applications which may provide useful features.
## Also, please note that software in backports WILL NOT receive any review
## or updates from the Ubuntu security team.
deb http://ru.archive.ubuntu.com/ubuntu/ intrepid-backports main restricted universe multiverse
# deb-src http://ru.archive.ubuntu.com/ubuntu/ intrepid-backports main restricted universe multiverse

## Uncomment the following two lines to add software from Canonical's
## 'partner' repository. This software is not part of Ubuntu, but is
## offered by Canonical and the respective vendors as a service to Ubuntu
## users.
deb http://archive.canonical.com/ubuntu intrepid partner
# deb-src http://archive.canonical.com/ubuntu intrepid partner

deb http://security.ubuntu.com/ubuntu intrepid-security main restricted
deb-src http://security.ubuntu.com/ubuntu intrepid-security main restricted
deb http://security.ubuntu.com/ubuntu intrepid-security universe
deb-src http://security.ubuntu.com/ubuntu intrepid-security universe
deb http://security.ubuntu.com/ubuntu intrepid-security multiverse
deb http://ru.archive.ubuntu.com/ubuntu/ intrepid-proposed restricted main multiverse universe
deb-src http://security.ubuntu.com/ubuntu intrepid-security multiverse
}}}
После того как мы обновили список репозиториев и сохранили файл, нам нужно обновить его.

Программа apt-get используется для установки приложения и обновления системы, мы рассмотрим ее в подробностях позже, пока же нам нужна команда:
{{{
sudo apt-get update
}}}

{{textAlignCenter{
[img[images/articles/sudo-apt-get-update.png]]
}}}
Все, мы сделали тоже самое вручную.

!См. далее
*[[Обновление системы]]


</pre>
</div>
<div title="Список часто используемых файлов и директорий" modifier="Яковлев Иван" created="200906032101" modified="200906191931" tags="[[Дополнительные материалы]]" changecount="4">
<pre>!Apt - приложения
{{{/etc/apt/sources.list}}} - список репозиториев
{{{/var/cache/apt/archives}}} - директория содержит архив пакетов, установленных в систему

!Сеть
{{{/etc/resolv.conf}}} - список ~DNS-серверов
{{{/etc/services}}} - стандарты well known ports (процесс/порт)

!Hard disk
{{{/dev/disk/by-uuid/}}} - разделы и их uuid ({{{ls -l /dev/disk/by-uuid/}}})
{{{/proc/partitions}}} - список разделов с размером

!Остальное
{{{/etc/usplash.conf}}} - файл конфигурации usplash
{{{/etc/rc.local}}} - запуск вашего скрипта при старте компьютера
{{{/boot/grub/menu.lst}}} - конфигурационный файл Grub
{{{/ets/fstab}}} - конфигурация монтируемых устройств


</pre>
</div>
<div title="Ссылки" modifier="Яковлев Иван" created="200906061607" modified="200906192123" tags="slider [[Дополнительные материалы]]" changecount="13">
<pre>*[[ресурсы по Ubuntu|Ссылки на ресурсы по Ubuntu]]
*[[МануалКкоманд(ubuntu.com)|http://manpages.ubuntu.com/manpages/jaunty/en/]]
*[[МануалКоманд(Opennet.ru)|http://www.opennet.ru/man.shtml]]
*[[МануалКоманд(FreeBSD.org)|http://www.freebsd.org/cgi/man.cgi]]
*[[Руководство Ubuntu|https://help.ubuntu.com/]]
*[[Руководство FreeBSD|http://www.freebsd.org/doc/ru_RU.KOI8-R/books/handbook/]]
*[[Удаленное подключение|Ссылки на программы для удаленного подключения]]
*[[Список портов|http://www.portforward.com/cports.htm]]
*[[wiki по nginx (англ.)|http://wiki.nginx.org//NginxXSendfile]]
*[[Оф.страница nginx|http://sysoev.ru/nginx/]]</pre>
</div>
<div title="Ссылки на программы для удаленного подключения" modifier="Яковлев Иван" created="200906061415" modified="200906121523" tags="Ссылки TODO" changecount="19">
<pre>!~PuTTY
''~PuTTY'' -- это клиент для подключения по протоколу SSH, Telnet, rlogin и чистого TCP.
*[[Домашняя страница PuTTY|http://www.chiark.greenend.org.uk/~sgtatham/putty/]]
*[[Раздел на Википедии|http://ru.wikipedia.org/wiki/PuTTY]]
*[[Xming-portablePuTTY|http://www.straightrunning.com/XmingNotes/portableputty.php]]

*[[PuTTY Connection Manager|http://puttycm.free.fr/]]
*[[PuTTY Session Manager|http://puttysm.sourceforge.net/]]

!Xming
''Xming'' -- это порт сервера X Window System для MS Windows (позволяет запускать приложения Unix в Windows).
*[[Домашняя страница Xming X Server|http://www.straightrunning.com/XmingNotes/]]
*[[Xming-portablePuTTY|http://www.straightrunning.com/XmingNotes/portableputty.php]]
*[[Дистрибутивы Xming на SourceForge|http://sourceforge.net/project/showfiles.php?group_id=156984]]
*[[Раздел на Википедии|http://ru.wikipedia.org/wiki/Xming]]

!SFTP (SSH File Transfer Protocol)
''SFTP'' -- это протокол для безопасной передачи файлов поверх безопасного соединения.
*[[Описание на xgu.ru|http://xgu.ru/wiki/Sftp]]
*[[Раздел на Википедии|http://ru.wikipedia.org/wiki/SFTP]]

!VNC
*[[Раздел VNC на Википедии|http://ru.wikipedia.org/wiki/Vnc]]
*[[TightVNC - бесплатный пакет для удаленного управления|http://www.tightvnc.org/]]
&lt;&lt;&lt;
''~TightVNC'' это бесплатный пакет для удаленного управления. С помощью него вы можете видеть и управлять удаленным компьютером как своим. Основные преимущества пакета ''~TightVNC'':
*бесплатен, с открытым исходным кодом
*обеспечивает удаленное управление для целей администрирование, тех. поддержки, обучения и т.д.
*платформо-независим -- может использоваться на Windiws и Unix системах, совместим с другими ~VNC-программами.
&lt;&lt;&lt;




</pre>
</div>
<div title="Ссылки на ресурсы по Ubuntu" modifier="Яковлев Иван" created="200906061639" modified="200906192136" tags="Ссылки TODO" changecount="3">
<pre>*http://articles.slicehost.com/ -- статьи по Ubuntu и другим ОС хостинг VPS</pre>
</div>
<div title="Ссылки по LVM" modifier="Яковлев Иван" created="200906122011" tags="LVM" changecount="1">
<pre>*http://ru.wikipedia.org/wiki/LVM -- описание на Википедии
*[[Описание работы с LVM на русском в pdf|http://const.tltsu.ru/articles/lvm.pdf]]


</pre>
</div>
<div title="Стандартный алгоритм настройки DynDNS сервиса" modifier="Яковлев Иван" created="200906171914" modified="200906171949" tags="[[Настройка DynDNS сервиса]] [[TODO - нужен перевод статьи]]" changecount="10">
<pre>!Шаг1: создание персонального аккаунта
First, you will need to [[create an account|http://www.dyndns.com/account/entrance/]]. Account creation is free and fast: simply fill out the form and click Create Account, and complete the confirmation email delivered to you. (If you do not receive your confirmation email within fifteen minutes, ensure our support@dyndns.com address is whitelisted in your spam filters, and use the Reset Password form to confirm the account.)

!Шаг2: Создание хоста
Once your account is created and confirmed, log in and [[visit the New Dynamic DNS Host page|http://www.dyndns.com/account/services/hosts/add.html]]. You will be presented with the following options for your host:

;Hostname
:This is the hostname you wish to use. Enter the desired third-level hostname into the field, and select a second-level domain from the drop-down box of [[available domains|http://www.dyndns.com/services/dns/dyndns/domains.html]]. For example, if you enter myhost into the field and select dyndns.org from the drop-down box, your hostname will be myhost.dyndns.org.

;Wildcard?
:If Wildcard is disabled, only the third-level hostname will resolve, e.g. myhost.dyndns.org works but www.myhost.dyndns.org doesn't. If Wildcard is enabled, any fourth-level hostname will resolve, e.g. www.myhost.dyndns.org, asdf1234.myhost.dyndns.org, and so on. This feature is particularly useful for [[virtual hosting|http://www.dyndns.com/support/kb/cat_web_server.html]].

;TTL
:TTL, or Time To Live, is how long the host's IP address is cached (remembered) before a computer has to ask for new information. For dynamic IP addresses, having a low TTL ensures changes are received quickly; for static IP addresses, a high TTL means the record is stored longer, and visitors don't have to spend extra time looking up your host.
:Service Type: There are three service types: 
:*''A-record pointed to IP address:'' This is the most common use for our Dynamic DNS service. This &quot;maps&quot; your IP address to your hostname for easy access. For example, if you have a webcam, VPN, or game server at home, and want visitors to reach it using the host, you should select this service type.
:*''~WebHop Redirect:'' This configures your host to use our [[WebHop url forwarding service|http://www.dyndns.com/services/webredirect/]]. ~WebHops are ~HTTP-based redirects which can send visitors to any URL. This is useful for creating short links to long ~URLs (myhost.dyndns.org to {{{freewebhost.com/really/long/~sub/directory/}}}) and for directing visitors to your web services on alternate ports ({{{myhost.dyndns.org}}} to {{{mysecondhost.dyndns.org:8000}}}). You can [[learn more about common WebHop configurations here|http://www.dyndns.com/support/kb/webhops_redirections.html]].
:*''Offline Hostname:'' This sets the host to our offline web page. This feature is useful for pointing visitors to a temporary site while your server is down for maintenance or otherwise unavailable. (Please note that this feature is manually enabled.)

;IP Address
:This is the IP address of your network. The Auto-detected Remote IP shows your current location's address; you can simply click this link to populate the field. (This field is not necessary if you are using the ~WebHop service.)

:~WebHop
:This is for the ~WebHop feature. (These options are not necessary if you are using the A-record feature.) 
:*''Redirect URL:'' The full URL (including {{{http://}}}) of your desired destination address.
:*''Yes, cloak this page:'' If you want to hide the address bar to prevent visitors from seeing the redirection, check this box.
:*''Cloaked Page Title:'' This appears if you enable cloaking. It replaces the title bar (at the top of your browser window) with this text when cloaking is enabled.

;Mail Routing
:This sets the MX (Mail eXchanger) records for your host. You can [[learn more about MX records here|http://www.dyndns.com/support/kb/email_mail_exchangers_and_dns.html]]. 
:*''My host will receive or reject mail itself:'' This is the default setting. Choose this if you have a mail server located at the network itself, or have no mail server at all. This creates no MX records. (According to ~RFCs, mail should be delivered directly to a host if no MX records exist, so no MX record is necessary in this case.)
:*''My host and backup mail exchanger should be added to DNS:'' This will create two MX records for your host: a primary MX record set to the host itself, and a secondary MX record set to the Backup MX hostname field.
:*''Specific mailserver will route all mail for my ~DynDNS host:'' This creates a single MX record set to the Mailserver Hostname field.

Now that you have selected your options, simply click Create New Host to create your new Dynamic DNS host.

!Шаг3: Установка и обновление клиента ~DynDNS
Now that you have an account and host, you will need to install an update client. Update clients monitor your IP for changes, and send the new address to the Dynamic DNS service whenever a change occurs. This keeps your host automatically up-to-date with your network's address, no matter how often it changes. You can find our [[update client page here|http://www.dyndns.com/support/clients/]]. Please follow the instructions for the chosen client to install and configure it to operate for your operating system and network.

!Шаг4: Настройка сети
With a Dynamic DNS host and an update client, you generally do not need to set up any additional services or make any other changes to your account. Now you will need to ensure that your network is properly configured, such as [[configuring port forwarding|http://portforward.com/]] in your router, opening ports in firewall applications, and ensuring your web services (cameras, game servers, etc.) are functioning correctly. For a list of common networking problems and solutions, please [[Устранение проблем в работе сервиса DynDNS]].

!См. также
*[[Настройка сервиса DynDNS для Ubuntu]]

!Ссылки
*http://www.dyndns.com -- официальный сайт
*[[Оригинал статьи|http://www.dyndns.com/services/dns/dyndns/howto.html]]
*http://en.wikipedia.org/wiki/DynDNS -- раздел на Википедии


</pre>
</div>
<div title="Стандартный способ подключения в Ubuntu" modifier="Яковлев Иван" created="200906171554" modified="200906171652" tags="[[Подключение к рабочему столу через VNC]] [[Удаленное подключение]]" changecount="11">
<pre>1. Выбираем Параметры -&gt; Удаленный рабочий стол:
{{textAlignCenter{
[img[images/articles/vnc-standart-ubuntu-001.jpg]]
}}}

2. В появившемся окне ставим нужные настройки:
{{textAlignCenter{
[img[images/articles/vnc-standart-ubuntu-002.jpg]]
}}}

3. Если включен файрвол, то в нем разрешаем соединение через порт 5900:
{{textAlignCenter{
[img[images/articles/vnc-standart-ubuntu-003.jpg]]
}}}

4. На компьютере, с которого вы собираетесь подключаться к удаленному рабочему столу Ubuntu (в данном случае из оперционной системы Windows XP) устанавливаем и запускаем клиент [[UltraVNC|http://www.uvnc.com/index.html]]:
{{textAlignCenter{
[img[images/articles/vnc-standart-ubuntu-004.jpg]]
}}}
Набираем ~IP-адрес нашего удаленного компьютера, к которому собираемся подключаться

5. Вводим пароль:
{{textAlignCenter{
[img[images/articles/vnc-standart-ubuntu-005.jpg]]
}}}
после чего появляется окно с удаленным рабочим столом для управления.
{{textAlignCenter{
[img[images/articles/vnc-standart-ubuntu-006.jpg]]
}}}
Все, теперь мы можем управлять Ubuntu из Windows или из другой операционной системы где установлен ~VNC-клиент.

</pre>
</div>
<div title="Статьи" modifier="Яковлев Иван" created="200906191932" tags="[[Дополнительные материалы]] TODO" changecount="1">
<pre>TODO</pre>
</div>
<div title="Стриминг Flash Video при помощи Nginx" modifier="Яковлев Иван" created="200906191433" modified="200906191531" tags="[[Nginx + Apache]] [[Потоковое видео]] TODO" changecount="3">
<pre>!Описание
Этот пост расскажет вам о том, как использовать новый модуль Nginx под названием http_flv_module, впервые реализованный в версии 0.4.7 (но там была досадная ошибка в реализации стриминга, которая исправляется моим патчем) и доведенный до идеала в 0.4.8.

Во-первых, для использования этого модуля, Вы должны перекомпилировать nginx с опцией –with-http_flv_module:
{{{
sudo ./configure --with-http_flv_module ...SOME-OTHER-OPTS...
}}}
Следующим действием является активация стриминга для Ваших flv-файлов в nginx.conf:
{{{
...
http {
    ...
    server {
        ...
        location ~ \.flv$ {
            flv;
        }
        ...
    }
    ...
}
}}}
Эта опция требует от Nginx добавлять специальный “заголовок” в поток данных, запрошенный из определенного flv-файла передачей параметра “{{{?start=XXX}}}”, обозначающего “отдай мне файл flv с байта XXX до конца файла” (такова идея стриминга видео во флеше). 

Последнее действие, которое требуется, если вы его еще не сделали, - это конвертация Вашего видео в FLV формат и добавление meta-информации в созданные файлы. Детальнее об этом процессе вы можете прочесть в одном из моих предыдущих постов.



!См. также
*[[Использование X-Accel-Redirect с Nginx для реализации контролируемых скачиваний (с примерами для rails и php)]]
*[[Использование lighttpd, Mplayer/Mencoder и Flvtool2 для реализации потоковой раздачи Flash Video]]

!Ссылки
*[[Оригинал статьи|http://blog.kovyrin.net/2006/10/14/flash-video-flv-streaming-nginx/]]


</pre>
</div>
<div title="Тильда (~) - домашний каталог пользователя" modifier="Яковлев Иван" created="200906111521" modified="200906121407" tags="[[Навигация по каталогам]] [[TODO - нужен перевод статьи]]" changecount="8">
<pre>!Описание
Every regular Linux user has a home directory, and the tilde ({{{~}}}) is frequently used to represent the home directory of the currently active user. For example, if your username is dickens, your home directory is {{{/home/dickens}}}. But if you allow logins as the root user, and log in as the root user, the home directory is {{{/root}}}. In other words, the effect of the {{{cd ~}}} command, depends on the login username.

Normally, if you logged in as user mj, the {{{cd ~}}} command brings you to the {{{/home/mj}}} directory. But if you’ve logged in as the root user, the command brings you to the {{{/root}}} directory. The tilde can be used with other commands; for example, you can list the contents of the current user’s home directory from anywhere in the directory tree with the {{{ls ~}}} command.

!См. также
*[[Шпоргалка по продвинутому использованию оболочки bash]]


</pre>
</div>
<div title="Типы файловых систем Linux" modifier="Яковлев Иван" created="200906031957" modified="200906031958" tags="Описания [[TODO - нужен перевод статьи]]" changecount="3">
<pre>When, as is customary, the proc file system is mounted on {{{/proc}}}, you can find in the file {{{/proc/filesystems}}} which file systems your kernel currently supports. If you need a currently unsupported one, insert the corresponding module or recompile the kernel.

In order to use a file system, you have to mount it; see mount(8).

Below a short description of a few of the available file systems.

;minix
    is the file system used in the Minix operating system, the first to run under Linux. It has a number of shortcomings: a 64MB partition size limit, short filenames, a single timestamp, etc. It remains useful for floppies and RAM disks. 

;ext
:is an elaborate extension of the minix file system. It has been completely superseded by the second version of the extended file system (ext2) and has been removed from the kernel (in 2.1.21). 

;ext2
:is the high performance disk file system used by Linux for fixed disks as well as removable media. The second extended file system was designed as an extension of the extended file system (''ext''). ''ext2'' offers the best performance (in terms of speed and CPU usage) of the file systems supported under Linux. 

;ext3
:is a journaling version of the ''ext2'' file system. It is easy to switch back and forth between ''ext2'' and ''ext3''. 

;Reiserfs
:is a journaling file system, designed by Hans Reiser, that was integrated into Linux in kernel 2.4.1. 

;XFS
:is a journaling file system, developed by SGI, that was integrated into Linux in kernel 2.4.20. 

;JFS
:is a journaling file system, developed by IBM, that was integrated into Linux in kernel 2.4.24. 

;xiafs
:was designed and implemented to be a stable, safe file system by extending the Minix file system code. It provides the basic most requested features without undue complexity. The xia file system is no longer actively developed or maintained. It was removed from the kernel in 2.1.21. 

;msdos
:is the file system used by ''DOS'', Windows, and some OS/2 computers. msdos filenames can be no longer than 8 characters, followed by an optional period and 3 character extension. 

;umsdos
:is an extended ''DOS'' file system used by Linux. It adds capability for long filenames, UID/GID, POSIX permissions, and special files (devices, named pipes, etc.) under the ''DOS'' file system, without sacrificing compatibility with ''DOS''. 

;vfat
:is an extended ''DOS'' file system used by Microsoft Windows95 and Windows NT. ''VFAT'' adds the capability to use long filenames under the ''MSDOS'' file system. 

;proc
:is a pseudo file system which is used as an interface to kernel data structures rather than reading and interpreting /dev/kmem. In particular, its files do not take disk space. See [[proc(5)|TODO]]. 

;iso9660
:is a ~CD-ROM file system type conforming to the ''ISO 9660'' standard.

:;High Sierra
::Linux supports High Sierra, the precursor to the ''ISO 9660'' standard for ~CD-ROM file systems. It is automatically recognized within the iso9660 file-system support under Linux. 
:;Rock Ridge
:: Linux also supports the System Use Sharing Protocol records specified by the Rock Ridge Interchange Protocol. They are used to further describe the files in the iso9660 file system to a Unix host, and provide information such as long filenames, UID/GID, POSIX permissions, and devices. It is automatically recognized within the iso9660 file-system support under Linux. 

;hpfs
:is the High Performance Filesystem, used in OS/2. This file system is read-only under Linux due to the lack of available documentation. 

;sysv
:is an implementation of the ''~SystemV/Coherent'' file system for Linux. It implements all of Xenix FS, ''~SystemV/386 FS'', and Coherent FS. 

;nfs
:is the network file system used to access disks located on remote computers. 

;smb
:is a network file system that supports the SMB protocol, used by Windows for Workgroups, Windows NT, and Lan Manager.
:To use smb fs, you need a special mount program, which can be found in the ksmbfs package, found at {{{ftp://sunsite.unc.edu/pub/Linux/system/Filesystems/smbfs}}}. 

ncpfs
:is a network file system that supports the ''NCP'' protocol, used by Novell ~NetWare.
:To use ncpfs, you need special programs, which can be found at {{{ftp://linux01.gwdg.de/pub/ncpfs}}}.


</pre>
</div>
<div title="Точка . и две точки .." modifier="Яковлев Иван" created="200906111523" modified="200906121407" tags="[[Навигация по каталогам]] [[TODO - нужен перевод статьи]]" changecount="5">
<pre>!Описание
The dot (''.'') and double dot (''..'') offer a couple of command options. A single dot represents files in the current directory. This notation is a handy way to copy regular and hidden files from the current directory. For example I created a new user (''katie'') manually and then copied default shell configuration files from the {{{/etc/skel}}} directory with the following command:
{{{
$ cp -ar /etc/skel/. /home/katie/
}}}
A single dot can also be useful for scripts that are not in the current value of ''PATH''. The current directory is typically not in any user’s ''PATH'', so if you create a script named testscript in your home directory and want to test it there, you can do so with the following command:
{{{
$ ./testscript
}}}

!См. также
*[[Шпоргалка по продвинутому использованию оболочки bash]]


</pre>
</div>
<div title="Удаление ненужных зависимостей" modifier="Яковлев Иван" created="200906032342" modified="200906040920" tags="[[Установка ПО в Ubuntu]]" changecount="3">
<pre>Как вы уже знаете, одна программа может зависеть от десятка библиотек. При установке приложения все зависимости будут установлены автоматически. А что будет, если программа нам не понравится и мы ее удалим? Что будет с зависимостями? Если другое приложение использует эти же библиотеки - то естественно они нужны в системе. А если нет?

Давайте удалим установленный Krusader. Как это сделать я описал выше.

После того, как Krusader будет удален, в Synaptic выберите &quot;Состояние&quot; из фильтра ПО. Если все было сделано правильно - вы увидите категорию &quot;Установленные (могут быть автоматически удалены)&quot;. Эта категория появляется только тогда, когда в системе установлены библиотеки, которые уже не нужны. Можно выделить все пакеты и удалить их.

{{textAlignCenter{
[img[images/articles/synaptic-packets-can-be-deleted.png]]
}}}

!См. далее
*[[Пункт меню УстановкаУдаление приложений]]


</pre>
</div>
<div title="Удаленное подключение" modifier="Яковлев Иван" created="200906052229" modified="200907201159" tags="MainMenu slider" changecount="14">
<pre>*[[Настройка openSSH|OpenSSH сервер]]
*[[Доступ по SSH по ключам|Настройка доступа по SSH на базе секретных ключей без ввода пароля]]
*[[SSH - работа с PuTTY]]
*[[SFTP - работа с WinSCP|WinSCP - бесплатный графический клиент SFTP и SCP для Windows]]
*[[Подкл. через Xming и SSH|Удаленное подключение к рабочему столу Linux из Windows с помощью Xming и SSH]]
*[[VPN через SSH - PuTTY|Настройка VPN через SSH с использованием PuTTY]]
*&lt;&lt;slider &quot;chk-vnc&quot; [[Подключение к рабочему столу через VNC]] &quot;Подключение через VNC&quot; &quot;Показать/Скрыть Подключение к рабочему столу через VNC&quot;&gt;&gt;</pre>
</div>
<div title="Удаленное подключение к рабочему столу Linux из Windows с помощью Xming и SSH" modifier="Яковлев Иван" created="200906052333" modified="200906151042" tags="SSH [[Удаленное подключение]] Безопасность TODO" changecount="16">
<pre>{{textAlignCenter borderNone{
[img[images/articles/brand.gif]]
}}}
!Описание
 В отличие от Windows, в Linux графическая оболочка не является частью ядра системы. Стандартная оконная система для Linux - это ''X Window System'', или, попросту говоря, иксы. Она берет на себя отрисовку графических элементов и взаимодействие с устройствами ввода-вывода. А самое вкусное заключается в том, что эта система имеет прозрачную клиент-серверную архитектуру. Оконная система выполняет роль сервера, а графические приложения - роль клиентов. Как и положено клиентам, они подключаются к серверу и взаимодействуют с ним для отрисовки и для получения событий мыши и клавиатуры.

Но это еще не все! Дело в том, что оконная система может находиться на другом компьютере, а графическое приложение связываться с ней через сеть. Так вы можете запустить приложение на удаленном компьютере, заставив его рисоваться на том компьютере, за которым сейчас работаете. Или наоборот. Или запустить программу на одном удаленном компьютере с отрисовкой интерфейса на другом удаленном компьютере. Заманчивая возможность, неправда ли? 

!Настройка
Для начала подготовим удаленный компьютер Debian Linux. Все, что нам здесь нужно - это ~SSH-сервер. Через него мы будем подключаться удаленно и запускать нужные нам программы. Выполняем всего одну команду в консоли:
{{{
sudo apt-get update
sudo apt-get install openssh-server
}}}
Все, с этим компьютером мы закончили, и касаться его клавиатуры в ходе этой статьи больше не будем. Теперь можем переходить к подготовке компьютера Windows. Здесь нужно установить две программы:
*~SSH-клиент. В данной статье мы используем [[PuTTY|http://ru.wikipedia.org/wiki/PuTTY]].
*X Server для Windows. Будет использовать [[Xming|http://ru.wikipedia.org/wiki/Xming]].

Обе программы можно загрузить с сайта [[SourceForge|http://sourceforge.net/project/showfiles.php?group_id=156984]] (пакеты [[Xming|http://www.straightrunning.com/XmingNotes/]] и [[Xming-portable-PuTTY|http://www.straightrunning.com/XmingNotes/portableputty.php]]). Также по желанию можно загрузить стандартный набор шрифтов (пакет ~Xming-fonts). Все, что загрузили - устанавливаем (с полной установкой всех компонент Xming), и переходим к настройке. Теперь главное не запутаться, что к чему будем подключать  

Для начала установим соединение по SSH с удаленным компьютером. Для этого запускаем ~PuTTY. Вводим ~IP-адрес компьютера Linux.

{{textAlignCenter borderNone{
[img[images/articles/xming8.PNG]]
}}}
Теперь переходим в раздел ''Connection / SSH / X11'' и включаем перенаправление графического интерфейса. В качестве расположения ~X-сервера водим ~IP-адрес компьютера Windows, за которым сейчас сидим.

{{textAlignCenter borderNone{
[img[images/articles/xming9.PNG]]
}}}
Кроме того, чтобы вместо русских букв не всплыли крокозябли, желательно в разделе ''Window / Translation'' установит правильную кодировку (предполагается, что ~UTF8 является стандартной кодировка на Debian и Ubuntu). Возвращаемся в раздел Session, сохраняем настройки и подключаемся к компьютеру Linux. В случае успешного подключения мы вводим логин и пароль и видим текстовую консоль. С ее помощью мы можем удаленно запустить консольные программы, но графические программы не могут рисоваться в консоли. Поэтому оставим на время наше подключение по SSH.

Теперь настроим Xming. Для этого запускаем программу ~XLaunch - это мастер настроек. На первом шаге указываем способ интеграции в графическое окружение Windows. Мне более всего по душе первый, когда каждое приложение Linux находится в своем окне.

{{textAlignCenter borderNone{
[img[images/articles/xming3.PNG]]
}}}
На втором шаге нам предлагается автоматически запускать какое-нибудь приложение вместе с иксами. Я предпочел сделать это позже по мере необходимости посредством уже запущенного нами ~PuTTY.

{{textAlignCenter borderNone{
[img[images/articles/xming4.PNG]]
}}}
На третьем шаге указываем параметры запуска Xming. Опция Clipboard позволяет интегрировать буфер обмена. Также для полноценной работы я ввел следующие параметры:
*''-dpi 96'' - чтобы поправить размер шрифтов. Значение можно подбирать по вкусу.
*''-xkblayout us,ru'' - для работы с двумя раскладками клавиатуры.
*''-xkbvariant basic,winkeys'' - уточнение раскладок.
*''-xkboptions grp:caps_toggle'' - переключение раскладки клавишей CAPS LOCK.

{{textAlignCenter borderNone{
[img[images/articles/xming5.PNG]]
}}}
И, наконец, на следующем шаге сохраняем настройки кнопкой “Save configuration” и запускаем X-сервер кнопкой “Готово”.

{{textAlignCenter borderNone{
[img[images/articles/xming6.PNG]]
}}}
В системном лотке появится иконка Xming

{{textAlignCenter borderNone{
[img[images/articles/xming7.PNG]]
}}}
В дальнейшем запустить сервер с теми же настройками можно просто путем открытия сохраненного файла. Изменить настройки можно через контекстное меню файла.

{{textAlignCenter borderNone{
[img[images/articles/xming2.PNG]]
}}}
Итак, X-сервер запущен. Возвращаемся в нашу консоль, предоставленную соединением SSH. Здесь мы можем удаленно запустить консольное приложение, и в этой же консоли увидим вывод этого приложения. А что теперь будет, если мы попытаемся запустить в этой консоли графическое приложение? Обычно, если вы подключились по SSH и пытаетесь запустить оконное приложение, вы получите ошибку, потому что вы подключились к удаленному компьютеру в консольном режиме, и рисовать окна просто нечем. Однако, в этот раз мы включили перенаправление графики на наш компьютер Windows, на котором уже запущен свой X-сервер. Поэтому, если вы попытаетесь запустить оконное приложение в удаленном консольном терминале, его окно нарисуется на компьютере Windows. Попробуйте, например, набрать следующую команду:
{{{
kwrite &amp;
}}}
или
{{{
gedit &amp;
}}}
Амперсанд в конце команды указывает, что программу нужно запустить в фоновом режиме, чтобы во время ее работы консоль была доступна для других действий.

Ну, надеюсь, у вас все получилось, и на вашем рабочем столе Windows красуются оконные приложения Linux.

Кстати говоря, благодаря этой клиент-серверной архитектуре злоумышленник может отправить на ваш экран окно с просьбой ввести ваш пароль или еще с какой-нибудь гадостью. Чтобы такого не происходило, не подключайтесь к общественным сетям без фаирвола. И помните: большие возможности - это большая ответственность.

!Комментарии
{{note{
Будет обрыв связи и все приложения вылетят
----
Справедливое замечание. Не лишним будет заметить, что этот тип удаленного доступа не является самым удачным в случае медленного или нестабильного соединения. С другой стороны, если два компьютера находятся в офисной или домашней сети, то вероятность обрыва связи невероятно мала :-) В моем случае для подключения к компьютеру в соседней комнате это то что нужно.
----
Ну а как сделать, чтобы не отваливались? screen-а в консоли будет достаточно? Видимо, нет...
----
К слову сказать, что при нестабильной связи даже Citryx не гарантирует возврата в сессию. А про потерю работоспособности и вовсе нет смысла говорить не только при нестабильной но и при медленной связи. 
:Не стоит переживать по поводу &quot;выпадений&quot; из-за плохой связи, т.к. ваши данные на сервере, а значит не критично. Нет и не будет надёжных решений для TCP для нестабильных каналов. Вариант - UDP с собсвенным механизмом контроля прохождения пакетов. Думаю к X серверу это можно прикрутить, программерам в Linux флаг в руки, в Windows - немного другое место :)
----
В свойствах putty, где X11 forwarding, ip можно не писать... если putty и xming на одной машине - лучше оставить пустым... писать IP нужно если форвардишь икс на &quot;соседнюю&quot; машину...
----
;&gt; Ну а как сделать, чтобы не отваливались? screen-а в консоли будет достаточно? Видимо, нет...
:Да, screen в этом случае поможет только тем, что даст возможность посмотреть на вывод ошибки, с которой вылетело окно :-) Если отваливается, вероятно, лучше воспользоваться другим видом удаленного доступа, который возможно восстановить. В этом направлении я еще не эксперементировал.
----
VNC Вас спасет
}}}

!См. также
*[[OpenSSH сервер]]
*[[SSH - работа с PuTTY]]

!Ссылки
#[[Оригинал статьи|http://sudouser.com/udalennoe-podklyuchenie-k-rabochemu-stolu-linux-iz-windows-s-pomoshhyu-xming-i-ssh.html]]
#[[Оригинал статьи|http://debback.blogspot.com]]


</pre>
</div>
<div title="Условные сиволы в HTML (HTML entities)" modifier="Яковлев Иван" created="200906182255" modified="200906182255" tags="CodeSnippets MainMenu" changecount="2">
<pre>''//HTML entities//'' это условные символы HTML кода, позволяющие добавлять в текст специальные символы, которые нальзя ввести с клавиатуру (их там просто нет). В таблице ниже собраны основные сиволы и их //HTML entities//.
/%
Entities in HTML documents allow characters to be entered that can't easily be typed on an ordinary keyboard. They take the form of an ampersand (&amp;), an identifying string, and a terminating semi-colon (;). There's a complete reference [[here|http://www.htmlhelp.com/reference/html40/entities/]]; some of the more common and useful ones are shown below. Also see [[Paul's Notepad|http://thepettersons.org/PaulsNotepad.html#GreekHtmlEntities%20HtmlEntitiesList%20LatinHtmlEntities%20MathHtmlEntities]] for a more complete list.
%/
|&gt;|&gt;|&gt;|&gt;|&gt;|&gt;| !HTML Entities |
| &amp;amp;nbsp; | &amp;nbsp; | no-break space | &amp;nbsp;&amp;nbsp; | &amp;amp;apos; | &amp;apos; | single quote, apostrophe |
| &amp;amp;ndash; | &amp;ndash; | en dash |~| &amp;amp;quot; | &quot; | quotation mark |
| &amp;amp;mdash; | &amp;mdash; | em dash |~| &amp;amp;prime; | &amp;prime; | prime; minutes; feet |
| &amp;amp;hellip; | &amp;hellip; |	horizontal ellipsis |~| &amp;amp;Prime; | &amp;Prime; | double prime; seconds; inches |
| &amp;amp;copy; | &amp;copy; | Copyright symbol |~| &amp;amp;lsquo; | &amp;lsquo; | left single quote |
| &amp;amp;reg; | &amp;reg; | Registered symbol |~| &amp;amp;rsquo; | &amp;rsquo; | right  single quote |
| &amp;amp;trade; | &amp;trade; | Trademark symbol |~| &amp;amp;ldquo; | &amp;ldquo; | left double quote |
| &amp;amp;dagger; | &amp;dagger; | dagger |~| &amp;amp;rdquo; | &amp;rdquo; | right double quote |
| &amp;amp;Dagger; | &amp;Dagger; | double dagger |~| &amp;amp;laquo; | &amp;laquo; | left angle quote |
| &amp;amp;para; | &amp;para; | paragraph sign |~| &amp;amp;raquo; | &amp;raquo; | right angle quote |
| &amp;amp;sect; | &amp;sect; | section sign |~| &amp;amp;times; | &amp;times; | multiplication symbol |
| &amp;amp;uarr; | &amp;uarr; | up arrow |~| &amp;amp;darr; | &amp;darr; | down arrow |
| &amp;amp;larr; | &amp;larr; | left arrow |~| &amp;amp;rarr; | &amp;rarr; | right arrow |
| &amp;amp;lArr; | &amp;lArr; | double left arrow |~| &amp;amp;rArr; | &amp;rArr; | double right arrow |
| &amp;amp;harr; | &amp;harr; | left right arrow |~| &amp;amp;hArr; | &amp;hArr; | double left right arrow |
| &amp;amp;pound; | &amp;pound; | Pound |~|  |  |  |
| &amp;amp;#8364; | &amp;#8364; | Euro |~|  |  |  |
| &amp;amp;yen; | &amp;yen; | Yen |~|  |  |  |
/%
The table below shows how accented characters can be built up by subsituting a base character into the various accent entities in place of the underscore ('_'):
%/
|&gt;|&gt;|&gt;|&gt;|&gt;|&gt;|&gt;|&gt;|&gt;|&gt;|&gt;|&gt;|&gt;|&gt;|&gt;|&gt;|&gt;| !Accented Characters |
| grave accent | &amp;amp;_grave; | &amp;Agrave; | &amp;agrave; | &amp;Egrave; | &amp;egrave; | &amp;Igrave; | &amp;igrave; | &amp;Ograve; | &amp;ograve; | &amp;Ugrave; | &amp;ugrave; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; |
| acute accent | &amp;amp;_acute; | &amp;Aacute; | &amp;aacute; | &amp;Eacute; | &amp;eacute; | &amp;Iacute; | &amp;iacute; | &amp;Oacute; | &amp;oacute; | &amp;Uacute; | &amp;uacute; | &amp;nbsp; | &amp;nbsp; | &amp;Yacute; | &amp;yacute; | &amp;nbsp; | &amp;nbsp; |
| circumflex accent | &amp;amp;_circ; | &amp;Acirc; | &amp;acirc; | &amp;Ecirc; | &amp;ecirc; | &amp;Icirc; | &amp;icirc; | &amp;Ocirc; | &amp;ocirc; | &amp;Ucirc; | &amp;ucirc; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; |
| umlaut mark | &amp;amp;_uml; | &amp;Auml; | &amp;auml; |  &amp;Euml; | &amp;euml; | &amp;Iuml; | &amp;iuml; | &amp;Ouml; | &amp;ouml; | &amp;Uuml; | &amp;uuml; | &amp;nbsp; | &amp;nbsp; | &amp;Yuml; | &amp;yuml; | &amp;nbsp; | &amp;nbsp; |
| tilde | &amp;amp;_tilde; | &amp;Atilde; | &amp;atilde; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;Otilde; | &amp;otilde; | &amp;nbsp; | &amp;nbsp; | &amp;Ntilde; | &amp;ntilde; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; |
| ring | &amp;amp;_ring; | &amp;Aring; | &amp;aring; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; |
| slash | &amp;amp;_slash; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;Oslash; | &amp;oslash; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; |
| cedilla | &amp;amp;_cedil; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;nbsp; | &amp;Ccedil; | &amp;ccedil; |

!Ссылки
TODO


</pre>
</div>
<div title="Устанвока кластера Distributed Replicated Block Device (DRBD)" modifier="Яковлев Иван" created="200906042318" modified="200906061954" tags="[[Установка/настройка сервера]] [[TODO - нужен перевод статьи]]" changecount="3">
<pre>!Описание
Distributed Replicated Block Device (DRBD) mirrors block devices between multiple hosts. The replication is transparent to other applications on the host systems. Any block device hard disks, partitions, RAID devices, logical volumes, etc can be mirrored. 

To get started using drbd, first install the necessary packages. From a terminal enter: 
{{{
sudo apt-get install drbd8-utils
}}}
This section covers setting up a drbd to replicate a separate {{{/srv}}} partition, with an ext3 filesystem between two hosts. The partition size is not particularly relevant, but both partitions need to be the same size.

!Настройка
The two hosts in this example will be called ''drbd01'' and ''drbd02''. They will need to have name resolution configured either through DNS or the {{{/etc/hosts}}} file. See [[Установка контроллера DNS на BIND в Ubuntu]] for details. 

To configure drbd, on the first host edit {{{/etc/drbd.conf}}}: 
{{{
global { usage-count no; }
common { syncer { rate 100M; } }
resource r0 {
        protocol C;
        startup {
                wfc-timeout  15;
                degr-wfc-timeout 60;
        }
        net {
                cram-hmac-alg sha1;
                shared-secret &quot;secret&quot;;
                allow-two-primaries;
        }
        on drbd01 {
                device /dev/drbd0;
                disk /dev/sdb1;
                address 192.168.0.1:7788;
                meta-disk internal;
        }
        on drbd02 {
                device /dev/drbd0;
                disk /dev/sdb1;
                address 192.168.0.2:7788;
                meta-disk internal;
        }
}  	
}}}
There are many other options in {{{/etc/drbd.conf}}}, but for this example their default values are fine. 


Now copy {{{/etc/drbd.conf}}} to the second host: 
{{{
scp /etc/drbd.conf drbd02:~
}}}
And, on ''drbd02'' move the file to {{{/etc}}}: 
{{{
sudo mv drbd.conf /etc/
}}}
Next, on both hosts, start the drbd daemon: 
{{{
sudo /etc/init.d/drbd start
}}}
Now using the drbdadm utility initialize the meta data storage. On each server execute: 
{{{
sudo drbdadm create-md r0
}}}
On the ''drbd01'', or whichever host you wish to be the primary, enter the following: 
{{{
sudo drbdadm -- --overwrite-data-of-peer primary all
}}}
After executing the above command, the data will start syncing with the secondary host. To watch the progresss, on ''drbd02'' enter the following: 
{{{
watch -n1 cat /proc/drbd
}}}
To stop watching the output press ''Ctrl+c''. 

Finally, add a filesystem to {{{/dev/drbd0}}} and mount it: 
{{{
sudo mkfs.ext3 /dev/drbd0
sudo mount /dev/drbd0 /srv
}}}

!Тестирование
To test that the data is actually syncing between the hosts copy some files on the ''drbd01'', the primary, to {{{/srv}}}: 
{{{
sudo cp -r /etc/default /srv
}}}
Next, unmount {{{/srv}}}: 
{{{
sudo umount /srv
}}}
Demote the primary server to the secondary role: 
{{{
sudo drbdadm secondary r0
}}}
Now on the the secondary server promote it to the primary role: 
{{{
sudo drbdadm primary r0
}}}
Lastly, mount the partition: 
{{{
sudo mount /dev/drbd0 /srv
}}}
Using ls you should see {{{/srv/default}}} copied from the former primary host ''drbd01''.

!См. также
*For more information on DRBD see the [[DRBD web site|http://www.drbd.org/]]. 
*The [[drbd.conf man page|http://manpages.ubuntu.com/manpages/jaunty/en/man5/drbd.conf.5.html]] contains details on the options not covered in this guide. 
*Also, see the [[drbdadm man page|http://manpages.ubuntu.com/manpages/jaunty/en/man8/drbdadm.8.html]].

!Ссылки
*[[Описание на ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/drbd.html]]



</pre>
</div>
<div title="Установка .deb вручную" modifier="Яковлев Иван" created="200906032341" modified="200906040933" tags="[[Установка ПО в Ubuntu]]" changecount="3">
<pre>Установить .deb можно и из консоли. Для этого используйте команду:
{{{
sudo dpkg -i имя файла
{{{
Например:
{{{
sudo dpkg -i smplayer_0.6.2_i386.deb
}}}

{{textAlignCenter{
[img[images/articles/sudo-dpkg-install.png]]
}}}
Естественно, вы должны находится в директории, где находится пакет, либо использовать полный путь к этому пакету.

!См. далее
*[[Исправление пакетов с ошибками]]


</pre>
</div>
<div title="Установка Apache и PHP" modifier="Яковлев Иван" created="200906200129" modified="200907021256" tags="[[Настройка Apache]] [[TODO - нужен перевод статьи]] TODO slicehost" changecount="7">
<pre>!Описание
Ubuntu Intrepid Ibex comes with Apache v.2.2.9 and PHP v.5.2.6 and they are easily installed via the default Ubuntu Package Manager 'aptitude'.

The advantage of using aptitude is that you will get any security updates from Ubuntu (if and when distributed) and dependencies are automatically taken care of.

!Установка
A basic Apache install is very easy:
{{{
sudo aptitude install apache2 apache2.2-common apache2-mpm-prefork \
apache2-utils libexpat1 ssl-cert
}}}

!Имя сервера
Towards the end of the install you will see this warning:
{{{
apache2: Could not reliably determine the server's fully qualified domain name,
using 127.0.0.1 for ServerName
}}}
Although I'll be going into some detail about the options and settings available in the main apache configuration file, let's fix that warning straight away.

Open the main apache config:
{{{
sudo nano /etc/apache2/apache2.conf
}}}
At the bottom of the file add the following:
{{{
ServerName demo
}}}
Change the ~ServerName to your Slice hostname or a FQDN (remember this demo Slice has a hostname of 'demo').

Once done, save apache2.conf and gracefully restart Apache (this method of restarting won't kill open connections):
{{{
sudo apache2ctl graceful
}}}
Now the warning has gone. Nice.

!Страница по умолчанию
If you navigate to your Slice IP address:
{{{
http://123.45.67.890
}}}
You will see the default 'It works!' screen.

Now we have the base Apache install completed, we can move onto installing PHP. If you don't require PHP then please feel free to skip the next section.

!Установка PHP
In this example, I'm not going to install all the modules available. Just some common ones.

To see what modules are available try a:
{{{
sudo aptitude search php5-
}}}
Note the '-' at the end of 'php5'. This will show any packages that start with 'php5-' and shows the available modules.

As before, due to using aptitude to install ~PHP5, any dependencies are taken care of:
{{{
sudo aptitude install libapache2-mod-php5 php5 php5-common php5-curl php5-dev php5-gd \
php5-imagick php5-mcrypt php5-memcache php5-mhash php5-mysql php5-pspell php5-snmp \
php5-sqlite php5-xmlrpc php5-xsl
}}}
Once done, do a quick Apache reload:
{{{
sudo /etc/init.d/apache2 reload
}}}
Done.

Well, almost done. We do need to configure Apache for our setup so we can host multiple sites and so on. The next articles will go through the [[Описание окружения Apache применительно к Ubuntu]] as it differs slightly from the 'classic' layout you might expect if you had installed from source.

!Ссылки
*[[Оригинал статьи на slicehost.com|http://articles.slicehost.com/2008/12/11/ubuntu-intrepid-installing-apache-and-php5]]


</pre>
</div>
<div title="Установка DNS сервера PowerDNS с поддержкой MYSQL веб интерфейсом Power admin" modifier="Яковлев Иван" created="200906052126" tags="[[Установка/настройка сервера]] TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/ustanovka-dns-servera-powerdns-s-podderzhkoj-mysql-veb-interfejsom-power-admin.html#more-189]]



</pre>
</div>
<div title="Установка FTP сервера" modifier="Яковлев Иван" created="200906142244" modified="200906191602" tags="[[Установка/настройка сервера]] slider" changecount="5">
<pre>#[[Стандартный вариант|Установка FTP сервера vsftpd - стандартный вариант]]
#[[Совместно с MySQL|Установка FTP сервера vsftpd совместно с MySQL]]
#[[Виртуальные FTP|Виртуальный FTP-сервер на основе  ProFTP]]</pre>
</div>
<div title="Установка FTP сервера vsftpd - стандартный вариант" modifier="Яковлев Иван" created="200906042254" modified="200906261803" tags="[[Установка FTP сервера]] [[TODO - нужен перевод статьи]]" changecount="7">
<pre>!Описание
File Transfer Protocol (FTP) is a TCP protocol for uploading and downloading files between computers. FTP works on a client/server model. The server component is called an FTP daemon. It continuously listens for FTP requests from remote clients. When a request is received, it manages the login and sets up the connection. For the duration of the session it executes any of commands sent by the FTP client. 

Access to an FTP server can be managed in two ways:
*Anonymous
*Authenticated

In the Anonymous mode, remote clients can access the FTP server by using the default user account called &quot;anonymous&quot; or &quot;ftp&quot; and sending an email address as the password. In the Authenticated mode a user must have an account and a password. User access to the FTP server directories and files is dependent on the permissions defined for the account used at login. As a general rule, the FTP daemon will hide the root directory of the FTP server and change it to the FTP Home directory. This hides the rest of the file system from remote sessions.

!Установка
vsftpd is an FTP daemon available in Ubuntu. It is easy to install, set up, and maintain. To install vsftpd you can run the following command: 
{{{
sudo aptitude install vsftpd
}}}

!Настройка для анонимного доступа
By default vsftpd is configured to only allow anonymous download. During installation a ftp user is created with a home directory of {{{/home/ftp}}}. This is the default FTP directory. 

If you wish to change this location, to {{{/srv/ftp}}} for example, simply create a directory in another location and change the ftp user's home directory:
{{{
sudo mkdir /srv/ftp
sudo usermod -d /srv/ftp ftp 
}}}

After making the change restart vsftpd: 
{{{
sudo /etc/init.d/vsftpd restart
}}}
Finally, copy any files and directories you would like to make available through anonymous FTP to {{{/srv/ftp}}}.

!Настройка для авторизованного доступа
To configure vsftpd to authenticate system users and allow them to upload files edit {{{/etc/vsftpd.conf}}}: 
{{terminal{
{{{
local_enable=YES
write_enable=YES
}}}
}}}
Now restart vsftpd: 
{{{
sudo /etc/init.d/vsftpd restart
}}}
Now when system users login to FTP they will start in their home directories where they can download, upload, create directories, etc. 

Similarly, by default, the anonymous users are not allowed to upload files to FTP server. To change this setting, you should uncomment the following line, and restart vsftpd: 
{{{
anon_upload_enable=YES
}}}
{{note{
@@font-weight: bold;color: red;ВНИМАНИЕ:@@
Enabling anonymous FTP upload can be an extreme security risk. It is best to not enable anonymous upload on servers accessed directly from the Internet.
}}}
The configuration file consists of many configuration parameters. The information about each parameter is available in the configuration file. Alternatively, you can refer to the man page, man 5 vsftpd.conf for details of each parameter.

!Защита FTP
There are options in {{{/etc/vsftpd.conf}}} to help make vsftpd more secure. For example users can be limited to their home directories by uncommenting:
{{terminal{
{{{
chroot_local_user=YES
}}}
}}}
You can also limit a specific list of users to just their home directories: 
{{terminal{
{{{
chroot_list_enable=YES
chroot_list_file=/etc/vsftpd.chroot_list
}}}
}}}
After uncommenting the above options, create a {{{/etc/vsftpd.chroot_list}}} containing a list of users one per line. Then restart vsftpd: 
{{{
sudo /etc/init.d/vsftpd restart
}}}
Also, the {{{/etc/ftpusers file}}} is a list of users that are disallowed FTP access. The default list includes root, daemon, nobody, etc. To disable FTP access for additional users simply add them to the list. 

FTP can also be encrypted using FTPS. Different from SFTP, FTPS is FTP over Secure Socket Layer (SSL). SFTP is a FTP like session over an encrypted SSH connection. A major difference is that users of SFTP need to have a shell account on the system, instead of a nologin shell. Providing all users with a shell may not be ideal for some environments, such as a shared web host. 

To configure FTPS, edit {{{/etc/vsftpd.conf}}} and at the bottom add: 
{{terminal{
{{{
ssl_enable=Yes
}}}
}}}
Also, notice the certificate and key related options: 
{{terminal{
{{{
rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem
rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key
}}}
}}}
By default these options are set the the certificate and key provided by the ssl-cert package. In a production environment these should be replaced with a certificate and key generated for the specific host. For more information on certificates see the section called “Certificates”. 

Now restart vsftpd, and non-anonymous users will be forced to use FTPS: 
{{{
sudo /etc/init.d/vsftpd restart
}}}
To allow users with a shell of {{{/usr/sbin/nologin}}} access to FTP, but have no shell access, edit {{{/etc/shells}}} adding the nologin shell: 
{{terminal{
{{{
# /etc/shells: valid login shells
/bin/csh
/bin/sh
/usr/bin/es
/usr/bin/ksh
/bin/ksh
/usr/bin/rc
/usr/bin/tcsh
/bin/tcsh
/usr/bin/esh
/bin/dash
/bin/bash
/bin/rbash
/usr/bin/screen
/usr/sbin/nologin
}}}
}}}
This is necessary because, by default vsftpd uses PAM for authentication, and the {{{/etc/pam.d/vsftpd}}} configuration file contains: 
{{terminal{
{{{
auth    required        pam_shells.so
}}}
}}}
The shells PAM module restricts access to shells listed in the {{{/etc/shells}}} file. 

Most popular FTP clients can be configured connect using FTPS. The lftp command line FTP client has the ability to use FTPS as well.

!См. также
*[[Установка FTP сервера vsftpd совместно с MySQL]]
*See the [[vsftpd website|http://vsftpd.beasts.org/vsftpd_conf.html]] for more information. 
*For detailed {{{/etc/vsftpd.conf}}} options see the [[vsftpd.conf man page|http://manpages.ubuntu.com/manpages/jaunty/en/man5/vsftpd.conf.5.html]]. 
*The ~CodeGurus article [[FTPS vs. SFTP: What to Choose has|http://www.codeguru.com/csharp/.net/net_general/internet/article.php/c14329]] useful information contrasting FTPS and SFTP.

!Ссылки
*[[Описание на ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/ftp-server.html]]



</pre>
</div>
<div title="Установка FTP сервера vsftpd совместно с MySQL" modifier="Яковлев Иван" created="200906142245" modified="200906261805" tags="[[Установка FTP сервера]] TODO" changecount="20">
<pre>!Описание
Vsftpd считается одним из самых быстрых и хорошо защищенных FTP серверов под Linux. Обычно он устанавливается и конфигурируется под пользователей зарегистрированных в системе. В этом руководстве предполагается установка vsftpd под виртуальных пользователей, зарегистрированных в базе данных ~MySQL.

Такое решение позволяет открыть и управлять до тысячи ftp пользователей на одном сервере.
Управлять ~MySQL базой вы можете с помощью пакета phpMyAdmin.
Он имеет достаточно удобный графический интерфейс, который позволяет не применять командную строку.

Использовался дистрибутив Ubuntu 7.10. Все пакеты взяты из штатных репозитариев.

!Установка
Vsftpd собран без поддержки ~MySQL, по этой причине неоходимо установить пакет libpam-mysql для PAM аутентификацию в ~MySQL базе данных. таким образом мы должны установить следующие пакеты libpam-mysql совместно с vsftpd, ~MySQL, и пакет phpMyAdmin:
{{{
sudo aptitude install vsftpd libpam-mysql mysql-server mysql-client phpmyadmin
}}}
Далее необходимо назначить пароль для пользователя root для управления ~MySQL (замените слово yourrootsqlpassword на ваш настоящий пароль) :
{{{
mysqladmin -u root password yourrootsqlpassword
}}}
проверим все ли получилось?
{{{
netstat -tap | grep mysql
}}}
должно написать:
{{{
tcp 0 0 localhost.localdo:mysql *:* LISTEN 2713/mysqld
}}}
Это если у вас имя хоста только локальное localhost.localdomain, в противном случае вы увидите что-то типа:
{{{
tcp 0 0 *:mysql *:* LISTEN 2713/mysqld
}}}
Для смены пароля вашей базы данных ~MySQL под ваш hostname, примените следующую команду:
{{{
mysqladmin -h server1.example.com -u root password yourrootsqlpassword
}}}

!Настройка
!!Созание базы данных &quot;vsftpd&quot;
С помощью phpMyAdmin создаем пользователя vsftpd с полными правами на одноименную базу данных, где будут хранится учетные записи зарегистрированных пользователей.

!!Создание таблицы &quot;accounts&quot;
{{{
CREATE TABLE `accounts` (
    `id` INT NOT NULL AUTO_INCREMENT PRIMARY KEY ,
    `username` VARCHAR( 30 ) NOT NULL ,
    `pass` VARCHAR( 50 ) NOT NULL ,
    UNIQUE (
        `username`
    )
) ENGINE = MYISAM ;
}}}

!!Добавление тестового пользователя &quot;testuser&quot;
Выполняем SQL запрос:
{{{
INSERT INTO accounts (username, pass) VALUES('testuser', PASSWORD('secret'));
}}}

!!Конфигурируем vsftpd
В начале создаем непривилегированного пользователя ''vsftpd'' (с домашней директорией: {{{/home/vsftpd}}}) входящего в группу: ''nogroup''. Домашние директории виртуальных пользователей, в дальнейшем будут расположены в этой {{{/home/vsftpd}}} директории (например: {{{/home/vsftpd/user1}}}, {{{/home/vsftpd/user2}}}, и т.д.).
{{{
useradd --home /home/vsftpd --gid nogroup -m --shell /bin/false vsftpd
}}}
Сохраняем оригинальный {{{/etc/vsftpd.conf}}} файл и создаем другой:
{{{
cp /etc/vsftpd.conf /etc/vsftpd.conf_orig
cat /dev/null &gt; /etc/vsftpd.conf
gedit /etc/vsftpd.conf
}}}
Вставляем в открывшееся окно следующий текст:
{{terminal{
{{{
listen=YES
anonymous_enable=NO
local_enable=YES
write_enable=YES
local_umask=022
dirmessage_enable=YES
xferlog_enable=YES
connect_from_port_20=YES
nopriv_user=vsftpd
chroot_local_user=YES
secure_chroot_dir=/var/run/vsftpd
pam_service_name=vsftpd
rsa_cert_file=/etc/ssl/certs/vsftpd.pem
guest_enable=YES
guest_username=vsftpd
local_root=/home/vsftpd/$USER
user_sub_token=$USER
virtual_use_local_privs=YES
user_config_dir=/etc/vsftpd_user_conf
}}}
}}}
сохраняем созданный файл.
Посмотреть примеры можно по адресу: http://vsftpd.beasts.org/vsftpd_conf.html

Для использования в дальнейшем опций: ''user_config_dir'', создадим вновь специальную директорию:
{{{
mkdir /etc/vsftpd_user_conf
}}}
В эту директорию в дальнейшем вы можете класть файлы конфигурации VSFTPD для отдельных пользователей.

Так же должны сконфигурировать PAM для ваших виртуальных FTP пользователей с аутентификацией в ~MySQL базе данных вместо расположения в {{{/etc/passwd}}} и {{{/etc/shadow}}}. Конфигурационный файл для PAM под vsftpd должен находится в папке {{{/etc/pam.d/vsftpd}}}. Сохраняем оригинальный и создаем новый:
{{{
cp /etc/pam.d/vsftpd /etc/pam.d/vsftpd_orig
cat /dev/null &gt; /etc/pam.d/vsftpd
gedit /etc/pam.d/vsftpd
}}}
Вставляем в открывшееся окно следующий текст:
{{terminal{
{{{
auth required pam_mysql.so user=vsftpd passwd=ftpdpass host=localhost db=vsftpd table=accounts usercolumn=username passwdcolumn=pass crypt=2
account required pam_mysql.so user=vsftpd passwd=ftpdpass host=localhost db=vsftpd table=accounts usercolumn=username passwdcolumn=pass crypt=2
}}}
}}}
Сохраняем этот файл.
{{note{
''ЗАМЕЧАНИЕ:''
crypt(0) -- флаг, устанавливающий какая функция шифрования паролей используется: функция ~MySQL PASSWORD() или функция crypt(). Доступны следующие значения:
*0 -- Нет шифрования. Парол является обычным текстом (Крайне не рекомендуется из-за небезопасности)
*1 -- используется crypt
*2 -- используется фстроенная функция ~MySQL PASSWORD()
}}}
Перезапустим наш vsftpd сервер:
{{{
/etc/init.d/vsftpd restart
}}}

!!Создаем первого виртуального пользователя
Заходим в phpMyAdmin и cоздаем пользователяпод именем: testuser и паролем secret.

Домашняя директория testuser’а будет здесь {{{/home/vsftpd/testuser}}}. Если она не создалась автоматически, создадим эту директорию вручную в группе: ''nogroup'':
{{{
mkdir /home/vsftpd/testuser
chown vsftpd:nogroup /home/vsftpd/testuser
}}}
Теперь через любой FTP клиент для Linux или Windows, или используя просто браузер, вы можете соединится c вновь созданным сервером, используя имя testuser и пароль secret.

!Скрипт для автоматизации настроек пользователей
Для создания и администрирования пользователей вашего фтп сервера вы можете использовать скрипт любезно предоставленный Александром Астаповым.

Скрипт позволяет создавать, изменять, удалять пользователей (с созданием резервной копии домашней директории), работать с их домашними каталогами, менять пароли, просматривать всех пользователей. Скрипт полностью настраивем под ваши нужды, а именно имя базы, корневая директория для каталогов пользователей, минимальная длинна паролей, и т.д. 

&lt;&lt;slider &quot;chk-listing-pam&quot; [[Листинг скрипта для автоматизации настроек пользователей]] &quot;Показать/Скрыть Листинг скрипта для автоматизации настроек пользователей&quot; &quot;Показать/Скрыть Листинг скрипта для автоматизации настроек пользователей&quot;&gt;&gt;

{{note{
Вот спасибо, класная статья. Именно то что я хотел - что бы для каждого пользователя можно точно настроить доступ. Единственно, может кому полезно будет, я добавил так в конфиге:
{{terminal{
{{{
anonymous_enable=YES # включ anonymous
anon_upload_enable=NO # запрешаем ему загружать
anon_mkdir_write_enable=NO # и делать директории
anon_root=/home/ftp/anonymous/ # перенаправляем его в нужную директорию
}}}
}}}
и вот так можно подключать директори:
{{{
sudo mount -o bind /здесь/путь/папки/что/я/хочу/расшарить/ /home/ftp/anonymous/
}}}
Что бы сделать это при загрузке системы, прописываем в:
{{{
sudo gedit /etc/fstab
}}}
----
;Объясните ломаке как прикрутить данный скрипт к тому что предложено здесь и как он запускаестся.
:В начале скрипта измените пути к домашним директриям, а так же имя базы, пользователя к ней и пароль. Потом просто запустите скрипт, и следуйте подсказкам.

----
;спасибо, вроде разобрался. Жалко только маунтить приходится руками нужные директории пользователям (( не знаете средств автоматизации данных процессов? И как некоторым пользователям можно давать права на запись и выход из домашней директории?
:Директории создаются скриптом, поменяйте путь в нем, что бы создавались где надо, и не надо маунтить будет. Включить запись для юзеров можно добавив в директорию для конфигов юзеров (смотри в посте где она) файл с названием соответствующим логину юзера, туда строку {{{write_enable=YES}}} Про выход из домашней директории не помню, почитайте ман к vsftpd.
}}}

!См. также
*[[Хранение информации о пользователях корпоративной системы в БД MySQL для всех используемых сервисов|http://avist.biz/article/show/31.html]]

!Ссылки
*[[Оригинал статьи|http://sudouser.com/ustanovka-i-nastrojka-vsftpd-mysql-ubuntu-debian]]
*http://sudouser.com/skript-dlya-upravleniya-polzovatelyami-vsftpd.html
*http://howtoforge.com/vsftpd_mysql_debian_etch
*http://vsftpd.beasts.org


</pre>
</div>
<div title="Установка Jabber сервера" modifier="Яковлев Иван" created="200906062031" modified="200906062050" tags="[[Установка/настройка сервера]] [[TODO - нужен перевод статьи]]" changecount="7">
<pre>!Описание из Википедии
Jabber [ˈʤæbə(r)], джа́ббер (досл. пер. с англ. — болтовня, трёп; тарабарщина) — система мгновенного обмена сообщениями и информацией о присутствии на основе открытого протокола XMPP.

В отличие от коммерческих систем мгновенных сообщений, таких, как AIM, ICQ, MSN и Yahoo, Jabber является децентрализованной, расширяемой и открытой системой. Любой желающий может открыть свой сервер мгновенных сообщений, регистрировать на нём пользователей и взаимодействовать с другими серверами Jabber. На основе протокола XMPP уже открыто множество частных и корпоративных серверов Jabber. Среди них есть достаточно крупные проекты, такие как Google Talk, Я.Онлайн, Gizmo, ~LiveJournal, Diary.ru и QIP Infium.

!Зачем тебе Jabber сервер?
Many people love IM (Instant Messaging) and many of these should run their own server. 

Jabber is an XML based cross platform chat and messenging server which is freely available. It runs on Linux, Solaris, and many other Unix variants. For a small office or a collection of offices it's a great way to allow people to chat without resorting to outside services such as MSN, Yahoo, Icq. The beauty of this distributed system is in its flexibility: anyone can set up a Jabber server and use it however they wish. It can be used in a closed &quot;environment&quot; or it can join the growing worldwide network.

!Установка
In Hoary the easy way to obtain a Jabber server is run 
{{{
sudo apt-get update
sudo apt-get install jabber
}}}
done. 

On server side, you should do common operations for system daemons: 
*Stop the server
{{{
sudo /etc/init.d/jabber stop
}}}
*Start the server
{{{
sudo /etc/init.d/jabber start
}}}
*Restart the server
{{{
sudo /etc/init.d/jabber restart
}}}
If you need additional &quot;transport&quot; to other IM you should install the following: 
*''jabber-aim'' - Provides AIM messenger transport for Jabber IM server
*''jabber-jit'' - Jabber ICQ Transport
*''jabber-msn'' - Provides the MSN transport for the Jabber IM server
*''jabber-yahoo'' - Provides Yahoo messenger transport for Jabber IM server

or check yourself what kind of packages are related to jabber: 
{{{
apt-cache search jabber
}}}

!Базовая настройка
For a very basic configuration you should look at {{{/etc/jabber/jabber.cfg}}} file where you'll find something like that: 
{{{
JABBER_HOSTNAME=localhost
JABBER_SPOOL=/var/lib/jabber
}}}
Where the ~JABBER_HOSTNAME is the running server hostname (&quot;localhost&quot; by default), and ~JABBER_SPOOL is the &quot;spool&quot; directory where temporary file are stored. These variables are then passed to jabberd in the {{{-h}}} switch. 

In small &quot;environments&quot; you should have a running DNS system and it is useful to setup your IM hostname. For example, if your hostname is &quot;jabber.mydomain&quot; the resulting {{{jabber.cfg}}} will be: 
{{{
JABBER_HOSTNAME=jabber.mydomain
}}}

!Продвинутая настройка
For advanced configuration you should look at {{{/etc/jabber/jabber.xml}}} file where are all the setting for your Jabber Server, well commented. Appart the hostname note, the default settings should be right for almost server implementations. 

Scripts: 
{{{
#1: Sample for Yahoo-Transport 

&lt;jabber&gt;
    &lt;service id=&quot;yahoo-linker&quot;&gt;
        &lt;connect&gt;
            &lt;ip&gt;&lt;/ip&gt;
            &lt;port&gt;&lt;/port&gt;
            &lt;secret&gt;&lt;/secret&gt;
        &lt;/connect&gt;
        &lt;uplink/&gt;
    &lt;/service&gt;
  &lt;pidfile&gt;./yahoo-jabber.pid&lt;/pidfile&gt;

  &lt;service id=&quot;yahoo.example.com&quot;&gt;

&lt;load&gt;&lt;yahoo_transport&gt;/path/to/yahoo-transport.so&lt;/yahoo_transport&gt;&lt;/load&gt;
    &lt;config xmlns=&quot;jabber:config:yahoo&quot;&gt;
      &lt;vCard&gt;
        &lt;NAME&gt;Yahoo Transport&lt;/NAME&gt;
      &lt;/vCard&gt;
      &lt;server&gt;scs.yahoo.com&lt;/server&gt;
      &lt;port&gt;5050&lt;/port&gt;
      &lt;charmap&gt;CP1252&lt;/charmap&gt;
    &lt;/config&gt;
  &lt;/service&gt;
&lt;/jabber&gt;
}}}

!Управление пользовательскими аккаунтами
If you want to control the registration process are needed some changes in the configuration file. You can disable registrations commenting out certain sections, for e.g. the {{{&lt;register&gt;}}} and the {{{&lt;mod_register&gt;}}} tags, which are in different parts of the file. 
{{{
&lt;register notify=&quot;yes&quot;&gt;
  &lt;instructions&gt;
  Choose a username and password to register with this server.
  &lt;instructions&gt;
  &lt;name/&gt;
  &lt;email/&gt;
&lt;register&gt;
}}}
and 
{{{
&lt;mod_register&gt;./jsm/jsm.so&lt;/mod_register&gt;
}}}

!Конференция
With the conference service you have group chat rooms, either public or private. Fot that you need to install jabber-jud with the command sudo apt-get install jabber-jud. After that edit the jabber.xml configuration file and add something like that: 
{{{
&lt;browse&gt;
  &lt;conference type=&quot;private&quot; jid=&quot;conference.localhost&quot; name=&quot;Private Conferencing&quot;/&gt;
&lt;/browse&gt;
}}}
to restrict access to the rooms to local account holders (example) and the following code: 
{{{
&lt;service id='conference.localhost'&gt;
  &lt;load&gt;&lt;conference&gt;/usr/lib/jabber/conference.so&lt;/conference&gt;&lt;/load&gt;
    &lt;conference xmlns=&quot;jabber:config:conference&quot;&gt;
      &lt;private/&gt;
      &lt;history&gt;30&lt;/history&gt;
      &lt;vCard&gt;
        &lt;FN&gt;Private Conferences&lt;/FN&gt;
        &lt;DESC&gt;This service is for private conferencing rooms.&lt;/DESC&gt;
        &lt;URL&gt;http://foo.bar/&lt;/URL&gt;
      &lt;/vCard&gt;
      &lt;notice&gt;
      &lt;join&gt; has joined&lt;/join&gt;
      &lt;leave&gt; has left&lt;/leave&gt;
      &lt;rename&gt; is now known as &lt;/rename&gt;
      &lt;/notice&gt;
    &lt;/conference&gt;
&lt;/service&gt;
}}}
Restart the server and log in again. You will be able to show Private Conferencing and create a conference room. You can then invite others to join in the conference room.

!Советы
Connecting to the server with your client appear this message &quot;There was an error authenticating with jabber server. Details: Unauthorized&quot;? Many references say that this is due to SSL directive: you need to set your IP with {{{&lt;ssl port='5223'&gt;}}} and restart the server. 

To test the connection try this: 
{{{
sudo netstat -an | grep -E '5222|5269'
}}}
If these ports are &quot;LISTEN&quot;ing it's all right.

Disabling registration, you need to create the user accounts manually.

!Ссылки
*[[Официальный сайт Jaber.org|http://www.jabber.org/]]
*[[Описание по настройке сервера на ubuntu.com|https://help.ubuntu.com/community/SettingUpJabberServer]]
*[[Описание на Википедии|http://ru.wikipedia.org/wiki/Jabber]]


</pre>
</div>
<div title="Установка MediaWiki" modifier="Яковлев Иван" created="200906042041" modified="200906042049" tags="[[Установка/настройка Web-сервера]] [[TODO - нужен перевод статьи]]" changecount="5">
<pre>!Описание
~MediaWiki is an web based Wiki software written in the PHP language. It can either use ~MySQL or ~PostgreSQL Database Management System.

!Установка
Before installing ~MediaWiki you should also install Apache 2, the ~PHP5 scripting language and Database a Management System. ~MySQL or ~PostgreSQL are the most common, choose one depending on your need. Please refer to those sections in this manual for installation instructions. 

To install ~MediaWiki, run the following command in the command prompt:
{{{
sudo apt-get install mediawiki php5-gd
}}}
For additional ~MediaWiki functionality see the mediawiki-extensions package.

!Настройка
Run the following commands to configure ~MediaWiki: 
{{{
sudo ln -s /var/lib/mediawiki /var/www/mediawiki
}}}
Point your web browser to the following URL for ~MediaWiki setup:
{{{
http://localhost/mediawiki/config/index.php 	
}}}
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
Please read the “Checking environment...” section in this page. You should be able to fix many issues by carefully reading this section.
}}}

!Дополнительные материалы
*For more details, please refer to the [[MediaWiki|http://www.mediawiki.org/]] web site. 
*The [[MediaWiki Administrators’ Tutorial Guide|http://www.packtpub.com/Mediawiki/book]] contains a wealth of information for new ~MediaWiki administrators.

!Ссылки
*[[Описание на ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/mediawiki.html]]



</pre>
</div>
<div title="Установка Midnight Commander в Debian/Ubuntu" modifier="Яковлев Иван" created="200906211736" modified="200906211743" tags="MidnightCommander" changecount="5">
<pre>!Установка последней версии MC
Загрузите последнюю доступную версию deb пакета Midnight Commander для установки в системах Debian/Ubuntu по ссылке: http://people.redhat-club.org/inf/mc-slavaz/debian/ После загрузки deb пакета откройте терминал и при необходимости измените каталог на тот, в который был загружен deb пакет. Затем выполните следующую команду для установки:
{{{
sudo dpkg -i &lt;название_пакета.deb&gt;
}}}

Пример:
{{{
sudo dpkg -i sudo dpkg -i mc_4.6.3~svn49-1_i386.deb
}}}
{{note{
''ЗАМЕЧАНИЕ:''
Для избежания возможных проблем с установкой или обновлением пакета, либо при наличии проблемы, блокирующей использование и работу в Midnight Commander рекомендуется полностью удалить установленную версию:
{{{
sudo dpkg -P mc
}}}
}}}
После этого можно установить последнюю доступную сборку: http://people.redhat-club.org/inf/mc-slavaz/debian/

!Установка из репозитария пакетов
Установка пакета mc из репозитария системы выполняется командой:
{{{
sudo aptitude install mc
}}}
{{note{
''ЗАМЕЧАНИЕ:''
Если Вы нашли ошибку в работе какой-либо функции файлового менеджера mc, либо у Вас есть пожелания или замечания по улучшению его работы и функционала -- используйте баг трекер для непосредственной связи с разработчиками.
}}}

!См. также
*[[Эта статья в формате PDF|data/Linux - MC/Install Midnight commander on Debian_Ubuntu.pdf]]
*[[Горячие клавиши MC|data/Linux - MC/HotKey Midnight Commander (PDF).pdf]]

!Ссылки
*Официальный сайт проекта: http://www.midnight-commander.org/
*Раздел на Википедии: http://ru.wikipedia.org/wiki/Midnight_Commander

*Информация о проекте: http://people.redhat-club.org/slavaz/trac/wiki/ProjectMc
*Список основных изменений: http://people.redhat-club.org/slavaz/trac/wiki/ChangesMc
*Часто задаваемые вопросы: http://people.redhat-club.org/slavaz/trac/wiki/FaqMc
*Горячие клавиши MC: http://people.redhat-club.org/slavaz/trac/wiki/HotKeyMc
*Страница загрузки MC: http://people.redhat-club.org/slavaz/trac/wiki/DownLoadMc
*Сообщить о ошибке/Написать пожелание: http://people.redhat-club.org/slavaz/trac/newticket


</pre>
</div>
<div title="Установка MySQL в Ubuntu" modifier="Яковлев Иван" created="200906041656" modified="200906231547" tags="[[Настройка MySQL]] [[TODO - нужен перевод статьи]]" changecount="7">
<pre>!Описание
~MySQL is a fast, multi-threaded, multi-user, and robust SQL database server. It is intended for mission-critical, heavy-load production systems as well as for embedding into mass-deployed software.

!Установка
To install ~MySQL, run the following command from a terminal prompt: 
sudo apt-get install mysql-server

During the installation process you will be prompted to enter a password for the ~MySQL root user. 

Once the installation is complete, the ~MySQL server should be started automatically. You can run the following command from a terminal prompt to check whether the ~MySQL server is running: 
{{{
sudo netstat -tap | grep mysql
}}}
When you run this command, you should see the following line or something similar: 
{{{
tcp        0      0 localhost:mysql         *:*                     LISTEN      2556/mysqld
}}}
If the server is not running correctly, you can type the following command to start it: 
{{{
sudo /etc/init.d/mysql restart
}}}

!Настройка
You can edit the {{{/etc/mysql/my.cnf}}} file to configure the basic settings -- log file, port number, etc. For example, to configure ~MySQL to listen for connections from network hosts, change the bind_address directive to the server's IP address:
{{{
bind-address            = 192.168.0.5 	
}}}
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
Replace 192.168.0.5 with the appropriate address. 
}}}
After making a change to /etc/mysql/my.cnf the mysql daemon will need to be restarted:
{{{
sudo /etc/init.d/mysql restart
}}}
If you would like to change the ~MySQL root password, in a terminal enter: 
sudo dpkg-reconfigure mysql-server-5.0

The mysql daemon will be stopped, and you will be prompted to enter a new password.

!Дополнительные материалы
*See the [[MySQL Home Page|http://www.mysql.com/]] for more information. 
*The ~MySQL Handbook is also available in the mysql-doc-5.0 package. To install the package enter the following in a terminal:
{{{
sudo apt-get install mysql-doc-5.0
}}}
The documentation is in HTML format, to view them enter {{{file:///usr/share/doc/mysql-doc-5.0/refman-5.0-en.html-chapter/index.html}}} in your browser's address bar. 
*For general SQL information see [[Using SQL Special Edition|http://www.informit.com/store/product.aspx?isbn=0768664128]] by Rafe Colburn.

!См. также
*[[Установка и настройка LAMP+SSL+SVN+Trac]]

!Ссылки
*[[Описание на manpages.ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/mysql.html]]



</pre>
</div>
<div title="Установка Network File System (NFS)" modifier="Яковлев Иван" created="200906042257" tags="[[Установка/настройка сервера]] TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Описание на ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/network-file-system.html]]



</pre>
</div>
<div title="Установка Nginx из исходных кодов" modifier="Яковлев Иван" created="200906200050" modified="200907021301" tags="[[Настройка Nginx]] slicehost [[TODO - нужен перевод статьи]]" changecount="11">
<pre>!Описание
At the time of writing, the latest stable version of Nginx is 0.6.35. You can check the latest versions and change logs at the main nginx site. Do note that Nginx is also available from Intrepid's 'aptitude' package manager as version 0.6.32, at the time of writing.

Using the package manager will ensure any dependencies are taken care of and any security issue (if any arise) are taken care of with a simple update. Please see [[Установка Nginx через aptitude]].

!Окружение
One final difference that is worth considering is the layout differences between using the packaged version and installing from source. 
Ubuntu's packaged version of Nginx uses a 'sites-available' and 'sites-enabled' layout in the same manner as a Debian based Apache install.

Although installing from source does not automatically create this layout, I will show how to adjust the folders and config files to do so. 
Mirroring the layout used in the packed version of Nginx gives us 'common ground' when moving on to creating virtual hosts and further configuration articles.

!Зависимости
As we are not using the package manager to install nginx, we need to take care of some dependencies. The dependencies list can be generated with aptitude:
{{{
aptitude show nginx
...
Depends: libc6 (&gt;= 2.4), libpcre3 (&gt;= 7.4), libssl0.9.8 (&gt;= 0.9.8f-5), zlib1g
         (&gt;= 1:1.1.4), lsb-base (&gt;= 3.2-14)
...
}}}
It turns out that a few additional, related packages are needed to successfully install nginx from source -- one of the hazards of source installs, and a sign that package managers aren't always 100% accurate in their dependency tracking. But altogether not too many packages are required:
{{{
sudo aptitude install libc6 libpcre3 libpcre3-dev libpcrecpp0 libssl0.9.8 \
libssl-dev zlib1g zlib1g-dev lsb-base
}}}

!Download
Now we can download the source code.

Create a 'sources' directory (you can download it to wherever you want):
{{{
mkdir ~/sources
}}}
Now move into the folder:
{{{
cd ~/sources/
}}}
And then download the source code:
{{{
wget http://sysoev.ru/nginx/nginx-0.6.35.tar.gz
}}}

!Unpack
Unpack the downloaded tar file and move into the newly created directory:
{{{
tar -zxvf nginx-0.6.35.tar.gz
...
cd nginx-0.6.35/
}}}

!Options
There are quite a few compile time options available. Have a look at the Install Options page of the nginx wiki for full details. We're going to use just two options to customise the install. The first of which is:
{{{
--sbin-path=/usr/local/sbin
}}}
By default, nginx will be installed in {{{/usr/local/nginx}}} which, although a good place, does mean the main nginx binary will be found in {{{/usr/local/nginx/sbin/nginx}}}.

Not a location we are likely to find in our default search paths. So instead of adding new directories to our path (which may cause errors later on) we simply define where to put the binary.

The second option is:
{{{
--with-http_ssl_module
}}}
Probably self explanatory, but this will enable the ssl module to be compiled so we can parse HTTPS requests.

!Compile
Let's go ahead and compile nginx using those two options:
{{{
./configure --sbin-path=/usr/local/sbin --with-http_ssl_module
}}}
There will be a nice summary at the end of the compile which includes such items as:
{{{
...
nginx path prefix: &quot;/usr/local/nginx&quot;
nginx binary file: &quot;/usr/local/sbin&quot;
nginx configuration prefix: &quot;/usr/local/nginx/conf&quot;
nginx pid file: &quot;/usr/local/nginx/logs/nginx.pid&quot;
...
}}}
Keep a note of the output as it does contain some useful paths and locations.

!Make
Ok, let's go ahead and 'make' and then 'make install':
{{{
make
...
sudo make install
}}}

!Defaults
Done. We can test the install by starting nginx:
{{{
sudo /usr/local/sbin/nginx
}}}
Navigating to your Slice's IP address (assuming you have no other server listening on port 80), you will be greeted with the standard welcome page:

{{textAlignCenter{
[img[images/articles/nginx-welcome.jpg]]
}}}

!Stop
If you have been running Apache or some other web server (or have previously installed Nginx via a package manager), you may be used to having a script to start and stop it, such as you might find in '{{{/etc/init.d/}}}'. Unfortunately, compiling from source does not create a script like that (we will create an init script in a subsequent article).

You may have noticed that one of the paths noted in the compile summary was:
{{{
nginx pid file: &quot;/usr/local/nginx/logs/nginx.pid&quot;
}}}
Let's make use of that to stop nginx:
{{{
sudo kill `cat /usr/local/nginx/logs/nginx.pid`
}}}
That will use the output of the pid file to kill the nginx process -- note the use of back ticks ( {{{` `}}} ) and not single quotes ( {{{' '}}} ) in the command.

!Заключение
Although quite detailed, we have installed the latest version of nginx from source and compiled it with some custom options to make life slightly easier. We also know how to start and stop nginx by hand. 

As mentioned, the next couple of articles will cover creation of an init script so we have more control over Nginx, and also mirroring the 'Debian' style layout to include 'sites-available' and 'sites-enabled' folders and so on.

Once finished, we will then look at configuring nginx, setting up vhosts and proxying to a backend (such as a mongrel cluster).

!См. далее
*[[Настройка автоматическго запуска nginx]]

!См. также
*[[Установка Nginx через aptitude]]
*Еще один вариант установки: http://habrahabr.ru/blogs/ruby/60676/

!Ссылки
*[[Оригинал статьи на slicehost.com|http://articles.slicehost.com/2009/3/4/ubuntu-intrepid-installing-nginx-from-source]]


</pre>
</div>
<div title="Установка Nginx через aptitude" modifier="Яковлев Иван" created="200906200049" modified="200907021300" tags="[[Настройка Nginx]] slicehost [[TODO - нужен перевод статьи]]" changecount="5">
<pre>!Описание
[[Nginx|http://nginx.net/]] is a popular lightweight server for those who do not need the bulk and extra services that Apache may offer. This article will look at installing Nginx on an Ubuntu Intrepid Slice using the 'aptitude' package manager. 

Using the inbuilt package manager to install packages is a great idea as it solves dependency issues and you are assured of any security updates if, and when, they occur.

However, one drawback can be that it is rare for a version upgrade to be placed into the repositories. As such, it is possible for a newer version of an application to be released and not be placed into the repository.

!Версии
Using aptitude, Ubuntu Intrepid will install Nginx version 0.6.32. However, at the time of writing, the latest stable version of Nginx is 0.6.35. You can check the latest versions and change logs at the [[main nginx site|http://nginx.net/]]. Which one you choose is, of course, entirely up to you.

If you decide you would rather have a later version of Nginx than the one aptitude provides, then please refer to the sister article (link on the way) which will take you through the process of installing Nginx from source.

!Установка и зависимости
Installing Nginx is incredibly simple as it involves one command:
{{{
sudo aptitude install nginx
}}}
This will install any and all dependencies that Nginx requires, such as libpcre.

!Запуск
One odd thing is that Nginx is not started automatically:
{{{
sudo /etc/init.d/nginx start
}}}
Done.

!Проверка работы
Now simply navigate to your IP address, and you will see the wonderfully simple welcome screen:

{{textAlignCenter{
[img[images/articles/nginx-welcome.jpg]]
}}}

!Скрипты запуска
As you would imagine when installing an application with the aptitude package manager, all init scripts have been created and added to the relevant run levels.

Controlling nginx is done with these commands:
{{{
sudo /etc/init.d/nginx start
...
sudo /etc/init.d/nginx stop
...
sudo /etc/init.d/nginx restart
}}}
That's it.

!Заключение
Using the aptitude package manager makes the installation of Nginx and associated dependencies very simple indeed. The only thing to consider is the version disparity between the one offered by aptitude and the one available via source code.

!См. также
*[[Установка Nginx из исходных кодов]]

!Ссылки
*[[Оригинал статьи на slicehost.com|http://articles.slicehost.com/2009/2/27/ubuntu-intrepid-installing-nginx-via-aptitude]]


</pre>
</div>
<div title="Установка Nginx-PHP5-FastCGI-XCache-MySQL на Ubuntu" modifier="Яковлев Иван" created="200906052122" modified="200906192354" tags="[[Nginx + Apache]]" changecount="13">
<pre>{{textAlignCenter borderNone{
[img[images/articles/xserve.jpg]]
}}}

*''Описание''
*''Первоначальная настройка сервера''
*''Установка PHP, ~MySQL и необходимых пакетов''
*''Установка и настройка сервера Nginx''
*''Запуск PHP как ~FastCGI процесса''
*''Тестирование, отладка, установка ~XCache''

!Описание
Как только вы начинаете чувствовать нагрузку на свой купленный за 5 долларов в месяц сервер, то читая статьи на тему «Когда стоит переходить на VPS», подумывайте о покупке чего-нибудь более серьёзного. И как только это «более серьёзное» находится в вашем распоряжении, перед вами открывается целая вселенная, когда всё зависит только от вас и вариантов развития событий миллионы. Вы – администратор виртуального (или физического) сервера.

Эта статья предназначена в первую очередь начинающим админам, желающим без многочасового поиска по Сети сделать всё быстро и правильно. Поэтому не будем откладывать и начнём.

*Apache хороший сервер, особенно если вы ставите его только на обработку скриптов и не загружаете отдачей статики. При правильной настройке с ним можно творить чудеса. Но я принципиально отказался от его использования, так как настроить один сервер проще и быстрее чем два, а в случае с Apache нам понадобится ещё один.

*Я использую Nginx как полноценную замену Apache. Он лёгкий, настраиваемый, мощный. Хорошо работает с Drupal. Но это абсолютно не значит, что вы не можете использовать Lighttpd. Просто поищите тогда другую статью :)

*Операционная система, на которой производилась инсталляция - Ubuntu Hardy LTS (поддержка до 2013 года). Если вы используете другую – вам не нужно искать другую статью, просто у вас будет немного отличаться синтаксис запуска программ. Например, вместо aptitude будете использовать apt-get, yum, и т.д. Читайте документацию к вашей системе. Однако по большей части на любых Linux системах мой мануал сработает. Любители ./configure, make, make install , порадуются только один раз.

*Виртуальный сервер куплен у компании Slicehost. Бесподобная поддержка, куча образовательных материалов на все случаи жизни, и очень демократичные цены (20$ за VPS c 256MB оперативы), плюс – идеология Слайсхоста заставит вас забыть о том, что такое Cpanel, Plesk и прочие костыли для управления хостингом. Вы будете делать всё сами, ни от кого не зависеть, тотальная свобода для творчества и работы! В общем, сначала попробуйте, а потом вы останетесь у них навсегда ;) Кстати, зарегистрировавшись по моей реферальной ссылке, вы получите круглосуточную поддержку ещё и от меня.

!Первоначальная настройка сервера
Нет, ребята, так дело не пойдёт, настолько я распыляться не буду. Идём [[сюда|http://articles.slicehost.com/ubuntu-hardy]] и делаем как написано. Настроить сервер – значит установить файрвол, создать юзеров для доступа по SSH, отключить учётную запись root, раскрасить bash, проапдейтить пакеты до последних версий. Просто следуйте простым инструкциям [[здесь|Настройка своего выделенного VPS сервера на основе Ubuntu Hardy LTS]]. Всё очень доступно.

!Установка PHP, ~MySQL и необходимых пакетов
Устанавливаем необходимые пакеты (Build Essentials):
{{{
sudo aptitude install build-essential
}}}
Устанавливаем PHP c клиентом. И без Apache!:
{{{
sudo aptitude install php5-common php5-dev php5-mysql php5-sqlite php5-tidy php5-xmlrpc php5-xsl php5-cgi php5-mcrypt php5-curl php5-gd php5-mhash php5-pspell php5-snmp php5-sqlite libmagick9-dev php5-cli
}}}
Возможно, я несколько перебрал с пакетами, но некоторые из них вам могут понадобиться в дальнейшем, они не занимают много места, поэтому абсолютно не помешают.
Устанавливаем ~MySQL сервер
{{{
sudo aptitude install mysql-server mysql-client libmysqlclient15-dev
}}}
Защищаем его от недоброжелателей
{{{
mysql_secure_installation
}}}
Конечно, ~MySQL – вещь сложная в настройке, и какой бы ни был у вас сервер, вам придётся потратить много времени на её оптимизации. Рекомендую после того, как разберётесь с сервером, начать тюнинг ~MySQL c помощью [[этого скрипта|https://launchpad.net/mysql-tuning-primer]]

!Установка и настройка сервера Nginx
Существуют миллионы инструкций как компилировать программы из исходников, но мне не хочется этим заморачиваться. К тому же Ubuntu позволяет проделывать такие вещи.
{{{
sudo aptitude install nginx
}}}
Эта строка установит сам сервер и основные зависимости. После этого вам остаётся только запустить его и проверить, всё ли работает.
{{{
sudo /etc/init.d/nginx start
}}}
Затем наберите в браузере IP (или URL) вашего сервера и насладитесь простым, но очень значимым для нас приветственным экраном Nginx.

Ваш сервер уже официально в Интернете. В принципе, вы уже можете разместить на нём сайт (только не на PHP, хотя мы его вроде и ставили).

!!Действительно, куда заливать?
По умолчанию после установки сервера вышеописанным способам дефолтный хост ведёт в папку на сервере {{{/var/www/nginx-default}}}. Мы это сможем легко поменять уже через несколько минут.

Помните, что контролируется Nginx тремя командами:
{{{
sudo /etc/init.d/nginx start

…
sudo /etc/init.d/nginx stop

…
sudo /etc/init.d/nginx restart
}}}
Однако последнюю (рестарт) использовать не рекомендую, это не Apache. Получите больше головной боли. Поэтому для перезапуска сервера сначала останавливаем его, а потом запускаем. Если не запускается – значит отлаживаем конфигурацию – обычно он довольно понятно говорит, где ошибка.

Также важной частью является первоначальная настройка сервера, откройте файл {{{/etc/nginx/nginx.conf}}} и вставьте в него всё, что находится здесь:
{{{
user www-data www-data;
worker_processes  2;

error_log /var/log/nginx/error.log;
pid /var/run/nginx.pid;

events {
    worker_connections 1024;
}

http {
    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    access_log /var/log/nginx/access.log;

    sendfile on;
    
    #tcp_nopush on;

    #keepalive_timeout 0;
    keepalive_timeout 3;
    tcp_nodelay off;

    gzip on;
    gzip_comp_level 2;
    gzip_proxied any;
    gzip_types text/plain text/html text/css application/x-javascript text/xml application/xml
    application/xml+rss text/javascript;

    include /etc/nginx/sites-enabled/*;
}
}}}
Таким образом мы сразу настроили сжатие сервером данных, выключили некоторые функции и включили некоторые важные. Потом вы сможете настроить его под свои нужды более точно, но пока нам нужна лишь работающая конфигурация.

А сейчас создадим грамотный лэйаут для наших будущих сайтов. В принципе – абсолютно не важно, где будет лежать ваш сайт, но более-менее стандартным является размещение сайтов в каталоге {{{/home/user/public_html}}}, где user – это пользователь системы с необходимыми правами. (как создать юзера и назначить права почитайте по ссылкам в начале мануала, если вы этого ещё не сделали)

Если же юзер только один (а зачастую это только вы), то можно сделать просто
{{{
sudo mkdir /home/public_html

…
sudo mkdir -p /home/public_html/mydomain.com/{public,private,log,backup}
}}}
Таким образом мы создали структуру папок для нашего будущего сайта {{{mydomain.com}}}. Файлы, доступные из Сети будут лежать в папке {{{/public}}}, логи в папке {{{/log}}}, остальное понятно.

Создаём виртуальный хост – файл, который будет указывать домену, где лежит наш сайт.
{{{
sudo nano /etc/nginx/sites-available/mydomain.com
}}}
Затем вставляем в него следующий текст конфига, естественно, заменяя структуру папок и название домена на ваши.
{{note{
@@font-weight: bold;color: red;ВНИМАНИЕ:!@@
Этот конфиг учитывает некоторые особенности Drupal, например, файловую структуру, крон, а также наличие модулей Imagecache, Fckeditor, Backup and Migrate. Если вы используете другие системы, просто удалите или закомментируйте ненужные части конфига, они подписаны. Если же вы ищете в сети решение проблем работы Drupal c Imagecache или Fckeditor, то вы его уже нашли 
}}}
{{{
server {
    listen          80;
    server_name     mydomain.com www.mydomain.com;

    access_log /home/public_html/mydomain.com/log/access.log;
    error_log /home/public_html/mydomain.com/log/error.log;

    root /home/public_html/mydomain.com/public;

    charset utf-8;

    location = / { rewrite . /index.php last; }
    location / { rewrite ^(.*)$ /index.php?q=$1 last; }
    location = /index.php {
        fastcgi_pass 127.0.0.1:9000;
        fastcgi_param SCRIPT_FILENAME /home/public_html/mydomain.com/public$fastcgi_script_name;
        include /etc/nginx/fastcgi_params;
    }
    
    # To retrieve this script periodically use: curl -sH “Host: my.host.tld” http://localhost/cron.php
    location = /cron.php {
        allow 127.0.0.1;
        deny all;
        fastcgi_pass 127.0.0.1:8521;
        include /etc/nginx/fastcgi_params;
    }
    
    # Static content
    location = /robots.txt { if (-f $document_root/sites/default/robots.txt) { rewrite . /sites/default/robots.txt$
    location ~ ^(/sites/all)?/(modules|themes)/.*.(css|js|png|gif|jpg)$ { break; }
    location /misc/ { break; }
    location /sites/all/modules/fckeditor { break; }
    location /files/ { break; } # Depending on Drupal configuration (Administer -&gt; File system)

    # Imagecache (http://drupal.org/project/imagecache)
    location /files/imagecache/ {
        if (-f $request_filename) { break; }
        rewrite ^(.*)$ /index.php?q=$1 last;
    }

    # **** Comment out this location after installing/updating Drupal ****
    # location ~ ^/(install|update).php$ {
    # allow 172.22.11.2;
    # deny all;
    # fastcgi_pass 127.0.0.1:8521;
    # include /etc/nginx/fastcgi_params;
    # }
    # ********************************************************************

    # hide protected files
    location ~* .(engine|inc|info|install|module|profile|po|sh|.*sql|theme|tpl(.php)?|xtmpl)$|^(code-style.pl|Entri$ {
        deny all;
    }

    # hide backup_migrate files
    location ~* ^/files/backup_migrate {
        deny all;
    }
}
}}}
И активизируем сайт:
{{{
sudo ln -s /etc/nginx/sites-available/mydomain.com /etc/nginx/sites-enabled/mydomain.com
}}}
{{note{
@@font-weight: bold;color: red;ВНИМАНИЕ:@@
А сейчас внимание! В конфиг включены правила для создания чистых ссылок (clean urls) для системы Drupal, если вы используете Wordpress или другие системы, вам необходимо поискать на сайтах поддержки правила создания чистых ссылок для nginx. Это займёт лишних 5 минут, особенно если ваша система популярная. Впрочем, она может работать и с моим конфигом  

Помните, файл {{{.htaccess}}} под Nginx не работает! Все директивы вставляются в конфигурацию сервера или виртуального хоста!
}}}
Таким образом, спорная часть это
{{{
if (!-e $request_filename) {
    rewrite ^/(.*)$ /index.php?q=$1 last;
}
}}}
Остальные части конфига необходимы!
{{note{
''ЗАМЕЧАНИЕ:''
В конфиге мы попросили Nginx слушать ~FastCGI на 9000 порту, поэтому – если у вас стоит файрвол, не забудьте открыть этому порту доступ (как и порту 3306 для ~MySQL)
}}}

!Запуск PHP как ~FastCGI процесса
Я не профессиональный администратор, поэтому ищите в Гугле подробные объяснения тому, что мы сейчас будем делать.
Дело в том, что нам необходимо заставить наш сервер работать с PHP, чего он по умолчанию делать вовсе не обязан (в настоящее время в Nginx анонсирована только тестовая поддержка Perl). Поэтому для взаимодействия сервера с языком программирования мы используем специальный протокол, или интерфейс – ~FastCGI. Это своеобразный мостик для обеспечения взаимопонимания между Nginx и PHP. И сейчас мы будем “учить” их работать вместе.

Мы уже устанавливали php5-cgi, если вы помните, теперь нам нужно каким-то образом запускать ~FastCGI процесс. Есть несколько способов сделать это. Мы будем использовать специальную программку spawn-fcgi, которая до недавнего времени шла в комплекте с другим сервером – Lighttpd. Сейчас она идёт как отдельный проект и расположена по адресу http://redmine.lighttpd.net/projects/spawn-fcgi

Мы же используем старый проверенный вариант “выдирания” её из Lighttpd. Это даст мне уверенность в том, что это точно будет работать у вас. Чуть позже я изменю эту часть статьи, но только когда сам всё сделаю на практике.

Итак
{{{
mkdir ~/sources

…
cd ~/sources

…
wget http://www.lighttpd.net/download/lighttpd-1.4.19.tar.bz2

…
tar jxvf lighttpd-1.4.19.tar.bz2
}}}
Не знаю, необходимы или нет эти зависимости, но установочный скрипт ругается, поэтому давайте лучше их установим:
{{{
sudo aptitude install libpcre3-dev libbz2-dev
}}}
Далее – скомпилируем Lighttpd, но не будем его устанавливать, нам нужна только одна программка. Поэтому делаем следующее:
{{{
cd lighttpd-1.4.19

…
./configure

…
make
}}}
Потом идём пить кофе, потому что на экране будет много всего, производящего впечатление на девушек  Безобразие на экране будет длиться минуты 3-4.

Затем берём исходники spawn-fcgi, и кладём их в то место, где им и полагается быть:
{{{
sudo cp src/spawn-fcgi /usr/bin/spawn-fcgi
}}}
Далее, если это программа, то нам нужен скрипт, чтобы запускать её:
{{{
sudo nano /usr/bin/php-fastcgi
}}}
Затем копируем в скрипт следующие строки:
{{{
#!/bin/sh
/usr/bin/spawn-fcgi -a 127.0.0.1 -p 9000 -u www-data -g www-data -f /usr/bin/php5-cgi
}}}
А теперь внимание! В Интернете, насколько мне известно, вы можете найти другие варианты синтаксиса этой строки, где www-data присутствует только один раз. Настоятельно рекомендую вам воспользоваться именно моим вариантом, так как это позволит вам в будущем избежать неприятностей и ошибки PHP – No input file specified. Отличие моего варианта от распространённого в том, что мы указываем не только пользователя, но и группу. Если они у вас отличаются, то просто замените на ваши данные. Самое интересное, что на одном сервере у меня сработало только с юзером, а на другом – нет. Поэтому будьте внимательны!

Строка, которую мы ввели, означает, что каждый раз, когда скрипт будет вызываться, процесс fcgi будет запущен на порту 9000 для пользователя www-data в группе www-data (это дефолтные пользователь и группа, устанавливаемые при первоначальной настройке системы).

Нам осталось только разобраться, как запускать этот скрипт при запуске ~FastCGI.
{{{
sudo nano /etc/init.d/init-fastcgi
}}}
Получаем пустой экран, и вставляем в него:
{{{
#!/bin/bash
PHP_SCRIPT=/usr/bin/php-fastcgi
RETVAL=0
case “$1″ in
start)
$PHP_SCRIPT
RETVAL=$?
;;
stop)
killall -9 php5-cgi
RETVAL=$?
;;
restart)
killall -9 php5-cgi
$PHP_SCRIPT
RETVAL=$?
;;
*)
echo “Usage: php-fastcgi {start|stop|restart}”
exit 1
;;
esac
exit $RETVAL
}}}
{{note{
@@font-weight: bold;color: red;ВНИМАНИЕ:@@
Опять же внимание! В Сети вы найдёте слегка изменённый вариант скрипта управления запуском FastCGI, где будет killall -9 php, вместо killall -9 php5-cgi. В моём случае работал только последний вариант, то есть в скрипт надо вставлять точное название процесса, который мы запускаем. Честно говоря, я вообще удивляюсь, как у людей работает без этого. Но мы же делаем всё правильно, не так ли!
}}}
Дальше – у нас ничего не будет работать, пока мы не сделаем два предущие скрипта исполняемыми. Для этого вводим следующее:
{{{
sudo chmod 755 /usr/bin/php-fastcgi

…
sudo chmod 755 /etc/init.d/init-fastcgi
}}}
Ну что ж, сейчас можно смело запускать наш FastCGI:
{{{
sudo /etc/init.d/init-fastcgi start
}}}
Вы должны получить что-то вроде информации о том, что spawn-fcgi успешно запустился как процесс.

А для того, чтобы всё работало после перезагрузки набираем:
{{{
sudo update-rc.d init-fastcgi defaults
}}}
И, я надеюсь, вы не забыли запустить Nginx  С этого момента вам придётся постоянно помнить, что сейчас вам нужно запускать и сервер и FastCGI.

В принципе, это всё!

!Тестирование, отладка, установка ~XCache
Так, давайте проверим, работает ли PHP как fast-cgi процесс:
{{{
ps ax | grep php
}}}
Если появился список запущенных процессов, значит всё ОК.

А чтобы проверить, подключён ли PHP к Nginx, создайте файл {{{info.php}}} в веб-директории вашего домена {{{mydomain.com}}}, вставьте туда:
{{{
&lt;php? echo phpinfo(); ?&gt;
}}}
А затем запустите его из браузера. Получите исчерпывающую информацию о том, как работает ваш PHP, какие модули загружены.

А сейчас давайте ускорим исполнение PHP скриптов путём кэширования бинарного кода. Вы можете установить любой акселератор, но я выбираю [[XCache|http://xcache.lighttpd.net/]].
Установка ~XCache:
{{{
sudo aptitude php5-xcache
}}}
Особенностью этого акселератора является то, что его надо вручную подключать к php.ini, и там же конфигурировать под свои нужды.

Открываем:
{{{
sudo nano /etc/php5/cgi/php.ini
}}}
Проматываем этот длиннющий файл до самого конца, попутно настраивая его под себя. Например, вы можете изменить значение {{{memory_limit}}} на большее (хотя бы до 64MB, особенно если работаете с Drupal). Для прокрутки используете ''Ctrl+V''.

В конце файла вставляем:
{{{
[xcache-common]
extension = xcache.so
[xcache.admin]
xcache.admin.user = “mOo”
; xcache.admin.pass = md5($your_password)
xcache.admin.pass = “”
[xcache]
; ini only settings, all the values here is default unless explained
; select low level shm/allocator scheme implemenation
xcache.shm_scheme =        ”mmap”
; to disable: xcache.size=0
; to enable : xcache.size=64M etc (any size &amp;gt; 0) and your system mmap allows
xcache.size  =                64M
; set to cpu count (cat /proc/cpuinfo |grep -c processor)
xcache.count =                 4
; just a hash hints, you can always store count(items) &amp;gt; slots
xcache.slots =                8K
; ttl of the cache item, 0=forever
xcache.ttl   =                 0
; interval of gc scanning expired items, 0=no scan, other values is in seconds
xcache.gc_interval =           0
; same as aboves but for variable cache
xcache.var_size  =            64M
xcache.var_count =             1
xcache.var_slots =            8K
; default ttl
xcache.var_ttl   =             0
xcache.var_maxttl   =          0
xcache.var_gc_interval =     300
xcache.test =                Off
; N/A for /dev/zero
xcache.readonly_protection = Off
; for *nix, xcache.mmap_path is a file path, not directory.
; Use something like “/tmp/xcache” if you want to turn on ReadonlyProtection
; 2 group of php won’t share the same /tmp/xcache
; for win32, xcache.mmap_path=anonymous map name, not file path
xcache.mmap_path =    ”/dev/zero”
; leave it blank(disabled) or “/tmp/phpcore/”
; make sure it’s writable by php (without checking open_basedir)
xcache.coredump_directory =   “”
; per request settings
xcache.cacher =               On
xcache.stat   =               On
xcache.optimizer =            On
[xcache.coverager]
; per request settings
; enable coverage data collecting for xcache.coveragedump_directory and xcache_coverager_start/stop/get/clean() functions (will hurt executing performance)
xcache.coverager =          Off
; ini only settings
; make sure it’s readable (care open_basedir) by coverage viewer script
; requires xcache.coverager=On
xcache.coveragedump_directory = “”
}}}
Обратите внимание на строку, где надо указать количество ядер в вашем процессоре. У меня их 4. Там же написано как это узнать, если не уверены.

Также здесь вы можете установить логин и пароль для управления скриптом. Если с логином всё понятно, то пароль должен быть зашифрован с помощью md5. Чтобы правильно установить пароль, создайте в веб-директории файл test.php, и поместите в него следующую строку:
{{{
&lt;?php echo md5(”вашпароль”); ?&gt;
}}}
Запустив его, вы получите ваш пароль в зашифрованном виде, его то и надо вставлять в ''php.ini''. Не вставляйте в ''php.ini'' 
 “человеческий пароль”!

Чтобы получить доступ к веб-интерфейсу ~XCache, нам придётся скачать исходники [[отсюда|http://xcache.lighttpd.net/wiki/Release-1.2.2]] и достать из них папку xcache/admin/ (всю папку), затем загрузить её в веб-директорию, и зайти в неё со своим логином и паролем, установленным в ''php.ini''.

Затем можете наслаждаться тем, как будет летать ваш сервер после установки акселератора.

!Ссылки
*[[Оригинал статьи|http://sudouser.com/ustanovka-nginx-php5-fastcgi-xcache-i-mysql-na-ubuntu.html]]
*http://moreintelligentweb.net -- оригинал на английском


</pre>
</div>
<div title="Установка PHP5" modifier="Яковлев Иван" created="200906042020" modified="200906181859" tags="[[Настройка PHP]] [[TODO - нужен перевод статьи]]" changecount="6">
<pre>!Описание
PHP is a general-purpose scripting language suited for Web development. The PHP script can be embedded into HTML. This section explains how to install and configure ~PHP5 in Ubuntu System with Apache 2 and ~MySQL.

This section assumes you have installed and configured Apache 2 Web Server and ~MySQL Database Server. You can refer to Apache 2 section and ~MySQL sections in this document to install and configure Apache 2 and ~MySQL respectively.

!Установка
The ~PHP5 is available in Ubuntu Linux. 

To install ~PHP5 you can enter the following command in the terminal prompt:
{{{
sudo apt-get install php5 libapache2-mod-php5
}}}
You can run ~PHP5 scripts from command line. To run ~PHP5 scripts from command line you should install ''php5-cli'' package. To install ''php5-cli'' you can enter the following command in the terminal prompt:
{{{
sudo apt-get install php5-cli
}}}
You can also execute ~PHP5 scripts without installing ~PHP5 Apache module. To accomplish this, you should install ''php5-cgi'' package. You can run the following command in a terminal prompt to install ''php5-cgi'' package:
{{{ 
sudo apt-get install php5-cgi
}}}
To use ~MySQL with ~PHP5 you should install ''php5-mysql'' package. To install ''php5-mysql'' you can enter the following command in the terminal prompt:
{{{
sudo apt-get install php5-mysql
}}}
Similarly, to use ~PostgreSQL with ~PHP5 you should install ''php5-pgsql'' package. To install ''php5-pgsql'' you can enter the following command in the terminal prompt:
{{{ 
sudo apt-get install php5-pgsql
}}}

!Настройка
Once you install ~PHP5, you can run ~PHP5 scripts from your web browser. If you have installed php5-cli package, you can run ~PHP5 scripts from your command prompt. 

By default, the Apache 2 Web server is configured to run ~PHP5 scripts. In other words, the ~PHP5 module is enabled in Apache 2 Web server automatically when you install the module. Please verify if the files {{{/etc/apache2/mods-enabled/php5.conf}}} and {{{/etc/apache2/mods-enabled/php5.load}}} exist. If they do not exists, you can enable the module using {{{a2enmod}}} command. 

Once you install ~PHP5 related packages and enabled ~PHP5 Apache 2 module, you should restart Apache 2 Web server to run ~PHP5 scripts. You can run the following command at a terminal prompt to restart your web server:
{{{
sudo /etc/init.d/apache2 restart 
}}}

!Тестирование
To verify your installation, you can run following ~PHP5 phpinfo script:
{{{
&lt;?php
print_r (phpinfo());
?&gt;
}}}
You can save the content in a file ''phpinfo.php'' and place it under ~DocumentRoot directory of Apache 2 Web server. When point your browser to {{{http://hostname/phpinfo.php}}}, it would display values of various ~PHP5 configuration parameters. 

!См. также
*[[Установка и настройка LAMP+SSL+SVN+Trac]]

!Ссылки
For more in depth information see [[php.net|http://www.php.net/docs.php]] documentation. 


</pre>
</div>
<div title="Установка Redmine в домашний каталог DebianUbuntu" modifier="Яковлев Иван" created="200906271302" modified="200906271303" tags="[[Система багтрекинга Redmine]] [[TODO - нужен перевод статьи]] TODO" changecount="3">
<pre>It seems that the version of Rails in Debian does not play well with Redmine. We will therefore use Debian packages for the basic Ruby and rubygems infrastructure, but install the remaining parts in a local home directory.

!Подготовка
First, as root, run:
{{{
sudo aptitude install ruby rake rubygems
}}}
You'll also want Ruby drivers for you databases, which are in one of these packages:
*libpgsql-ruby for ~PostgreSQL
*libmysql-ruby
*libsqlite3-ruby

!Настройка окружения пользователя
As an individual user, edit your {{{~/.bashrc}}} file and add a line such as this:
{{terminal{
{{{
export GEM_PATH=$HOME/gems
}}}
}}}
Log out and back on. Make sure your {{{GEM_PATH}}} is set:
{{{
echo $GEM_PATH
}}}
And make the directory for the gems:
{{{
mkdir ~/gems
}}}
Now, install rails:
{{{
gem install -i $GEM_PATH rails -y
}}}
Then proceed to the ~RedmineInstall instructions.

If you will be running this under ~FastCGI or some other environment, make sure the {{{GEM_PATH}}} gets passed along.

Thanks to Eric Davis for help with this procedure.

!Ссылки
*[[Оригинал статьи|http://www.redmine.org/wiki/redmine/HowTo_Install_Redmine_in_a_home_directory_on_Debian]]


</pre>
</div>
<div title="Установка Samba Active Directory" modifier="Яковлев Иван" created="200906042308" modified="200906052338" tags="[[Установка/настройка сервера]] TODO" changecount="2">
<pre>!Описание
TODO

!См. также
*[[Установка Samba сервера на Ubuntu или Debian за 5 минут]]

!Ссылки
*[[Описание на ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/samba-ad-integration.html]]



</pre>
</div>
<div title="Установка Samba сервера на Ubuntu или Debian за 5 минут" modifier="Яковлев Иван" created="200906052340" tags="[[Установка/настройка сервера]] Samba Статьи TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/ustanovka-samba-servera-na-ubuntu-debian-za-5-minut.html#more-99]]



</pre>
</div>
<div title="Установка Subversion" modifier="Яковлев Иван" created="200906042258" modified="200906202217" tags="[[Настройка Subversion (SVN)]] [[TODO - нужен перевод статьи]]" changecount="16">
<pre>!Описание
Subversion is an open source version control system. Using Subversion, you can record the history of source files and documents. It manages files and directories over time. A tree of files is placed into a central repository. The repository is much like an ordinary file server, except that it remembers every change ever made to files and directories.

!Установка
To access Subversion repository using the HTTP protocol, you must install and configure a web server. Apache2 is proven to work with Subversion. Please refer to the HTTP subsection in the Apache2 section to install and configure Apache2. To access the Subversion repository using the HTTPS protocol, you must install and configure a digital certificate in your Apache 2 web server. Please refer to the HTTPS subsection in the Apache2 section to install and configure the digital certificate.

To install Subversion, run the following command from a terminal prompt:
{{{
sudo apt-get install subversion libapache2-svn
}}}

!Настройка
his step assumes you have installed above mentioned packages on your system. This section explains how to create a Subversion repository and access the project.

!!Create Subversion Repository
The Subversion repository can be created using the following command from a terminal prompt:
{{{
svnadmin create /path/to/repos/project
}}}

!!Importing Files
Once you create the repository you can import files into the repository. To import a directory, enter the following from a terminal prompt:
{{{
svn import /path/to/import/directory file:///path/to/repos/project
}}}

!Access Methods
Subversion repositories can be accessed (checked out) through many different methods on local disk, or through various network protocols. A repository location, however, is always a URL. The table describes how different URL schemes map to the available access methods.

''Access Methods''
|!Schema|!Access Method|
|{{{file://}}} |direct repository access (on local disk)|
|{{{http://}}} |Access via ~WebDAV protocol to Subversion-aware Apache2 web server|
|{{{https://}}} |Same as {{{http://}}}, but with SSL encryption|
|{{{svn://}}} |Access via custom protocol to an svnserve server|
|{{{svn+ssh://}}} |Same as {{{svn://}}}, but through an SSH tunnel|

In this section, we will see how to configure Subversion for all these access methods. Here, we cover the basics. For more advanced usage details, refer to the [[svn book|http://svnbook.red-bean.com/]].

!!Direct repository access ({{{file://}}})
This is the simplest of all access methods. It does not require any Subversion server process to be running. This access method is used to access Subversion from the same machine. The syntax of the command, entered at a terminal prompt, is as follows:
{{{
svn co file:///path/to/repos/project
}}}
or
{{{
svn co file://localhost/path/to/repos/project
}}}
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
If you do not specify the hostname, there are three forward slashes ({{{///}}}) -- two for the protocol (file, in this case) plus the leading slash in the path. If you specify the hostname, you must use two forward slashes ({{{//}}}).
}}}
The repository permissions depend on filesystem permissions. If the user has read/write permission, he can checkout from and commit to the repository.

!!Access via ~WebDAV protocol ({{{http://}}})
To access the Subversion repository via ~WebDAV protocol, you must configure your Apache 2 web server. You must add the following snippet in your etc/apache2/apache2.conf file:
{{{
 &lt;Location /svn&gt;
  DAV svn
  SVNParentPath /home/svn
  AuthType Basic
  AuthName &quot;Your repository name&quot;
  AuthUserFile /etc/subversion/passwd
  &lt;LimitExcept GET PROPFIND OPTIONS REPORT&gt;
  Require valid-user
  &lt;/LimitExcept&gt;
  &lt;/Location&gt; 
}}}

{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
The above configuration snippet assumes that Subversion repositories are created under /home/svn/ directory using svnadmin command. They can be accessible using {{{htpp://hostname/svn/repos_name}}} url.
}}}
To import or commit files to your Subversion repository over HTTP, the repository should be owned by the HTTP user. In Ubuntu systems, normally the HTTP user is ''www-data''. To change the ownership of the repository files enter the following command from terminal prompt:
{{{
sudo chown -R www-data:www-data /path/to/repos
}}}
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
By changing the ownership of repository as www-data you will not be able to import or commit files into the repository by running svn import {{{file:///}}} command as any user other than ''www-data''.
}}}
Next, you must create the /etc/subversion/passwd file that will contain user authentication details. To create a file issue the following command at a command prompt (which will create the file and add the first user):
{{{
sudo htpasswd -c /etc/subversion/passwd user_name
}}}
To add additional users omit the &quot;{{{-c}}}&quot; option as this option replaces the old file. Instead use this form:
{{{
sudo htpasswd /etc/subversion/password user_name
}}}
This command will prompt you to enter the password. Once you enter the password, the user is added. Now, to access the repository you can run the following command:
{{{
                    
                      svn co http://servername/svn
                    
}}}
{{note{
@@color: red;font-weight: bold;ВНИМАНИЕ:@@
The password is transmitted as plain text. If you are worried about password snooping, you are advised to use SSL encryption. For details, please refer next section.
}}}

!!Access via ~WebDAV protocol with SSL encryption ({{{https://}}})
Accessing Subversion repository via ~WebDAV protocol with SSL encryption ({{{https://}}}) is similar to {{{http://}}} except that you must install and configure the digital certificate in your Apache2 web server.

You can install a digital certificate issued by a signing authority like Verisign. Alternatively, you can install your own self-signed certificate.

This step assumes you have installed and configured a digital certificate in your Apache 2 web server. Now, to access the Subversion repository, please refer to the above section! The access methods are exactly the same, except the protocol. You must use {{{https://}}} to access the Subversion repository.

!!Access via custom protocol ({{{svn://}}})
Once the Subversion repository is created, you can configure the access control. You can edit the {{{/path/to/repos/project/conf/svnserve.conf}}} file to configure the access control. For example, to set up authentication, you can uncomment the following lines in the configuration file:
{{{
# [general]
# password-db = passwd
}}}
After uncommenting the above lines, you can maintain the user list in the passwd file. So, edit the file passwd in the same directory and add the new user. The syntax is as follows:
{{{
username = password
}}}
For more details, please refer to the file.

Now, to access Subversion via the {{{svn://}}} custom protocol, either from the same machine or a different machine, you can run svnserver using svnserve command. The syntax is as follows:
{{{
$ svnserve -d --foreground -r /path/to/repos
# -d -- daemon mode
# --foreground -- run in foreground (useful for debugging)
# -r -- root of directory to serve
}}}
For more usage details, please refer to:
{{{
$ svnserve --help
}}}
Once you run this command, Subversion starts listening on default port (3690). To access the project repository, you must run the following command from a terminal prompt:
{{{
svn co svn://hostname/project project --username user_name
}}}
Based on server configuration, it prompts for password. Once you are authenticated, it checks out the code from Subversion repository. To synchronize the project repository with the local copy, you can run the update sub-command. The syntax of the command, entered at a terminal prompt, is as follows:
{{{
cd project_dir ; svn update
}}}
For more details about using each Subversion sub-command, you can refer to the manual. For example, to learn more about the co (checkout) command, please run the following command from a terminal prompt:
{{{
                    
                      svn co help
                    
}}}

!!Access via custom protocol with SSL encryption ({{{svn+ssh://}}})
The configuration and server process is same as in the {{{svn://}}} method. For details, please refer to the above section. This step assumes you have followed the above step and started the Subversion server using svnserve command.

It is also assumed that the ssh server is running on that machine and that it is allowing incoming connections. To confirm, please try to login to that machine using ssh. If you can login, everything is perfect. If you cannot login, please address it before continuing further.

The {{{svn+ssh://}}} protocol is used to access the Subversion repository using SSL encryption. The data transfer is encrypted using this method. To access the project repository (for example with a checkout), you must use the following command syntax:
{{{
svn co svn+ssh://hostname/var/svn/repos/project
}}}
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
You must use the full path ({{{/path/to/repos/project}}}) to access the Subversion repository using this access method.
}}}
Based on server configuration, it prompts for password. You must enter the password you use to login via ssh. Once you are authenticated, it checks out the code from the Subversion repository.

!См. также
*[[CVS сервер|https://help.ubuntu.com/9.04/serverguide/C/cvs-server.html]]

!Ссылки
*[[Описание на ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/subversion.html]]



</pre>
</div>
<div title="Установка Trac" modifier="Яковлев Иван" created="200906042259" modified="200906271253" tags="[[Система багтрекинга Trac]] TODO" changecount="4">
<pre>!Описание
TODO

!См. также
*[[Установка и настройка LAMP+SSL+SVN+Trac]]

!Ссылки
*[[Описание на ubuntu.com|TODO]]



</pre>
</div>
<div title="Установка Ubuntu на RAID-1 диски" modifier="Яковлев Иван" created="200906052326" modified="200906052349" tags="[[Установка/настройка сервера]] Статьи RAID TODO" changecount="3">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/ustanovka-ubuntu-na-raid-1-diski.html]]



</pre>
</div>
<div title="Установка deb с помощью GDebi" modifier="Яковлев Иван" created="200906032342" modified="200906040932" tags="[[Установка ПО в Ubuntu]]" changecount="4">
<pre>Репозитории это хорошо, но иногда бывают ситуации, когда там нету того, что нам нужно. Иногда там вообще нету нужного пакета, а иногда там находится старая версия, которая не поддерживает то, что было реализовано совсем недавно. И тогда вы заходите на сайт производителя в надежде что там есть .deb версия и скачиваете ее.

{{textAlignCenter{
[img[images/articles/downloaded-package.png]]
}}}
После того как пакет скачали - найдите его (по-умолчанию Firefox сохранит его на рабочем столе, если там нету, зайдите в домашнюю директорию через меню &quot;Переход&quot;).

Все что нужно сделать - просто дважды нажать мышкой на пакете.

{{textAlignCenter{
[img[images/articles/attention.png]]
}}}
Если в репозитариях есть ПО, которое вы пытаетесь ставить вручную - вы увидите различные предупреждающие сообщения. Если вы видите сообщение и не знали о том, что в репозитариях есть это ПО, а тем более если в репозитариях такая же версия или даже новее - то ставьте с помощью Synaptic. Но в нашем случае мы знаем что мы делаем.

{{textAlignCenter{
[img[images/articles/before.png]]
}}}
Как видно из рисунка, у пакета есть 35 зависимостей. Откуда они будут ставится? Из репозиториев. Что это значит? Если на сайте, где вы скачали ПО есть какие-то дополнительные библиотеки и их не будет в репозитариях, то вы увидите ошибку. Вот пример:

{{textAlignCenter{
[img[images/articles/no-dependencies.png]]
}}}
В этом случае надо поискать на этом же сайте разработчика дополнительные пакеты-зависимости и установить их до того, как ставить основной пакет.

В нашем случае все зависимости находятся в репозитариях. Нажимаем кнопку &quot;Установить пакет&quot;. Зависимости скачиваются (если их нету в кеше), устанавливаются и потом устанавливается сам пакет.

{{textAlignCenter{
[img[images/articles/installed.png]]
}}}
Ну вот и все. Пакет установлен. Откроем Synaptic.

{{textAlignCenter{
[img[images/articles/synaptic-deb-installed.png]]
}}}
В фильтре по состоянию появилась категория &quot;Установленые (локально или устаревшие)&quot; и в нем находится наш пакет. Таким образом вы можете контролировать все, что поставили вручную.

!См. далее
*[[Установка .deb вручную]]


</pre>
</div>
<div title="Установка phpMyAdmin" modifier="Яковлев Иван" created="200906042034" modified="200906042049" tags="[[Установка/настройка Web-сервера]] [[TODO - нужен перевод статьи]]" changecount="3">
<pre>!Описание
phpMyAdmin is a LAMP application specifically written for administering ~MySQL servers. Written in PHP, and accessed through a web browser, phpMyAdmin provides a graphical interface for database administration tasks. 

!Установка
Before installing phpMyAdmin you will need access to a ~MySQL database either on the same host as that phpMyAdmin is installed on, or on a host accessible over the network. For more information see the section called “~MySQL”. From a terminal prompt enter:
{{{ 
sudo apt-get install phpmyadmin
}}}
At the prompt choose which web server to be configured for phpMyAdmin. The rest of this section will use Apache 2 for the web server. 

In a browser go to {{{http://servername/phpmyadmin}}}, replacing serveranme with the server's actual hostname. At the login, page enter root for the username, or another ~MySQL user if you any setup, and enter the ~MySQL user's password. 

Once logged in you can reset the root password if needed, create users, create/destroy databases and tables, etc. 

!Настройка
The configuration files for phpMyAdmin are located in {{{/etc/phpmyadmin}}}. The main configuration file is {{{/etc/phpmyadmin/config.inc.php}}}. This file contains configuration options that apply globally to phpMyAdmin. 

To use phpMyAdmin to administer a ~MySQL database hosted on another server, adjust the following in {{{/etc/phpmyadmin/config.inc.php}}}: 
{{{
$cfg['Servers'][$i]['host'] = 'db_server'; 	
}}}
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
Replace {{{db_server}}} with the actual remote database server name or IP address. Also, be sure that the phpMyAdmin host has permissions to access the remote database. 
}}}
Once configured, log out of phpMyAdmin and back in, and you should be accessing the new server. 

The config.header.inc.php and config.footer.inc.php files are used to add a HTML header and footer to phpMyAdmin. 

Another important configuration file is {{{/etc/phpmyadmin/apache.conf}}}, this file is symlinked to {{{/etc/apache2/conf.d/phpmyadmin.conf}}}, and is used to configure Apache 2 to serve the phpMyAdmin site. The file contains directives for loading PHP, directory permissions, etc. For more information on configuring Apache 2 see the section called “[[HTTPD - Apache 2 Web Server|https://help.ubuntu.com/9.04/serverguide/C/httpd.html]]”. 

!Дополнительные материалы
The phpMyAdmin documentation comes installed with the package and can be accessed from the phpMyAdmin Documentation link (a question mark with a box around it) under the phpMyAdmin logo. The official docs can also be access on the [[phpMyAdmin site|http://www.phpmyadmin.net/home_page/docs.php]]. 

Also, [[Mastering phpMyAdmin|http://www.packtpub.com/phpmyadmin-3rd-edition/book]] is a great resource.

!Ссылки
*[[Описание на manpages.ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/phpmyadmin.html]]



</pre>
</div>
<div title="Установка ПО в Ubuntu" modifier="Яковлев Иван" created="200906032333" modified="200906041135" tags="[[Настройка Ubuntu]]" changecount="6">
<pre>*[[Зависимости]]
*[[.deb = setup.exe]]
*[[Synaptic]]
*[[Просмотр свойств|Просмотр свойств установленного пакета с помощью Synaptic]]
*[[Кэш пакетов|Кэш установленных пакетов]]
*[[Удаление зависимостей|Удаление ненужных зависимостей]]
*[[Графический режим|Пункт меню УстановкаУдаление приложений]]
*[[Операции вручную|Установка, удаление, поиск и другие операции вручную]]
*[[.deb через GDebi|Установка deb с помощью GDebi]]
*[[Установка .deb вручную]]
*[[Исправление ошибок|Исправление пакетов с ошибками]]
*[[Alien]]
*[[Заключение]]</pre>
</div>
<div title="Установка и настройка DHCP сервера" modifier="Яковлев Иван" created="200906052350" tags="DHCP [[Установка/настройка сервера]] Статьи TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/ustanovka-i-nastrojka-dhcp-servera.html#more-121]]



</pre>
</div>
<div title="Установка и настройка L2TP сервера xl2tpd или l2tpd" modifier="Яковлев Иван" created="200906052353" tags="[[Установка/настройка сервера]] Статьи TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/ustanovka-i-nastrojka-l2tp-servera-xl2tpd-ili-l2tpd.html#more-145]]



</pre>
</div>
<div title="Установка и настройка LAMP+SSL+SVN+Trac" modifier="Яковлев Иван" created="200906022341" modified="200906092250" tags="Статьи [[Установка/настройка Web-сервера]] TODO" changecount="36">
<pre>!Установка Apache+PHP+~MySQL
Открываем консоль и пишем:
{{{
sudo apt-get update
sudo apt-get install apache2 php5 php5-mysql mysql-server
}}}
или
{{{
sudo aptitude update
sudo aptitude install apache2 php5 php5-mysql mysql-server
}}}
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
Дополнительную информацию по использованию {{{apt-get}}} можно посмотреть [[здесь|http://www.debian.org/doc/manuals/apt-howto/]] 
}}}
Теперь у вас установлен веб-сервер Apache, PHP и ~MySQL, а также модуль для работы с базами. Если вам нужны дополительные модули для PHP, то их установить достаточно легко, например:
{{{sudo aptitude install php5-gd php5-imagick php5-xsl}}} -- устанавливает библиотеки GD, Imagick, XSL.

{{{mysqladmin -u root password ваш_пароль_для_root}}} -- устанавливает пароль администраторской учетной записи для доступа к БД.
{{note{
@@font-weighr: bold;ЗАМЕЧАНИЕ:@@
Если у вас уже установлена связка LAMP и вы хотите обновить версии без нарушения целостности зависимостей, то наберите команду:
{{{
sudo apt-get update
sudo apt-get dist-upgrade
}}}
Первая команда обновляет данные локального репозитария пакетов, вторая команда интеллектуально обновляет уже установленные программы до новых версий. Вот что пишет мануал на этот счет:
&lt;&lt;&lt;
;dist-upgrade
:dist-upgrade in addition to performing the function of upgrade, also intelligently handles changing dependencies with new versions of packages; apt-get has a &quot;smart&quot; conflict resolution system, and it will attempt to upgrade the most important packages at the expense of less important ones if necessary. So, dist-upgrade command may remove some packages. The /etc/apt/sources.list file contains a list of locations from which to retrieve desired package files. See also apt_preferences(5) for a mechanism for overriding the general settings for individual packages.
&lt;&lt;&lt;
}}}

!Настройка
Для управления модулями Apache и виртуальными хостами существуют команды: {{{a2enmod}}} (включает модуль), {{{a2ensite}}} (включает хост), {{{a2dismod}}} и {{{a2dissite}}} (выключают модуль и хост).

включаем модуль PHP:
{{{
sudo a2enmod php5
}}}
заставляем апач перечитать конфигурационные файлы без остановки сервера:
{{{
sudo /etc/init.d/apache2 force-reload
}}}
или перезагружаем сервер:
{{{
sudo /etc/init.d/apache2 restart
}}}

Создаем файл phpinfo.php:

''Alt+F2'' {{{gksu gedit /var/www/phpinfo.php}}}

там пишем знакомое {{{&lt;?php phpinfo() ?&gt;}}}, сохраняем и закрываем.
Открываем браузер:
{{{http://localhost}}} -- для проверки работы апача
{{{http://localhost/phpinfo.php}}} -- для проверки PHP

{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
Также можно установить небольшую утилиту [[rapache|http://www.rapache.org]], которая позволяет производить настройку Apache в графическом режиме. Очень полезная и удобная утилита, если вы не хотите или не знаете как настраивать сервер через конфигурационные файлы.
}}}

!Наш любимый {{{mod_rewrite}}}
активируем сам модуль
{{{
sudo a2enmod rewrite
}}}

''Alt+F2'' {{{gksu gedit /etc/apache2/sites-available/default}}}

Меняем {{{AllowOverride None}}} на {{{AllowOverride All}}}, вот так:
{{{
&lt;Directory /&gt;
        Options FollowSymLinks
        AllowOverride All
&lt;/Directory&gt;
}}}
да, сервер нужно перезапускать после внесения изменений в настройках :)
{{{
sudo /etc/init.d/apache2 force-reload
}}}

!Вам надо SSL? Пожалуйста
создаем сертификат
{{{
sudo make-ssl-cert /usr/share/ssl-cert/ssleay.cnf /etc/apache2/apache.pem
}}}

копируем настройки для будущего хоста
{{{
sudo cp /etc/apache2/sites-available/default /etc/apache2/sites-available/ssl
}}}

''Alt+F2'' {{{gksu gedit /etc/apache2/sites-available/default}}}

меняем первые две строки на:
{{{
NameVirtualHost *:80
&lt;VirtualHost *:80&gt;
}}}
Теперь к нему доступ будет происходить только по 80-му порту.

''Alt+F2'' {{{gksu gedit /etc/apache2/sites-available/ssl}}}
{{{
NameVirtualHost *:443

&lt;VirtualHost *:443&gt;

        …

        DocumentRoot …
        SSLEngine on
        SSLCertificateFile /etc/apache2/apache.pem

        …

}}}
А тут по 443, порту SSL

включаем SSL модуль и включаем хост:
{{{
a2enmod ssl
a2ensite ssl
}}}

уже пора запомнить, перезагружаем апач:
{{{
sudo /etc/init.d/apache2 force-reload
}}}

{{{https://localhost}}} — проверяем (скорее всего скажет, что неправильный сертификат)

А для того, чтобы апач не ругался при перезагрузке:

''Alt+F2'' {{{gksu gedit /etc/apache2/httpd.conf}}}
{{{
ServerName localhost
}}}
Итак, у нас теперь есть готовый веб-сервер с PHP и ~MySQL.

!А как же насчет Trac и SVN?
Есть несколько подходов к организации репозиториев, можно использовать для каждого проекта новый репозиторий, а можно использовать один репозиторий на несколько проектов. Первый способ лучше подходит для крупных компаний и для работы средней группы разработчиков над проектом, чтобы не путаться в большом потоке данных; второй проще, и лучше подходит для фрилансеров и небольших студий, на нем я и остановился.

!!Subversion
устанавливаем необходимые компоненты:
{{{
sudo apt-get install trac libapache2-svn subversion python-subversion libapache2-mod-python
}}}

включаем модуль для работы с Python’ом:
{{{
sudo a2enmod mod_python
}}}
или
{{{
sudo a2enmod python
}}}

создаем группу для работу с SVN, добавляем вашего пользователя в созданную группу и добавляем пользователя Apache в группу:
{{{
sudo groupadd svn
sudo usermod -a -G svn имя_вашего_пользователя
sudo usermod -a -G svn www-data
}}}

создаем папку для будущего репозитория и  сам репозиторий:
{{{
sudo mkdir /var/svn
sudo svnadmin create /var/svn
}}}
меняем права папке для доступа пользователям из группы SVN
{{{
sudo chown -R www-data:svn /var/svn
sudo chmod -R g+ws /var/svn
}}}

создайте пароль, который будет в последствии использоваться в Apache для доступа к папке
{{{
sudo htpasswd -c -m /etc/apache2/svn.htpasswd имя_вашего_пользователя
}}}

Теперь создадим правило для Apache:

''Alt+F2'' {{{gksu gedit /etc/apache2/conf.d/svn}}}

{{{
&lt;Location &quot;/svn&quot;&gt;
        DAV svn
        SVNPath /var/svn
        AuthType Basic
        AuthName &quot;SVN Repositories&quot;
        AuthUserFile /etc/apache2/svn.htpasswd
        Require valid-user
&lt;/Location&gt;
}}}
{{note{
''ЗАМЕЧАНИЕ:''
Если вы планируете поддержку множества SVN репозитариев, каждый из которых будет размещаться в соответствующих подкаталогах родительского каталога {{{/var/svn}}}, то в конфигурационном файле надо использовать вместо &quot;{{{SVNPath /var/svn}}}&quot; -- директиву &quot;{{{SVNParentPath /var/svn}}}&quot;, которая задает родительский каталог {{{/av/svn}}} для всех последующих репозитариев. Теперь, если вы в адресной строке браузера наберете, например: {{{http://localhost/svn/my-new-progect}}}, то автоматически svn сервер поймет, что вы собираетесь работать с проектом {{{my-new-project}}}, который находится в каталоге {{{/var/svn/my-new-project}}}.
{{{
&lt;Location /svn&gt;
        DAV svn
        
        # URL &quot;/svn/foo&quot;  будет указывать на соответсвующий репозитарий в каталоге /var/svn/foo
        SVNParentPath /var/svn
        
        ...

&lt;/Location&gt;
}}}
}}}

!!Trac
Повторяем практически идентичные операции, только для Trac
{{{
sudo mkdir /var/trac
sudo trac-admin /var/trac initenv
sudo chown -R www-data:svn /var/trac
sudo chmod -R g+ws /var/trac
sudo htpasswd -c -m /etc/apache2/trac.htpasswd имя_вашего_пользователя
}}}

''Alt+F2'' {{{gksu gedit /etc/apache2/conf.d/trac}}}

{{{
&lt;LocationMatch &quot;/trac/login&quot;&gt;
        AuthType Basic
        AuthName &quot;Projects&quot;
        AuthUserFile /etc/apache2/trac.htpasswd
        Require valid-user
&lt;/LocationMatch&gt;

&lt;Location /trac&gt;
        SetHandler mod_python
        PythonInterpreter main_interpreter
        PythonHandler trac.web.modpython_frontend
        PythonOption TracEnv /var/trac
        PythonOption TracUriRoot /trac                                           
&lt;/Location&gt;
}}}

!Заключение
Вот и все. По-моему ничего не забыл :)
Итого:
http://localhost — обычный доступ
https://localhost — безопасный доступ
http://localhost/svn — SVN, требует авторизации
http://localhost/trac — сам Trac
http://localhost/trac/login — вход в Trac, требует авторизации

!Обещанный бонус
У многих из нас есть широкополосный интернет, для доступа к вашему вышенастроенному серверу можно использовать ваш айпи-адрес. Но мне, например, такое не нравится. Для подобных целей есть достаточно удобный сервис [[DynDNS|https://www.dyndns.com/]]. После регистрации вы можете создать свой домен и привязать его к вашему адресу. У меня адрес меняется динамически, каждый раз редактировать на сайте я его не хочу. Для этого существует небольшой клиент inadyn

устанавливаем:
{{{
sudo aptitude install inadyn
}}}

''Alt+F2'' {{{gksu gedit /etc/inadyn.conf}}} — создаем файл настройки

{{{
--username ваше_имя_в_системе_DynDNS

--password ваш_вароль

--update_period 60000

--alias название.вашего.хоста

--background
}}}
запускаем клиент:
{{{
sudo /usr/sbin/inadyn
}}}

Теперь нужно добавить его в кронтаб, чтобы запускался автоматически
{{{
export EDITOR=gedit
sudo crontab -e
}}}
добавляем строку
{{{
@reboot /usr/sbin/inadyn
}}}
сохраняем и выходим.

Проверяем, записалось ли и смотрим, запущен или нет:
{{{
sudo crontab -l
ps -A | grep inadyn
}}}

!Оригинал статьи
*http://habrahabr.ru/blogs/ubuntu/20525/

!См. также
*[[Сервер дома - AMD, Debian x64, Bind9, Apache 2, PHP5, MySQL5, Trac, Subversion и море удовольствия|http://skazkin.habrahabr.ru/blog/45921/]]

!Ссылки
*TODO
</pre>
</div>
<div title="Установка и настройка Nginx. Nginx frontend + Apache backend. Установка mod_rpaf" modifier="Яковлев Иван" created="200906181253" modified="200907021222" tags="[[Nginx + Apache]]" changecount="16">
<pre>!Описание
Легкие веб-сервера набирают обороты. По статистике Google Online Security Blog в Интернете стоит около 4% веб серверов на Nginx. Всем известный rambler.ru крутится на nginx. Nginx действительно отличный веб-сервер который достоин внимания.

Перед нами стоит задача, поставить Nginx как frontend что бы он обрабатывал только некоторые типы файлов, как мы знаем типы файлов - css, js, jpg, gif, exe, tar, pdf и другие подобные - это статика, обрабатывая такие типы файлов легким веб-сервером nginx мы снизим нагрузку на веб-сервер Apache и получим хороший прирост к производительности.

!Установка
Установка Nginx занимает несколько секунд.
Debian:
{{{
sudo aptitude install nginx
}}}
~FreeBSD:
{{{
cd /usr/ports/www/nginx
make install clean
}}}
Конфигурационный файл nginx вы найдете у себя в
Debian/Ubuntu -- {{{/etc/nginx/nginx.conf}}}
~FreeBSD -- {{{/usr/local/etc/nginx/nginx.conf}}}

!Подготовка Apache
Настроим Apache, открываем конфигурационный файл, имя файла зависит от версии Apache и платформы. У меня вторая ветка Apache (2.2.x) на Debian/Ubuntu и ~FreeBSD платформах.

Debian/Ubuntu -- {{{/etc/apache2/ports.conf}}}
~FreeBSD -- {{{/usr/local/etc/apache2/httpd.conf}}}

Находим строку вида {{{Listen 80.100.100.10:80}}} где “80.100.100.10″ -- IP вашего сервера и устанавливаем порт, например: 81
{{{
Listen 80.100.100.10:81
}}}
Больше ничего не меняйте в конфиге Apache.

!Настройка Nginx
{{{
server {
    listen 80.100.100.10:80; # ip вашего сервера и порт
    server_name myexample.com www.myexample.com; # Имя вашего домена с www и без
    location / {
        proxy_pass http://80.100.100.10:81/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
     # Обрабатываемые типы файлов
    location ~* ^.+\.(htm|html|jpg|jpeg|gif|png|ico|css|zip|tgz|gz|rar|bz2|doc|xls|exe|pdf|ppt|txt|tar|wav|bmp|rtf|js)$ {
        root /home/www/myexample.com/httpdocs; # Путь к коренвевому каталогу вашего сайта
    }
}
}}}
Строки заголовка запроса {{{X-Real-IP}}} и {{{X-Forwarded-For}}} нужны будут вам если вы в своих скриптах используете информацию об ~IP-адресе посетителя или хотите скрыть от скриптов разделение на фрондэнд/бэкэнд и видеть нормальные IP пользователей, вместо IP фронтэнда, в таком случае вам необходимо будет дополнительно установить и настроить модуль ''mod_rpaf''.

!Установка mod_rpaf
Debian/Ubuntu
{{{
sudo aptitude install libapache2-mod-rpaf
}}}

~FreeBSD
{{{
cd /usr/ports/www/mod_rpaf
make install clean
}}}

Включаем модуль, если он еще не включен (но по умолчанию после установки в Ubuntu он должен быть включен автоматически):
{{{
sudo a2enmod rpaf
}}}
или второй вариант включения через ручное редактирование конфигов:
*откройте конфигурационный файл Apache и проверьте наличие следующей строки :
{{{
LoadModule rpaf_module        libexec/apache22/mod_rpaf.so
}}}
если такой строки нет, добавьте, но указывайте свой путь к файлу ''mod_rpaf.so''

И немного ниже добавьте следующие строки предварительно заменив “80.100.100.10″ на свой IP
{{note{
Для Ubuntu нижеприведенный текст конфигурации надо вставить в файл {{{/etc/apache2/httpd.conf}}}
}}}
{{{
RPAFenable On
RPAFsethostname On
RPAFproxy_ips 80.100.100.10
RPAFheader X-Forwarded-For
}}}

!См. также
*[[Установка Nginx-PHP5-FastCGI-XCache-MySQL на Ubuntu]]
*[[Разгоняем веб-сервер|Разгоняем веб-сервер ngnix + Apache + mod_praf]]

*http://sysoev.ru/nginx/docs/install.html -- установка ngnix
*http://wiki.nginx.org//NginxXSendfile -- wiki по nginx на англ.

*http://opennet.ru/base/net/nginx_ipb.txt.html -- еще одна статья с open.net по установке и конфигурированию nginx

!Ссылки
*[[Оригинал статьи|http://server-help.ru/?cat=4]]


</pre>
</div>
<div title="Установка и настройка SSHD в среде chroot при помощи makejail" modifier="Яковлев Иван" created="200906052313" modified="200906061803" tags="Безопасность Статьи [[Администрирование сервера]]" changecount="9">
<pre>!Описание
Иногда возникает необходимость ограничить пользователя который имеет доступ по ssh, конечно это можно реализовать выставив права на лиректории, урезав права пользователю и тд. Но сменив корневую директорию для пользователя и ограничив его набором программ которые вы выбрали сами гораздо безопаснее. В этой статье я опишу как настроить SSHD на работу с chroot, применяя ограничения только к нужным пользователям. Для настроки нам понадобятся измененная версия SSHD и пакет makejail  который создает chroot окружение для программ автоматически, используя конфигурационные файлы. Есть и минусы, так как на сегодня имеется не самая свежая версия пакета sshd, а именно версии 4.3.2. Установку и настройку я проводил на системе Ubuntu 8.04, но на странице где можно скачать пропатченный SSHD имеются исходные коды, которые можно собрать на других операционных системах.

Установим необходимое програмное обеспечение командой
{{{
apt-get update
apt-get install makejail
}}}
Затем создадим конфигурационный файл для этой программы, он понадобится нам для создания среды chroot с набором необходимых программ, библиотек и прочего.
{{{
touch /etc/makejail/sshd.py
}}}
Ниже я приведу свой файл, вы можете изменить там директорию для chroot, имена пользователей, а так же набор программ, вписав названия в секцию packages
{{{
chroot=&quot;/mnt/chroot&quot;
forceCopy=[&quot;/etc/ssh/ssh_host*&quot;,&quot;/etc/ssh/sshd*&quot;,&quot;/etc/ssh/moduli&quot;,
&quot;/etc/pam.conf&quot;,&quot;/etc/security/*&quot;,&quot;/etc/pam.d/ssh&quot;,&quot;/etc/pam.d/other&quot;,
&quot;/etc/hosts&quot;,&quot;/etc/nsswitch.conf&quot;,
&quot;/var/run/sshd&quot;,&quot;/lib/security/*&quot;,
&quot;/etc/shells&quot;, &quot;/etc/nologin&quot;,&quot;/etc/environment&quot;,&quot;/etc/motd&quot;,
&quot;/etc/shadow&quot;,&quot;/etc/hosts*&quot;,
&quot;/bin/*sh&quot;, &quot;/lib/libnss*&quot;,
&quot;/dev/pt*&quot;,&quot;/dev/ttyp[0-9]*&quot;]
packages=[&quot;fileutils&quot;]
preserve=[&quot;/dev/&quot;,&quot;/var/www&quot;,&quot;/etc&quot;,&quot;/usr&quot;,&quot;/lib&quot;,&quot;/etc/ssh&quot;]
userFiles=[&quot;/etc/passwd&quot;,&quot;/etc/shadow&quot;]
groupFiles=[&quot;/etc/group&quot;,&quot;/etc/gshadow&quot;]
users=[&quot;sshd&quot;,&quot;tester&quot;]
groups=[&quot;sshd&quot;,&quot;tester&quot;]
testCommandsInsideJail=[&quot;start-stop-daemon --start --quiet --pidfile /var/run/sshd.pid --exec /usr/sbin/sshd&quot;]
testCommandsOutsideJail=[&quot;ssh localhost&quot;]
processNames=[&quot;sshd&quot;]
}}}
Установим пропатченный SSHD, который имеет поддержку chroot. Так же придется заменить и клиент, что бы версии совпадали.
{{{
wget http://debian.home-dn.net/etch/ssh/openssh-server_4.3p2-9etch2-chroot4.3p1_i386.deb
wget http://debian.home-dn.net/etch/ssh/openssh-client_4.3p2-9etch2-chroot4.3p1_i386.deb
dpkg -i openssh-client_4.3p2-9etch2-chroot4.3p1_i386.deb openssh-server_4.3p2-9etch2-chroot4.3p1_i386.deb
}}}
Cоздадим тестового пользователя с логином tester 
{{{
sudo useradd -m -d /mnt/chroot/home/tester -s /bin/bash -p secret tester
}}}
где:
;{{{-m}}}
:Создает начальный каталог нового пользователя, если он еще не существует. Если каталог уже существует, добавляемый пользователь должен иметь права на доступ к указанному каталогу.
;{{{-d каталог}}}
:Начальный каталог (home directory) нового пользователя. Длина этого поля не должна превосходить 256 символов. По умолчанию используется {{{HOMEDIR/рег_имя}}}, где ''HOMEDIR'' - базовый каталог для начальных каталогов новых пользователей, а ''рег_имя'' - регистрационное имя нового пользователя.
;{{{-s shell}}}
:Полный путь к программе, используемой в качестве начального командного интерпретатора для пользователя сразу после регистрации. Длина этого поля не должна превосходить 256 символов. По умолчанию это поле - пустое, что заставляет систему использовать стандартный командный интерпретатор {{{/usr/bin/sh}}}. В качестве значения shell должен быть указан существующий выполняемый файл.
;{{{-p passgen}}}
:Указывает, что поле FLAG в файле {{{/etc/shadow}}} должно быть установлено в указанное значение. К этому полю обращается команда ''passwd'', чтобы определить, действует ли для данного пользователя генератор паролей. Если опция {{{-p}}} явно не задана, проверяется запись ~FORCED_PASS в файле {{{/etc/default/useradd}}}, чтобы определить значение для соответствующего поля в {{{/etc/shadow}}}. Если записи ~FORCED_PASS нет в {{{/etc/default/useradd}}}, в соответствующем поле записи в {{{/etc/shadow}}} значения не будет. Если значение ~FORCED_PASS равно 1, запись в {{{/etc/shadow}}} получает значение 1. Если значение ''passgen'' не пустое и не является печатным символом ASCII, выдается диагностическое сообщение.

Если вы заглянете в файл {{{/etc/passwd}}} то увидите там примерно следующее:
{{{
tester:x:142:142::/mnt/chroot/home/tester:/bin/bash
}}}
Для того что бы наш пользователь при входе по SSH попадал в chroot необходимо изменить строку в {{{/etc/passwd}}} вот так:
{{{
tester:x:142:142::/mnt/chroot/./home/tester:/bin/bash
}}}
Мы добавили в строку символы &quot;{{{/./}}}&quot;, которые и сменят корневой каталог для нашего пользователя вместо &quot;{{{/}}}&quot; на &quot;{{{/mnt/chroot}}}&quot;

Теперь запустим программу makejail для создания chroot среды
{{{
makejail /etc/makejail/sshd.py
}}}
Она автоматически скопирует все необходимое и запустит демона SSHD. После этого попробуйте выполнить вход на сервер от пользователя tester.

Для того что бы наш SSH сервер при перезагрузках и рестартах стартовал в созданной нами изолированной среде немного подправим скрипт {{{/etc/init.d/ssh}}} изменив строку “{{{start-stop-daemon …}}}” на “{{{chroot /var/chroot/sshd start-stop-daemon …}}}”

Вот собственно и все.

!См. также
*[[chroot - выполнение команды или оболочки shell с особым корневым каталогом]]

!Ссылки
*[[Оригинал статьи|http://sudouser.com/ustanovka-i-nastrojka-sshd-v-srede-chroot-pri-pomoshhi-makejail.html]]



</pre>
</div>
<div title="Установка контроллера DNS на BIND в Ubuntu" modifier="Яковлев Иван" created="200906051243" modified="200906261800" tags="[[Установка/настройка сервера]] [[TODO - нужен перевод статьи]]" changecount="29">
<pre>!Содержание статьи
*''Описание''
*''Установка''
*''Настройка''
**Обзор
**Кеширующий сервер имен (Caching Nameserver)
**Primary Master
***//Forward Zone File//
***//Reverse Zone File//
**Secondary Master
*''Возможные проблемы''
**Тестирование
***//resolv.conf//
***//dig//
***//ping//
***//named-checkzone//
**Ведение лога
*''Дополнительные материалы''
*''См. также''
*''Ссылки''

!Описание
''Domain Name Service'' (DNS) is an Internet service that maps IP addresses and fully qualified domain names (FQDN) to one another. In this way, DNS alleviates the need to remember IP addresses. Computers that run DNS are called name servers. Ubuntu ships with ''BIND'' (Berkley Internet Naming Daemon), the most common program used for maintaining a name server on Linux.

!Установка
Чтобы установить DNS введите в командной строке терминала следующую команду: 
{{{
sudo apt-get update
sudo apt-get install bind9
}}}
Так же очень пригодится для диагностики и тестирования DNS пакет ''dnsutil''. Что бы его установить, наберите:
{{{
sudo apt-get install dnsutils
}}}

!Настройка
There a many ways to configure ~BIND9. Some of the most common configurations are a caching nameserver, primary master, and a as a secondary master. 
*When configured as a caching nameserver ~BIND9 will find the answer to name queries and remember the answer when the domain is queried again. 
*As a primary master server ~BIND9 reads the data for a zone from a file on it's host and is authoritative for that zone. 
*In a secondary master configuration ~BIND9 gets the zone data from another nameserver authoritative for the zone.

!!Обзор
The DNS configuration files are stored in the {{{/etc/bind}}} directory. The primary configuration file is {{{/etc/bind/named.conf}}}. 

The include line specifies the filename which contains the DNS options. The directory line in the {{{/etc/bind/named.conf.options}}} file tells DNS where to look for files. All files BIND uses will be relative to this directory. 

The file named {{{/etc/bind/db.root}}} describes the root nameservers in the world. The servers change over time, so the {{{/etc/bind/db.root}}} file must be maintained now and then. This is usually done as updates to the bind9 package. The zone section defines a master server, and it is stored in a file mentioned in the file option. 

It is possible to configure the same server to be a caching name server, primary master, and secondary master. A server can be the Start of Authority (SOA) for one zone, while providing secondary service for another zone. All the while providing caching services for hosts on the local LAN.

!!Кеширующий сервер имен (Caching Nameserver)
The default configuration is setup to act as a caching server. All that is required is simply adding the IP Addresses of your ISP's DNS servers. Simply uncomment and edit the following in {{{/etc/bind/named.conf.options}}}:
{{terminal{
{{{
forwarders {
                1.2.3.4;
                5.6.7.8;
           }; 	
}}}
}}}
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
Replace 1.2.3.4 and 5.6.7.8 with the IP Adresses of actual nameservers. 
}}}
Now restart the DNS server, to enable the new configuration. From a terminal prompt:
{{{
sudo /etc/init.d/bind9 restart
}}}
See [[the section called “dig”|https://help.ubuntu.com/9.04/serverguide/C/dns-troubleshooting.html#dns-testing-dig]] for information on testing a caching DNS server.

!!Primary Master
In this section ~BIND9 will be configured as the Primary Master for the domain ''example.com''. Simply replace example.com with your ''FQDN'' (''Fully Qualified Domain Name''). 

!!!Forward Zone File
To add a DNS zone to ~BIND9, turning ~BIND9 into a Primary Master server, the first step is to edit {{{/etc/bind/named.conf.local}}}:
{{terminal{
{{{
zone &quot;example.com&quot; {
	type master;
        file &quot;/etc/bind/db.example.com&quot;;
};
}}}
}}}
Now use an existing zone file as a template to create the {{{/etc/bind/db.example.com}}} file:
{{{
sudo cp /etc/bind/db.local /etc/bind/db.example.com
}}}
Edit the new zone file {{{/etc/bind/db.example.com}}} change ''localhost''. to the FQDN of your server, leaving the additional &quot;{{{.}}}&quot; at the end. Change 127.0.0.1 to the nameserver's IP Address and ''root.localhost'' to a valid email address, but with a &quot;{{{.}}}&quot; instead of the usual &quot;{{{@}}}&quot; symbol, again leaving the &quot;{{{.}}}&quot; at the end. 

Also, create an A record for ns.example.com. The name server in this example:
{{terminal{
{{{
;
; BIND data file for local loopback interface
;
$TTL    604800
@       IN      SOA     ns.example.com. root.example.com. (
                              2         ; Serial
                         604800         ; Refresh
                          86400         ; Retry
                        2419200         ; Expire
                         604800 )       ; Negative Cache TTL
;
@       IN      NS      ns.example.com.
@       IN      A       127.0.0.1
@       IN      AAAA    ::1
ns      IN      A       192.168.1.10
}}}
}}}
You must increment the Serial Number every time you make changes to the zone file. If you make multiple changes before restarting ~BIND9, simply increment the Serial once. 

Now, you can add DNS records to the bottom of the zone file. See [[the section called “Common Record Types” for details|https://help.ubuntu.com/9.04/serverguide/C/dns-references.html#dns-record-types]].
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
Many admins like to use the last date edited as the serial of a zone, such as 2007010100 which is yyyymmddss (where ss is the Serial Number) 
}}}
Once you have made a change to the zone file ~BIND9 will need to be restarted for the changes to take effect:
{{{
sudo /etc/init.d/bind9 restart
}}}

!!!Reverse Zone File
Now that the zone is setup and resolving names to IP Adresses a Reverse zone is also required. A Reverse zone allows DNS to resolve an address to a name. 

Edit {{{/etc/bind/named.conf.local}}} and add the following: 
{{terminal{
{{{
zone &quot;1.168.192.in-addr.arpa&quot; {
        type master;
        notify no;
        file &quot;/etc/bind/db.192&quot;;
}; 	
}}}
}}}
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
Replace 1.168.192 with the first three octets of whatever network you are using. Also, name the zone file {{{/etc/bind/db.192}}} appropriately. It should match the first octet of your network. 
}}}
Now create the {{{/etc/bind/db.192}}} file: 
{{{
sudo cp /etc/bind/db.127 /etc/bind/db.192
}}}
Next edit {{{/etc/bind/db.192}}} changing the basically the same options as {{{/etc/bind/db.example.com}}}:
{{terminal{
{{{
;
; BIND reverse data file for local loopback interface
;
$TTL    604800
@       IN      SOA     ns.example.com. root.example.com. (
                              2         ; Serial
                         604800         ; Refresh
                          86400         ; Retry
                        2419200         ; Expire
                         604800 )       ; Negative Cache TTL
;
@       IN      NS      ns.
10      IN      PTR     ns.example.com.
}}}
}}}
The Serial Number in the Reverse zone needs to be incremented on each changes as well. For each A record you configure in {{{/etc/bind/db.example.com}}} you need to create a PTR record in {{{/etc/bind/db.192}}}. 

After creating the reverse zone file restart ~BIND9:
{{{
sudo /etc/init.d/bind9 restart
}}}

!!Secondary Master
Once a Primary Master has been configured a Secondary Master is needed in order to maintain the availability of the domain should the Primary become unavailable. 

First, on the Primary Master server, the zone transfer needs to be allowed. Add the allow-transfer option to the example Forward and Reverse zone definitions in {{{/etc/bind/named.conf.local}}}:
{{terminal{
{{{
zone &quot;example.com&quot; {
        type master;
	file &quot;/etc/bind/db.example.com&quot;;
        allow-transfer { 192.168.1.11; };
};

zone &quot;1.168.192.in-addr.arpa&quot; {
        type master;
        notify no;
        file &quot;/etc/bind/db.192&quot;;
	allow-transfer { 192.168.1.11; };
}; 	
}}}
}}}
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
Replace 192.168.1.11 with the IP Address of your Secondary nameserver. 
}}}
Next, on the Secondary Master, install the ''bind9 package'' the same way as on the Primary. Then edit the {{{/etc/bind/named.conf.local}}} and add the following declarations for the Forward and Reverse zones:
{{terminal{
{{{
zone &quot;example.com&quot; {
	type slave;
        file &quot;/var/cache/bind/db.example.com&quot;;
        masters { 192.168.1.10; };
};        
      
zone &quot;1.168.192.in-addr.arpa&quot; {
	type slave;
        file &quot;/var/cache/bind/db.192&quot;;
        masters { 192.168.1.10; };
}; 	
}}}
}}}
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
Replace 192.168.1.10 with the IP Address of your Primary nameserver. 
}}}
Restart ~BIND9 on the Secondary Master: 
{{{
sudo /etc/init.d/bind9 restart
}}}
In {{{/var/log/syslog}}} you should see something similar to:
{{terminal{
{{{
slave zone &quot;example.com&quot; (IN) loaded (serial 6)
slave zone &quot;100.18.172.in-addr.arpa&quot; (IN) loaded (serial 3) 	
}}}
}}}
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
Note: A zone is only transferred if the Serial Number on the Primary is larger than the one on the Secondary. 
}}}
The default directory for non-authoritative zone files is {{{/var/cache/bind/}}}. This directory is also configured in ~AppArmor to allow the named daemon to write to. For more information on ~AppArmor see the section called “[[AppArmor]]”.

!Возможные проблемы
This section covers ways to help determine the cause when problems happen with DNS and ~BIND9.

!!Тестирование
!!!resolv.conf
The first step in testing ~BIND9 is to add the nameserver's IP Address to a hosts resolver. The Primary nameserver should be configured as well as another host to double check things. Simply edit /etc/resolv.conf and add the following: 
{{terminal{
{{{
nameserver	192.168.1.10
nameserver	192.168.1.11 	
}}}
}}}
You should also add the IP Address of the Secondary nameserver in case the Primary becomes unavailable.

!!!dig
If you installed the dnsutils package you can test your setup using the DNS lookup utility dig:
1. After installing ~BIND9 use dig against the loopback interface to make sure it is listening on port 53. From a terminal prompt:
{{{
dig -x 127.0.0.1
}}}
You should see lines similar to the following in the command output: 
{{terminal{
{{{
;; Query time: 1 msec
;; SERVER: 192.168.1.10#53(192.168.1.10)
}}}
}}}
2. If you have configured ~BIND9 as a Caching nameserver &quot;{{{dig}}}&quot; an outside domain to check the query time:
{{{
dig ubuntu.com
}}}
Note the query time toward the end of the command output:
{{terminal{
{{{
;; Query time: 49 msec
}}}
}}}
After a second dig there should be improvement: 
{{terminal{
{{{
;; Query time: 1 msec
}}}
}}}

!!!ping
Now to demonstrate how applications make use of DNS to resolve a host name use the ping utility to send an ICMP echo request. From a terminal prompt enter: 
{{{
ping example.com
}}}
This tests if the nameserver can resolve the name ns.example.com to an IP Address. The command output should resemble: 
{{terminal{
{{{
PING ns.example.com (192.168.1.10) 56(84) bytes of data.
64 bytes from 192.168.1.10: icmp_seq=1 ttl=64 time=0.800 ms
64 bytes from 192.168.1.10: icmp_seq=2 ttl=64 time=0.813 ms
}}}
}}}

!!!named-checkzone
A great way to test your zone files is by using the ''named-checkzone'' utility installed with the ''bind9 package''. This utility allows you to make sure the configuration is correct before restarting ~BIND9 and making the changes live. 

To test our example Forward zone file enter the following from a command prompt: 
{{{
named-checkzone example.com /etc/bind/db.example.com
}}}
If everything is configured correctly you should see output similar to: 
{{{
zone example.com/IN: loaded serial 6
OK
}}}
Similarly, to test the Reverse zone file enter the following: 
{{{
named-checkzone example.com /etc/bind/db.192
}}}
The output should be similar to: 
{{{
zone example.com/IN: loaded serial 3
OK 	
}}}
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
The //Serial Number// of your zone file will probably be different.
}}}

!!Ведение лога
~BIND9 has a wide variety of logging configuration options available. There are two main options. The channel option configures where logs go, and the the category option determines what information to log. 

If no logging option is configured the default option is: 
{{terminal{
{{{
logging {
     category default { default_syslog; default_debug; };
     category unmatched { null; };
};
}}}
}}}
This section covers configuring ~BIND9 to send debug messages related to DNS queries to a separate file.

1. First, we need to configure a channel to specify which file to send the messages to. Edit {{{/etc/bind/named.conf.local}}} and add the following: 
{{terminal{
{{{
logging {
    channel query.log {      
        file &quot;/var/log/query.log&quot;;
        severity debug 3; 
    }; 
};
}}}
}}}
2. Next, configure a category to send all DNS queries to the query file: 
{{terminal{
{{{
logging {
    channel query.log {      
        file &quot;/var/log/query.log&quot;; 
        severity debug 3; 
    }; 
    category queries { query.log; }; 
}; 	
}}}
}}}
{{note{
''ЗАМЕЧАНИЕ:''
Note: the debug option can be set from 1 to 3. If a level isn't specified level 1 is the default. 
}}}

3. Since the named daemon runs as the bind user the /var/log/query.log file must be created and the ownership changed: 
{{{
sudo touch /var/log/query.log
sudo chown bind /var/log/query.log
}}}

4. Before named daemon can write to the new log file the AppArmor profile must be updated. First, edit /{{{etc/apparmor.d/usr.sbin.named}}} and add: 
{{terminal{
{{{
/var/log/query.log w,
}}}
}}}

5. Next, reload the profile: 
{{{
cat /etc/apparmor.d/usr.sbin.named | sudo apparmor_parser -r
}}}
For more information on ~AppArmor see the section called “[[AppArmor]]” 

6. Now restart ~BIND9 for the changes to take effect: 
{{{
sudo /etc/init.d/bind9 restart
}}}
You should see the file {{{/var/log/query.log}}} fill with query information. This is a simple example of the ~BIND9 logging options. For coverage of advanced options see the section called “[[More Information|https://help.ubuntu.com/9.04/serverguide/C/dns-references.html#dns-more-info]]”.

!Дополнительные материалы
This section covers some of the most common DNS record types. 

1. A record: This record maps an IP Address to a hostname. 
{{terminal{
{{{
www      IN    A      192.168.1.12
}}}
}}}

2. CNAME record: Used to create an alias to an existing A record. You cannot create a CNAME record pointing to another CNAME record. 
{{terminal{
{{{
web     IN    CNAME  www
}}}
}}}

3. MX record: Used to define where email should be sent to. Must point to an A record, not a CNAME. 
{{terminal{
{{{
        IN    MX      mail.example.com.
mail    IN    A       192.168.1.13
}}}
}}}

4. NS record: Used to define which servers serve copies of a zone. It must point to an A record, not a CNAME. This is where Primary and Secondary servers are defined. 
{{terminal{
{{{
        IN    NS     ns.example.com.
        IN    NS     ns2.example.com.
ns      IN    A      192.168.1.10
ns2     IN    A	     192.168.1.11
}}}
}}}

!См. также
*The [[DNS HOWTO|http://www.tldp.org/HOWTO/DNS-HOWTO.html]] explains more advanced options for configuring ~BIND9. 
*For in depth coverage of DNS and ~BIND9 see [[Bind9.net|http://www.bind9.net/]]. 
*[[DNS and BIND|http://www.oreilly.com/catalog/dns5/index.html]] is a popular book now in it's fifth edition. 
*A great place to ask for ~BIND9 assistance, and get involved with the Ubuntu Server community, is the #ubuntu-server IRC channel on [[freenode|http://freenode.net/]].

!Ссылки
*[[Описание на ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/dns.html]]
*[[Установка и настройка DNS сервера bind9 Ubuntu-Debian HOWTO|http://sudouser.com/ustanovka-i-nastrojka-dns-servera-bind9-ubuntu-debian-howto.html]]


</pre>
</div>
<div title="Установка контроллера домена на Samba" modifier="Яковлев Иван" created="200906042306" modified="200906052338" tags="[[Установка/настройка сервера]] TODO" changecount="2">
<pre>!Описание
TODO

!См. также
*[[Установка Samba сервера на Ubuntu или Debian за 5 минут]]

!Ссылки
*[[Описание на ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/samba-dc.html]]




</pre>
</div>
<div title="Установка почтового сервера Postfix + Dovecot + MYSQL и виртуальных доменов" modifier="Яковлев Иван" created="200906052342" tags="[[Установка/настройка сервера]] Postfix Статьи TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/ustanovka-pochtovogo-servera-postfix-dovecot-mysql-i-virtualnyx-domenov.html#more-109]]



</pre>
</div>
<div title="Установка принтсервера CUPS" modifier="Яковлев Иван" created="200906042303" modified="200906042303" tags="[[Установка/настройка сервера]] TODO" changecount="2">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Описание на ubuntu.com|TODO]]


</pre>
</div>
<div title="Установка принтсервера Samba" modifier="Яковлев Иван" created="200906042304" modified="200906052339" tags="[[Установка/настройка сервера]] TODO" changecount="2">
<pre>!Описание
TODO

!См. также
*[[Установка Samba сервера на Ubuntu или Debian за 5 минут]]

!Ссылки
*[[Описание на ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/samba-printserver.html]]


</pre>
</div>
<div title="Установка прокси сервера Squid" modifier="Яковлев Иван" created="200906042214" modified="200906042223" tags="[[Установка/настройка Web-сервера]] [[TODO - нужен перевод статьи]]" changecount="2">
<pre>!Описание
Squid is a full-featured web proxy cache server application which provides proxy and cache services for Hyper Text Transport Protocol (HTTP), File Transfer Protocol (FTP), and other popular network protocols. Squid can implement caching and proxying of Secure Sockets Layer (SSL) requests and caching of Domain Name Server (DNS) lookups, and perform transparent caching. Squid also supports a wide variety of caching protocols, such as Internet Cache Protocol, (ICP) the Hyper Text Caching Protocol, (HTCP) the Cache Array Routing Protocol (CARP), and the Web Cache Coordination Protocol. (WCCP) 

The Squid proxy cache server is an excellent solution to a variety of proxy and caching server needs, and scales from the branch office to enterprise level networks while providing extensive, granular access control mechanisms and monitoring of critical parameters via the Simple Network Management Protocol (SNMP). When selecting a computer system for use as a dedicated Squid proxy, or caching servers, ensure your system is configured with a large amount of physical memory, as Squid maintains an in-memory cache for increased performance.

!Установка
At a terminal prompt, enter the following command to install the Squid server: 
{{{
sudo apt-get install squid
}}}

!Настройка
Squid is configured by editing the directives contained within the {{{/etc/squid/squid.conf}}} configuration file. The following examples illustrate some of the directives which may be modified to affect the behavior of the Squid server. For more in-depth configuration of Squid, see the References section.  	
{{note{
@@font-weght: bold;ЗАМЕЧАНИЕ:@@
Prior to editing the configuration file, you should make a copy of the original file and protect it from writing so you will have the original settings as a reference, and to re-use as necessary. 
}}}
Copy the {{{/etc/squid/squid.conf}}} file and protect it from writing with the following commands entered at a terminal prompt: 
{{{
sudo cp /etc/squid/squid.conf /etc/squid/squid.conf.original
sudo chmod a-w /etc/squid/squid.conf.original
}}}

To set your Squid server to listen on TCP port 8888 instead of the default TCP port 3128, change the ''http_port'' directive as such: 
{{{
http_port 8888
}}}
Change the visible_hostname directive in order to give the Squid server a specific hostname. This hostname does not necessarily need to be the computer's hostname. In this example it is set to weezie 
{{{
visible_hostname weezie
}}}
Again, Using Squid's access control, you may configure use of Internet services proxied by Squid to be available only users with certain Internet Protocol (IP) addresses. For example, we will illustrate access by users of the 192.168.42.0/24 subnetwork only: 

Add the following to the bottom of the ACL section of your {{{/etc/squid/squid.conf}}} file: 
{{{
acl fortytwo_network src 192.168.42.0/24
}}}
Then, add the following to the top of the http_access section of your /etc/squid/squid.conf file: 
{{{
http_access allow fortytwo_network
}}}
Using the excellent access control features of Squid, you may configure use of Internet services proxied by Squid to be available only during normal business hours. For example, we'll illustrate access by employees of a business which is operating between 9:00AM and 5:00PM, Monday through Friday, and which uses the 10.1.42.0/42 subnetwork: 
{{{
Add the following to the bottom of the ACL section of your /etc/squid/squid.conf file: 
acl biz_network src 10.1.42.0/24
acl biz_hours time M T W T F 9:00-17:00
}}}
Then, add the following to the top of the http_access section of your /etc/squid/squid.conf file:
{{{ 
http_access allow biz_network biz_hours
 }}}
{{note{
@@fot-weight: bold;ЗАМЕЧАНИЕ:@@
After making changes to the {{{/etc/squid/squid.conf}}} file, save the file and restart the squid server application to effect the changes using the following command entered at a terminal prompt: 
}}}
{{{
sudo /etc/init.d/squid restart
}}}

!Ссылки
*[[Описание на ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/squid.html]]
*http://www.squid-cache.org/ -- официальный сайт


</pre>
</div>
<div title="Установка сервера Apache" modifier="Яковлев Иван" created="200906042102" modified="200906181745" tags="[[TODO - нужен перевод статьи]] [[Настройка Apache]]" changecount="19">
<pre>!Описание
Apache is the most commonly used Web Server on Linux systems. Web Servers are used to serve Web Pages requested by client computers. Clients typically request and view Web Pages using Web Browser applications such as Firefox, Opera, or Mozilla.

Users enter a Uniform Resource Locator (URL) to point to a Web server by means of its Fully Qualified Domain Name (FQDN) and a path to the required resource. For example, to view the home page of the Ubuntu Web site a user will enter only the FQDN. To request specific information about paid support, a user will enter the FQDN followed by a path.

The most common protocol used to transfer Web pages is the Hyper Text Transfer Protocol (HTTP). Protocols such as Hyper Text Transfer Protocol over Secure Sockets Layer (HTTPS), and File Transfer Protocol (FTP), a protocol for uploading and downloading files, are also supported.

Apache Web Servers are often used in combination with the ~MySQL database engine, the ~HyperText Preprocessor (PHP) scripting language, and other popular scripting languages such as Python and Perl. This configuration is termed LAMP (Linux, Apache, ~MySQL and Perl/Python/PHP) and forms a powerful and robust platform for the development and deployment of Web-based applications.

!Установка
The Apache2 web server is available in Ubuntu Linux. To install Apache2: 
*At a terminal prompt enter the following command: 
{{{
sudo apt-get install apache2
}}}

!Настройка
Apache2 is configured by placing directives in plain text configuration files. The configuration files are separated between the following files and directories: 
;{{{apache2.conf}}}
:the main Apache2 configuration file. Contains settings that are global to Apache2. 
;{{{conf.d}}}
:contains configuration files which apply globally to Apache. Other packages that use Apache2 to serve content may add files, or symlinks, to this directory. 
;{{{envvars}}}
:file where Apache2 environment variables are set. 
;{{{httpd.conf}}}
:historically the main Apache2 configuration file, named after the httpd daemon. The file can be used for user specific configuration options that globally effect Apache2. 
;{{{mods-available}}}
:this directory contains configuration files to both load modules and configure them. Not all modules will have specific configuration files, however. 
;{{{mods-enabled}}}
:holds symlinks to the files in {{{/etc/apache2/mods-available}}}. When a module configuration file is symlinked it will be enabled the next time apache2 is restarted. 
;{{{ports.conf}}}
:houses the directives that determine which TCP ports Apache2 is listening on. 
;{{{sites-available}}}
:this directory has configuration files for Apache Virtual Hosts. Virtual Hosts allow Apache2 to be configured for multiple sites that have separate configurations. 
;{{{sites-enabled}}}
:like ''mods-enabled'', ''sites-enabled'' contains symlinks to the {{{/etc/apache2/sites-available}}} directory. Similarly when a configuration file in sites-available is symlinked it will be active once Apache is restarted. 

In addition, other configuration files may be added using the Include directive, and wildcards can be used to include many configuration files. Any directive may be placed in any of these configuration files. Changes to the main configuration files are only recognized by Apache2 when it is started or restarted. 

The server also reads a file containing mime document types; the filename is set by the ~TypesConfig directive, and is {{{/etc/mime.types}}} by default.

!!Базовые настройки
This section explains Apache2 server essential configuration parameters. Refer to the [[Apache2 Documentation|http://httpd.apache.org/docs/2.2/]] for more details.

Apache2 ships with a virtual-host-friendly default configuration. That is, it is configured with a single default virtual host (using the ~VirtualHost directive) which can modified or used as-is if you have a single site, or used as a template for additional virtual hosts if you have multiple sites. If left alone, the default virtual host will serve as your default site, or the site users will see if the URL they enter does not match the ~ServerName directive of any of your custom sites. To modify the default virtual host, edit the file {{{/etc/apache2/sites-available/default}}}.
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
The directives set for a virtual host only apply to that particular virtual host. If a directive is set server-wide and not defined within the virtual host settings, the default setting is used. For example, you can define a Webmaster email address and not define individual email addresses for each virtual host.
}}}
If you wish to configure a new virtual host or site, copy that file into the same directory with a name you choose. For example: 
{{{
sudo cp /etc/apache2/sites-available/default /etc/apache2/sites-available/mynewsite
}}}
Edit the new file to configure the new site using some of the directives described below.

The ''~ServerAdmin'' directive specifies the email address to be advertised for the server's administrator. The default value is {{{webmaster@localhost}}}. This should be changed to an email address that is delivered to you (if you are the server's administrator). If your website has a problem, Apache2 will display an error message containing this email address to report the problem to. Find this directive in your site's configuration file in {{{/etc/apache2/sites-available}}}. 

The ''Listen'' directive specifies the port, and optionally the IP address, Apache2 should listen on. If the IP address is not specified, Apache2 will listen on all IP addresses assigned to the machine it runs on. The default value for the Listen directive is ''80'' Change this to ''127.0.0.1:80'' to cause Apache2 to listen only on your loopback interface so that it will not be available to the Internet, to (for example) ''81'' to change the port that it listens on, or leave it as is for normal operation. This directive can be found and changed in its own file, {{{/etc/apache2/ports.conf}}} 

The ''~ServerName'' directive is optional and specifies what FQDN your site should answer to. The default virtual host has no ''~ServerName'' directive specified, so it will respond to all requests that do not match a ''~ServerName'' directive in another virtual host. If you have just acquired the domain name ubunturocks.com and wish to host it on your Ubuntu server, the value of the ''~ServerName'' directive in your virtual host configuration file should be ubunturocks.com. Add this directive to the new virtual host file you created earlier ({{{/etc/apache2/sites-available/mynewsite}}}). 

You may also want your site to respond to {{{www.ubunturocks.com}}}, since many users will assume the www prefix is appropriate. Use the ''~ServerAlias'' directive for this. You may also use wildcards in the ''~ServerAlias'' directive. 

For example, the following configuration will cause your site to respond to any domain request ending in {{{.ubunturocks.com}}}. 
{{{
ServerAlias *.ubunturocks.com
}}}
The ''~DocumentRoot'' directive specifies where Apache should look for the files that make up the site. The default value is {{{/var/www}}}. No site is configured there, but if you uncomment the ''~RedirectMatch'' directive in {{{/etc/apache2/apache2.conf}}} requests will be redirected to {{{/var/www/apache2-default}}} where the default Apache2 site awaits. Change this value in your site's virtual host file, and remember to create that directory if necessary!

The {{{/etc/apache2/sites-available}}} directory is not parsed by Apache2. Symbolic links in {{{/etc/apache2/sites-enabled}}} point to &quot;available&quot; sites. 

Enable the new ~VirtualHost using the ''a2ensite'' utility and restart Apache:
{{{
sudo a2ensite mynewsite
sudo /etc/init.d/apache2 restart
}}}

{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
Be sure to replace mynewsite with a more descriptive name for the ~VirtualHost. One method is to name the file after the ''~ServerName'' directive of the ~VirtualHost.
}}}
Similarly, use the ''a2dissite'' utility to disable sites. This is can be useful when troubleshooting configuration problems with multiple ~VirtualHosts: 
{{{
sudo a2dissite mynewsite
sudo /etc/init.d/apache2 restart
}}}

!!Настройки по-умолчанию
This section explains configuration of the Apache2 server default settings. For example, if you add a virtual host, the settings you configure for the virtual host take precedence for that virtual host. For a directive not defined within the virtual host settings, the default value is used. 

The ''~DirectoryIndex'' is the default page served by the server when a user requests an index of a directory by specifying a forward slash ({{{/}}}) at the end of the directory name. 

For example, when a user requests the page {{{http://www.example.com/this_directory/}}}, he or she will get either the ''~DirectoryIndex'' page if it exists, a server-generated directory list if it does not and the Indexes option is specified, or a Permission Denied page if neither is true. The server will try to find one of the files listed in the ''~DirectoryIndex'' directive and will return the first one it finds. If it does not find any of these files and if Options Indexes is set for that directory, the server will generate and return a list, in HTML format, of the subdirectories and files in the directory. The default value, found in {{{/etc/apache2/apache2.conf}}} is &quot;{{{index.html index.cgi index.pl index.php index.xhtml}}}&quot;. Thus, if Apache2 finds a file in a requested directory matching any of these names, the first will be displayed. 

The ''~ErrorDocument'' directive allows you to specify a file for Apache to use for specific error events. For example, if a user requests a resource that does not exist, a ''404 error'' will occur, and per Apache2's default configuration, the file {{{/usr/share/apache2/error/HTTP_NOT_FOUND.html.var}}} will be displayed. That file is not in the server's ''~DocumentRoot'', but there is an ''Alias'' directive in {{{/etc/apache2/apache2.conf}}} that redirects requests to the {{{/error}}} directory to {{{/usr/share/apache2/error/}}}. 

To see a list of the default ''~ErrorDocument'' directives, use this command: 
{{{
grep ErrorDocument /etc/apache2/apache2.conf
}}}
By default, the server writes the transfer log to the file {{{/var/log/apache2/access.log}}}. You can change this on a per-site basis in your virtual host configuration files with the ''~CustomLog'' directive, or omit it to accept the default, specified in {{{/etc/apache2/apache2.conf}}}. You may also specify the file to which errors are logged, via the ''~ErrorLog'' directive, whose default is {{{/var/log/apache2/error.log}}}. These are kept separate from the transfer logs to aid in troubleshooting problems with your Apache2 server. You may also specify the ''~LogLevel'' (the default value is &quot;warn&quot;) and the ''~LogFormat'' (see {{{/etc/apache2/apache2.conf}}} for the default value). 

Some options are specified on a per-directory basis rather than per-server. Options is one of these directives. A Directory stanza is enclosed in ~XML-like tags, like so: 
{{{
&lt;Directory /var/www/mynewsite&gt;
...
&lt;/Directory&gt;
}}}
The ''Options'' directive within a ''Directory'' stanza accepts one or more of the following values (among others), separated by spaces: 
;~ExecCGI
:Allow execution of CGI scripts. CGI scripts are not executed if this option is not chosen.  	
{{note{
@@font-weight: bold;ЗАМЕЧАНИЕ:@@
Most files should not be executed as CGI scripts. This would be very dangerous. CGI scripts should kept in a directory separate from and outside your ''~DocumentRoot'', and only this directory should have the ~ExecCGI option set. This is the default, and the default location for CGI scripts is {{{/usr/lib/cgi-bin}}}. 
}}}
;Includes
:Allow server-side includes. Server-side includes allow an HTML file to include other files. This is not a common option. See the [[Apache2 SSI HOWTO|http://httpd.apache.org/docs/2.2/howto/ssi.html]] for more information. 
;~IncludesNOEXEC
:Allow server-side includes, but disable the #exec and #include commands in CGI scripts. 
;Indexes
:Display a formatted list of the directory's contents, if no ''~DirectoryIndex'' (such as index.html) exists in the requested directory.  	
{{note{
@@font-weight: bold;color: red;ВЕИМАНИЕ:@@
For security reasons, this should usually not be set, and certainly should not be set on your ''~DocumentRoot'' directory. Enable this option carefully on a per-directory basis only if you are certain you want users to see the entire contents of the directory. 
}}}
;Multiview
:Support content-negotiated multiviews; this option is disabled by default for security reasons. See the [[Apache2 documentation on this option|http://httpd.apache.org/docs/2.2/mod/mod_negotiation.html#multiviews]]. 
;~SymLinksIfOwnerMatch
:Only follow symbolic links if the target file or directory has the same owner as the link.

!!Настройки демона httpd
This section explains some basic httpd daemon configuration settings. 

;~LockFile
:The ''~LockFile'' directive sets the path to the lockfile used when the server is compiled with either {{{USE_FCNTL_SERIALIZED_ACCEPT}}} or {{{USE_FLOCK_SERIALIZED_ACCEPT}}}. It must be stored on the local disk. It should be left to the default value unless the logs directory is located on an NFS share. If this is the case, the default value should be changed to a location on the local disk and to a directory that is readable only by root. 
;~PidFile
:The ''~PidFile'' directive sets the file in which the server records its process ID (pid). This file should only be readable by root. In most cases, it should be left to the default value. 
;User
:The ''User'' directive sets the userid used by the server to answer requests. This setting determines the server's access. Any files inaccessible to this user will also be inaccessible to your website's visitors. The default value for User is www-data.  	
{{note{
@@color: red;font-weight: bold;ВНИМАНИЕ:@@
Unless you know exactly what you are doing, do not set the User directive to root. Using root as the User will create large security holes for your Web server. 
}}}

The Group directive is similar to the User directive. Group sets the group under which the server will answer requests. The default group is also www-data. 

!!Модули сервера Apache
Apache is a modular server. This implies that only the most basic functionality is included in the core server. Extended features are available through modules which can be loaded into Apache. By default, a base set of modules is included in the server at compile-time. If the server is compiled to use dynamically loaded modules, then modules can be compiled separately, and added at any time using the ''~LoadModule'' directive. Otherwise, Apache must be recompiled to add or remove modules. 

Ubuntu compiles Apache2 to allow the dynamic loading of modules. Configuration directives may be conditionally included on the presence of a particular module by enclosing them in an {{{&lt;IfModule&gt;}}} block. 

You can install additional Apache2 modules and use them with your Web server. For example, run the following command from a terminal prompt to install the ~MySQL Authentication module:
{{{
sudo apt-get install libapache2-mod-auth-mysql
}}}
See the {{{/etc/apache2/mods-available}}} directory, for additional modules. 

Use the ''a2enmod'' utility to enable a module: 
{{{
sudo a2enmod auth_mysql
sudo /etc/init.d/apache2 restart
}}}
Similarly, ''a2dismod'' will disable a module: 
{{{
sudo a2dismod auth_mysql
sudo /etc/init.d/apache2 restart
}}}

!Настройка HTTPS
The ''mod_ssl'' module adds an important feature to the Apache2 server - the ability to encrypt communications. Thus, when your browser is communicating using SSL, the {{{https://}}} prefix is used at the beginning of the Uniform Resource Locator (URL) in the browser navigation bar. 

The ''mod_ssl'' module is available in ''apache2-common package''. Execute the following command from a terminal prompt to enable the mod_ssl module:
{{{ 
sudo a2enmod ssl
}}}
There is a default HTTPS configuration file in {{{/etc/apache2/sites-available/default-ssl}}}. In order for Apache to provide HTTPS, a certificate and key file are also needed. The default HTTPS configuration will use a certificate and key generated by the ''ssl-cert package''. They are good for testing, but the auto-generated certificate and key should be replaced by a certificate specific to the site or server. For information on generating a key and obtaining a certificate see [[the section called “Certificates”|https://help.ubuntu.com/9.04/serverguide/C/certificates-and-security.html]] 

To configure Apache for HTTPS, enter the following:
{{{
sudo a2ensite default-ssl 	
}}}
The directories {{{/etc/ssl/certs}}} and {{{/etc/ssl/private}}} are the default locations. If you install the certificate and key in another directory make sure to change ''~SSLCertificateFile'' and ''~SSLCertificateKeyFile'' appropriately. 


With Apache now configured for HTTPS, restart the service to enable the new settings: 
{{{
sudo /etc/init.d/apache2 restart 	
}}}
Depending on how you obtained your certificate you may need to enter a passphrase when Apache starts. 

You can access the secure server pages by typing https://your_hostname/url/ in your browser address bar. 

!Дополнительные материалы
*[[Apache2 Documentation|http://httpd.apache.org/docs/2.2/]] contains in depth information on Apache2 configuration directives. Also, see the apache2-doc package for the official Apache2 docs. 
*See the [[Mod SSL Documentation|http://www.modssl.org/docs/]] site for more SSL related information. 
*O'Reilly's [[Apache Cookbook|http://oreilly.com/catalog/9780596001919/]] is a good resource for accomplishing specific Apache2 configurations. 
*For Ubuntu specific Apache2 questions, ask in the #ubuntu-server IRC channel on [[freenode.net|http://freenode.net/]].

!Ссылки
*[[Описание на ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/httpd.html]]


</pre>
</div>
<div title="Установка файлового сервера Samba" modifier="Яковлев Иван" created="200906042301" modified="200906052338" tags="[[Установка/настройка сервера]] TODO" changecount="2">
<pre>!Описание
TODO

!См. также
*[[Установка Samba сервера на Ubuntu или Debian за 5 минут]]

!Ссылки
*[[Описание на ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/samba-fileserver.html]]



</pre>
</div>
<div title="Установка файрвола UFW" modifier="Яковлев Иван" created="200906042310" modified="200906121525" tags="Безопасность [[TODO - нужен перевод статьи]]" changecount="7">
<pre>!Содержание
*''Описание''
*''ufw - простой Firewall''
**ufw Application Integration
*''IP Masquerading''
**ufw Masquerading
**iptables Masquerading
*''Логи''
*''Другие инструменты''


!Описание
The Linux kernel includes the Netfilter subsystem, which is used to manipulate or decide the fate of network traffic headed into or through your server. All modern Linux firewall solutions use this system for packet filtering. 

The kernel's packet filtering system would be of little use to administrators without a userspace interface to manage it. This is the purpose of iptables. When a packet reaches your server, it will be handed off to the Netfilter subsystem for acceptance, manipulation, or rejection based on the rules supplied to it from userspace via iptables. Thus, iptables is all you need to manage your firewall if you're familiar with it, but many frontends are available to simplify the task.

!ufw - простой Firewall
The default firewall configuration tool for Ubuntu is ufw. Developed to ease iptables firewall configuration, ufw provides a user friendly way to create an ~IPv4 or ~IPv6 host-based firewall. 

ufw by default is initially disabled. From the ufw man page: 
&lt;&lt;&lt;
ufw is not intended to provide complete firewall functionality via its command interface, but instead provides an easy way to add or remove simple rules. It is currently mainly used for host-based firewalls.
&lt;&lt;&lt;

The following are some examples of how to use ufw:

1. First, ufw needs to be enabled. From a terminal prompt enter: 
{{{
sudo ufw enable
}}}

2. To open a port (ssh in this example): 
{{{
sudo ufw allow 22
}}}

3. Rules can also be added using a numbered format: 
{{{
sudo ufw insert 1 allow 80
}}}

4. Similarly, to close an opened port: 
{{{
sudo ufw deny 22
}}}

5. To remove a rule, use delete followed by the rule: 
{{{
sudo ufw delete deny 22
}}}

6. It is also possible to allow access from specific hosts or networks to a port. The following example allows ssh access from host 192.168.0.2 to any ip address on this host: 
{{{
sudo ufw allow proto tcp from 192.168.0.2 to any port 22
}}}
Replace 192.168.0.2 with 192.168.0.0/24 to allow ssh access from the entire subnet. 

7. Adding the {{{--dry-run}}} option to a ufw command will output the resulting rules, but not apply them. For example, the following is what would be applied if opening the HTTP port: 
{{{
 sudo ufw --dry-run allow http
*filter
:ufw-user-input - [0:0]
:ufw-user-output - [0:0]
:ufw-user-forward - [0:0]
:ufw-user-limit - [0:0]
:ufw-user-limit-accept - [0:0]
### RULES ###

### tuple ### allow tcp 80 0.0.0.0/0 any 0.0.0.0/0
-A ufw-user-input -p tcp --dport 80 -j ACCEPT

### END RULES ###
-A ufw-user-input -j RETURN
-A ufw-user-output -j RETURN
-A ufw-user-forward -j RETURN
-A ufw-user-limit -m limit --limit 3/minute -j LOG --log-prefix &quot;[UFW LIMIT]: &quot;
-A ufw-user-limit -j REJECT
-A ufw-user-limit-accept -j ACCEPT
COMMIT
Rules updated
}}}

8. ufw can be disabled by: 
{{{
sudo ufw disable
}}}

9. To see the firewall status, enter: 
{{{
sudo ufw status
}}}

10. And for more verbose status information use: 
{{{
sudo ufw status verbose
}}}

11. To view the numbered format: 
{{{
sudo ufw status numbered 	
}}}
{{note{
''ЗАМЕЧАНИЕ:''
If the port you want to open or close is defined in /etc/services, you can use the port name instead of the number. In the above examples, replace 22 with ssh. 
}}}
This is a quick introduction to using ufw. Please refer to the ufw man page for more information.

!!ufw Application Integration
The profiles are kept in /etc/ufw/applications.d, and can be edited if the default ports have been changed. 

To view which applications have installed a profile, enter the following in a terminal: 
{{{
sudo ufw app list
}}}
Similar to allowing traffic to a port, using an application profile is accomplished by entering: 
{{{
sudo ufw allow Samba
}}}
An extended syntax is available as well: 
{{{
ufw allow from 192.168.0.0/24 to any app Samba
}}}
Replace Samba and 192.168.0.0/24 with the application profile you are using and the IP range for your network.  	
{{note{
''ЗАМЕЧАНИЕ:''
There is no need to specify the protocol for the application, because that information is detailed in the profile. Also, note that the app name replaces the port number. 
}}}
To view details about which ports, protocols, etc are defined for an application, enter: 
{{{
sudo ufw app info Samba
}}}
Not all applications that require opening a network port come with ufw profiles, but if you have profiled an application and want the file to be included with the package, please file a bug against the package in Launchpad.

!IP Masquerading
The purpose of IP Masquerading is to allow machines with private, non-routable IP addresses on your network to access the Internet through the machine doing the masquerading. Traffic from your private network destined for the Internet must be manipulated for replies to be routable back to the machine that made the request. To do this, the kernel must modify the source IP address of each packet so that replies will be routed back to it, rather than to the private IP address that made the request, which is impossible over the Internet. Linux uses Connection Tracking (conntrack) to keep track of which connections belong to which machines and reroute each return packet accordingly. Traffic leaving your private network is thus &quot;masqueraded&quot; as having originated from your Ubuntu gateway machine. This process is referred to in Microsoft documentation as Internet Connection Sharing.

!!ufw Masquerading
IP Masquerading can be achieved using custom ufw rules. This is possible because the current back-end for ufw is iptables-restore with the rules files located in {{{/etc/ufw/}}}*.rules. These files are a great place to add legacy iptables rules used without ufw, and rules that are more network gateway or bridge related. 

The rules are split into two different files, rules that should be executed before ufw command line rules, and rules that are executed after ufw command line rules.

1. First, packet forwarding needs to be enabled in ufw. Two configuration files will need to be adjusted, in {{{/etc/default/ufw}}} change the 
{{{
DEFAULT_FORWARD_POLICY to “ACCEPT”: 
DEFAULT_FORWARD_POLICY=&quot;ACCEPT&quot;
}}}

Then edit {{{/etc/ufw/sysctl.conf}}} and uncomment: 
{{{
net.ipv4.ip_forward=1
}}}

Similarly, for ~IPv6 forwarding uncomment: 
{{{
net.ipv6.conf.default.forwarding=1
}}}

2. Now we will add rules to the {{{/etc/ufw/before.rules}}} file. The default rules only configure the filter table, and to enable masquerading the nat table will need to be configured. Add the following to the top of the file just after the header comments: 
{{{
# nat Table rules
*nat
:POSTROUTING ACCEPT [0:0]

# Forward traffic from eth1 through eth0.
-A POSTROUTING -s 192.168.0.0/24 -o eth0 -j MASQUERADE

# don't delete the 'COMMIT' line or these nat table rules won't be processed
COMMIT
}}}
The comments are not strictly necessary, but it is considered good practice to document your configuration. Also, when modifying any of the rules files in {{{/etc/ufw}}}, make sure these lines are the last line for each table modified: 
{{{
# don't delete the 'COMMIT' line or these rules won't be processed
COMMIT
}}}
For each Table a corresponding COMMIT statement is required. In these examples only the nat and filter tables are shown, but you can also add rules for the raw and mangle tables.  	
{{note{
''ЗАМЕЧАНИЕ:''
In the above example replace eth0, eth1, and 192.168.0.0/24 with the appropriate interfaces and IP range for your network. 
}}}

3. Finally, disable and re-enable ufw to apply the changes: 
{{{
sudo ufw disable &amp;&amp; sudo ufw enable
}}}
IP Masquerading should now be enabled. You can also add any additional {{{FORWARD}}} rules to the {{{/etc/ufw/before.rules}}}. It is recommended that these additional rules be added to the {{{ufw-before-forward}}} chain.

!!iptables Masquerading
iptables can also be used to enable masquerading. 

1. Similar to ufw, the first step is to enable ~IPv4 packet forwarding by editing /etc/sysctl.conf and uncomment the following line 
{{{
net.ipv4.ip_forward=1
}}}
If you wish to enable ~IPv6 forwarding also uncomment: 
{{{
net.ipv6.conf.default.forwarding=1
}}}

2. Next, execute the sysctl command to enable the new settings in the configuration file: 
{{{
sudo sysctl -p
}}}

3. IP Masquerading can now be accomplished with a single iptables rule, which may differ slightly based on your network configuration: 
{{{
sudo iptables -t nat -A POSTROUTING -s 192.168.0.0/16 -o ppp0 -j MASQUERADE
}}}
The above command assumes that your private address space is 192.168.0.0/16 and that your Internet-facing device is ppp0. The syntax is broken down as follows: 
*{{{-t nat}}} -- the rule is to go into the nat table
*{{{-A POSTROUTING}}} -- the rule is to be appended ({{{-A}}}) to the {{{POSTROUTING}}} chain
*{{{-s 192.168.0.0/16}}} -- the rule applies to traffic originating from the specified address space
*{{{-o ppp0}}} -- the rule applies to traffic scheduled to be routed through the specified network device
*{{{-j MASQUERADE}}} -- traffic matching this rule is to &quot;jump&quot; ({{{-j}}}) to the {{{MASQUERADE}}} target to be manipulated as described above 

4. Also, each chain in the filter table (the default table, and where most or all packet filtering occurs) has a default policy of {{{ACCEPT}}}, but if you are creating a firewall in addition to a gateway device, you may have set the policies to {{{DROP}}} or {{{REJECT}}}, in which case your masqueraded traffic needs to be allowed through the {{{FORWARD}}} chain for the above rule to work: 
{{{
sudo iptables -A FORWARD -s 192.168.0.0/16 -o ppp0 -j ACCEPT
sudo iptables -A FORWARD -d 192.168.0.0/16 -m state --state ESTABLISHED,RELATED -i ppp0 -j ACCEPT
}}}
The above commands will allow all connections from your local network to the Internet and all traffic related to those connections to return to the machine that initiated them. 

5. If you want masquerading to be enabled on reboot, which you probably do, edit /etc/rc.local and add any commands used above. For example add the first command with no filtering: 
{{{
iptables -t nat -A POSTROUTING -s 192.168.0.0/16 -o ppp0 -j MASQUERADE
}}}

!Логи
Firewall logs are essential for recognizing attacks, troubleshooting your firewall rules, and noticing unusual activity on your network. You must include logging rules in your firewall for them to be generated, though, and logging rules must come before any applicable terminating rule (a rule with a target that decides the fate of the packet, such as {{{ACCEPT}}}, {{{DROP}}}, or {{{REJECT}}}). 

If you are using ufw, you can turn on logging by entering the following in a terminal: 
{{{
sudo ufw logging on
}}}
To turn logging off in ufw, simply replace on with off in the above command. 

If using iptables instead of ufw, enter: 
{{{
sudo iptables -A INPUT -m state --state NEW -p tcp --dport 80 -j LOG --log-prefix &quot;NEW_HTTP_CONN: &quot;
}}}
A request on port 80 from the local machine, then, would generate a log in dmesg that looks like this: 
{{{
[4304885.870000] NEW_HTTP_CONN: IN=lo OUT= MAC=00:00:00:00:00:00:00:00:00:00:00:00:08:00 SRC=127.0.0.1 DST=127.0.0.1 LEN=60 TOS=0x00 PREC=0x00 TTL=64 ID=58288 DF PROTO=TCP SPT=53981 DPT=80 WINDOW=32767 RES=0x00 SYN URGP=0
}}}
The above log will also appear in /var/log/messages, {{{/var/log/syslog}}}, and {{{/var/log/kern.log}}}. This behavior can be modified by editing {{{/etc/syslog.conf}}} appropriately or by installing and configuring ulogd and using the ULOG target instead of LOG. The ulogd daemon is a userspace server that listens for logging instructions from the kernel specifically for firewalls, and can log to any file you like, or even to a ~PostgreSQL or ~MySQL database. Making sense of your firewall logs can be simplified by using a log analyzing tool such as fwanalog, fwlogwatch, or lire.

!Другие инструменты
There are many tools available to help you construct a complete firewall without intimate knowledge of iptables. For the ~GUI-inclined: 
*[[Firestarter|http://www.fs-security.com/]] is quite popular and easy to use. 
*[[fwbuilder|http://www.fwbuilder.org/]] is very powerful and will look familiar to an administrator who has used a commercial firewall utility such as Checkpoint ~FireWall-1. 
If you prefer a command-line tool with plain-text configuration files: 
*[[Shorewall|http://www.shorewall.net/]] is a very powerful solution to help you configure an advanced firewall for any network. 
*[[ipkungfu|http://www.linuxkungfu.org/]] should give you a working firewall &quot;out of the box&quot; with zero configuration, and will allow you to easily set up a more advanced firewall by editing simple, well-documented configuration files. 
*[[fireflier|http://fireflier.sourceforge.net/]] is designed to be a desktop firewall application. It is made up of a server (fireflier-server) and your choice of GUI clients (GTK or QT), and behaves like many popular interactive firewall applications for Windows.

!См. также
*The [[Ubuntu Firewall|https://wiki.ubuntu.com/UbuntuFirewall]] wiki page contains information on the development of ufw. 
*Also, the ufw manual page contains some very useful information: man ufw. 
*See the [[packet-filtering-HOWTO|http://www.netfilter.org/documentation/HOWTO/packet-filtering-HOWTO.html]] for more information on using iptables. 
*The [[nat-HOWTO|http://www.netfilter.org/documentation/HOWTO/NAT-HOWTO.html]] contains further details on masquerading.

!Ссылки
*[[Описание на ubuntu.com|https://help.ubuntu.com/9.04/serverguide/C/firewall.html]]



</pre>
</div>
<div title="Установка шрифтов Windows в Ubuntu" modifier="Яковлев Иван" created="200906032209" modified="200906041648" tags="Статьи" changecount="9">
<pre>Многие пользователи Windows при переходе на Ubuntu сразу же замечают разницу в шрифте и хотят установить те, к которым они привыкли. Это легко и просто делается. Для начала нужно установить сами шрифты. У вас должны быть настроены [[репозитории|TODO]].
{{{
sudo apt-get install msttcorefonts
}}}
Далее у вас есть два варианта.
Вариант первый: настроить все вручную.
Шрифты настраиваются там же, где и темы gnome.
Заходим в меню &quot;Система - Параметры - Внешний вид&quot;.

{{textAlignCenter{
[img[images/articles/menu-choose-appearance.png]]
}}}
Затем закладка &quot;Шрифты&quot;.

{{textAlignCenter{
[img[images/articles/applications-fonts.png]]
}}}
После того, как вы установили нужный пакет, в списке появляются привычные шрифты.

{{textAlignCenter{
[img[images/articles/fonts-time-new-roman.png]]
}}}
Только вот придется отдельно настраивать шрифты для Firefox.
Но есть и другой путь. Выполнить следующую команду, для выполнения нужно интернет-соединение (это одна команда, копируйте ее полностью):
{{{
cd &amp;&amp; wget http://zeroed.ru/xlam/files/gnome/lookandfeel/fontconfig.tbz 
&amp;&amp; sudo tar xvjpf fontconfig.tbz -C /etc/fonts/ &amp;&amp; rm fontconfig.tbz
}}}
В результате вы получите следующее (на рисунках сначала идут шрифты до изменения, а затем после).
Меню:

{{textAlignCenter{
[img[images/articles/old-fonts-menu.png]]

[img[images/articles/new-fonts-menu.png]]
}}}

!!Firefox:

{{textAlignCenter{
[img[images/articles/old-fonts-firefox.png]]

[img[images/articles/new-fonts-firefox.png]]
}}}

!!Терминал:

{{textAlignCenter{
[img[images/articles/old-fonts-terminal.png]]

[img[images/articles/new-fonts-terminal.png]]
}}}

!!Файловый менеджер наутилус:

{{textAlignCenter{
[img[images/articles/old-fonts-nautilus.png]]

[img[images/articles/new-fonts-nautilus.png]]
}}}

{{note{
@@font-weight: bold;СОВЕТ:@@
Чтобы все отменить, просто выполните команду (это одна команда, копируйте ее полностью):
{{{
sudo rm /etc/fonts/alias.conf &amp;&amp; sudo rm /etc/fonts/local.conf 
&amp;&amp; sudo rm /etc/fonts/misc.conf &amp;&amp; sudo rm /etc/fonts/msfonts-rules.conf
}}}
}}}

!Оригинал статьи
*http://ubuntologia.ru/gnome-windows-fonts


</pre>
</div>
<div title="Установка, удаление, поиск и другие операции вручную" modifier="Яковлев Иван" created="200906032342" modified="200906040928" tags="[[Установка ПО в Ubuntu]]" changecount="3">
<pre>Все то, что было показано выше, можно сделать вручную в консоли. Чтобы сделать поиск в репозиториях используйте команду
{{{
apt-cache search имя
}}}
Давайте попробуем поискать krusader
{{{
apt-cache search krusader
}}}

{{textAlignCenter{
[img[images/articles/console-apt-cache-search.png]]
}}}
Как и в случае с Synaptic - мы нашли два пакета. Чтобы установить пакет, используйте команду
{{{
sudo apt-get install имя
}}}
Вы можете заметить что команда поиска выполнялась без {{{sudo}}}, тогда как установка выполняется от имени суперпользователя. Давайте установим krusader:
{{{
sudo apt-get install krusader
}}}

{{textAlignCenter{
[img[images/articles/console-apt-get-install.png]]
}}}
Как и в случае с Synaptic, мы видим какие зависимости будут установлены вместе с приложением и какие дополнительные приложения нам предлагают установить.

Обратите внимание на то, что скачать необходимо 0 MB из 25,4 MB! В примерах выше я поставил Krusader с помощью Synaptic, а потом удалил его. Но, как я говорил ранее, все скачанные пакеты сохраняются в директории {{{/var/cache/apt/archives}}}. И теперь, когда мы повторно устанавливаем krusader, нам не нужно ничего скачивать. Соглашаемся и устанавливаем krusader. Чтобы удалить приложение используйте команду:
{{{
sudo apt-get remove имя
}}}
Чтобы удалить вместе с конфигурационными файлами:
{{{
sudo apt-get purge имя
}}}
Давайте удалим krusader
{{{
sudo apt-get remove krusader
}}}

{{textAlignCenter{
[img[images/articles/console-apt-get-remove.png]]
}}}
Читаем, соглашаемся и удаляем.

На рисунке выше вы можете заметить уведомление о том, что библиотеки, которые использовал krusader (зависимости) не используются другими приложениями и могут быть удалены. Также показана команда, с помощью которой можно это сделать. К сожалению, там не сказано, что команда должна быть выполнена от имени суперпользователя, и мы это сейчас исправим.

Итак, чтобы удалить зависимости, которые более не используются ни одним приложением, используйте команду:
{{{
sudo apt-get autoremove
}}}
Ну и напоследок. Как я уже говорил, все скачанные пакеты автоматически сохраняются в директории {{{/var/cache/apt/archives/}}}. Чтобы удалить все такие пакеты за один раз, используйте следующую команду:
{{{
sudo apt-get clean
}}}
И еще один момент. Как я уже сказал {{{remove}}} удаляет пакет, а {{{purge}}} удаляет его полностью, вместе с конфигурационными файлами. В примере выше мы использовали {{{remove}}}.

Давайте откроем Synaptic.

{{textAlignCenter{
[img[images/articles/krusader-config-files.png]]
}}}
В фильтре по состоянию появилась категория &quot;Не установленные (остались конфигурационные файлы)&quot;. Что можно сказать... Контроль над ПО реализован на высшем уровне! Можно удалить конфигурационные файлы отсюда.

!См. далее
*[[Установка deb с помощью GDebi]]


</pre>
</div>
<div title="Установка/настройка Web-сервера" modifier="Яковлев Иван" created="200906032125" modified="200907041250" tags="MainMenu slider" changecount="44">
<pre>*[[LAMP+SSL+SVN+Trac|Установка и настройка LAMP+SSL+SVN+Trac]]
*[[Несколько доменов в одном VPS|Создание и обслуживание нескольки доменов на одном выделенном сервере VPS]]
*[[Введение в виртуальные хосты]]
*[[Окружение для виртуальных хостов|Настройка окружения для виртуальных хостов]]
*[[Права доступа для хостов|Настройка прав доступа для виртуальных хостов]]
*&lt;&lt;slider &quot;chk-apache&quot; [[Настройка Apache]] &quot;Настройка Apache&quot; &quot;Показать/Скрыть раздел по серверу Apache&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-zendserver&quot; [[Настройка ZendServer CE]] &quot;Настройка ZendServer CE&quot; &quot;Показать/Скрыть раздел Настройка ZendServer CE&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-ngnix-apache&quot; [[Nginx + Apache]] &quot;Настройка Nginx+Apache&quot; &quot;Показать/Скрыть раздел Ngnix+Apache&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-ngnix&quot; [[Настройка Nginx]] &quot;Настройка одного Nginx&quot; &quot;Показать/Скрыть раздел Настройка Nginx&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-video-striming&quot; [[Потоковое видео]] &quot;Потоковое видео&quot; &quot;Показать/Скрыть раздел Потоковое видео&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-php&quot; [[Настройка PHP]] &quot;Настройка PHP&quot; &quot;Показать/Скрыть раздел Настройка PHP&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-mysql&quot; [[Настройка MySQL]] &quot;Настройка MySQL&quot; &quot;Показать/Скрыть раздел Настройка MySQL&quot;&gt;&gt;
*[[Установка phpMyAdmin]]
*&lt;&lt;slider &quot;chk-svn&quot; [[Настройка Subversion (SVN)]] &quot;Настройка Subversion (SVN)&quot; &quot;Показать/Скрыть раздел Настройка Subversion (SVN)&quot;&gt;&gt;
*&lt;&lt;slider &quot;chk-bugtracking&quot; [[Системы багтрекинга (Bugtracking)]] &quot;Системы багтрекинга (Bugtracking)&quot; &quot;Показать/Скрыть раздел Системы багтрекинга (Bugtracking)&quot;&gt;&gt;
*[[Установка MediaWiki]]
*[[Установка Squid|Установка прокси сервера Squid]]</pre>
</div>
<div title="Установка/настройка сервера" modifier="Яковлев Иван" created="200906042054" modified="200906192150" tags="Статьи slider" changecount="28">
<pre>*&lt;&lt;slider &quot;chk-vsftpd&quot; [[Установка FTP сервера]] &quot;Установка FTP сервера&quot; &quot;Показать/Скрыть Установка FTP сервера&quot;&gt;&gt;
*[[Установка Jabber сервера]]
*[[DNS на BIND|Установка контроллера DNS на BIND в Ubuntu]]
*[[DNS на PowerDNS|Установка DNS сервера PowerDNS с поддержкой MYSQL веб интерфейсом Power admin]]
*[[Установка NFS|Установка Network File System (NFS)]]
*[[Samba-домен|Установка контроллера домена на Samba]]
*[[Samba-ActiveDirectory|Установка Samba Active Directory]]
*[[Samba-файлсервер|Установка файлового сервера Samba]]
*[[Samba-принтсервер|Установка принтсервера Samba]]
*[[CUPS-принтсервер|Установка принтсервера CUPS]]
*[[Настройка OpenVPN|Настройка OpenVPN на Ubuntu Server]]
*[[Устанвока кластера DRBD|Устанвока кластера Distributed Replicated Block Device (DRBD)]]
</pre>
</div>
<div title="Устранение проблем в работе сервиса DynDNS" modifier="Яковлев Иван" created="200906171949" modified="200906172141" tags="[[Настройка DynDNS сервиса]] [[TODO - нужен перевод статьи]]" changecount="12">
<pre>!Шаг1: Тестирование своего сервера
Самым первым шагом является проверка работоспособности вашего сервера. Попробуйте зайти на свой сервер набрав в адресной строке браузера следующий адрес: {{{http://localhost/}}} или {{{http://127.0.0.1/}}}. Вы должны зайти на свой сервер.

Если вы используете отдельный сетевые устройства, например веб-камеру, то попробуйте подключиться к ней с другого компьютера вашей локальной сети, набрав ее ~IP-адрес (например 192.168.1.2).

Если у вас не получилось подключиться указанными выше способами, то у вас проблема в некорректной работе вашей локальной сети. И прежде чем подключаться к внешним сервисам ~DynDNS устраните свои внутренние проблемы с локальной сетью.

!Шаг2: Тестирование своего ~IP-адреса
Следующим шагом является проверка того, что вы используете корректные ~IP-адреса для вашей локальной сети. Для проверки перейдите по ссылке указанной ниже:

http://checkip.dyndns.com:8245/

Это наш сервер проверки ~IP-адресов, который просто возвращает ваш внешний IP адрес. Цыфры {{{:8245}}} -- это альтернативный порт для подключения к нашему серверу, что позволяет обойти прокси серверы, которые могут работать в вашей сети.

The IP address on this page is your external IP address. If you are using a router, each device in your network will also have an internal IP address, such as {{{192.168.x.x}}} or {{{10.0.x.x}}}. Your Dynamic DNS or Custom DNS host needs to use the external IP address to allow visitors to locate and access your network.

If visitors can reach your services from outside of the network using your external IP address, but you cannot view it locally, you are likely experiencing a loopback connection error.

!Шаг3: Тестирование портов
You can test your server by visiting the external IP address, or by having someone else in another network try to connect to your IP address. We also provide a tool known as the [[Open Port Tool|https://www.dyndns.com/support/tools/openport.html]], which is useful for externally testing your network. Simply enter your IP address and the necessary port (such as 80 for HTTP). You will receive one of three responses:
*''Connection Open:'' The port is open and our tool is able to establish a connection. This indicates that your network is available on this port, and that a server application is listening on this port and accepting incoming connections.
*''Connection Refused:'' The port is open, but no service is listening. This indicates that the port is available, but the computer or device is rejecting (refusing) the connection. This can occur if the service is not running, or if port forwarding is not correctly configured (see below).
*''Connection Timed Out:'' The port is actively being blocked. The port can be blocked by a firewall, a router, or your ISP. Please see below for more information.

If the port is open, visitors should be able to connect without a problem. If the port is refused, you may need to check your port forwarding settings and make sure the server is running. If the port times out, something is blocking the connection on that port, and you will need to determine where and why the error is occurring.

In addition to our Open Port Tool, you can also test for connections on a particular port using the Telnet utility. Telnet is a command line application used for connecting to terminals, but it is also very useful in determining service availability. For example:
{{{
telnet 1.2.3.4 80
}}}
will try to connect to the IP address 1.2.3.4 on port 80; if a web server is available, Telnet can't display the page, but you will receive some HTML which demonstrates the server is available. If the server isn't available, you will get timeout and refusal errors just like the Open Port Tool. (Note to Windows Vista users: Vista does not provide a native Telnet client. We recommend using [[PuTTY|http://www.chiark.greenend.org.uk/~sgtatham/putty/]] instead.)

!!Проверка файрвола и роутера
If the port is blocked, you will need to determine where the block is occurring. First, make sure your firewall applications are correctly configured to allow connections on the desired port and protocols (TCP and/or UDP). For testing purposes, you should fully disable all firewalls, including the Windows firewall, and try again. (Make sure to re-enable your firewalls when you have determined the problem, to ensure your system is protected against intrusion.)

Next, you need to ensure your router is properly configured for port forwarding. Port forwarding tells your router where to direct certain requests it receives based on the incoming port. For example, if you have three computers in the network, and have a web server running on port 80 on one of the machines, port forwarding directs incoming visitors to the desired computer.

Port forwarding is the most common configuration error when setting up a new service. You can find full step-by-step pictorial walkthroughs for most common routers and applications at [[PortForward.com|http://www.portforward.com/]] или [[эту стаью|Настройка форвординга портов (Port Forwarding)]].

!!Проверка работы на альтернативном порту
If your firewalls are disabled, and port forwarding is properly configured in your router (or you don't have a router), the last possibility is that your Internet Service Provider is blocking the port. Many ISPs block common ports such as 21, 25, and 80 to prevent people from hosting servers on their networks. You can verify port blocking by simply calling your ISP and asking about the problem (since they often use it as an incentive to upgrade to a better package).

Another way to tell is to simply change to an alternate port. For example, if you are hosting a web server on port 80, change the server's listen port to 8000, and try connecting using {{{http://1.2.3.4:####}}}, where {{{1.2.3.4}}} is your IP address and {{{:####}}} is the alternate port. (Be sure to open this port in your firewalls and forward it in your router during testing.) If the new, alternate port works, your ISP is likely blocking the common port, and you will need to host your server on the alternate port.

If your ISP is blocking port 80, you can use the [[URL forwarding service|https://www.dyndns.com/services/webredirect/]] to redirect visitors automatically to the desired alternate port. If your ISP is blocking port 25, we offer [[MailHop® Outbound|https://www.dyndns.com/services/mailhop/outbound.html]] for outgoing email and [[MailHop Relay|https://www.dyndns.com/services/mailhop/relay.html]] for incoming email on alternate ports

!Шаг4: Проверка DNS
!!Проверка базы данных
If the server is accessible using the IP address, your next step is to check the DNS. Log into your account and view your Dynamic DNS or Custom DNS service, and make sure that the IP address in our database matches the IP address for your network. If the addresses do not match, you must update your host to the new address.

If your IP address is dynamic (changes often), you can [[install an update client|https://www.dyndns.com/support/clients]] to keep your hosts automatically up-to-date no matter how often the address changes. We offer software update clients for Windows, Mac OSX and *nix environments, and offer a [[list of certified router-based clients for networks|https://www.dyndns.com/support/clients/hardware/]] that do not have a computer.

!!Проверка хоста в DNS
If your host's IP address is correct, you need to see if the host is resolving properly in DNS. The easiest way to check is to use our online [[DNSCog|http://www.dnscog.com/dig/]] DNS Lookup utility. Simply enter your host into the field and click Submit, and ~DNSCog will try to retrieve the record. The results will contain something like this:
{{{
;; ANSWER SECTION:
myhost.dyndns.org.             60     IN      A       1.2.3.4
}}}
The first portion shows your hostname; the second shows the remaining TTL (Time To Live) of the record in seconds; the fourth shows the record type (A, CNAME, MX, etc.); and the last shows the IP address of the host in DNS. This IP address should match the IP address you have assigned to the host in your account. If the host in DNS does not match the settings in your account, you are likely seeing a [[DNS caching error|https://www.dyndns.com/support/kb/dns_caching.html]]. If the domain uses Custom DNS, [[make sure that your domain is delegated properly to our nameservers|https://www.dyndns.com/services/dns/custom/howto.html#delegation]].

!Шаг5: Тех. поддержка
If you have performed all of the above testing, you should have located the problem or at least determined where the problem exists. The most difficult step to troubleshoot is usually Step 3, as there are many places where security measures can silently block incoming connections. You may wish to try installing a packet sniffer at various points in your network to try and determine where the connections are failing. Outside of that, try searching online and in forums for the specific service you are trying to host; it's likely that other people have experienced your exact problem, and an archived newsgroup or forum post may have the answer you need. You can also post a question in the [[DynDNS.com Community Forum|http://dyndnscommunity.com/forum/]].

If you need help for questions directly related to your ~DynDNS.com services, you can use our [[online support form|https://www.dyndns.com/support/contact/email.html]] to contact our support team. Customers with paid services also have access to phone support. Please note that ~DynDNS.com cannot provide support for service installation or configuration.

!Основные проблемы
!!Другие могут попадать на мой сервер, а я нет
If external visitors to your network are able to reach your services, but you can't view them locally using the host, you are experiencing a loopback connection error. Instead of correctly interpreting your request and routing you locally, the router gets confused and you simply can't connect. In some instances, this can be fixed by changing security settings in your router such as the &quot;Filter Internet NAT Redirection&quot; setting in Linksys devices.

!!Когда я захожу на свой хост, мой роутер перезагружается
This is also a loopback connection error. The router mistakenly believes you that are attempting to connect to the router instead of to local services running on port 80. External visitors do not see your router's login screen, however, and should be able to properly access your services.

!!Я могу пинговать свой хост, но не вижу своего сервера
Being able to ping a host does not indicate connectivity. Many firewalls, routers and even some ~ISPs reject ICMP (ping) packets. Likewise, even if a host responds to a ping, that doesn't indicate that services are available at that location. Instead, you should attempt to reach services at your network using our [[Open Port tool|https://www.dyndns.com/support/tools/openport.html]] or a Telnet command.

!Ссылки
*[[Оригинал статьи|https://www.dyndns.com/support/kb/why_cant_i_connect_to_my_server.html]]


</pre>
</div>
<div title="Фильтрация почты на сервере Postfix при помощи postgrey" modifier="Яковлев Иван" created="200906052346" tags="Postfix Статьи TODO" changecount="1">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Оригинал статьи|http://sudouser.com/filtraciya-pochty-na-servere-postfix-pri-pomoshhi-postgrey.html#more-120]]



</pre>
</div>
<div title="Что такое Ubuntu" modifier="Яковлев Иван" created="200911261053" modified="200911261054" tags="ubuntu" changecount="3">
<pre>{{textAlignCenter{
[img[images/articles/ubuntu-logo.jpg]]
}}}
''Ubuntu''  -- дистрибутив GNU/Linux на основе проекта [[Debian|http://ru.wikipedia.org/wiki/Debian]] GNU/Linux. Слово &amp;laquo;//ubuntu//&amp;raquo; в переводе с языка зулу означает &quot;//человечность//&quot;.

Новая версия дистрибутива выходит каждые 6 месяцев, поддерживается обновлениями безопасности в течение 18 месяцев или 3 и 5 лет для ~LTS-версии.
Генеральный спонсор Ubuntu -- Canonical Ltd. Марка Шаттлворта. Проект активно развивается и поддерживается свободным сообществом.

Ubuntu поставляется с подборкой программного обеспечения для серверов и рабочих станций (установка -- c помощью ~Live-CD или текстового установщика (&amp;laquo;alternate&amp;raquo;-версия)).
Диски Ubuntu -- бесплатны, доставка по почте -- бесплатна.

''Что такое Ubuntu?''
&lt;&lt;&lt;
Ubuntu -- это разрабатываемая сообществом, основанная на ядре Linux операционная система, которая идеально подходит для использования на персональных компьютерах, ноутбуках и серверах. Она содержит все необходимые программы, которые вам нужны: программу просмотра Интернет, офисный пакет для работы с текстами, электронными таблицами и презентациями, программы для общения в Интернет и много других.
&lt;&lt;&lt;

''Обещание Ubuntu''
*Ubuntu всегда будет распространяться бесплатно, включая корпоративные версии и обновления безопасности.
*Для Ubuntu доступна полная коммерческая поддержка от Canonical Ltd. и сотен компаний по всему миру.
*Ubuntu включает наилучшие переводы и средства доступности для людей с ограниченными возможностями, которые только существуют в виде открытого ПО.
*Диски c Ubuntu содержат только свободное программное обеспечение; мы поощряем использование свободно распространяемого и открытого ПО, его улучшение и распространение.

''Официальные варианты системы''
*''[[Ubuntu|http://www.ubuntu.com/]]'' -- базовая версия операционной системы, сочетающая простоту, удобство и функциональность. Основана на рабочем столе Gnome.
*''[[Ubuntu Server|http://www.ubuntu.com/server]]'' -- серверная версия операционной системы, включающая средства быстрого создания серверов [[LAMP|http://ru.wikipedia.org/wiki/LAMP]] и [[LTSP|http://ru.wikipedia.org/wiki/LTSP]].
*''[[Kubuntu|http://www.kubuntu.org/]]'' -- версия операционной системы, основанная на рабочем столе KDE: чёткость линий и действий, лучшая интегрированность компонент и конфигурируемость.
*''[[Edubuntu|http://www.edubuntu.org/]]'' -- версия Ubuntu, включающая набор ПО для применения в образовательных учреждениях.

''Специализированные варианты системы''
*''[[Xubuntu|http://www.xubuntu.org/]]'' -- Лучший выбор для систем с небольшой производительностью и для желающих получить максимум скорости работы. Основана на рабочем столе Xfce.
*''[[Gobuntu|https://wiki.ubuntu.com/Gobuntu]]'' -- Версия системы для применения в странах с ограничениями лицензирования и любителей лицензионно-чистого ПО.
*''[[Ubuntu Studio|http://ubuntustudio.org/]]'' -- Система для желающих максимально использовать мультимедийные возможности современной ОС Linux и включает специальное ПО для воспроизведения и редактирования аудио, музыки, изображений и видео.
*''[[Mythbuntu|http://mythbuntu.org/]]'' -- Основанная на Ubuntu и ~MythTV операционная система, позволяющая легко превратить ваш компьютер в полноценный домашний развлекательный центр, персональный видеорекордер (PVR), телевизионную приставку с поистине безграничными возможностями.
*''[[Ubuntu Server JeOS|http://www.ubuntu.com/products/whatisubuntu/serveredition/jeos]]'' -- Серверная версия операционной системы, специально оптимизированная для работы в виртуальных машинах. Ограниченное только необходимыми модулями и драйверами ядро позволяет достичь небольшой требовательности к ресурсам базовой системы, а также повысить надёжность, производительность и масштабируемость сервисов, работающих под управлением этой ОС в среде виртуальной машины ~VMware Server или ~VMware ESX.

!См. также
*http://habrahabr.ru/blogs/ubuntu/20525/ -- статья как настроить LAMP+SVN+Trac на Ubuntu

!Ссылки
*http://www.ubuntu.com/ -- официальный сайт
*http://ubuntu.ru/ -- русскоязычное сообщество поклонников данной ОС
*http://ru.wikipedia.org/wiki/Ubuntu -- описание на Википедии
*http://www.opennet.ru/man.shtml -- справочник команд
*[[Полезный ресурс по администрированию и настройке Ubuntu|http://tuxtraining.com/]]


</pre>
</div>
<div title="Шаблон - См. также" modifier="Яковлев Иван" created="200906031142" modified="200906261540" tags="[[Системные шаблоны]]" changecount="5">
<pre>{{{
!См. также
*[[Описание на manpages.ubuntu.com|TODO]]
*[[Описание на Opennet.ru|TODO]]
}}}

</pre>
</div>
<div title="Шаблон новой записи" modifier="Яковлев Иван" created="200906031207" modified="200906031717" tags="[[Системные шаблоны]]" changecount="2">
<pre>!Описание
TODO

!См. также
TODO

!Ссылки
*[[Описание на manpages.ubuntu.com|TODO]]
*[[Описание на Opennet.ru|TODO]]


</pre>
</div>
<div title="Шпоргалка по основным командам Unix/Linux и оболочке bash" modifier="Яковлев Иван" created="200906031852" modified="200906121318" tags="[[Команды Unix]]" changecount="50">
<pre>!Псевдонимы (Alias)
Применяются для задания коротких и удобных псевдонимов для очень длинных команд с множеством дополнительных параметров, например:
{{{
alias agu='sudo apt-get update'
alias ln='ln -s'
}}}
{{note{
''ЗАМЕЧАНИЕ:''
Заданные таким образом псевдонимы действуют до окончания текущей сессии bash, т.е. если вы закроете и заново откроете терминал, то псевдонимы пропадут. Чтобы этого не происходило, псевдонимы надо прописать в файле {{{~/.bashrc}}} -- системном файле настроек оболочки bash для текущего пользователя.
}}}

!Привилегированный запуск
''{{{sudo комманда}}}'' - запуск команды под именем привилегированного пользователя
''{{{gksu комманда}}}'' - тоже самое, разница в том что появляется графическое окно с просьбой ввести пароль
{{note{
в обоих случаях вводится пароль вашего текущего пользователя.
}}}

!Установка пакетов
Установка из исходников:
{{{
./configure
make
make install
}}}
Установка пакета Debian:
{{{
dpkg -i pkg.deb
}}}
Установка пакета Ubuntu: 
{{{
apt-get update      &lt;-- обновление локального кеша
apt-get install     &lt;-- установка пакета
}}}
перед выполнением команды установки необходимо обновить локальный кеш репозитариев, эту проблему решает следующая команда установки пакетов для Ubuntu/Debian:
{{{
aptitude install
}}}
автоматически обновляет локальный кеш репозитария и устанавливает пакет.

!Файловые команды
''{{{ls}}}'' – список файлов и каталогов
''{{{ls -la}}}'' – форматированный список со скрытыми каталогами и файлами
''{{{cd dir}}}'' – сменить директорию на dir
''{{{cd}}}'' – сменить на домашний каталог
''{{{pwd}}}'' – показать текущий каталог
''{{{mkdir dir}}}'' – создать каталог dir
''{{{rm file}}}'' – удалить file
''{{{rm -r dir}}}'' – удалить каталог dir
''{{{rm -f file}}}'' – удалить форсированно file
''{{{rm -rf dir}}}'' – удалить форсированно каталог dir
''{{{cp file1 file2}}}'' – скопировать file1 в file2
''{{{cp -r dir1 dir2}}}'' – скопировать dir1 в dir2; создаст каталог dir2, если он не существует
''{{{mv file1 file2}}}'' – переименовать или переместить file1 в file2. если file2 существующий каталог - переместить file1 в каталог file2
''{{{ln -s file link}}}'' – создать символическую ссылку link к файлу file
''{{{touch file}}}'' – создать file
''{{{cat &gt; file}}}'' – направить стандартный ввод в file
''{{{less file}}}'' – вывести содержимое file
''{{{head file}}}'' – вывести первые 10 строк file
''{{{tail file}}}'' – вывести последние 10 строк file
''{{{tail -f file}}}'' – вывести содержимое file по мере роста, начинает с последних 10 строк

!Управление процессами
''{{{ps}}}'' – вывести ваши текущие активные процессы
''{{{ps aux}}}'' - вывести все процессы
''{{{ps aux | grep -v grep | grep -i %name}}}'' - найти процесс {{{%name}}} (можно использовать частичное название)
''{{{top}}}'' – показать все запущенные процессы
''{{{kill pid}}}'' – убить процесс с id pid
''{{{killall proc}}}'' – убить все процессы с именем proc
''{{{bg}}}'' – список остановленных и фоновых задач; продолжить выполнение остановленной задачи в фоне
''{{{fg}}}'' – выносит на передний план последние задачи
''{{{fg n}}}'' – вынести задачу n на передний план

!Права доступа на файлы
''{{{chmod octal file}}}'' – сменить права file на octal, раздельно для пользователя, группы и для всех добавлением: 
*4 – чтение (''r'')
*2 – запись (''w'')
*1 – исполнение (''x'')

;Примеры:
:''{{{chmod 777}}}'' -- чтение, запись, исполнение для всех
:''{{{chmod 755}}}'' -- ''rwx'' для владельца, ''rx'' для группы и остальных.
:{{{chmod 000 www/file.html}}} -- изменить режим доступа к файлу ''file.html'' в каталоге ''www'' на 000. При таком режиме доступа его никто не сможет открыть. Так можно быстро запретить доступ через веб к какому-то файлу.
:Дополнительные опции: {{{man chmod}}}.

!SSH
''{{{ssh user@host}}}'' – подключится к host как user
''{{{ssh -p port user@host}}}'' – подключится к host на порт port как user
''{{{ssh-copy-id user@host}}}'' – добавить ваш ключ на host для user чтобы включить логин без пароля и по ключам

!Поиск
''{{{grep pattern files}}}'' – искать pattern в files
''{{{grep -r pattern dir}}}'' – искать рекурсивно pattern в dir
''{{{command | grep pattern}}}'' – искать pattern в выводе command
''{{{locate file}}}'' – найти все файлы с именем file

!Системная информация
''{{{date}}}'' – вывести текущую дату и время
''{{{cal}}}'' – вывести календарь на текущий месяц
''{{{uptime}}}'' – показать текущий аптайм
''{{{w}}}'' – показать пользователей онлайн
''{{{whoami}}}'' – имя, под которым вы залогинены
''{{{finger user}}}'' – показать информацию о user
''{{{uname -a}}}'' – показать информацию о ядре
''{{{cat /proc/cpuinfo}}}'' – информация ЦПУ
''{{{cat /proc/meminfo}}}'' – информация о памяти
''{{{man command}}}'' – показать мануал для command
''{{{df}}}'' – показать инф. о использовании дисков
''{{{du}}}'' – вывести “вес” текущего каталога
''{{{du -sh каталог}}}'' - вывести &quot;вес&quot; определенного каталога в human readable виде
''{{{free}}}'' – использование памяти и swap
''{{{whereis app}}}'' – возможное расположение программы app
''{{{which app}}}'' – какая app будет запущена по умолчанию

!Архивация
''{{{tar cf file.tar files}}}'' – создать tar-архив с именем file.tar содержащий files
''{{{tar xf file.tar}}}'' – распаковать file.tar
''{{{tar czf file.tar.gz files}}}'' – создать архив tar с сжатием Gzip
''{{{tar xzf file.tar.gz}}}'' – распаковать tar с Gzip
''{{{tar cjf file.tar.bz2}}}'' – создать архив tar с сжатием Bzip2
''{{{tar xjf file.tar.bz2}}}'' – распаковать tar с Bzip2
''{{{gzip file}}}'' – сжать file и переименовать в file.gz
''{{{gzip -d file.gz}}}'' – разжать file.gz в file

!Сеть
''{{{ping host}}}'' – пропинговать host и вывести результат
''{{{whois domain}}}'' – получить информацию whois для domain
''{{{dig domain}}}'' – получить DNS информацию domain
''{{{dig -x host}}}'' – реверсивно искать host
''{{{wget file}}}'' – скачать file
''{{{wget -c file}}}'' – продолжить остановленную закачку
''{{{nmap -v -A scanme.nmap.org}}}'' - сканировать узел

!Остальные команды
''{{{crontab -e}}}'' – редактировать список задач cron


</pre>
</div>
<div title="Шпоргалка по продвинутому использованию оболочки bash" modifier="Яковлев Иван" created="200906121317" modified="200906151102" tags="[[Командная оболочка bash]]" changecount="16">
<pre>!Строка приветствия bash
Пример строки приветствия:
{{{
uran@uran-ubuntu:~$
}}}
*{{{uran}}} -- имя пользователя
*{{{uran-ubuntu}}} -- имя компьютера
*{{{~}}} -- указатель домашнего каталога пользователя (в данном случае это {{{/home/uran}}})
*{{{$}}} -- приглашение ввода для пользователя (если пользователь является администратором, то приглашение ввода имеет вид {{{#}}})

!Указатели абсолютного и относительного путей к файлам и каталогам
Предположим, что мы находимся в домашнем каталоге пользователя: {{{/home/uran}}}
Пример указания абсолютного пути смены каталога:
{{{
cd /home
}}}
Пример указания относительного пути смены каталога (результат будет такойже как и в предыдущем примере):
{{{
cd ..
}}}

Таким образом мы имеем:
''{{{/}}}'' -- указатель абсолютного пути
''{{{.}}}'' -- указатель относительного пути на текущий каталог
''{{{..}}}'' -- указатель относительного пути на родительский каталог
''{{{~}}}'' -- указатель пути на домашний каталог текущего пользователя (в данном случае {{{/home/uran}}})
''{{{~+}}}'' -- текущий рабочий каталог (соответствует переменной ''PWD'' -- рабочий каталог)
''{{{~-}}}'' -- указывает на предыдущий рабочий каталог

!Кавычки
*Одиночные кавычки {{{'}}} -- переменные и команды заключенные в одинарные кавычки не обрабатываются bash.
*Двойные кавычки {{{&quot;}}} -- переменные, такие как ''NAME'', обрабатываются, команды не обрабатываются. Также применяются для задания комплексных имен файлов или каталогов содержащих пробелы.
*Обратные кавычки {{{`}}} -- каждое выражение заключенное в такие кавычки обрабатывается так, как будто это команда.
{{{
команда1 `команда2`
}}}
равнозначно
{{{
команда1 $(команда2)
}}}
Здесь сначала выполняется команда2, затем вызов команды2 заменяется ее результатом и выполняется команда1.

!!Пример использования кавычек
|!Выражение|!Значение|
|$person|hatter|
|&quot;$person&quot;|hatter|
|\$person|$person|
|`$person'|$person|
|&quot;'$person'&quot;|’hatter’|
|~alice|/home/alice|
|&quot;~alice&quot;|~alice|
|`~alice'|~alice|

!Обратный слеш ({{{\}}})
Применяется для экранирования спец символов, например:
{{{
cd &quot;/home/user/Имя каталога с пробелами в названии&quot;
}}}
равносильно
{{{
cd /home/user/Имя\ каталога\ с\ пробелами\ в\ названии
}}}

!Спец. символы -- маски (Wildcards)
''{{{*}}}'' -- любые символы
''{{{?}}}'' -- любой один символ
''{{{[123]}}}'' -- перечисление, например: name[123] будет соответствовать  name1, name2 и name3
''{ }'' -- блочные последовательности (Brace expantion), например: name_{one,two,three} будет соответствовать name_one, name_two, name_three

!История набранных в bash команд
''{{{!!}}}'' - повторить последнюю команду
''{{{!имя_команды}}}'' -- вызвать недавнюю команду с указанным именем
''{{{!?часть_имени_недавней_команды}}}'' -- вызвать наиболее подходящую по названию недавнюю команду
''{{{history -c}}}'' -- очистить историю команд (история последних 500 набранных команд хранится в файле {{{~/.bash_history}}}.

!Создание списков команд (Lists)
''{{{;}}}'' -- разделитель выполнения по очереди нескольких команд
{{{
команда1; команда2; ...; командаN
}}}
после выполнения первой команды будет выполнена вторая и т.д.

''{{{команда &amp;}}}'' -- запуск команды в фоновом режиме, переключится к фоновой команде можно с помощью команды {{{fg}}}
последовательное выполнение нескольких команд:
{{{
команда1 &amp; команда2 &amp; ... командаN
}}}
выполнение команды в фоновом режиме:
{{{
команда1 &amp;
}}}
''{{{&amp;&amp;}}}'' -- запускает первую команду и, если по окончании своего выполнения, эта команда возвращает нулевой статус (zero exit status), т.е. выполняется без ошибок, то выполняется следующая команда.

''{{{||}}}'' --  запускает первую команду и, если по окончании своего выполнения, эта команда возвращает не нулевой статус (non-zero exit status), то выполняется следующая команда.

!Перенаправление вывода/ввода
''{{{&gt;}}}'' -- указатель перенаправления вывода:
{{{
ls &gt; listing.txt
}}}
заставляет bash перенаправить вывод списка в файл listing.txt, если этого файла нет, то он будет создан, если файл уже есть, то он будет перезаписан.

''{{{&gt;&gt;}}}'' -- добавление вывода к уже имеющемуся контенту:
{{{
ls &gt;&gt; listing.txt
}}}
к содержимому файл listing.txt будет добавлено новое содержимое из вывода.

''{{{&lt;}}}'' -- перенаправление ввода:
{{{
sort &lt; shoppinglist.txt
}}}
сортирует записи из файла shoppinglist.txt и выводит их на экран.

!&quot;Трубопровод&quot; команд (Piping)
''{{{|}}}'' -- позволяет последовотельно выполнять команды, когда вывод одной команды является вводом для другой команды (трубопровод):
{{{
ls | sort                &lt;-- получение списка и сортировка его
ls | grep report.doc     &lt;-- получение списка и поиск его в файле report.doc
}}}


</pre>
</div>
<div title="Шпоргалки по Unix-like" modifier="Яковлев Иван" created="200906191915" modified="200906191924" tags="MainMenu slider Шпоргалки" changecount="6">
<pre>''Администрирование''
*[[LINUX Admin-quickRef|data/Linux - CheatSheets/linux_quickref.pdf]]
*[[TheOnePageLinuxManual|data/Linux - CheatSheets/The One Page Linux Manual.pdf]]
*[[Debian/Ubuntu-quickRef|data/Linux - CheatSheets/refcard-en-a4.pdf]]
*[[LinuxSecurity-quickRef|data/Linux - CheatSheets/linux_security_quickref.pdf]]
*[[LinuxSyscall-quickRef.pdf|data/Linux - CheatSheets/Linux_Syscall_quickref.pdf]]
''Работа с SSH''
*[[OpenSSH-quickRef|data/Linux - CheatSheets - SSH/OpenSSH_quickref.pdf]]
</pre>
</div>
<div title="Яковлев Иван" modifier="Яковлев Иван" created="200911261243" modified="200911290429" tags="[[Обо мне]]" changecount="10">
<pre>Web-разработчик, php-программист.

!Мой сайт
*[[www.uran1980.com|http://www.uran1980.com]]


!Мой e-mail: 
*//''[[uran1980@gmail.com|mailto:uran1980@gmail.com]]''//


!Мой персональный чат
Также я доступен для прямого общения через &lt;html&gt;&lt;img height=&quot;14&quot; width=&quot;16&quot; style=&quot;padding:0 2px 0 0;margin:0;border:none&quot; src=&quot;http://www.google.com/talk/service/resources/chaticon.gif&quot; alt=&quot;&quot; /&gt;&lt;img height=&quot;9&quot; width=&quot;9&quot; style=&quot;padding:0 2px 0 0;margin:0;border:none&quot; src=&quot;http://www.google.com/talk/service/badge/Show?tk=z01q6amlqledejtoccc1sc1ualbatdu4d82ogqp8hq1r6fivuod2l9rr822vrep878aui85tmi2rdon6v3u9p2v7q708li4nbmo9lohe6svil9dnd1unhumsl486rpm3dv7esld31hij928votpf6isnnuaeqjvkgsmhp27g4&amp;amp;w=9&amp;amp;h=9&quot; alt=&quot;&quot; /&gt; &lt;a style=&quot;font-weight: bold;&quot; title=&quot;Общаться через чат GoogleTalk&quot; href=&quot;http://www.google.com/talk/service/badge/Start?tk=z01q6amlqledejtoccc1sc1ualbatdu4d82ogqp8hq1r6fivuod2l9rr822vrep878aui85tmi2rdon6v3u9p2v7q708li4nbmo9lohe6svil9dnd1unhumsl486rpm3dv7esld31hij928votpf6isnnuaeqjvkgsmhp27g4&quot; target=&quot;_blank&quot;&gt;GoogleTalk&lt;/a&gt;&lt;/html&gt; или [[OperaUnitLongue|http://home.uran1980.operaunite.com/the_lounge/]]


!Мои проекты
*http://www.uran1980.com/myfolio/my-projects/ - описания и демонстрации всех моих проектов.


</pre>
</div>
</div>
<!--POST-STOREAREA-->
<!--POST-BODY-START-->
<!--POST-BODY-END-->
<script id="jsArea" type="text/javascript">
//<![CDATA[
//
// Please note:
//
// * This code is designed to be readable but for compactness it only includes brief comments. You can see fuller comments
//   in the project Subversion repository at http://svn.tiddlywiki.org/Trunk/core/
//
// * You should never need to modify this source code directly. TiddlyWiki is carefully designed to allow deep customisation
//   without changing the core code. Please consult the development group at http://groups.google.com/group/TiddlyWikiDev
//

//--
//-- Configuration repository
//--

// Miscellaneous options
var config = {
	numRssItems: 20, // Number of items in the RSS feed
	animDuration: 400, // Duration of UI animations in milliseconds
	cascadeFast: 20, // Speed for cascade animations (higher == slower)
	cascadeSlow: 60, // Speed for EasterEgg cascade animations
	cascadeDepth: 5, // Depth of cascade animation
	locale: "en" // W3C language tag
};

// Hashmap of alternative parsers for the wikifier
config.parsers = {};

// Adaptors
config.adaptors = {};
config.defaultAdaptor = null;

// Backstage tasks
config.tasks = {};

// Annotations
config.annotations = {};

// Custom fields to be automatically added to new tiddlers
config.defaultCustomFields = {};

// Messages
config.messages = {
	messageClose: {},
	dates: {},
	tiddlerPopup: {}
};

// Options that can be set in the options panel and/or cookies
config.options = {
	chkRegExpSearch: false,
	chkCaseSensitiveSearch: false,
	chkIncrementalSearch: true,
	chkAnimate: true,
	chkSaveBackups: true,
	chkAutoSave: false,
	chkGenerateAnRssFeed: false,
	chkSaveEmptyTemplate: false,
	chkOpenInNewWindow: true,
	chkToggleLinks: false,
	chkHttpReadOnly: true,
	chkForceMinorUpdate: false,
	chkConfirmDelete: true,
	chkInsertTabs: false,
	chkUsePreForStorage: true, // Whether to use <pre> format for storage
	chkDisplayInstrumentation: false,
	txtBackupFolder: "",
	txtEditorFocus: "text",
	txtMainTab: "tabTimeline",
	txtMoreTab: "moreTabAll",
	txtMaxEditRows: "30",
	txtFileSystemCharSet: "UTF-8",
	txtTheme: ""
	};
config.optionsDesc = {};

// Default tiddler templates
var DEFAULT_VIEW_TEMPLATE = 1;
var DEFAULT_EDIT_TEMPLATE = 2;
config.tiddlerTemplates = {
	1: "ViewTemplate",
	2: "EditTemplate"
};

// More messages (rather a legacy layout that should not really be like this)
config.views = {
	wikified: {
		tag: {}
	},
	editor: {
		tagChooser: {}
	}
};

// Backstage tasks
config.backstageTasks = ["save","sync","importTask","tweak","upgrade","plugins"];

// Extensions
config.extensions = {};

// Macros; each has a 'handler' member that is inserted later
config.macros = {
	today: {},
	version: {},
	search: {sizeTextbox: 15},
	tiddler: {},
	tag: {},
	tags: {},
	tagging: {},
	timeline: {},
	allTags: {},
	list: {
		all: {},
		missing: {},
		orphans: {},
		shadowed: {},
		touched: {},
		filter: {}
	},
	closeAll: {},
	permaview: {},
	saveChanges: {},
	slider: {},
	option: {},
	options: {},
	newTiddler: {},
	newJournal: {},
	tabs: {},
	gradient: {},
	message: {},
	view: {defaultView: "text"},
	edit: {},
	tagChooser: {},
	toolbar: {},
	plugins: {},
	refreshDisplay: {},
	importTiddlers: {},
	upgrade: {
		source: "http://www.tiddlywiki.com/upgrade/",
		backupExtension: "pre.core.upgrade"
	},
	sync: {},
	annotations: {}
};

// Commands supported by the toolbar macro
config.commands = {
	closeTiddler: {},
	closeOthers: {},
	editTiddler: {},
	saveTiddler: {hideReadOnly: true},
	cancelTiddler: {},
	deleteTiddler: {hideReadOnly: true},
	permalink: {},
	references: {type: "popup"},
	jump: {type: "popup"},
	syncing: {type: "popup"},
	fields: {type: "popup"}
};

// Browser detection... In a very few places, there's nothing else for it but to know what browser we're using.
config.userAgent = navigator.userAgent.toLowerCase();
config.browser = {
	isIE: config.userAgent.indexOf("msie") != -1 && config.userAgent.indexOf("opera") == -1,
	isGecko: config.userAgent.indexOf("gecko") != -1,
	ieVersion: /MSIE (\d.\d)/i.exec(config.userAgent), // config.browser.ieVersion[1], if it exists, will be the IE version string, eg "6.0"
	isSafari: config.userAgent.indexOf("applewebkit") != -1,
	isBadSafari: !((new RegExp("[\u0150\u0170]","g")).test("\u0150")),
	firefoxDate: /gecko\/(\d{8})/i.exec(config.userAgent), // config.browser.firefoxDate[1], if it exists, will be Firefox release date as "YYYYMMDD"
	isOpera: config.userAgent.indexOf("opera") != -1,
	isLinux: config.userAgent.indexOf("linux") != -1,
	isUnix: config.userAgent.indexOf("x11") != -1,
	isMac: config.userAgent.indexOf("mac") != -1,
	isWindows: config.userAgent.indexOf("win") != -1
};

// Basic regular expressions
config.textPrimitives = {
	upperLetter: "[A-Z\u00c0-\u00de\u0150\u0170]",
	lowerLetter: "[a-z0-9_\\-\u00df-\u00ff\u0151\u0171]",
	anyLetter:   "[A-Za-z0-9_\\-\u00c0-\u00de\u00df-\u00ff\u0150\u0170\u0151\u0171]",
	anyLetterStrict: "[A-Za-z0-9\u00c0-\u00de\u00df-\u00ff\u0150\u0170\u0151\u0171]"
};
if(config.browser.isBadSafari) {
	config.textPrimitives = {
		upperLetter: "[A-Z\u00c0-\u00de]",
		lowerLetter: "[a-z0-9_\\-\u00df-\u00ff]",
		anyLetter:   "[A-Za-z0-9_\\-\u00c0-\u00de\u00df-\u00ff]",
		anyLetterStrict: "[A-Za-z0-9\u00c0-\u00de\u00df-\u00ff]"
	};
}
config.textPrimitives.sliceSeparator = "::";
config.textPrimitives.sectionSeparator = "##";
config.textPrimitives.urlPattern = "(?:file|http|https|mailto|ftp|irc|news|data):[^\\s'\"]+(?:/|\\b)";
config.textPrimitives.unWikiLink = "~";
config.textPrimitives.wikiLink = "(?:(?:" + config.textPrimitives.upperLetter + "+" +
	config.textPrimitives.lowerLetter + "+" +
	config.textPrimitives.upperLetter +
	config.textPrimitives.anyLetter + "*)|(?:" +
	config.textPrimitives.upperLetter + "{2,}" +
	config.textPrimitives.lowerLetter + "+))";

config.textPrimitives.cssLookahead = "(?:(" + config.textPrimitives.anyLetter + "+)\\(([^\\)\\|\\n]+)(?:\\):))|(?:(" + config.textPrimitives.anyLetter + "+):([^;\\|\\n]+);)";
config.textPrimitives.cssLookaheadRegExp = new RegExp(config.textPrimitives.cssLookahead,"mg");

config.textPrimitives.brackettedLink = "\\[\\[([^\\]]+)\\]\\]";
config.textPrimitives.titledBrackettedLink = "\\[\\[([^\\[\\]\\|]+)\\|([^\\[\\]\\|]+)\\]\\]";
config.textPrimitives.tiddlerForcedLinkRegExp = new RegExp("(?:" + config.textPrimitives.titledBrackettedLink + ")|(?:" +
	config.textPrimitives.brackettedLink + ")|(?:" +
	config.textPrimitives.urlPattern + ")","mg");
config.textPrimitives.tiddlerAnyLinkRegExp = new RegExp("("+ config.textPrimitives.wikiLink + ")|(?:" +
	config.textPrimitives.titledBrackettedLink + ")|(?:" +
	config.textPrimitives.brackettedLink + ")|(?:" +
	config.textPrimitives.urlPattern + ")","mg");

config.glyphs = {
	browsers: [
		function() {return config.browser.isIE;},
		function() {return true;}
	],
	currBrowser: null,
	codes: {
		downTriangle: ["\u25BC","\u25BE"],
		downArrow: ["\u2193","\u2193"],
		bentArrowLeft: ["\u2190","\u21A9"],
		bentArrowRight: ["\u2192","\u21AA"]
	}
};

//--
//-- Shadow tiddlers
//--

config.shadowTiddlers = {
	StyleSheet: "",
	MarkupPreHead: "",
	MarkupPostHead: "",
	MarkupPreBody: "",
	MarkupPostBody: "",
	TabTimeline: '<<timeline>>',
	TabAll: '<<list all>>',
	TabTags: '<<allTags excludeLists>>',
	TabMoreMissing: '<<list missing>>',
	TabMoreOrphans: '<<list orphans>>',
	TabMoreShadowed: '<<list shadowed>>',
	AdvancedOptions: '<<options>>',
	PluginManager: '<<plugins>>',
	ToolbarCommands: '|~ViewToolbar|closeTiddler closeOthers +editTiddler > fields syncing permalink references jump|\n|~EditToolbar|+saveTiddler -cancelTiddler deleteTiddler|'
};

//--
//-- Translateable strings
//--

// Strings in "double quotes" should be translated; strings in 'single quotes' should be left alone

merge(config.options,{
	txtUserName: "YourName"});

merge(config.tasks,{
	save: {text: "save", tooltip: "Save your changes to this TiddlyWiki", action: saveChanges},
	sync: {text: "sync", tooltip: "Synchronise changes with other TiddlyWiki files and servers", content: '<<sync>>'},
	importTask: {text: "import", tooltip: "Import tiddlers and plugins from other TiddlyWiki files and servers", content: '<<importTiddlers>>'},
	tweak: {text: "tweak", tooltip: "Tweak the appearance and behaviour of TiddlyWiki", content: '<<options>>'},
	upgrade: {text: "upgrade", tooltip: "Upgrade TiddlyWiki core code", content: '<<upgrade>>'},
	plugins: {text: "plugins", tooltip: "Manage installed plugins", content: '<<plugins>>'}
});

// Options that can be set in the options panel and/or cookies
merge(config.optionsDesc,{
	txtUserName: "Username for signing your edits",
	chkRegExpSearch: "Enable regular expressions for searches",
	chkCaseSensitiveSearch: "Case-sensitive searching",
	chkIncrementalSearch: "Incremental key-by-key searching",
	chkAnimate: "Enable animations",
	chkSaveBackups: "Keep backup file when saving changes",
	chkAutoSave: "Automatically save changes",
	chkGenerateAnRssFeed: "Generate an RSS feed when saving changes",
	chkSaveEmptyTemplate: "Generate an empty template when saving changes",
	chkOpenInNewWindow: "Open external links in a new window",
	chkToggleLinks: "Clicking on links to open tiddlers causes them to close",
	chkHttpReadOnly: "Hide editing features when viewed over HTTP",
	chkForceMinorUpdate: "Don't update modifier username and date when editing tiddlers",
	chkConfirmDelete: "Require confirmation before deleting tiddlers",
	chkInsertTabs: "Use the tab key to insert tab characters instead of moving between fields",
	txtBackupFolder: "Name of folder to use for backups",
	txtMaxEditRows: "Maximum number of rows in edit boxes",
	txtTheme: "Name of the theme to use",
	txtFileSystemCharSet: "Default character set for saving changes (Firefox/Mozilla only)"});

merge(config.messages,{
	customConfigError: "Problems were encountered loading plugins. See PluginManager for details",
	pluginError: "Error: %0",
	pluginDisabled: "Not executed because disabled via 'systemConfigDisable' tag",
	pluginForced: "Executed because forced via 'systemConfigForce' tag",
	pluginVersionError: "Not executed because this plugin needs a newer version of TiddlyWiki",
	nothingSelected: "Nothing is selected. You must select one or more items first",
	savedSnapshotError: "It appears that this TiddlyWiki has been incorrectly saved. Please see http://www.tiddlywiki.com/#Download for details",
	subtitleUnknown: "(unknown)",
	undefinedTiddlerToolTip: "The tiddler '%0' doesn't yet exist",
	shadowedTiddlerToolTip: "The tiddler '%0' doesn't yet exist, but has a pre-defined shadow value",
	tiddlerLinkTooltip: "%0 - %1, %2",
	externalLinkTooltip: "External link to %0",
	noTags: "There are no tagged tiddlers",
	notFileUrlError: "You need to save this TiddlyWiki to a file before you can save changes",
	cantSaveError: "It's not possible to save changes. Possible reasons include:\n- your browser doesn't support saving (Firefox, Internet Explorer, Safari and Opera all work if properly configured)\n- the pathname to your TiddlyWiki file contains illegal characters\n- the TiddlyWiki HTML file has been moved or renamed",
	invalidFileError: "The original file '%0' does not appear to be a valid TiddlyWiki",
	backupSaved: "Backup saved",
	backupFailed: "Failed to save backup file",
	rssSaved: "RSS feed saved",
	rssFailed: "Failed to save RSS feed file",
	emptySaved: "Empty template saved",
	emptyFailed: "Failed to save empty template file",
	mainSaved: "Main TiddlyWiki file saved",
	mainFailed: "Failed to save main TiddlyWiki file. Your changes have not been saved",
	macroError: "Error in macro <<\%0>>",
	macroErrorDetails: "Error while executing macro <<\%0>>:\n%1",
	missingMacro: "No such macro",
	overwriteWarning: "A tiddler named '%0' already exists. Choose OK to overwrite it",
	unsavedChangesWarning: "WARNING! There are unsaved changes in TiddlyWiki\n\nChoose OK to save\nChoose CANCEL to discard",
	confirmExit: "--------------------------------\n\nThere are unsaved changes in TiddlyWiki. If you continue you will lose those changes\n\n--------------------------------",
	saveInstructions: "SaveChanges",
	unsupportedTWFormat: "Unsupported TiddlyWiki format '%0'",
	tiddlerSaveError: "Error when saving tiddler '%0'",
	tiddlerLoadError: "Error when loading tiddler '%0'",
	wrongSaveFormat: "Cannot save with storage format '%0'. Using standard format for save.",
	invalidFieldName: "Invalid field name %0",
	fieldCannotBeChanged: "Field '%0' cannot be changed",
	loadingMissingTiddler: "Attempting to retrieve the tiddler '%0' from the '%1' server at:\n\n'%2' in the workspace '%3'",
	upgradeDone: "The upgrade to version %0 is now complete\n\nClick 'OK' to reload the newly upgraded TiddlyWiki"});

merge(config.messages.messageClose,{
	text: "close",
	tooltip: "close this message area"});

config.messages.backstage = {
	open: {text: "backstage", tooltip: "Open the backstage area to perform authoring and editing tasks"},
	close: {text: "close", tooltip: "Close the backstage area"},
	prompt: "backstage: ",
	decal: {
		edit: {text: "edit", tooltip: "Edit the tiddler '%0'"}
	}
};

config.messages.listView = {
	tiddlerTooltip: "Click for the full text of this tiddler",
	previewUnavailable: "(preview not available)"
};

config.messages.dates.months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November","December"];
config.messages.dates.days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
config.messages.dates.shortMonths = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
config.messages.dates.shortDays = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
// suffixes for dates, eg "1st","2nd","3rd"..."30th","31st"
config.messages.dates.daySuffixes = ["st","nd","rd","th","th","th","th","th","th","th",
		"th","th","th","th","th","th","th","th","th","th",
		"st","nd","rd","th","th","th","th","th","th","th",
		"st"];
config.messages.dates.am = "am";
config.messages.dates.pm = "pm";

merge(config.messages.tiddlerPopup,{
	});

merge(config.views.wikified.tag,{
	labelNoTags: "no tags",
	labelTags: "tags: ",
	openTag: "Open tag '%0'",
	tooltip: "Show tiddlers tagged with '%0'",
	openAllText: "Open all",
	openAllTooltip: "Open all of these tiddlers",
	popupNone: "No other tiddlers tagged with '%0'"});

merge(config.views.wikified,{
	defaultText: "The tiddler '%0' doesn't yet exist. Double-click to create it",
	defaultModifier: "(missing)",
	shadowModifier: "(built-in shadow tiddler)",
	dateFormat: "DD MMM YYYY",
	createdPrompt: "created"});

merge(config.views.editor,{
	tagPrompt: "Type tags separated with spaces, [[use double square brackets]] if necessary, or add existing",
	defaultText: "Type the text for '%0'"});

merge(config.views.editor.tagChooser,{
	text: "tags",
	tooltip: "Choose existing tags to add to this tiddler",
	popupNone: "There are no tags defined",
	tagTooltip: "Add the tag '%0'"});

merge(config.messages,{
	sizeTemplates:
		[
		{unit: 1024*1024*1024, template: "%0\u00a0GB"},
		{unit: 1024*1024, template: "%0\u00a0MB"},
		{unit: 1024, template: "%0\u00a0KB"},
		{unit: 1, template: "%0\u00a0B"}
		]});

merge(config.macros.search,{
	label: "search",
	prompt: "Search this TiddlyWiki",
	accessKey: "F",
	successMsg: "%0 tiddlers found matching %1",
	failureMsg: "No tiddlers found matching %0"});

merge(config.macros.tagging,{
	label: "tagging: ",
	labelNotTag: "not tagging",
	tooltip: "List of tiddlers tagged with '%0'"});

merge(config.macros.timeline,{
	dateFormat: "DD MMM YYYY"});

merge(config.macros.allTags,{
	tooltip: "Show tiddlers tagged with '%0'",
	noTags: "There are no tagged tiddlers"});

config.macros.list.all.prompt = "All tiddlers in alphabetical order";
config.macros.list.missing.prompt = "Tiddlers that have links to them but are not defined";
config.macros.list.orphans.prompt = "Tiddlers that are not linked to from any other tiddlers";
config.macros.list.shadowed.prompt = "Tiddlers shadowed with default contents";
config.macros.list.touched.prompt = "Tiddlers that have been modified locally";

merge(config.macros.closeAll,{
	label: "close all",
	prompt: "Close all displayed tiddlers (except any that are being edited)"});

merge(config.macros.permaview,{
	label: "permaview",
	prompt: "Link to an URL that retrieves all the currently displayed tiddlers"});

merge(config.macros.saveChanges,{
	label: "save changes",
	prompt: "Save all tiddlers to create a new TiddlyWiki",
	accessKey: "S"});

merge(config.macros.newTiddler,{
	label: "new tiddler",
	prompt: "Create a new tiddler",
	title: "New Tiddler",
	accessKey: "N"});

merge(config.macros.newJournal,{
	label: "new journal",
	prompt: "Create a new tiddler from the current date and time",
	accessKey: "J"});

merge(config.macros.options,{
	wizardTitle: "Tweak advanced options",
	step1Title: "These options are saved in cookies in your browser",
	step1Html: "<input type='hidden' name='markList'></input><br><input type='checkbox' checked='false' name='chkUnknown'>Show unknown options</input>",
	unknownDescription: "//(unknown)//",
	listViewTemplate: {
		columns: [
			{name: 'Option', field: 'option', title: "Option", type: 'String'},
			{name: 'Description', field: 'description', title: "Description", type: 'WikiText'},
			{name: 'Name', field: 'name', title: "Name", type: 'String'}
			],
		rowClasses: [
			{className: 'lowlight', field: 'lowlight'}
			]}
	});

merge(config.macros.plugins,{
	wizardTitle: "Manage plugins",
	step1Title: "Currently loaded plugins",
	step1Html: "<input type='hidden' name='markList'></input>", // DO NOT TRANSLATE
	skippedText: "(This plugin has not been executed because it was added since startup)",
	noPluginText: "There are no plugins installed",
	confirmDeleteText: "Are you sure you want to delete these plugins:\n\n%0",
	removeLabel: "remove systemConfig tag",
	removePrompt: "Remove systemConfig tag",
	deleteLabel: "delete",
	deletePrompt: "Delete these tiddlers forever",
	listViewTemplate: {
		columns: [
			{name: 'Selected', field: 'Selected', rowName: 'title', type: 'Selector'},
			{name: 'Tiddler', field: 'tiddler', title: "Tiddler", type: 'Tiddler'},
			{name: 'Description', field: 'Description', title: "Description", type: 'String'},
			{name: 'Version', field: 'Version', title: "Version", type: 'String'},
			{name: 'Size', field: 'size', tiddlerLink: 'size', title: "Size", type: 'Size'},
			{name: 'Forced', field: 'forced', title: "Forced", tag: 'systemConfigForce', type: 'TagCheckbox'},
			{name: 'Disabled', field: 'disabled', title: "Disabled", tag: 'systemConfigDisable', type: 'TagCheckbox'},
			{name: 'Executed', field: 'executed', title: "Loaded", type: 'Boolean', trueText: "Yes", falseText: "No"},
			{name: 'Startup Time', field: 'startupTime', title: "Startup Time", type: 'String'},
			{name: 'Error', field: 'error', title: "Status", type: 'Boolean', trueText: "Error", falseText: "OK"},
			{name: 'Log', field: 'log', title: "Log", type: 'StringList'}
			],
		rowClasses: [
			{className: 'error', field: 'error'},
			{className: 'warning', field: 'warning'}
			]}
	});

merge(config.macros.toolbar,{
	moreLabel: "more",
	morePrompt: "Show additional commands",
	lessLabel: "less",
	lessPrompt: "Hide additional commands",
	separator: "|"
	});

merge(config.macros.refreshDisplay,{
	label: "refresh",
	prompt: "Redraw the entire TiddlyWiki display"
	});

merge(config.macros.importTiddlers,{
	readOnlyWarning: "You cannot import into a read-only TiddlyWiki file. Try opening it from a file:// URL",
	wizardTitle: "Import tiddlers from another file or server",
	step1Title: "Step 1: Locate the server or TiddlyWiki file",
	step1Html: "Specify the type of the server: <select name='selTypes'><option value=''>Choose...</option></select><br>Enter the URL or pathname here: <input type='text' size=50 name='txtPath'><br>...or browse for a file: <input type='file' size=50 name='txtBrowse'><br><hr>...or select a pre-defined feed: <select name='selFeeds'><option value=''>Choose...</option></select>",
	openLabel: "open",
	openPrompt: "Open the connection to this file or server",
	openError: "There were problems fetching the tiddlywiki file",
	statusOpenHost: "Opening the host",
	statusGetWorkspaceList: "Getting the list of available workspaces",
	step2Title: "Step 2: Choose the workspace",
	step2Html: "Enter a workspace name: <input type='text' size=50 name='txtWorkspace'><br>...or select a workspace: <select name='selWorkspace'><option value=''>Choose...</option></select>",
	cancelLabel: "cancel",
	cancelPrompt: "Cancel this import",
	statusOpenWorkspace: "Opening the workspace",
	statusGetTiddlerList: "Getting the list of available tiddlers",
	errorGettingTiddlerList: "Error getting list of tiddlers, click Cancel to try again",
	step3Title: "Step 3: Choose the tiddlers to import",
	step3Html: "<input type='hidden' name='markList'></input><br><input type='checkbox' checked='true' name='chkSync'>Keep these tiddlers linked to this server so that you can synchronise subsequent changes</input><br><input type='checkbox' name='chkSave'>Save the details of this server in a 'systemServer' tiddler called:</input> <input type='text' size=25 name='txtSaveTiddler'>",
	importLabel: "import",
	importPrompt: "Import these tiddlers",
	confirmOverwriteText: "Are you sure you want to overwrite these tiddlers:\n\n%0",
	step4Title: "Step 4: Importing %0 tiddler(s)",
	step4Html: "<input type='hidden' name='markReport'></input>", // DO NOT TRANSLATE
	doneLabel: "done",
	donePrompt: "Close this wizard",
	statusDoingImport: "Importing tiddlers",
	statusDoneImport: "All tiddlers imported",
	systemServerNamePattern: "%2 on %1",
	systemServerNamePatternNoWorkspace: "%1",
	confirmOverwriteSaveTiddler: "The tiddler '%0' already exists. Click 'OK' to overwrite it with the details of this server, or 'Cancel' to leave it unchanged",
	serverSaveTemplate: "|''Type:''|%0|\n|''URL:''|%1|\n|''Workspace:''|%2|\n\nThis tiddler was automatically created to record the details of this server",
	serverSaveModifier: "(System)",
	listViewTemplate: {
		columns: [
			{name: 'Selected', field: 'Selected', rowName: 'title', type: 'Selector'},
			{name: 'Tiddler', field: 'tiddler', title: "Tiddler", type: 'Tiddler'},
			{name: 'Size', field: 'size', tiddlerLink: 'size', title: "Size", type: 'Size'},
			{name: 'Tags', field: 'tags', title: "Tags", type: 'Tags'}
			],
		rowClasses: [
			]}
	});

merge(config.macros.upgrade,{
	wizardTitle: "Upgrade TiddlyWiki core code",
	step1Title: "Update or repair this TiddlyWiki to the latest release",
	step1Html: "You are about to upgrade to the latest release of the TiddlyWiki core code (from <a href='%0' class='externalLink' target='_blank'>%1</a>). Your content will be preserved across the upgrade.<br><br>Note that core upgrades have been known to interfere with older plugins. If you run into problems with the upgraded file, see <a href='http://www.tiddlywiki.org/wiki/CoreUpgrades' class='externalLink' target='_blank'>http://www.tiddlywiki.org/wiki/CoreUpgrades</a>",
	errorCantUpgrade: "Unable to upgrade this TiddlyWiki. You can only perform upgrades on TiddlyWiki files stored locally",
	errorNotSaved: "You must save changes before you can perform an upgrade",
	step2Title: "Confirm the upgrade details",
	step2Html_downgrade: "You are about to downgrade to TiddlyWiki version %0 from %1.<br><br>Downgrading to an earlier version of the core code is not recommended",
	step2Html_restore: "This TiddlyWiki appears to be already using the latest version of the core code (%0).<br><br>You can continue to upgrade anyway to ensure that the core code hasn't been corrupted or damaged",
	step2Html_upgrade: "You are about to upgrade to TiddlyWiki version %0 from %1",
	upgradeLabel: "upgrade",
	upgradePrompt: "Prepare for the upgrade process",
	statusPreparingBackup: "Preparing backup",
	statusSavingBackup: "Saving backup file",
	errorSavingBackup: "There was a problem saving the backup file",
	statusLoadingCore: "Loading core code",
	errorLoadingCore: "Error loading the core code",
	errorCoreFormat: "Error with the new core code",
	statusSavingCore: "Saving the new core code",
	statusReloadingCore: "Reloading the new core code",
	startLabel: "start",
	startPrompt: "Start the upgrade process",
	cancelLabel: "cancel",
	cancelPrompt: "Cancel the upgrade process",
	step3Title: "Upgrade cancelled",
	step3Html: "You have cancelled the upgrade process"
	});

merge(config.macros.sync,{
	listViewTemplate: {
		columns: [
			{name: 'Selected', field: 'selected', rowName: 'title', type: 'Selector'},
			{name: 'Tiddler', field: 'tiddler', title: "Tiddler", type: 'Tiddler'},
			{name: 'Server Type', field: 'serverType', title: "Server type", type: 'String'},
			{name: 'Server Host', field: 'serverHost', title: "Server host", type: 'String'},
			{name: 'Server Workspace', field: 'serverWorkspace', title: "Server workspace", type: 'String'},
			{name: 'Status', field: 'status', title: "Synchronisation status", type: 'String'},
			{name: 'Server URL', field: 'serverUrl', title: "Server URL", text: "View", type: 'Link'}
			],
		rowClasses: [
			],
		buttons: [
			{caption: "Sync these tiddlers", name: 'sync'}
			]},
	wizardTitle: "Synchronize with external servers and files",
	step1Title: "Choose the tiddlers you want to synchronize",
	step1Html: "<input type='hidden' name='markList'></input>", // DO NOT TRANSLATE
	syncLabel: "sync",
	syncPrompt: "Sync these tiddlers",
	hasChanged: "Changed while unplugged",
	hasNotChanged: "Unchanged while unplugged",
	syncStatusList: {
		none: {text: "...", display:null, className:'notChanged'},
		changedServer: {text: "Changed on server", display:null, className:'changedServer'},
		changedLocally: {text: "Changed while unplugged", display:null, className:'changedLocally'},
		changedBoth: {text: "Changed while unplugged and on server", display:null, className:'changedBoth'},
		notFound: {text: "Not found on server", display:null, className:'notFound'},
		putToServer: {text: "Saved update on server", display:null, className:'putToServer'},
		gotFromServer: {text: "Retrieved update from server", display:null, className:'gotFromServer'}
		}
	});

merge(config.macros.annotations,{
	});

merge(config.commands.closeTiddler,{
	text: "close",
	tooltip: "Close this tiddler"});

merge(config.commands.closeOthers,{
	text: "close others",
	tooltip: "Close all other tiddlers"});

merge(config.commands.editTiddler,{
	text: "edit",
	tooltip: "Edit this tiddler",
	readOnlyText: "view",
	readOnlyTooltip: "View the source of this tiddler"});

merge(config.commands.saveTiddler,{
	text: "done",
	tooltip: "Save changes to this tiddler"});

merge(config.commands.cancelTiddler,{
	text: "cancel",
	tooltip: "Undo changes to this tiddler",
	warning: "Are you sure you want to abandon your changes to '%0'?",
	readOnlyText: "done",
	readOnlyTooltip: "View this tiddler normally"});

merge(config.commands.deleteTiddler,{
	text: "delete",
	tooltip: "Delete this tiddler",
	warning: "Are you sure you want to delete '%0'?"});

merge(config.commands.permalink,{
	text: "permalink",
	tooltip: "Permalink for this tiddler"});

merge(config.commands.references,{
	text: "references",
	tooltip: "Show tiddlers that link to this one",
	popupNone: "No references"});

merge(config.commands.jump,{
	text: "jump",
	tooltip: "Jump to another open tiddler"});

merge(config.commands.syncing,{
	text: "syncing",
	tooltip: "Control synchronisation of this tiddler with a server or external file",
	currentlySyncing: "<div>Currently syncing via <span class='popupHighlight'>'%0'</span> to:</"+"div><div>host: <span class='popupHighlight'>%1</span></"+"div><div>workspace: <span class='popupHighlight'>%2</span></"+"div>", // Note escaping of closing <div> tag
	notCurrentlySyncing: "Not currently syncing",
	captionUnSync: "Stop synchronising this tiddler",
	chooseServer: "Synchronise this tiddler with another server:",
	currServerMarker: "\u25cf ",
	notCurrServerMarker: "  "});

merge(config.commands.fields,{
	text: "fields",
	tooltip: "Show the extended fields of this tiddler",
	emptyText: "There are no extended fields for this tiddler",
	listViewTemplate: {
		columns: [
			{name: 'Field', field: 'field', title: "Field", type: 'String'},
			{name: 'Value', field: 'value', title: "Value", type: 'String'}
			],
		rowClasses: [
			],
		buttons: [
			]}});

merge(config.shadowTiddlers,{
	DefaultTiddlers: "[[GettingStarted]]",
	MainMenu: "[[GettingStarted]]",
	SiteTitle: "My TiddlyWiki",
	SiteSubtitle: "a reusable non-linear personal web notebook",
	SiteUrl: "http://www.tiddlywiki.com/",
	SideBarOptions: '<<search>><<closeAll>><<permaview>><<newTiddler>><<newJournal "DD MMM YYYY" "journal">><<saveChanges>><<slider chkSliderOptionsPanel OptionsPanel "options \u00bb" "Change TiddlyWiki advanced options">>',
	SideBarTabs: '<<tabs txtMainTab "Timeline" "Timeline" TabTimeline "All" "All tiddlers" TabAll "Tags" "All tags" TabTags "More" "More lists" TabMore>>',
	TabMore: '<<tabs txtMoreTab "Missing" "Missing tiddlers" TabMoreMissing "Orphans" "Orphaned tiddlers" TabMoreOrphans "Shadowed" "Shadowed tiddlers" TabMoreShadowed>>'
	});

merge(config.annotations,{
	AdvancedOptions: "This shadow tiddler provides access to several advanced options",
	ColorPalette: "These values in this shadow tiddler determine the colour scheme of the ~TiddlyWiki user interface",
	DefaultTiddlers: "The tiddlers listed in this shadow tiddler will be automatically displayed when ~TiddlyWiki starts up",
	EditTemplate: "The HTML template in this shadow tiddler determines how tiddlers look while they are being edited",
	GettingStarted: "This shadow tiddler provides basic usage instructions",
	ImportTiddlers: "This shadow tiddler provides access to importing tiddlers",
	MainMenu: "This shadow tiddler is used as the contents of the main menu in the left-hand column of the screen",
	MarkupPreHead: "This tiddler is inserted at the top of the <head> section of the TiddlyWiki HTML file",
	MarkupPostHead: "This tiddler is inserted at the bottom of the <head> section of the TiddlyWiki HTML file",
	MarkupPreBody: "This tiddler is inserted at the top of the <body> section of the TiddlyWiki HTML file",
	MarkupPostBody: "This tiddler is inserted at the end of the <body> section of the TiddlyWiki HTML file immediately after the script block",
	OptionsPanel: "This shadow tiddler is used as the contents of the options panel slider in the right-hand sidebar",
	PageTemplate: "The HTML template in this shadow tiddler determines the overall ~TiddlyWiki layout",
	PluginManager: "This shadow tiddler provides access to the plugin manager",
	SideBarOptions: "This shadow tiddler is used as the contents of the option panel in the right-hand sidebar",
	SideBarTabs: "This shadow tiddler is used as the contents of the tabs panel in the right-hand sidebar",
	SiteSubtitle: "This shadow tiddler is used as the second part of the page title",
	SiteTitle: "This shadow tiddler is used as the first part of the page title",
	SiteUrl: "This shadow tiddler should be set to the full target URL for publication",
	StyleSheetColors: "This shadow tiddler contains CSS definitions related to the color of page elements. ''DO NOT EDIT THIS TIDDLER'', instead make your changes in the StyleSheet shadow tiddler",
	StyleSheet: "This tiddler can contain custom CSS definitions",
	StyleSheetLayout: "This shadow tiddler contains CSS definitions related to the layout of page elements. ''DO NOT EDIT THIS TIDDLER'', instead make your changes in the StyleSheet shadow tiddler",
	StyleSheetLocale: "This shadow tiddler contains CSS definitions related to the translation locale",
	StyleSheetPrint: "This shadow tiddler contains CSS definitions for printing",
	TabAll: "This shadow tiddler contains the contents of the 'All' tab in the right-hand sidebar",
	TabMore: "This shadow tiddler contains the contents of the 'More' tab in the right-hand sidebar",
	TabMoreMissing: "This shadow tiddler contains the contents of the 'Missing' tab in the right-hand sidebar",
	TabMoreOrphans: "This shadow tiddler contains the contents of the 'Orphans' tab in the right-hand sidebar",
	TabMoreShadowed: "This shadow tiddler contains the contents of the 'Shadowed' tab in the right-hand sidebar",
	TabTags: "This shadow tiddler contains the contents of the 'Tags' tab in the right-hand sidebar",
	TabTimeline: "This shadow tiddler contains the contents of the 'Timeline' tab in the right-hand sidebar",
	ToolbarCommands: "This shadow tiddler determines which commands are shown in tiddler toolbars",
	ViewTemplate: "The HTML template in this shadow tiddler determines how tiddlers look"
	});

//--
//-- Main
//--

var params = null; // Command line parameters
var store = null; // TiddlyWiki storage
var story = null; // Main story
var formatter = null; // Default formatters for the wikifier
var anim = typeof Animator == "function" ? new Animator() : null; // Animation engine
var readOnly = false; // Whether we're in readonly mode
var highlightHack = null; // Embarrassing hack department...
var hadConfirmExit = false; // Don't warn more than once
var safeMode = false; // Disable all plugins and cookies
var showBackstage; // Whether to include the backstage area
var installedPlugins = []; // Information filled in when plugins are executed
var startingUp = false; // Whether we're in the process of starting up
var pluginInfo,tiddler; // Used to pass information to plugins in loadPlugins()

// Whether to use the JavaSaver applet
var useJavaSaver = (config.browser.isSafari || config.browser.isOpera) && (document.location.toString().substr(0,4) != "http");

// Starting up
function main()
{
	var t10,t9,t8,t7,t6,t5,t4,t3,t2,t1,t0 = new Date();
	startingUp = true;
	jQuery.noConflict();
	window.onbeforeunload = function(e) {if(window.confirmExit) return confirmExit();};
	params = getParameters();
	if(params)
		params = params.parseParams("open",null,false);
	store = new TiddlyWiki();
	invokeParamifier(params,"oninit");
	story = new Story("tiddlerDisplay","tiddler");
	addEvent(document,"click",Popup.onDocumentClick);
	saveTest();
	loadOptionsCookie();
	for(var s=0; s<config.notifyTiddlers.length; s++)
		store.addNotification(config.notifyTiddlers[s].name,config.notifyTiddlers[s].notify);
	t1 = new Date();
	loadShadowTiddlers();
	jQuery().trigger("loadShadows");
	t2 = new Date();
	store.loadFromDiv("storeArea","store",true);
	jQuery().trigger("loadTiddlers");
	t3 = new Date();
	invokeParamifier(params,"onload");
	t4 = new Date();
	readOnly = (window.location.protocol == "file:") ? false : config.options.chkHttpReadOnly;
	var pluginProblem = loadPlugins();
	jQuery().trigger("loadPlugins");
	t5 = new Date();
	formatter = new Formatter(config.formatters);
	invokeParamifier(params,"onconfig");
	story.switchTheme(config.options.txtTheme);
	showBackstage = !readOnly;
	t6 = new Date();
	for(var m in config.macros) {
		if(config.macros[m].init)
			config.macros[m].init();
	}
	t7 = new Date();
	store.notifyAll();
	t8 = new Date();
	restart();
	refreshDisplay();
	t9 = new Date();
	if(pluginProblem) {
		story.displayTiddler(null,"PluginManager");
		displayMessage(config.messages.customConfigError);
	}
	if(showBackstage)
		backstage.init();
	t10 = new Date();
	if(config.options.chkDisplayInstrumentation) {
		displayMessage("LoadShadows " + (t2-t1) + " ms");
		displayMessage("LoadFromDiv " + (t3-t2) + " ms");
		displayMessage("LoadPlugins " + (t5-t4) + " ms");
		displayMessage("Macro init " + (t7-t6) + " ms");
		displayMessage("Notify " + (t8-t7) + " ms");
		displayMessage("Restart " + (t9-t8) + " ms");
		displayMessage("Total: " + (t10-t0) + " ms");
	}
	startingUp = false;
	jQuery().trigger("startup");
}

// Called on unload. All functions called conditionally since they themselves may have been unloaded.
function unload()
{
	if(window.checkUnsavedChanges)
		checkUnsavedChanges();
	if(window.scrubNodes)
		scrubNodes(document.body);
}

// Restarting
function restart()
{
	invokeParamifier(params,"onstart");
	if(story.isEmpty()) {
		story.displayDefaultTiddlers();
	}
	window.scrollTo(0,0);
}

function saveTest()
{
	var s = document.getElementById("saveTest");
	if(s.hasChildNodes())
		alert(config.messages.savedSnapshotError);
	s.appendChild(document.createTextNode("savetest"));
}

function loadShadowTiddlers()
{
	var shadows = new TiddlyWiki();
	shadows.loadFromDiv("shadowArea","shadows",true);
	shadows.forEachTiddler(function(title,tiddler){config.shadowTiddlers[title] = tiddler.text;});
	delete shadows;
}

function loadPlugins()
{
	if(safeMode)
		return false;
	var tiddlers = store.getTaggedTiddlers("systemConfig");
	var toLoad = [];
	var nLoaded = 0;
	var map = {};
	var nPlugins = tiddlers.length;
	installedPlugins = [];
	for(var i=0; i<nPlugins; i++) {
		var p = getPluginInfo(tiddlers[i]);
		installedPlugins[i] = p;
		var n = p.Name;
		if(n)
			map[n] = p;
		n = p.Source;
		if(n)
			map[n] = p;
	}
	var visit = function(p) {
		if(!p || p.done)
			return;
		p.done = 1;
		var reqs = p.Requires;
		if(reqs) {
			reqs = reqs.readBracketedList();
			for(var i=0; i<reqs.length; i++)
				visit(map[reqs[i]]);
		}
		toLoad.push(p);
	};
	for(i=0; i<nPlugins; i++)
		visit(installedPlugins[i]);
	for(i=0; i<toLoad.length; i++) {
		p = toLoad[i];
		pluginInfo = p;
		tiddler = p.tiddler;
		if(isPluginExecutable(p)) {
			if(isPluginEnabled(p)) {
				p.executed = true;
				var startTime = new Date();
				try {
					if(tiddler.text)
						window.eval(tiddler.text);
					nLoaded++;
				} catch(ex) {
					p.log.push(config.messages.pluginError.format([exceptionText(ex)]));
					p.error = true;
				}
				pluginInfo.startupTime = String((new Date()) - startTime) + "ms";
			} else {
				nPlugins--;
			}
		} else {
			p.warning = true;
		}
	}
	return nLoaded != nPlugins;
}

function getPluginInfo(tiddler)
{
	var p = store.getTiddlerSlices(tiddler.title,["Name","Description","Version","Requires","CoreVersion","Date","Source","Author","License","Browsers"]);
	p.tiddler = tiddler;
	p.title = tiddler.title;
	p.log = [];
	return p;
}

// Check that a particular plugin is valid for execution
function isPluginExecutable(plugin)
{
	if(plugin.tiddler.isTagged("systemConfigForce")) {
		plugin.log.push(config.messages.pluginForced);
		return true;
	}
	if(plugin["CoreVersion"]) {
		var coreVersion = plugin["CoreVersion"].split(".");
		var w = parseInt(coreVersion[0],10) - version.major;
		if(w == 0 && coreVersion[1])
			w = parseInt(coreVersion[1],10) - version.minor;
		if(w == 0 && coreVersion[2])
			w = parseInt(coreVersion[2],10) - version.revision;
		if(w > 0) {
			plugin.log.push(config.messages.pluginVersionError);
			return false;
		}
	}
	return true;
}

function isPluginEnabled(plugin)
{
	if(plugin.tiddler.isTagged("systemConfigDisable")) {
		plugin.log.push(config.messages.pluginDisabled);
		return false;
	}
	return true;
}

function invokeMacro(place,macro,params,wikifier,tiddler)
{
	try {
		var m = config.macros[macro];
		if(m && m.handler) {
			var tiddlerElem = story.findContainingTiddler(place);
			window.tiddler = tiddlerElem ? store.getTiddler(tiddlerElem.getAttribute("tiddler")) : null;
			window.place = place;
			m.handler(place,macro,params.readMacroParams(),wikifier,params,tiddler);
		} else {
			createTiddlyError(place,config.messages.macroError.format([macro]),config.messages.macroErrorDetails.format([macro,config.messages.missingMacro]));
		}
	} catch(ex) {
		createTiddlyError(place,config.messages.macroError.format([macro]),config.messages.macroErrorDetails.format([macro,ex.toString()]));
	}
}

//--
//-- Paramifiers
//--

function getParameters()
{
	var p = null;
	if(window.location.hash) {
		p = decodeURIComponent(window.location.hash.substr(1));
		if(config.browser.firefoxDate != null && config.browser.firefoxDate[1] < "20051111")
			p = convertUTF8ToUnicode(p);
	}
	return p;
}

function invokeParamifier(params,handler)
{
	if(!params || params.length == undefined || params.length <= 1)
		return;
	for(var i=1; i<params.length; i++) {
		var p = config.paramifiers[params[i].name];
		if(p && p[handler] instanceof Function)
			p[handler](params[i].value);
		else {
			var h = config.optionHandlers[params[i].name.substr(0,3)];
			if(h && h.set instanceof Function)
				h.set(params[i].name,params[i].value);
		}
	}
}

config.paramifiers = {};

config.paramifiers.start = {
	oninit: function(v) {
		safeMode = v.toLowerCase() == "safe";
	}
};

config.paramifiers.open = {
	onstart: function(v) {
		if(!readOnly || store.tiddlerExists(v) || store.isShadowTiddler(v))
			story.displayTiddler("bottom",v,null,false,null);
	}
};

config.paramifiers.story = {
	onstart: function(v) {
		var list = store.getTiddlerText(v,"").parseParams("open",null,false);
		invokeParamifier(list,"onstart");
	}
};

config.paramifiers.search = {
	onstart: function(v) {
		story.search(v,false,false);
	}
};

config.paramifiers.searchRegExp = {
	onstart: function(v) {
		story.prototype.search(v,false,true);
	}
};

config.paramifiers.tag = {
	onstart: function(v) {
		story.displayTiddlers(null,store.filterTiddlers("[tag["+v+"]]"),null,false,null);
	}
};

config.paramifiers.newTiddler = {
	onstart: function(v) {
		if(!readOnly) {
			story.displayTiddler(null,v,DEFAULT_EDIT_TEMPLATE);
			story.focusTiddler(v,"text");
		}
	}
};

config.paramifiers.newJournal = {
	onstart: function(v) {
		if(!readOnly) {
			var now = new Date();
			var title = now.formatString(v.trim());
			story.displayTiddler(null,title,DEFAULT_EDIT_TEMPLATE);
			story.focusTiddler(title,"text");
		}
	}
};

config.paramifiers.readOnly = {
	onconfig: function(v) {
		var p = v.toLowerCase();
		readOnly = p == "yes" ? true : (p == "no" ? false : readOnly);
	}
};

config.paramifiers.theme = {
	onconfig: function(v) {
		story.switchTheme(v);
	}
};

config.paramifiers.upgrade = {
	onstart: function(v) {
		upgradeFrom(v);
	}
};

config.paramifiers.recent= {
	onstart: function(v) {
		var titles=[];
		var tiddlers=store.getTiddlers("modified","excludeLists").reverse();
		for(var i=0; i<v && i<tiddlers.length; i++)
			titles.push(tiddlers[i].title);
		story.displayTiddlers(null,titles);
	}
};

config.paramifiers.filter = {
	onstart: function(v) {
		story.displayTiddlers(null,store.filterTiddlers(v),null,false);
	}
};

//--
//-- Formatter helpers
//--

function Formatter(formatters)
{
	this.formatters = [];
	var pattern = [];
	for(var n=0; n<formatters.length; n++) {
		pattern.push("(" + formatters[n].match + ")");
		this.formatters.push(formatters[n]);
	}
	this.formatterRegExp = new RegExp(pattern.join("|"),"mg");
}

config.formatterHelpers = {

	createElementAndWikify: function(w)
	{
		w.subWikifyTerm(createTiddlyElement(w.output,this.element),this.termRegExp);
	},

	inlineCssHelper: function(w)
	{
		var styles = [];
		config.textPrimitives.cssLookaheadRegExp.lastIndex = w.nextMatch;
		var lookaheadMatch = config.textPrimitives.cssLookaheadRegExp.exec(w.source);
		while(lookaheadMatch && lookaheadMatch.index == w.nextMatch) {
			var s,v;
			if(lookaheadMatch[1]) {
				s = lookaheadMatch[1].unDash();
				v = lookaheadMatch[2];
			} else {
				s = lookaheadMatch[3].unDash();
				v = lookaheadMatch[4];
			}
			if(s=="bgcolor")
				s = "backgroundColor";
			styles.push({style: s, value: v});
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
			config.textPrimitives.cssLookaheadRegExp.lastIndex = w.nextMatch;
			lookaheadMatch = config.textPrimitives.cssLookaheadRegExp.exec(w.source);
		}
		return styles;
	},

	applyCssHelper: function(e,styles)
	{
		for(var t=0; t< styles.length; t++) {
			try {
				e.style[styles[t].style] = styles[t].value;
			} catch (ex) {
			}
		}
	},

	enclosedTextHelper: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			var text = lookaheadMatch[1];
			if(config.browser.isIE)
				text = text.replace(/\n/g,"\r");
			createTiddlyElement(w.output,this.element,null,null,text);
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
		}
	},

	isExternalLink: function(link)
	{
		if(store.tiddlerExists(link) || store.isShadowTiddler(link)) {
			return false;
		}
		var urlRegExp = new RegExp(config.textPrimitives.urlPattern,"mg");
		if(urlRegExp.exec(link)) {
			return true;
		}
		if(link.indexOf(".")!=-1 || link.indexOf("\\")!=-1 || link.indexOf("/")!=-1 || link.indexOf("#")!=-1) {
			return true;
		}
		return false;
	}

};

//--
//-- Standard formatters
//--

config.formatters = [
{
	name: "table",
	match: "^\\|(?:[^\\n]*)\\|(?:[fhck]?)$",
	lookaheadRegExp: /^\|([^\n]*)\|([fhck]?)$/mg,
	rowTermRegExp: /(\|(?:[fhck]?)$\n?)/mg,
	cellRegExp: /(?:\|([^\n\|]*)\|)|(\|[fhck]?$\n?)/mg,
	cellTermRegExp: /((?:\x20*)\|)/mg,
	rowTypes: {"c":"caption", "h":"thead", "":"tbody", "f":"tfoot"},
	handler: function(w)
	{
		var table = createTiddlyElement(w.output,"table",null,"twtable");
		var prevColumns = [];
		var currRowType = null;
		var rowContainer;
		var rowCount = 0;
		w.nextMatch = w.matchStart;
		this.lookaheadRegExp.lastIndex = w.nextMatch;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		while(lookaheadMatch && lookaheadMatch.index == w.nextMatch) {
			var nextRowType = lookaheadMatch[2];
			if(nextRowType == "k") {
				table.className = lookaheadMatch[1];
				w.nextMatch += lookaheadMatch[0].length+1;
			} else {
				if(nextRowType != currRowType) {
					rowContainer = createTiddlyElement(table,this.rowTypes[nextRowType]);
					currRowType = nextRowType;
				}
				if(currRowType == "c") {
					// Caption
					w.nextMatch++;
					if(rowContainer != table.firstChild)
						table.insertBefore(rowContainer,table.firstChild);
					rowContainer.setAttribute("align",rowCount == 0?"top":"bottom");
					w.subWikifyTerm(rowContainer,this.rowTermRegExp);
				} else {
					var theRow = createTiddlyElement(rowContainer,"tr",null,(rowCount&1)?"oddRow":"evenRow");
					theRow.onmouseover = function() {addClass(this,"hoverRow");};
					theRow.onmouseout = function() {removeClass(this,"hoverRow");};
					this.rowHandler(w,theRow,prevColumns);
					rowCount++;
				}
			}
			this.lookaheadRegExp.lastIndex = w.nextMatch;
			lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		}
	},
	rowHandler: function(w,e,prevColumns)
	{
		var col = 0;
		var colSpanCount = 1;
		var prevCell = null;
		this.cellRegExp.lastIndex = w.nextMatch;
		var cellMatch = this.cellRegExp.exec(w.source);
		while(cellMatch && cellMatch.index == w.nextMatch) {
			if(cellMatch[1] == "~") {
				// Rowspan
				var last = prevColumns[col];
				if(last) {
					last.rowSpanCount++;
					last.element.setAttribute("rowspan",last.rowSpanCount);
					last.element.setAttribute("rowSpan",last.rowSpanCount); // Needed for IE
					last.element.valign = "center";
				}
				w.nextMatch = this.cellRegExp.lastIndex-1;
			} else if(cellMatch[1] == ">") {
				// Colspan
				colSpanCount++;
				w.nextMatch = this.cellRegExp.lastIndex-1;
			} else if(cellMatch[2]) {
				// End of row
				if(prevCell && colSpanCount > 1) {
					prevCell.setAttribute("colspan",colSpanCount);
					prevCell.setAttribute("colSpan",colSpanCount); // Needed for IE
				}
				w.nextMatch = this.cellRegExp.lastIndex;
				break;
			} else {
				// Cell
				w.nextMatch++;
				var styles = config.formatterHelpers.inlineCssHelper(w);
				var spaceLeft = false;
				var chr = w.source.substr(w.nextMatch,1);
				while(chr == " ") {
					spaceLeft = true;
					w.nextMatch++;
					chr = w.source.substr(w.nextMatch,1);
				}
				var cell;
				if(chr == "!") {
					cell = createTiddlyElement(e,"th");
					w.nextMatch++;
				} else {
					cell = createTiddlyElement(e,"td");
				}
				prevCell = cell;
				prevColumns[col] = {rowSpanCount:1,element:cell};
				if(colSpanCount > 1) {
					cell.setAttribute("colspan",colSpanCount);
					cell.setAttribute("colSpan",colSpanCount); // Needed for IE
					colSpanCount = 1;
				}
				config.formatterHelpers.applyCssHelper(cell,styles);
				w.subWikifyTerm(cell,this.cellTermRegExp);
				if(w.matchText.substr(w.matchText.length-2,1) == " ") // spaceRight
					cell.align = spaceLeft ? "center" : "left";
				else if(spaceLeft)
					cell.align = "right";
				w.nextMatch--;
			}
			col++;
			this.cellRegExp.lastIndex = w.nextMatch;
			cellMatch = this.cellRegExp.exec(w.source);
		}
	}
},

{
	name: "heading",
	match: "^!{1,6}",
	termRegExp: /(\n)/mg,
	handler: function(w)
	{
		w.subWikifyTerm(createTiddlyElement(w.output,"h" + w.matchLength),this.termRegExp);
	}
},

{
	name: "list",
	match: "^(?:[\\*#;:]+)",
	lookaheadRegExp: /^(?:(?:(\*)|(#)|(;)|(:))+)/mg,
	termRegExp: /(\n)/mg,
	handler: function(w)
	{
		var stack = [w.output];
		var currLevel = 0, currType = null;
		var listLevel, listType, itemType, baseType;
		w.nextMatch = w.matchStart;
		this.lookaheadRegExp.lastIndex = w.nextMatch;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		while(lookaheadMatch && lookaheadMatch.index == w.nextMatch) {
			if(lookaheadMatch[1]) {
				listType = "ul";
				itemType = "li";
			} else if(lookaheadMatch[2]) {
				listType = "ol";
				itemType = "li";
			} else if(lookaheadMatch[3]) {
				listType = "dl";
				itemType = "dt";
			} else if(lookaheadMatch[4]) {
				listType = "dl";
				itemType = "dd";
			}
			if(!baseType)
				baseType = listType;
			listLevel = lookaheadMatch[0].length;
			w.nextMatch += lookaheadMatch[0].length;
			var t;
			if(listLevel > currLevel) {
				for(t=currLevel; t<listLevel; t++) {
					var target = (currLevel == 0) ? stack[stack.length-1] : stack[stack.length-1].lastChild;
					stack.push(createTiddlyElement(target,listType));
				}
			} else if(listType!=baseType && listLevel==1) {
				w.nextMatch -= lookaheadMatch[0].length;
				return;
			} else if(listLevel < currLevel) {
				for(t=currLevel; t>listLevel; t--)
					stack.pop();
			} else if(listLevel == currLevel && listType != currType) {
				stack.pop();
				stack.push(createTiddlyElement(stack[stack.length-1].lastChild,listType));
			}
			currLevel = listLevel;
			currType = listType;
			var e = createTiddlyElement(stack[stack.length-1],itemType);
			w.subWikifyTerm(e,this.termRegExp);
			this.lookaheadRegExp.lastIndex = w.nextMatch;
			lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		}
	}
},

{
	name: "quoteByBlock",
	match: "^<<<\\n",
	termRegExp: /(^<<<(\n|$))/mg,
	element: "blockquote",
	handler: config.formatterHelpers.createElementAndWikify
},

{
	name: "quoteByLine",
	match: "^>+",
	lookaheadRegExp: /^>+/mg,
	termRegExp: /(\n)/mg,
	element: "blockquote",
	handler: function(w)
	{
		var stack = [w.output];
		var currLevel = 0;
		var newLevel = w.matchLength;
		var t;
		do {
			if(newLevel > currLevel) {
				for(t=currLevel; t<newLevel; t++)
					stack.push(createTiddlyElement(stack[stack.length-1],this.element));
			} else if(newLevel < currLevel) {
				for(t=currLevel; t>newLevel; t--)
					stack.pop();
			}
			currLevel = newLevel;
			w.subWikifyTerm(stack[stack.length-1],this.termRegExp);
			createTiddlyElement(stack[stack.length-1],"br");
			this.lookaheadRegExp.lastIndex = w.nextMatch;
			var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
			var matched = lookaheadMatch && lookaheadMatch.index == w.nextMatch;
			if(matched) {
				newLevel = lookaheadMatch[0].length;
				w.nextMatch += lookaheadMatch[0].length;
			}
		} while(matched);
	}
},

{
	name: "rule",
	match: "^----+$\\n?|<hr ?/?>\\n?",
	handler: function(w)
	{
		createTiddlyElement(w.output,"hr");
	}
},

{
	name: "monospacedByLine",
	match: "^(?:/\\*\\{\\{\\{\\*/|\\{\\{\\{|//\\{\\{\\{|<!--\\{\\{\\{-->)\\n",
	element: "pre",
	handler: function(w)
	{
		switch(w.matchText) {
		case "/*{{{*/\n": // CSS
			this.lookaheadRegExp = /\/\*\{\{\{\*\/\n*((?:^[^\n]*\n)+?)(\n*^\/\*\}\}\}\*\/$\n?)/mg;
			break;
		case "{{{\n": // monospaced block
			this.lookaheadRegExp = /^\{\{\{\n((?:^[^\n]*\n)+?)(^\}\}\}$\n?)/mg;
			break;
		case "//{{{\n": // plugin
			this.lookaheadRegExp = /^\/\/\{\{\{\n\n*((?:^[^\n]*\n)+?)(\n*^\/\/\}\}\}$\n?)/mg;
			break;
		case "<!--{{{-->\n": //template
			this.lookaheadRegExp = /<!--\{\{\{-->\n*((?:^[^\n]*\n)+?)(\n*^<!--\}\}\}-->$\n?)/mg;
			break;
		default:
			break;
		}
		config.formatterHelpers.enclosedTextHelper.call(this,w);
	}
},

{
	name: "wikifyComment",
	match: "^(?:/\\*\\*\\*|<!---)\\n",
	handler: function(w)
	{
		var termRegExp = (w.matchText == "/***\n") ? (/(^\*\*\*\/\n)/mg) : (/(^--->\n)/mg);
		w.subWikifyTerm(w.output,termRegExp);
	}
},

{
	name: "macro",
	match: "<<",
	lookaheadRegExp: /<<([^>\s]+)(?:\s*)((?:[^>]|(?:>(?!>)))*)>>/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart && lookaheadMatch[1]) {
			w.nextMatch = this.lookaheadRegExp.lastIndex;
			invokeMacro(w.output,lookaheadMatch[1],lookaheadMatch[2],w,w.tiddler);
		}
	}
},

{
	name: "prettyLink",
	match: "\\[\\[",
	lookaheadRegExp: /\[\[(.*?)(?:\|(~)?(.*?))?\]\]/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			var e;
			var text = lookaheadMatch[1];
			if(lookaheadMatch[3]) {
				// Pretty bracketted link
				var link = lookaheadMatch[3];
				e = (!lookaheadMatch[2] && config.formatterHelpers.isExternalLink(link)) ?
						createExternalLink(w.output,link) : createTiddlyLink(w.output,decodeURIComponent(link),false,null,w.isStatic,w.tiddler);
			} else {
				// Simple bracketted link
				e = createTiddlyLink(w.output,decodeURIComponent(text),false,null,w.isStatic,w.tiddler);
			}
			createTiddlyText(e,text);
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
},

{
	name: "wikiLink",
	match: config.textPrimitives.unWikiLink+"?"+config.textPrimitives.wikiLink,
	handler: function(w)
	{
		if(w.matchText.substr(0,1) == config.textPrimitives.unWikiLink) {
			w.outputText(w.output,w.matchStart+1,w.nextMatch);
			return;
		}
		if(w.matchStart > 0) {
			var preRegExp = new RegExp(config.textPrimitives.anyLetterStrict,"mg");
			preRegExp.lastIndex = w.matchStart-1;
			var preMatch = preRegExp.exec(w.source);
			if(preMatch.index == w.matchStart-1) {
				w.outputText(w.output,w.matchStart,w.nextMatch);
				return;
			}
		}
		if(w.autoLinkWikiWords || store.isShadowTiddler(w.matchText)) {
			var link = createTiddlyLink(w.output,w.matchText,false,null,w.isStatic,w.tiddler);
			w.outputText(link,w.matchStart,w.nextMatch);
		} else {
			w.outputText(w.output,w.matchStart,w.nextMatch);
		}
	}
},

{
	name: "urlLink",
	match: config.textPrimitives.urlPattern,
	handler: function(w)
	{
		w.outputText(createExternalLink(w.output,w.matchText),w.matchStart,w.nextMatch);
	}
},

{
	name: "image",
	match: "\\[[<>]?[Ii][Mm][Gg]\\[",
	lookaheadRegExp: /\[([<]?)(>?)[Ii][Mm][Gg]\[(?:([^\|\]]+)\|)?([^\[\]\|]+)\](?:\[([^\]]*)\])?\]/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			var e = w.output;
			if(lookaheadMatch[5]) {
				var link = lookaheadMatch[5];
				e = config.formatterHelpers.isExternalLink(link) ? createExternalLink(w.output,link) : createTiddlyLink(w.output,link,false,null,w.isStatic,w.tiddler);
				addClass(e,"imageLink");
			}
			var img = createTiddlyElement(e,"img");
			if(lookaheadMatch[1])
				img.align = "left";
			else if(lookaheadMatch[2])
				img.align = "right";
			if(lookaheadMatch[3]) {
				img.title = lookaheadMatch[3];
				img.setAttribute("alt",lookaheadMatch[3]);
			}
			img.src = lookaheadMatch[4];
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
},

{
	name: "html",
	match: "<[Hh][Tt][Mm][Ll]>",
	lookaheadRegExp: /<[Hh][Tt][Mm][Ll]>((?:.|\n)*?)<\/[Hh][Tt][Mm][Ll]>/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			createTiddlyElement(w.output,"span").innerHTML = lookaheadMatch[1];
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
},

{
	name: "commentByBlock",
	match: "/%",
	lookaheadRegExp: /\/%((?:.|\n)*?)%\//mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart)
			w.nextMatch = this.lookaheadRegExp.lastIndex;
	}
},

{
	name: "characterFormat",
	match: "''|//|__|\\^\\^|~~|--(?!\\s|$)|\\{\\{\\{",
	handler: function(w)
	{
		switch(w.matchText) {
		case "''":
			w.subWikifyTerm(w.output.appendChild(document.createElement("strong")),/('')/mg);
			break;
		case "//":
			w.subWikifyTerm(createTiddlyElement(w.output,"em"),/(\/\/)/mg);
			break;
		case "__":
			w.subWikifyTerm(createTiddlyElement(w.output,"u"),/(__)/mg);
			break;
		case "^^":
			w.subWikifyTerm(createTiddlyElement(w.output,"sup"),/(\^\^)/mg);
			break;
		case "~~":
			w.subWikifyTerm(createTiddlyElement(w.output,"sub"),/(~~)/mg);
			break;
		case "--":
			w.subWikifyTerm(createTiddlyElement(w.output,"strike"),/(--)/mg);
			break;
		case "{{{":
			var lookaheadRegExp = /\{\{\{((?:.|\n)*?)\}\}\}/mg;
			lookaheadRegExp.lastIndex = w.matchStart;
			var lookaheadMatch = lookaheadRegExp.exec(w.source);
			if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
				createTiddlyElement(w.output,"code",null,null,lookaheadMatch[1]);
				w.nextMatch = lookaheadRegExp.lastIndex;
			}
			break;
		}
	}
},

{
	name: "customFormat",
	match: "@@|\\{\\{",
	handler: function(w)
	{
		switch(w.matchText) {
		case "@@":
			var e = createTiddlyElement(w.output,"span");
			var styles = config.formatterHelpers.inlineCssHelper(w);
			if(styles.length == 0)
				e.className = "marked";
			else
				config.formatterHelpers.applyCssHelper(e,styles);
			w.subWikifyTerm(e,/(@@)/mg);
			break;
		case "{{":
			var lookaheadRegExp = /\{\{[\s]*([\w]+[\s\w]*)[\s]*\{(\n?)/mg;
			lookaheadRegExp.lastIndex = w.matchStart;
			var lookaheadMatch = lookaheadRegExp.exec(w.source);
			if(lookaheadMatch) {
				w.nextMatch = lookaheadRegExp.lastIndex;
				e = createTiddlyElement(w.output,lookaheadMatch[2] == "\n" ? "div" : "span",null,lookaheadMatch[1]);
				w.subWikifyTerm(e,/(\}\}\})/mg);
			}
			break;
		}
	}
},

{
	name: "mdash",
	match: "--",
	handler: function(w)
	{
		createTiddlyElement(w.output,"span").innerHTML = "&mdash;";
	}
},

{
	name: "lineBreak",
	match: "\\n|<br ?/?>",
	handler: function(w)
	{
		createTiddlyElement(w.output,"br");
	}
},

{
	name: "rawText",
	match: "\"{3}|<nowiki>",
	lookaheadRegExp: /(?:\"{3}|<nowiki>)((?:.|\n)*?)(?:\"{3}|<\/nowiki>)/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			createTiddlyElement(w.output,"span",null,null,lookaheadMatch[1]);
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
},

{
	name: "htmlEntitiesEncoding",
	match: "(?:(?:&#?[a-zA-Z0-9]{2,8};|.)(?:&#?(?:x0*(?:3[0-6][0-9a-fA-F]|1D[c-fC-F][0-9a-fA-F]|20[d-fD-F][0-9a-fA-F]|FE2[0-9a-fA-F])|0*(?:76[89]|7[7-9][0-9]|8[0-7][0-9]|761[6-9]|76[2-7][0-9]|84[0-3][0-9]|844[0-7]|6505[6-9]|6506[0-9]|6507[0-1]));)+|&#?[a-zA-Z0-9]{2,8};)",
	handler: function(w)
	{
		createTiddlyElement(w.output,"span").innerHTML = w.matchText;
	}
}

];

//--
//-- Wikifier
//--

function getParser(tiddler,format)
{
	if(tiddler) {
		if(!format)
			format = tiddler.fields["wikiformat"];
		var i;
		if(format) {
			for(i in config.parsers) {
				if(format == config.parsers[i].format)
					return config.parsers[i];
			}
		} else {
			for(i in config.parsers) {
				if(tiddler.isTagged(config.parsers[i].formatTag))
					return config.parsers[i];
			}
		}
	}
	return formatter;
}

function wikify(source,output,highlightRegExp,tiddler)
{
	if(source) {
		var wikifier = new Wikifier(source,getParser(tiddler),highlightRegExp,tiddler);
		var t0 = new Date();
		wikifier.subWikify(output);
		if(tiddler && config.options.chkDisplayInstrumentation)
			displayMessage("wikify:" +tiddler.title+ " in " + (new Date()-t0) + " ms");
	}
}

function wikifyStatic(source,highlightRegExp,tiddler,format)
{
	var e = createTiddlyElement(document.body,"pre");
	e.style.display = "none";
	var html = "";
	if(source && source != "") {
		if(!tiddler)
			tiddler = new Tiddler("temp");
		var wikifier = new Wikifier(source,getParser(tiddler,format),highlightRegExp,tiddler);
		wikifier.isStatic = true;
		wikifier.subWikify(e);
		html = e.innerHTML;
		removeNode(e);
	}
	return html;
}

function wikifyPlain(title,theStore,limit)
{
	if(!theStore)
		theStore = store;
	if(theStore.tiddlerExists(title) || theStore.isShadowTiddler(title)) {
		return wikifyPlainText(theStore.getTiddlerText(title),limit,tiddler);
	} else {
		return "";
	}
}

function wikifyPlainText(text,limit,tiddler)
{
	if(limit > 0)
		text = text.substr(0,limit);
	var wikifier = new Wikifier(text,formatter,null,tiddler);
	return wikifier.wikifyPlain();
}

function highlightify(source,output,highlightRegExp,tiddler)
{
	if(source) {
		var wikifier = new Wikifier(source,formatter,highlightRegExp,tiddler);
		wikifier.outputText(output,0,source.length);
	}
}

function Wikifier(source,formatter,highlightRegExp,tiddler)
{
	this.source = source;
	this.output = null;
	this.formatter = formatter;
	this.nextMatch = 0;
	this.autoLinkWikiWords = tiddler && tiddler.autoLinkWikiWords() == false ? false : true;
	this.highlightRegExp = highlightRegExp;
	this.highlightMatch = null;
	this.isStatic = false;
	if(highlightRegExp) {
		highlightRegExp.lastIndex = 0;
		this.highlightMatch = highlightRegExp.exec(source);
	}
	this.tiddler = tiddler;
}

Wikifier.prototype.wikifyPlain = function()
{
	var e = createTiddlyElement(document.body,"div");
	e.style.display = "none";
	this.subWikify(e);
	var text = getPlainText(e);
	removeNode(e);
	return text;
};

Wikifier.prototype.subWikify = function(output,terminator)
{
	try {
		if(terminator)
			this.subWikifyTerm(output,new RegExp("(" + terminator + ")","mg"));
		else
			this.subWikifyUnterm(output);
	} catch(ex) {
		showException(ex);
	}
};

Wikifier.prototype.subWikifyUnterm = function(output)
{
	var oldOutput = this.output;
	this.output = output;
	this.formatter.formatterRegExp.lastIndex = this.nextMatch;
	var formatterMatch = this.formatter.formatterRegExp.exec(this.source);
	while(formatterMatch) {
		// Output any text before the match
		if(formatterMatch.index > this.nextMatch)
			this.outputText(this.output,this.nextMatch,formatterMatch.index);
		// Set the match parameters for the handler
		this.matchStart = formatterMatch.index;
		this.matchLength = formatterMatch[0].length;
		this.matchText = formatterMatch[0];
		this.nextMatch = this.formatter.formatterRegExp.lastIndex;
		for(var t=1; t<formatterMatch.length; t++) {
			if(formatterMatch[t]) {
				this.formatter.formatters[t-1].handler(this);
				this.formatter.formatterRegExp.lastIndex = this.nextMatch;
				break;
			}
		}
		formatterMatch = this.formatter.formatterRegExp.exec(this.source);
	}
	if(this.nextMatch < this.source.length) {
		this.outputText(this.output,this.nextMatch,this.source.length);
		this.nextMatch = this.source.length;
	}
	this.output = oldOutput;
};

Wikifier.prototype.subWikifyTerm = function(output,terminatorRegExp)
{
	var oldOutput = this.output;
	this.output = output;
	terminatorRegExp.lastIndex = this.nextMatch;
	var terminatorMatch = terminatorRegExp.exec(this.source);
	this.formatter.formatterRegExp.lastIndex = this.nextMatch;
	var formatterMatch = this.formatter.formatterRegExp.exec(terminatorMatch ? this.source.substr(0,terminatorMatch.index) : this.source);
	while(terminatorMatch || formatterMatch) {
		if(terminatorMatch && (!formatterMatch || terminatorMatch.index <= formatterMatch.index)) {
			if(terminatorMatch.index > this.nextMatch)
				this.outputText(this.output,this.nextMatch,terminatorMatch.index);
			this.matchText = terminatorMatch[1];
			this.matchLength = terminatorMatch[1].length;
			this.matchStart = terminatorMatch.index;
			this.nextMatch = this.matchStart + this.matchLength;
			this.output = oldOutput;
			return;
		}
		if(formatterMatch.index > this.nextMatch)
			this.outputText(this.output,this.nextMatch,formatterMatch.index);
		this.matchStart = formatterMatch.index;
		this.matchLength = formatterMatch[0].length;
		this.matchText = formatterMatch[0];
		this.nextMatch = this.formatter.formatterRegExp.lastIndex;
		for(var t=1; t<formatterMatch.length; t++) {
			if(formatterMatch[t]) {
				this.formatter.formatters[t-1].handler(this);
				this.formatter.formatterRegExp.lastIndex = this.nextMatch;
				break;
			}
		}
		terminatorRegExp.lastIndex = this.nextMatch;
		terminatorMatch = terminatorRegExp.exec(this.source);
		formatterMatch = this.formatter.formatterRegExp.exec(terminatorMatch ? this.source.substr(0,terminatorMatch.index) : this.source);
	}
	if(this.nextMatch < this.source.length) {
		this.outputText(this.output,this.nextMatch,this.source.length);
		this.nextMatch = this.source.length;
	}
	this.output = oldOutput;
};

Wikifier.prototype.outputText = function(place,startPos,endPos)
{
	while(this.highlightMatch && (this.highlightRegExp.lastIndex > startPos) && (this.highlightMatch.index < endPos) && (startPos < endPos)) {
		if(this.highlightMatch.index > startPos) {
			createTiddlyText(place,this.source.substring(startPos,this.highlightMatch.index));
			startPos = this.highlightMatch.index;
		}
		var highlightEnd = Math.min(this.highlightRegExp.lastIndex,endPos);
		var theHighlight = createTiddlyElement(place,"span",null,"highlight",this.source.substring(startPos,highlightEnd));
		startPos = highlightEnd;
		if(startPos >= this.highlightRegExp.lastIndex)
			this.highlightMatch = this.highlightRegExp.exec(this.source);
	}
	if(startPos < endPos) {
		createTiddlyText(place,this.source.substring(startPos,endPos));
	}
};

//--
//-- Macro definitions
//--

config.macros.today.handler = function(place,macroName,params)
{
	var now = new Date();
	var text = params[0] ? now.formatString(params[0].trim()) : now.toLocaleString();
	jQuery("<span/>").text(text).appendTo(place);
};

config.macros.version.handler = function(place)
{
	jQuery("<span/>").text(formatVersion()).appendTo(place);
};

config.macros.list.handler = function(place,macroName,params)
{
	var type = params[0] || "all";
	var list = document.createElement("ul");
	place.appendChild(list);
	if(this[type].prompt)
		createTiddlyElement(list,"li",null,"listTitle",this[type].prompt);
	var results;
	if(this[type].handler)
		results = this[type].handler(params);
	for(var t = 0; t < results.length; t++) {
		var li = document.createElement("li");
		list.appendChild(li);
		createTiddlyLink(li,typeof results[t] == "string" ? results[t] : results[t].title,true);
	}
};

config.macros.list.all.handler = function(params)
{
	return store.reverseLookup("tags","excludeLists",false,"title");
};

config.macros.list.missing.handler = function(params)
{
	return store.getMissingLinks();
};

config.macros.list.orphans.handler = function(params)
{
	return store.getOrphans();
};

config.macros.list.shadowed.handler = function(params)
{
	return store.getShadowed();
};

config.macros.list.touched.handler = function(params)
{
	return store.getTouched();
};

config.macros.list.filter.handler = function(params)
{
	var filter = params[1];
	var results = [];
	if(filter) {
		var tiddlers = store.filterTiddlers(filter);
		for(var t=0; t<tiddlers.length; t++)
			results.push(tiddlers[t].title);
	}
	return results;
};

config.macros.allTags.handler = function(place,macroName,params)
{
	var tags = store.getTags(params[0]);
	var ul = createTiddlyElement(place,"ul");
	if(tags.length == 0)
		createTiddlyElement(ul,"li",null,"listTitle",this.noTags);
	for(var t=0; t<tags.length; t++) {
		var title = tags[t][0];
		var info = getTiddlyLinkInfo(title);
		var li = createTiddlyElement(ul,"li");
		var btn = createTiddlyButton(li,title + " (" + tags[t][1] + ")",this.tooltip.format([title]),onClickTag,info.classes);
		btn.setAttribute("tag",title);
		btn.setAttribute("refresh","link");
		btn.setAttribute("tiddlyLink",title);
	}
};

config.macros.timeline.handler = function(place,macroName,params)
{
	var field = params[0] || "modified";
	var tiddlers = store.reverseLookup("tags","excludeLists",false,field);
	var lastDay = "";
	var last = params[1] ? tiddlers.length-Math.min(tiddlers.length,parseInt(params[1])) : 0;
	var dateFormat = params[2] || this.dateFormat;
	for(var t=tiddlers.length-1; t>=last; t--) {
		var tiddler = tiddlers[t];
		var theDay = tiddler[field].convertToLocalYYYYMMDDHHMM().substr(0,8);
		if(theDay != lastDay) {
			var ul = document.createElement("ul");
			place.appendChild(ul);
			createTiddlyElement(ul,"li",null,"listTitle",tiddler[field].formatString(dateFormat));
			lastDay = theDay;
		}
		createTiddlyElement(ul,"li",null,"listLink").appendChild(createTiddlyLink(place,tiddler.title,true));
	}
};

config.macros.tiddler.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	params = paramString.parseParams("name",null,true,false,true);
	var names = params[0]["name"];
	var tiddlerName = names[0];
	var className = names[1] || null;
	var args = params[0]["with"];
	var wrapper = createTiddlyElement(place,"span",null,className);
	if(!args) {
		wrapper.setAttribute("refresh","content");
		wrapper.setAttribute("tiddler",tiddlerName);
	}
	var text = store.getTiddlerText(tiddlerName);
	if(text) {
		var stack = config.macros.tiddler.tiddlerStack;
		if(stack.indexOf(tiddlerName) !== -1)
			return;
		stack.push(tiddlerName);
		try {
			var n = args ? Math.min(args.length,9) : 0;
			for(var i=0; i<n; i++) {
				var placeholderRE = new RegExp("\\$" + (i + 1),"mg");
				text = text.replace(placeholderRE,args[i]);
			}
			config.macros.tiddler.renderText(wrapper,text,tiddlerName,params);
		} finally {
			stack.pop();
		}
	}
};

config.macros.tiddler.renderText = function(place,text,tiddlerName,params)
{
	wikify(text,place,null,store.getTiddler(tiddlerName));
};

config.macros.tiddler.tiddlerStack = [];

config.macros.tag.handler = function(place,macroName,params)
{
	createTagButton(place,params[0],null,params[1],params[2]);
};

config.macros.tags.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	params = paramString.parseParams("anon",null,true,false,false);
	var ul = createTiddlyElement(place,"ul");
	var title = getParam(params,"anon","");
	if(title && store.tiddlerExists(title))
		tiddler = store.getTiddler(title);
	var sep = getParam(params,"sep"," ");
	var lingo = config.views.wikified.tag;
	var prompt = tiddler.tags.length == 0 ? lingo.labelNoTags : lingo.labelTags;
	createTiddlyElement(ul,"li",null,"listTitle",prompt.format([tiddler.title]));
	for(var t=0; t<tiddler.tags.length; t++) {
		createTagButton(createTiddlyElement(ul,"li"),tiddler.tags[t],tiddler.title);
		if(t<tiddler.tags.length-1)
			createTiddlyText(ul,sep);
	}
};

config.macros.tagging.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	params = paramString.parseParams("anon",null,true,false,false);
	var ul = createTiddlyElement(place,"ul");
	var title = getParam(params,"anon","");
	if(title == "" && tiddler instanceof Tiddler)
		title = tiddler.title;
	var sep = getParam(params,"sep"," ");
	ul.setAttribute("title",this.tooltip.format([title]));
	var tagged = store.getTaggedTiddlers(title);
	var prompt = tagged.length == 0 ? this.labelNotTag : this.label;
	createTiddlyElement(ul,"li",null,"listTitle",prompt.format([title,tagged.length]));
	for(var t=0; t<tagged.length; t++) {
		createTiddlyLink(createTiddlyElement(ul,"li"),tagged[t].title,true);
		if(t<tagged.length-1)
			createTiddlyText(ul,sep);
	}
};

config.macros.closeAll.handler = function(place)
{
	createTiddlyButton(place,this.label,this.prompt,this.onClick);
};

config.macros.closeAll.onClick = function(e)
{
	story.closeAllTiddlers();
	return false;
};

config.macros.permaview.handler = function(place)
{
	createTiddlyButton(place,this.label,this.prompt,this.onClick);
};

config.macros.permaview.onClick = function(e)
{
	story.permaView();
	return false;
};

config.macros.saveChanges.handler = function(place,macroName,params)
{
	if(!readOnly)
		createTiddlyButton(place,params[0] || this.label,params[1] || this.prompt,this.onClick,null,null,this.accessKey);
};

config.macros.saveChanges.onClick = function(e)
{
	saveChanges();
	return false;
};

config.macros.slider.onClickSlider = function(ev)
{
	var e = ev || window.event;
	var n = this.nextSibling;
	var cookie = n.getAttribute("cookie");
	var isOpen = n.style.display != "none";
	if(config.options.chkAnimate && anim && typeof Slider == "function")
		anim.startAnimating(new Slider(n,!isOpen,null,"none"));
	else
		n.style.display = isOpen ? "none" : "block";
	config.options[cookie] = !isOpen;
	saveOptionCookie(cookie);
	return false;
};

config.macros.slider.createSlider = function(place,cookie,title,tooltip)
{
	var c = cookie || "";
	var btn = createTiddlyButton(place,title,tooltip,this.onClickSlider);
	var panel = createTiddlyElement(null,"div",null,"sliderPanel");
	panel.setAttribute("cookie",c);
	panel.style.display = config.options[c] ? "block" : "none";
	place.appendChild(panel);
	return panel;
};

config.macros.slider.handler = function(place,macroName,params)
{
	var panel = this.createSlider(place,params[0],params[2],params[3]);
	var text = store.getTiddlerText(params[1]);
	panel.setAttribute("refresh","content");
	panel.setAttribute("tiddler",params[1]);
	if(text)
		wikify(text,panel,null,store.getTiddler(params[1]));
};

// <<gradient [[tiddler name]] vert|horiz rgb rgb rgb rgb... >>
config.macros.gradient.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var panel = wikifier ? createTiddlyElement(place,"div",null,"gradient") : place;
	panel.style.position = "relative";
	panel.style.overflow = "hidden";
	panel.style.zIndex = "0";
	if(wikifier) {
		var styles = config.formatterHelpers.inlineCssHelper(wikifier);
		config.formatterHelpers.applyCssHelper(panel,styles);
	}
	params = paramString.parseParams("color");
	var locolors = [], hicolors = [];
	for(var t=2; t<params.length; t++) {
		var c = params[t].value;
		if(params[t].name == "snap") {
			hicolors[hicolors.length-1] = c;
		} else {
			locolors.push(c);
			hicolors.push(c);
		}
	}
	drawGradient(panel,params[1].value != "vert",locolors,hicolors);
	if(wikifier)
		wikifier.subWikify(panel,">>");
	if(document.all) {
		panel.style.height = "100%";
		panel.style.width = "100%";
	}
};

config.macros.message.handler = function(place,macroName,params)
{
	if(params[0]) {
		var names = params[0].split(".");
		var lookupMessage = function(root,nameIndex) {
				if(names[nameIndex] in root) {
					if(nameIndex < names.length-1)
						return (lookupMessage(root[names[nameIndex]],nameIndex+1));
					else
						return root[names[nameIndex]];
				} else
					return null;
			};
		var m = lookupMessage(config,0);
		if(m == null)
			m = lookupMessage(window,0);
		createTiddlyText(place,m.toString().format(params.splice(1)));
	}
};


config.macros.view.views = {
	text: function(value,place,params,wikifier,paramString,tiddler) {
		highlightify(value,place,highlightHack,tiddler);
	},
	link: function(value,place,params,wikifier,paramString,tiddler) {
		createTiddlyLink(place,value,true);
	},
	wikified: function(value,place,params,wikifier,paramString,tiddler) {
		if(params[2])
			value=params[2].unescapeLineBreaks().format([value]);
		wikify(value,place,highlightHack,tiddler);
	},
	date: function(value,place,params,wikifier,paramString,tiddler) {
		value = Date.convertFromYYYYMMDDHHMM(value);
		createTiddlyText(place,value.formatString(params[2] ? params[2] : config.views.wikified.dateFormat));
	}
};

config.macros.view.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if((tiddler instanceof Tiddler) && params[0]) {
		var value = store.getValue(tiddler,params[0]);
		if(value) {
			var type = params[1] || config.macros.view.defaultView;
			var handler = config.macros.view.views[type];
			if(handler)
				handler(value,place,params,wikifier,paramString,tiddler);
		}
	}
};

config.macros.edit.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var field = params[0];
	var rows = params[1] || 0;
	var defVal = params[2] || '';
	if((tiddler instanceof Tiddler) && field) {
		story.setDirty(tiddler.title,true);
		var e,v;
		if(field != "text" && !rows) {
			e = createTiddlyElement(null,"input");
			if(tiddler.isReadOnly())
				e.setAttribute("readOnly","readOnly");
			e.setAttribute("edit",field);
			e.setAttribute("type","text");
			e.value = store.getValue(tiddler,field) || defVal;
			e.setAttribute("size","40");
			e.setAttribute("autocomplete","off");
			place.appendChild(e);
		} else {
			var wrapper1 = createTiddlyElement(null,"fieldset",null,"fieldsetFix");
			var wrapper2 = createTiddlyElement(wrapper1,"div");
			e = createTiddlyElement(wrapper2,"textarea");
			if(tiddler.isReadOnly())
				e.setAttribute("readOnly","readOnly");
			e.value = v = store.getValue(tiddler,field) || defVal;
			rows = rows || 10;
			var lines = v.match(/\n/mg);
			var maxLines = Math.max(parseInt(config.options.txtMaxEditRows),5);
			if(lines != null && lines.length > rows)
				rows = lines.length + 5;
			rows = Math.min(rows,maxLines);
			e.setAttribute("rows",rows);
			e.setAttribute("edit",field);
			place.appendChild(wrapper1);
		}
		return e;
	}
};

config.macros.tagChooser.onClick = function(ev)
{
	var e = ev || window.event;
	var lingo = config.views.editor.tagChooser;
	var popup = Popup.create(this);
	var tags = store.getTags(this.getAttribute("tags"));
	if(tags.length == 0)
		jQuery("<li/>").text(lingo.popupNone).appendTo(jQuery(popup));
	for(var t=0; t<tags.length; t++) {
		var tag = createTiddlyButton(createTiddlyElement(popup,"li"),tags[t][0],lingo.tagTooltip.format([tags[t][0]]),config.macros.tagChooser.onTagClick);
		tag.setAttribute("tag",tags[t][0]);
		tag.setAttribute("tiddler",this.getAttribute("tiddler"));
	}
	Popup.show();
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	return false;
};

config.macros.tagChooser.onTagClick = function(ev)
{
	var e = ev || window.event;
	if(e.metaKey || e.ctrlKey) stopEvent(e); //# keep popup open on CTRL-click
	var tag = this.getAttribute("tag");
	var title = this.getAttribute("tiddler");
	if(!readOnly)
		story.setTiddlerTag(title,tag,0);
	return false;
};

config.macros.tagChooser.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if(tiddler instanceof Tiddler) {
		var lingo = config.views.editor.tagChooser;
		var btn = createTiddlyButton(place,lingo.text,lingo.tooltip,this.onClick);
		btn.setAttribute("tiddler",tiddler.title);
		btn.setAttribute("tags",params[0]);
	}
};

config.macros.refreshDisplay.handler = function(place)
{
	createTiddlyButton(place,this.label,this.prompt,this.onClick);
};

config.macros.refreshDisplay.onClick = function(e)
{
	refreshAll();
	return false;
};

config.macros.annotations.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var title = tiddler ? tiddler.title : null;
	var a = title ? config.annotations[title] : null;
	if(!tiddler || !title || !a)
		return;
	var text = a.format([title]);
	wikify(text,createTiddlyElement(place,"div",null,"annotation"),null,tiddler);
};

//--
//-- NewTiddler and NewJournal macros
//--

config.macros.newTiddler.createNewTiddlerButton = function(place,title,params,label,prompt,accessKey,newFocus,isJournal)
{
	var tags = [];
	for(var t=1; t<params.length; t++) {
		if((params[t].name == "anon" && t != 1) || (params[t].name == "tag"))
			tags.push(params[t].value);
	}
	label = getParam(params,"label",label);
	prompt = getParam(params,"prompt",prompt);
	accessKey = getParam(params,"accessKey",accessKey);
	newFocus = getParam(params,"focus",newFocus);
	var customFields = getParam(params,"fields","");
	if(!customFields && !store.isShadowTiddler(title))
		customFields = String.encodeHashMap(config.defaultCustomFields);
	var btn = createTiddlyButton(place,label,prompt,this.onClickNewTiddler,null,null,accessKey);
	btn.setAttribute("newTitle",title);
	btn.setAttribute("isJournal",isJournal ? "true" : "false");
	if(tags.length > 0)
		btn.setAttribute("params",tags.join("|"));
	btn.setAttribute("newFocus",newFocus);
	btn.setAttribute("newTemplate",getParam(params,"template",DEFAULT_EDIT_TEMPLATE));
	if(customFields !== "")
		btn.setAttribute("customFields",customFields);
	var text = getParam(params,"text");
	if(text !== undefined)
		btn.setAttribute("newText",text);
	return btn;
};

config.macros.newTiddler.onClickNewTiddler = function()
{
	var title = this.getAttribute("newTitle");
	if(this.getAttribute("isJournal") == "true") {
		title = new Date().formatString(title.trim());
	}
	var params = this.getAttribute("params");
	var tags = params ? params.split("|") : [];
	var focus = this.getAttribute("newFocus");
	var template = this.getAttribute("newTemplate");
	var customFields = this.getAttribute("customFields");
	if(!customFields && !store.isShadowTiddler(title))
		customFields = String.encodeHashMap(config.defaultCustomFields);
	story.displayTiddler(null,title,template,false,null,null);
	var tiddlerElem = story.getTiddler(title);
	if(customFields)
		story.addCustomFields(tiddlerElem,customFields);
	var text = this.getAttribute("newText");
	if(typeof text == "string" && story.getTiddlerField(title,"text"))
		story.getTiddlerField(title,"text").value = text.format([title]);
	for(var t=0;t<tags.length;t++)
		story.setTiddlerTag(title,tags[t],+1);
	story.focusTiddler(title,focus);
	return false;
};

config.macros.newTiddler.handler = function(place,macroName,params,wikifier,paramString)
{
	if(!readOnly) {
		params = paramString.parseParams("anon",null,true,false,false);
		var title = params[1] && params[1].name == "anon" ? params[1].value : this.title;
		title = getParam(params,"title",title);
		this.createNewTiddlerButton(place,title,params,this.label,this.prompt,this.accessKey,"title",false);
	}
};

config.macros.newJournal.handler = function(place,macroName,params,wikifier,paramString)
{
	if(!readOnly) {
		params = paramString.parseParams("anon",null,true,false,false);
		var title = params[1] && params[1].name == "anon" ? params[1].value : config.macros.timeline.dateFormat;
		title = getParam(params,"title",title);
		config.macros.newTiddler.createNewTiddlerButton(place,title,params,this.label,this.prompt,this.accessKey,"text",true);
	}
};

//--
//-- Search macro
//--

config.macros.search.handler = function(place,macroName,params)
{
	var searchTimeout = null;
	var btn = createTiddlyButton(place,this.label,this.prompt,this.onClick,"searchButton");
	var txt = createTiddlyElement(null,"input",null,"txtOptionInput searchField");
	if(params[0])
		txt.value = params[0];
	if(config.browser.isSafari) {
		txt.setAttribute("type","search");
		txt.setAttribute("results","5");
	} else {
		txt.setAttribute("type","text");
	}
	place.appendChild(txt);
	txt.onkeyup = this.onKeyPress;
	txt.onfocus = this.onFocus;
	txt.setAttribute("size",this.sizeTextbox);
	txt.setAttribute("accessKey",params[1] || this.accessKey);
	txt.setAttribute("autocomplete","off");
	txt.setAttribute("lastSearchText","");
};

// Global because there's only ever one outstanding incremental search timer
config.macros.search.timeout = null;

config.macros.search.doSearch = function(txt)
{
	if(txt.value.length > 0) {
		story.search(txt.value,config.options.chkCaseSensitiveSearch,config.options.chkRegExpSearch);
		txt.setAttribute("lastSearchText",txt.value);
	}
};

config.macros.search.onClick = function(e)
{
	config.macros.search.doSearch(this.nextSibling);
	return false;
};

config.macros.search.onKeyPress = function(ev)
{
	var e = ev || window.event;
	switch(e.keyCode) {
		case 13: // Ctrl-Enter
		case 10: // Ctrl-Enter on IE PC
			config.macros.search.doSearch(this);
			break;
		case 27: // Escape
			this.value = "";
			clearMessage();
			break;
	}
	if(config.options.chkIncrementalSearch) {
		if(this.value.length > 2) {
			if(this.value != this.getAttribute("lastSearchText")) {
				if(config.macros.search.timeout)
					clearTimeout(config.macros.search.timeout);
				var txt = this;
				config.macros.search.timeout = setTimeout(function() {config.macros.search.doSearch(txt);},500);
			}
		} else {
			if(config.macros.search.timeout)
				clearTimeout(config.macros.search.timeout);
		}
	}
};

config.macros.search.onFocus = function(e)
{
	this.select();
};

//--
//-- Tabs macro
//--

config.macros.tabs.handler = function(place,macroName,params)
{
	var cookie = params[0];
	var numTabs = (params.length-1)/3;
	var wrapper = createTiddlyElement(null,"div",null,"tabsetWrapper " + cookie);
	var tabset = createTiddlyElement(wrapper,"div",null,"tabset");
	tabset.setAttribute("cookie",cookie);
	var validTab = false;
	for(var t=0; t<numTabs; t++) {
		var label = params[t*3+1];
		var prompt = params[t*3+2];
		var content = params[t*3+3];
		var tab = createTiddlyButton(tabset,label,prompt,this.onClickTab,"tab tabUnselected");
		tab.setAttribute("tab",label);
		tab.setAttribute("content",content);
		tab.title = prompt;
		if(config.options[cookie] == label)
			validTab = true;
	}
	if(!validTab)
		config.options[cookie] = params[1];
	place.appendChild(wrapper);
	this.switchTab(tabset,config.options[cookie]);
};

config.macros.tabs.onClickTab = function(e)
{
	config.macros.tabs.switchTab(this.parentNode,this.getAttribute("tab"));
	return false;
};

config.macros.tabs.switchTab = function(tabset,tab)
{
	var cookie = tabset.getAttribute("cookie");
	var theTab = null;
	var nodes = tabset.childNodes;
	for(var t=0; t<nodes.length; t++) {
		if(nodes[t].getAttribute && nodes[t].getAttribute("tab") == tab) {
			theTab = nodes[t];
			theTab.className = "tab tabSelected";
		} else {
			nodes[t].className = "tab tabUnselected";
		}
	}
	if(theTab) {
		if(tabset.nextSibling && tabset.nextSibling.className == "tabContents")
			removeNode(tabset.nextSibling);
		var tabContent = createTiddlyElement(null,"div",null,"tabContents");
		tabset.parentNode.insertBefore(tabContent,tabset.nextSibling);
		var contentTitle = theTab.getAttribute("content");
		wikify(store.getTiddlerText(contentTitle),tabContent,null,store.getTiddler(contentTitle));
		if(cookie) {
			config.options[cookie] = tab;
			saveOptionCookie(cookie);
		}
	}
};

//--
//-- Tiddler toolbar
//--

// Create a toolbar command button
config.macros.toolbar.createCommand = function(place,commandName,tiddler,className)
{
	if(typeof commandName != "string") {
		var c = null;
		for(var t in config.commands) {
			if(config.commands[t] == commandName)
				c = t;
		}
		commandName = c;
	}
	if((tiddler instanceof Tiddler) && (typeof commandName == "string")) {
		var command = config.commands[commandName];
		if(command.isEnabled ? command.isEnabled(tiddler) : this.isCommandEnabled(command,tiddler)) {
			var text = command.getText ? command.getText(tiddler) : this.getCommandText(command,tiddler);
			var tooltip = command.getTooltip ? command.getTooltip(tiddler) : this.getCommandTooltip(command,tiddler);
			var cmd;
			switch(command.type) {
			case "popup":
				cmd = this.onClickPopup;
				break;
			case "command":
			default:
				cmd = this.onClickCommand;
				break;
			}
			var btn = createTiddlyButton(null,text,tooltip,cmd);
			btn.setAttribute("commandName",commandName);
			btn.setAttribute("tiddler",tiddler.title);
			if(className)
				jQuery(btn).addClass(className);
			place.appendChild(btn);
		}
	}
};

config.macros.toolbar.isCommandEnabled = function(command,tiddler)
{
	var title = tiddler.title;
	var ro = tiddler.isReadOnly();
	var shadow = store.isShadowTiddler(title) && !store.tiddlerExists(title);
	return (!ro || (ro && !command.hideReadOnly)) && !(shadow && command.hideShadow);
};

config.macros.toolbar.getCommandText = function(command,tiddler)
{
	return tiddler.isReadOnly() && command.readOnlyText || command.text;
};

config.macros.toolbar.getCommandTooltip = function(command,tiddler)
{
	return tiddler.isReadOnly() && command.readOnlyTooltip || command.tooltip;
};

config.macros.toolbar.onClickCommand = function(ev)
{
	var e = ev || window.event;
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	var command = config.commands[this.getAttribute("commandName")];
	return command.handler(e,this,this.getAttribute("tiddler"));
};

config.macros.toolbar.onClickPopup = function(ev)
{
	var e = ev || window.event;
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	var popup = Popup.create(this);
	var command = config.commands[this.getAttribute("commandName")];
	var title = this.getAttribute("tiddler");
	var tiddler = store.fetchTiddler(title);
	popup.setAttribute("tiddler",title);
	command.handlePopup(popup,title);
	Popup.show();
	return false;
};

// Invoke the first command encountered from a given place that is tagged with a specified class
config.macros.toolbar.invokeCommand = function(place,className,event)
{
	var children = place.getElementsByTagName("a");
	for(var t=0; t<children.length; t++) {
		var c = children[t];
		if(hasClass(c,className) && c.getAttribute && c.getAttribute("commandName")) {
			if(c.onclick instanceof Function)
				c.onclick.call(c,event);
			break;
		}
	}
};

config.macros.toolbar.onClickMore = function(ev)
{
	var e = this.nextSibling;
	e.style.display = "inline";
	this.style.display = "none";
	return false;
};

config.macros.toolbar.onClickLess = function(ev)
{
	var e = this.parentNode;
	var m = e.previousSibling;
	e.style.display = "none";
	m.style.display = "inline";
	return false;
};

config.macros.toolbar.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	for(var t=0; t<params.length; t++) {
		var c = params[t];
		switch(c) {
		case "!":
			createTiddlyText(place,this.separator);
			break;
		case "*":
			createTiddlyElement(place,"br");
			break;
		case "<":
			var btn = createTiddlyButton(place,this.lessLabel,this.lessPrompt,config.macros.toolbar.onClickLess);
			jQuery(btn).addClass("lessCommand");
			break;
		case ">":
			var btn = createTiddlyButton(place,this.moreLabel,this.morePrompt,config.macros.toolbar.onClickMore);
			jQuery(btn).addClass("moreCommand");
			var e = createTiddlyElement(place,"span",null,"moreCommand");
			e.style.display = "none";
			place = e;
			break;
		default:
			var className = "";
			switch(c.substr(0,1)) {
			case "+":
				className = "defaultCommand";
				c = c.substr(1);
				break;
			case "-":
				className = "cancelCommand";
				c = c.substr(1);
				break;
			}
			if(c in config.commands)
				this.createCommand(place,c,tiddler,className);
			break;
		}
	}
};

//--
//-- Menu and toolbar commands
//--

config.commands.closeTiddler.handler = function(event,src,title)
{
	if(story.isDirty(title) && !readOnly) {
		if(!confirm(config.commands.cancelTiddler.warning.format([title])))
			return false;
	}
	story.setDirty(title,false);
	story.closeTiddler(title,true);
	return false;
};

config.commands.closeOthers.handler = function(event,src,title)
{
	story.closeAllTiddlers(title);
	return false;
};

config.commands.editTiddler.handler = function(event,src,title)
{
	clearMessage();
	var tiddlerElem = story.getTiddler(title);
	var fields = tiddlerElem.getAttribute("tiddlyFields");
	story.displayTiddler(null,title,DEFAULT_EDIT_TEMPLATE,false,null,fields);
	story.focusTiddler(title,config.options.txtEditorFocus||"text");
	return false;
};

config.commands.saveTiddler.handler = function(event,src,title)
{
	var newTitle = story.saveTiddler(title,event.shiftKey);
	if(newTitle)
		story.displayTiddler(null,newTitle);
	return false;
};

config.commands.cancelTiddler.handler = function(event,src,title)
{
	if(story.hasChanges(title) && !readOnly) {
		if(!confirm(this.warning.format([title])))
			return false;
	}
	story.setDirty(title,false);
	story.displayTiddler(null,title);
	return false;
};

config.commands.deleteTiddler.handler = function(event,src,title)
{
	var deleteIt = true;
	if(config.options.chkConfirmDelete)
		deleteIt = confirm(this.warning.format([title]));
	if(deleteIt) {
		store.removeTiddler(title);
		story.closeTiddler(title,true);
		autoSaveChanges();
	}
	return false;
};

config.commands.permalink.handler = function(event,src,title)
{
	var t = encodeURIComponent(String.encodeTiddlyLink(title));
	if(window.location.hash != t)
		window.location.hash = t;
	return false;
};

config.commands.references.handlePopup = function(popup,title)
{
	var references = store.getReferringTiddlers(title);
	var c = false;
	for(var r=0; r<references.length; r++) {
		if(references[r].title != title && !references[r].isTagged("excludeLists")) {
			createTiddlyLink(createTiddlyElement(popup,"li"),references[r].title,true);
			c = true;
		}
	}
	if(!c)
		createTiddlyElement(popup,"li",null,"disabled",this.popupNone);
};

config.commands.jump.handlePopup = function(popup,title)
{
	story.forEachTiddler(function(title,element) {
		createTiddlyLink(createTiddlyElement(popup,"li"),title,true,null,false,null,true);
		});
};

config.commands.syncing.handlePopup = function(popup,title)
{
	var tiddler = store.fetchTiddler(title);
	if(!tiddler)
		return;
	var serverType = tiddler.getServerType();
	var serverHost = tiddler.fields["server.host"];
	var serverWorkspace = tiddler.fields["server.workspace"];
	if(!serverWorkspace)
		serverWorkspace = "";
	if(serverType) {
		var e = createTiddlyElement(popup,"li",null,"popupMessage");
		e.innerHTML = config.commands.syncing.currentlySyncing.format([serverType,serverHost,serverWorkspace]);
	} else {
		createTiddlyElement(popup,"li",null,"popupMessage",config.commands.syncing.notCurrentlySyncing);
	}
	if(serverType) {
		createTiddlyElement(createTiddlyElement(popup,"li",null,"listBreak"),"div");
		var btn = createTiddlyButton(createTiddlyElement(popup,"li"),this.captionUnSync,null,config.commands.syncing.onChooseServer);
		btn.setAttribute("tiddler",title);
		btn.setAttribute("server.type","");
	}
	createTiddlyElement(createTiddlyElement(popup,"li",null,"listBreak"),"div");
	createTiddlyElement(popup,"li",null,"popupMessage",config.commands.syncing.chooseServer);
	var feeds = store.getTaggedTiddlers("systemServer","title");
	for(var t=0; t<feeds.length; t++) {
		var f = feeds[t];
		var feedServerType = store.getTiddlerSlice(f.title,"Type");
		if(!feedServerType)
			feedServerType = "file";
		var feedServerHost = store.getTiddlerSlice(f.title,"URL");
		if(!feedServerHost)
			feedServerHost = "";
		var feedServerWorkspace = store.getTiddlerSlice(f.title,"Workspace");
		if(!feedServerWorkspace)
			feedServerWorkspace = "";
		var caption = f.title;
		if(serverType == feedServerType && serverHost == feedServerHost && serverWorkspace == feedServerWorkspace) {
			caption = config.commands.syncing.currServerMarker + caption;
		} else {
			caption = config.commands.syncing.notCurrServerMarker + caption;
		}
		btn = createTiddlyButton(createTiddlyElement(popup,"li"),caption,null,config.commands.syncing.onChooseServer);
		btn.setAttribute("tiddler",title);
		btn.setAttribute("server.type",feedServerType);
		btn.setAttribute("server.host",feedServerHost);
		btn.setAttribute("server.workspace",feedServerWorkspace);
	}
};

config.commands.syncing.onChooseServer = function(e)
{
	var tiddler = this.getAttribute("tiddler");
	var serverType = this.getAttribute("server.type");
	if(serverType) {
		store.addTiddlerFields(tiddler,{
			"server.type": serverType,
			"server.host": this.getAttribute("server.host"),
			"server.workspace": this.getAttribute("server.workspace")
			});
	} else {
		store.setValue(tiddler,"server",null);
	}
	return false;
};

config.commands.fields.handlePopup = function(popup,title)
{
	var tiddler = store.fetchTiddler(title);
	if(!tiddler)
		return;
	var items = [];
	store.forEachField(tiddler,function(tiddler,fieldName,value){items.push({field:fieldName,value:value});},true);
	items.sort(function(a,b) {return a.field < b.field ? -1 : (a.field == b.field ? 0 : +1);});
	if(items.length > 0)
		ListView.create(popup,items,this.listViewTemplate);
	else
		createTiddlyElement(popup,"div",null,null,this.emptyText);
};

//--
//-- Tiddler() object
//--

function Tiddler(title)
{
	this.title = title;
	this.text = "";
	this.modifier = null;
	this.created = new Date();
	this.modified = this.created;
	this.links = [];
	this.linksUpdated = false;
	this.tags = [];
	this.fields = {};
	return this;
}

Tiddler.prototype.getLinks = function()
{
	if(this.linksUpdated==false)
		this.changed();
	return this.links;
};

// Returns the fields that are inherited in string field:"value" field2:"value2" format
Tiddler.prototype.getInheritedFields = function()
{
	var f = {};
	for(var i in this.fields) {
		if(i=="server.host" || i=="server.workspace" || i=="wikiformat"|| i=="server.type") {
			f[i] = this.fields[i];
		}
	}
	return String.encodeHashMap(f);
};

// Increment the changeCount of a tiddler
Tiddler.prototype.incChangeCount = function()
{
	var c = this.fields['changecount'];
	c = c ? parseInt(c,10) : 0;
	this.fields['changecount'] = String(c+1);
};

// Clear the changeCount of a tiddler
Tiddler.prototype.clearChangeCount = function()
{
	if(this.fields['changecount']) {
		delete this.fields['changecount'];
	}
};

Tiddler.prototype.doNotSave = function()
{
	return this.fields['doNotSave'];
};

// Returns true if the tiddler has been updated since the tiddler was created or downloaded
Tiddler.prototype.isTouched = function()
{
	var changeCount = this.fields['changecount'];
	if(changeCount === undefined)
		changeCount = 0;
	return changeCount > 0;
};

// Change the text and other attributes of a tiddler
Tiddler.prototype.set = function(title,text,modifier,modified,tags,created,fields)
{
	this.assign(title,text,modifier,modified,tags,created,fields);
	this.changed();
	return this;
};

// Change the text and other attributes of a tiddler without triggered a tiddler.changed() call
Tiddler.prototype.assign = function(title,text,modifier,modified,tags,created,fields)
{
	if(title != undefined)
		this.title = title;
	if(text != undefined)
		this.text = text;
	if(modifier != undefined)
		this.modifier = modifier;
	if(modified != undefined)
		this.modified = modified;
	if(created != undefined)
		this.created = created;
	if(fields != undefined)
		this.fields = fields;
	if(tags != undefined)
		this.tags = (typeof tags == "string") ? tags.readBracketedList() : tags;
	else if(this.tags == undefined)
		this.tags = [];
	return this;
};

// Get the tags for a tiddler as a string (space delimited, using [[brackets]] for tags containing spaces)
Tiddler.prototype.getTags = function()
{
	return String.encodeTiddlyLinkList(this.tags);
};

// Test if a tiddler carries a tag
Tiddler.prototype.isTagged = function(tag)
{
	return this.tags.indexOf(tag) != -1;
};

// Static method to convert "\n" to newlines, "\s" to "\"
Tiddler.unescapeLineBreaks = function(text)
{
	return text ? text.unescapeLineBreaks() : "";
};

// Convert newlines to "\n", "\" to "\s"
Tiddler.prototype.escapeLineBreaks = function()
{
	return this.text.escapeLineBreaks();
};

// Updates the secondary information (like links[] array) after a change to a tiddler
Tiddler.prototype.changed = function()
{
	this.links = [];
	var text = this.text;
	// remove 'quoted' text before scanning tiddler source
	text = text.replace(/\/%((?:.|\n)*?)%\//g,"").
		replace(/\{{3}((?:.|\n)*?)\}{3}/g,"").
		replace(/"""((?:.|\n)*?)"""/g,"").
		replace(/\<nowiki\>((?:.|\n)*?)\<\/nowiki\>/g,"").
		replace(/\<html\>((?:.|\n)*?)\<\/html\>/g,"").
		replace(/\<script((?:.|\n)*?)\<\/script\>/g,"");
	var t = this.autoLinkWikiWords() ? 0 : 1;
	var tiddlerLinkRegExp = t==0 ? config.textPrimitives.tiddlerAnyLinkRegExp : config.textPrimitives.tiddlerForcedLinkRegExp;
	tiddlerLinkRegExp.lastIndex = 0;
	var formatMatch = tiddlerLinkRegExp.exec(text);
	while(formatMatch) {
		var lastIndex = tiddlerLinkRegExp.lastIndex;
		if(t==0 && formatMatch[1] && formatMatch[1] != this.title) {
			// wikiWordLink
			if(formatMatch.index > 0) {
				var preRegExp = new RegExp(config.textPrimitives.unWikiLink+"|"+config.textPrimitives.anyLetter,"mg");
				preRegExp.lastIndex = formatMatch.index-1;
				var preMatch = preRegExp.exec(text);
				if(preMatch.index != formatMatch.index-1)
					this.links.pushUnique(formatMatch[1]);
			} else {
				this.links.pushUnique(formatMatch[1]);
			}
		}
		else if(formatMatch[2-t] && !config.formatterHelpers.isExternalLink(formatMatch[3-t])) // titledBrackettedLink
			this.links.pushUnique(formatMatch[3-t]);
		else if(formatMatch[4-t] && formatMatch[4-t] != this.title) // brackettedLink
			this.links.pushUnique(formatMatch[4-t]);
		tiddlerLinkRegExp.lastIndex = lastIndex;
		formatMatch = tiddlerLinkRegExp.exec(text);
	}
	this.linksUpdated = true;
};

Tiddler.prototype.getSubtitle = function()
{
	var modifier = this.modifier;
	if(!modifier)
		modifier = config.messages.subtitleUnknown;
	var modified = this.modified;
	if(modified)
		modified = modified.toLocaleString();
	else
		modified = config.messages.subtitleUnknown;
	return config.messages.tiddlerLinkTooltip.format([this.title,modifier,modified]);
};

Tiddler.prototype.isReadOnly = function()
{
	return readOnly;
};

Tiddler.prototype.autoLinkWikiWords = function()
{
	return !(this.isTagged("systemConfig") || this.isTagged("excludeMissing"));
};

Tiddler.prototype.getServerType = function()
{
	var serverType = null;
	if(this.fields['server.type'])
		serverType = this.fields['server.type'];
	if(!serverType)
		serverType = this.fields['wikiformat'];
	if(serverType && !config.adaptors[serverType])
		serverType = null;
	return serverType;
};

Tiddler.prototype.getAdaptor = function()
{
	var serverType = this.getServerType();
	return serverType ? new config.adaptors[serverType]() : null;
};

//--
//-- TiddlyWiki() object contains Tiddler()s
//--

function TiddlyWiki()
{
	var tiddlers = {}; // Hashmap by name of tiddlers
	this.tiddlersUpdated = false;
	this.namedNotifications = []; // Array of {name:,notify:} of notification functions
	this.notificationLevel = 0;
	this.slices = {}; // map tiddlerName->(map sliceName->sliceValue). Lazy.
	this.clear = function() {
		tiddlers = {};
		this.setDirty(false);
	};
	this.fetchTiddler = function(title) {
		var t = tiddlers[title];
		return t instanceof Tiddler ? t : null;
	};
	this.deleteTiddler = function(title) {
		delete this.slices[title];
		delete tiddlers[title];
	};
	this.addTiddler = function(tiddler) {
		delete this.slices[tiddler.title];
		tiddlers[tiddler.title] = tiddler;
	};
	this.forEachTiddler = function(callback) {
		for(var t in tiddlers) {
			var tiddler = tiddlers[t];
			if(tiddler instanceof Tiddler)
				callback.call(this,t,tiddler);
		}
	};
}

TiddlyWiki.prototype.setDirty = function(dirty)
{
	this.dirty = dirty;
};

TiddlyWiki.prototype.isDirty = function()
{
	return this.dirty;
};

TiddlyWiki.prototype.tiddlerExists = function(title)
{
	var t = this.fetchTiddler(title);
	return t != undefined;
};

TiddlyWiki.prototype.isShadowTiddler = function(title)
{
	return config.shadowTiddlers[title] === undefined ? false : true;
};

TiddlyWiki.prototype.createTiddler = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(!tiddler) {
		tiddler = new Tiddler(title);
		this.addTiddler(tiddler);
		this.setDirty(true);
	}
	return tiddler;
};

TiddlyWiki.prototype.getTiddler = function(title)
{
	var t = this.fetchTiddler(title);
	if(t != undefined)
		return t;
	else
		return null;
};

TiddlyWiki.prototype.getShadowTiddlerText = function(title)
{
	if(typeof config.shadowTiddlers[title] == "string")
		return config.shadowTiddlers[title];
	else
		return "";
};

// Retrieve tiddler contents
TiddlyWiki.prototype.getTiddlerText = function(title,defaultText)
{
	if(!title)
		return defaultText;
	var pos = title.indexOf(config.textPrimitives.sectionSeparator);
	var section = null;
	if(pos != -1) {
		section = title.substr(pos + config.textPrimitives.sectionSeparator.length);
		title = title.substr(0,pos);
	}
	pos = title.indexOf(config.textPrimitives.sliceSeparator);
	if(pos != -1) {
		var slice = this.getTiddlerSlice(title.substr(0,pos),title.substr(pos + config.textPrimitives.sliceSeparator.length));
		if(slice)
			return slice;
	}
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		if(!section)
			return tiddler.text;
		var re = new RegExp("(^!{1,6}" + section.escapeRegExp() + "[ \t]*\n)","mg");
		re.lastIndex = 0;
		var match = re.exec(tiddler.text);
		if(match) {
			var t = tiddler.text.substr(match.index+match[1].length);
			var re2 = /^!/mg;
			re2.lastIndex = 0;
			match = re2.exec(t); //# search for the next heading
			if(match)
				t = t.substr(0,match.index-1);//# don't include final \n
			return t;
		}
		return defaultText;
	}
	if(this.isShadowTiddler(title))
		return this.getShadowTiddlerText(title);
	if(defaultText != undefined)
		return defaultText;
	return null;
};

TiddlyWiki.prototype.getRecursiveTiddlerText = function(title,defaultText,depth)
{
	var bracketRegExp = new RegExp("(?:\\[\\[([^\\]]+)\\]\\])","mg");
	var text = this.getTiddlerText(title,null);
	if(text == null)
		return defaultText;
	var textOut = [];
	var lastPos = 0;
	do {
		var match = bracketRegExp.exec(text);
		if(match) {
			textOut.push(text.substr(lastPos,match.index-lastPos));
			if(match[1]) {
				if(depth <= 0)
					textOut.push(match[1]);
				else
					textOut.push(this.getRecursiveTiddlerText(match[1],"[[" + match[1] + "]]",depth-1));
			}
			lastPos = match.index + match[0].length;
		} else {
			textOut.push(text.substr(lastPos));
		}
	} while(match);
	return textOut.join("");
};

TiddlyWiki.prototype.slicesRE = /(?:^([\'\/]{0,2})~?([\.\w]+)\:\1[\t\x20]*([^\n]+)[\t\x20]*$)|(?:^\|([\'\/]{0,2})~?([\.\w]+)\:?\4\|[\t\x20]*([^\n]+)[\t\x20]*\|$)/gm;

// @internal
TiddlyWiki.prototype.calcAllSlices = function(title)
{
	var slices = {};
	var text = this.getTiddlerText(title,"");
	this.slicesRE.lastIndex = 0;
	var m = this.slicesRE.exec(text);
	while(m) {
		if(m[2])
			slices[m[2]] = m[3];
		else
			slices[m[5]] = m[6];
		m = this.slicesRE.exec(text);
	}
	return slices;
};

// Returns the slice of text of the given name
TiddlyWiki.prototype.getTiddlerSlice = function(title,sliceName)
{
	var slices = this.slices[title];
	if(!slices) {
		slices = this.calcAllSlices(title);
		this.slices[title] = slices;
	}
	return slices[sliceName];
};

// Build an hashmap of the specified named slices of a tiddler
TiddlyWiki.prototype.getTiddlerSlices = function(title,sliceNames)
{
	var r = {};
	for(var t=0; t<sliceNames.length; t++) {
		var slice = this.getTiddlerSlice(title,sliceNames[t]);
		if(slice)
			r[sliceNames[t]] = slice;
	}
	return r;
};

TiddlyWiki.prototype.suspendNotifications = function()
{
	this.notificationLevel--;
};

TiddlyWiki.prototype.resumeNotifications = function()
{
	this.notificationLevel++;
};

// Invoke the notification handlers for a particular tiddler
TiddlyWiki.prototype.notify = function(title,doBlanket)
{
	if(!this.notificationLevel) {
		for(var t=0; t<this.namedNotifications.length; t++) {
			var n = this.namedNotifications[t];
			if((n.name == null && doBlanket) || (n.name == title))
				n.notify(title);
		}
	}
};

// Invoke the notification handlers for all tiddlers
TiddlyWiki.prototype.notifyAll = function()
{
	if(!this.notificationLevel) {
		for(var t=0; t<this.namedNotifications.length; t++) {
			var n = this.namedNotifications[t];
			if(n.name)
				n.notify(n.name);
		}
	}
};

// Add a notification handler to a tiddler
TiddlyWiki.prototype.addNotification = function(title,fn)
{
	for(var i=0; i<this.namedNotifications.length; i++) {
		if((this.namedNotifications[i].name == title) && (this.namedNotifications[i].notify == fn))
			return this;
	}
	this.namedNotifications.push({name: title, notify: fn});
	return this;
};

TiddlyWiki.prototype.removeTiddler = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		this.deleteTiddler(title);
		this.notify(title,true);
		this.setDirty(true);
	}
};

// Reset the sync status of a freshly synced tiddler
TiddlyWiki.prototype.resetTiddler = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		tiddler.clearChangeCount();
		this.notify(title,true);
		this.setDirty(true);
	}
};

TiddlyWiki.prototype.setTiddlerTag = function(title,status,tag)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		var t = tiddler.tags.indexOf(tag);
		if(t != -1)
			tiddler.tags.splice(t,1);
		if(status)
			tiddler.tags.push(tag);
		tiddler.changed();
		tiddler.incChangeCount();
		this.notify(title,true);
		this.setDirty(true);
	}
};

TiddlyWiki.prototype.addTiddlerFields = function(title,fields)
{
	var tiddler = this.fetchTiddler(title);
	if(!tiddler)
		return;
	merge(tiddler.fields,fields);
	tiddler.changed();
	tiddler.incChangeCount();
	this.notify(title,true);
	this.setDirty(true);
};

// Store tiddler in TiddlyWiki instance
TiddlyWiki.prototype.saveTiddler = function(title,newTitle,newBody,modifier,modified,tags,fields,clearChangeCount,created)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		created = created || tiddler.created; // Preserve created date
		this.deleteTiddler(title);
	} else {
		created = created || modified;
		tiddler = new Tiddler();
	}
	tiddler.set(newTitle,newBody,modifier,modified,tags,created,fields);
	this.addTiddler(tiddler);
	if(clearChangeCount)
		tiddler.clearChangeCount();
	else
		tiddler.incChangeCount();
	if(title != newTitle)
		this.notify(title,true);
	this.notify(newTitle,true);
	this.setDirty(true);
	return tiddler;
};

TiddlyWiki.prototype.incChangeCount = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler)
		tiddler.incChangeCount();
};

TiddlyWiki.prototype.getLoader = function()
{
	if(!this.loader)
		this.loader = new TW21Loader();
	return this.loader;
};

TiddlyWiki.prototype.getSaver = function()
{
	if(!this.saver)
		this.saver = new TW21Saver();
	return this.saver;
};

// Return all tiddlers formatted as an HTML string
TiddlyWiki.prototype.allTiddlersAsHtml = function()
{
	return this.getSaver().externalize(store);
};

// Load contents of a TiddlyWiki from an HTML DIV
TiddlyWiki.prototype.loadFromDiv = function(src,idPrefix,noUpdate)
{
	this.idPrefix = idPrefix;
	var storeElem = (typeof src == "string") ? document.getElementById(src) : src;
	if(!storeElem)
		return;
	var tiddlers = this.getLoader().loadTiddlers(this,storeElem.childNodes);
	this.setDirty(false);
	if(!noUpdate) {
		for(var i = 0;i<tiddlers.length; i++)
			tiddlers[i].changed();
	}
	jQuery().trigger("loadTiddlers");
};

// Load contents of a TiddlyWiki from a string
// Returns null if there's an error
TiddlyWiki.prototype.importTiddlyWiki = function(text)
{
	var posDiv = locateStoreArea(text);
	if(!posDiv)
		return null;
	var content = "<" + "html><" + "body>" + text.substring(posDiv[0],posDiv[1] + endSaveArea.length) + "<" + "/body><" + "/html>";
	// Create the iframe
	var iframe = document.createElement("iframe");
	iframe.style.display = "none";
	document.body.appendChild(iframe);
	var doc = iframe.document;
	if(iframe.contentDocument)
		doc = iframe.contentDocument; // For NS6
	else if(iframe.contentWindow)
		doc = iframe.contentWindow.document; // For IE5.5 and IE6
	// Put the content in the iframe
	doc.open();
	doc.writeln(content);
	doc.close();
	// Load the content into a TiddlyWiki() object
	var storeArea = doc.getElementById("storeArea");
	this.loadFromDiv(storeArea,"store");
	// Get rid of the iframe
	iframe.parentNode.removeChild(iframe);
	return this;
};

TiddlyWiki.prototype.updateTiddlers = function()
{
	this.tiddlersUpdated = true;
	this.forEachTiddler(function(title,tiddler) {
		tiddler.changed();
	});
};

// Return an array of tiddlers matching a search regular expression
TiddlyWiki.prototype.search = function(searchRegExp,sortField,excludeTag,match)
{
	var candidates = this.reverseLookup("tags",excludeTag,!!match);
	var results = [];
	for(var t=0; t<candidates.length; t++) {
		if((candidates[t].title.search(searchRegExp) != -1) || (candidates[t].text.search(searchRegExp) != -1))
			results.push(candidates[t]);
	}
	if(!sortField)
		sortField = "title";
	results.sort(function(a,b) {return a[sortField] < b[sortField] ? -1 : (a[sortField] == b[sortField] ? 0 : +1);});
	return results;
};

// Returns a list of all tags in use
//   excludeTag - if present, excludes tags that are themselves tagged with excludeTag
// Returns an array of arrays where [tag][0] is the name of the tag and [tag][1] is the number of occurances
TiddlyWiki.prototype.getTags = function(excludeTag)
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		for(var g=0; g<tiddler.tags.length; g++) {
			var tag = tiddler.tags[g];
			var n = true;
			for(var c=0; c<results.length; c++) {
				if(results[c][0] == tag) {
					n = false;
					results[c][1]++;
				}
			}
			if(n && excludeTag) {
				var t = this.fetchTiddler(tag);
				if(t && t.isTagged(excludeTag))
					n = false;
			}
			if(n)
				results.push([tag,1]);
		}
	});
	results.sort(function(a,b) {return a[0].toLowerCase() < b[0].toLowerCase() ? -1 : (a[0].toLowerCase() == b[0].toLowerCase() ? 0 : +1);});
	return results;
};

// Return an array of the tiddlers that are tagged with a given tag
TiddlyWiki.prototype.getTaggedTiddlers = function(tag,sortField)
{
	return this.reverseLookup("tags",tag,true,sortField);
};

// Return an array of the tiddlers that link to a given tiddler
TiddlyWiki.prototype.getReferringTiddlers = function(title,unusedParameter,sortField)
{
	if(!this.tiddlersUpdated)
		this.updateTiddlers();
	return this.reverseLookup("links",title,true,sortField);
};

// Return an array of the tiddlers that do or do not have a specified entry in the specified storage array (ie, "links" or "tags")
// lookupMatch == true to match tiddlers, false to exclude tiddlers
TiddlyWiki.prototype.reverseLookup = function(lookupField,lookupValue,lookupMatch,sortField)
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		var f = !lookupMatch;
		for(var lookup=0; lookup<tiddler[lookupField].length; lookup++) {
			if(tiddler[lookupField][lookup] == lookupValue)
				f = lookupMatch;
		}
		if(f)
			results.push(tiddler);
	});
	if(!sortField)
		sortField = "title";
	results.sort(function(a,b) {return a[sortField] < b[sortField] ? -1 : (a[sortField] == b[sortField] ? 0 : +1);});
	return results;
};

// Return the tiddlers as a sorted array
TiddlyWiki.prototype.getTiddlers = function(field,excludeTag)
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		if(excludeTag == undefined || !tiddler.isTagged(excludeTag))
			results.push(tiddler);
	});
	if(field)
		results.sort(function(a,b) {return a[field] < b[field] ? -1 : (a[field] == b[field] ? 0 : +1);});
	return results;
};

// Return array of names of tiddlers that are referred to but not defined
TiddlyWiki.prototype.getMissingLinks = function(sortField)
{
	if(!this.tiddlersUpdated)
		this.updateTiddlers();
	var results = [];
	this.forEachTiddler(function (title,tiddler) {
		if(tiddler.isTagged("excludeMissing") || tiddler.isTagged("systemConfig"))
			return;
		for(var n=0; n<tiddler.links.length;n++) {
			var link = tiddler.links[n];
			if(this.fetchTiddler(link) == null && !this.isShadowTiddler(link))
				results.pushUnique(link);
		}
	});
	results.sort();
	return results;
};

// Return an array of names of tiddlers that are defined but not referred to
TiddlyWiki.prototype.getOrphans = function()
{
	var results = [];
	this.forEachTiddler(function (title,tiddler) {
		if(this.getReferringTiddlers(title).length == 0 && !tiddler.isTagged("excludeLists"))
			results.push(title);
	});
	results.sort();
	return results;
};

// Return an array of names of all the shadow tiddlers
TiddlyWiki.prototype.getShadowed = function()
{
	var results = [];
	for(var t in config.shadowTiddlers) {
		if(this.isShadowTiddler(t))
			results.push(t);
	}
	results.sort();
	return results;
};

// Return an array of tiddlers that have been touched since they were downloaded or created
TiddlyWiki.prototype.getTouched = function()
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		if(tiddler.isTouched())
			results.push(tiddler);
		});
	results.sort();
	return results;
};

// Resolves a Tiddler reference or tiddler title into a Tiddler object, or null if it doesn't exist
TiddlyWiki.prototype.resolveTiddler = function(tiddler)
{
	var t = (typeof tiddler == "string") ? this.getTiddler(tiddler) : tiddler;
	return t instanceof Tiddler ? t : null;
};

// Filter a list of tiddlers
TiddlyWiki.prototype.filterTiddlers = function(filter)
{
	var results = [];
	if(filter) {
		var tiddler;
		var re = /([^\s\[\]]+)|(?:\[([ \w]+)\[([^\]]+)\]\])|(?:\[\[([^\]]+)\]\])/mg;
		var match = re.exec(filter);
		while(match) {
			if(match[1] || match[4]) {
				var title = match[1] || match[4];
				tiddler = this.fetchTiddler(title);
				if(tiddler) {
					results.pushUnique(tiddler);
				} else if(this.isShadowTiddler(title)) {
					tiddler = new Tiddler();
					tiddler.set(title,this.getTiddlerText(title));
					results.pushUnique(tiddler);
				} else {
					results.pushUnique(new Tiddler(title));
				}
			} else if(match[2]) {
				switch(match[2]) {
					case "tag":
						var matched = this.getTaggedTiddlers(match[3]);
						for(var m = 0; m < matched.length; m++)
							results.pushUnique(matched[m]);
						break;
					case "sort":
						results = this.sortTiddlers(results,match[3]);
						break;
				}
			}
			match = re.exec(filter);
		}
	}
	return results;
};

// Sort a list of tiddlers
TiddlyWiki.prototype.sortTiddlers = function(tiddlers,field)
{
	var asc = +1;
	switch(field.substr(0,1)) {
	case "-":
		asc = -1;
		// Note: this fall-through is intentional
		/*jsl:fallthru*/
	case "+":
		field = field.substr(1);
		break;
	}
	if(TiddlyWiki.standardFieldAccess[field])
		tiddlers.sort(function(a,b) {return a[field] < b[field] ? -asc : (a[field] == b[field] ? 0 : asc);});
	else
		tiddlers.sort(function(a,b) {return a.fields[field] < b.fields[field] ? -asc : (a.fields[field] == b.fields[field] ? 0 : +asc);});
	return tiddlers;
};

// Returns true if path is a valid field name (path),
// i.e. a sequence of identifiers, separated by "."
TiddlyWiki.isValidFieldName = function(name)
{
	var match = /[a-zA-Z_]\w*(\.[a-zA-Z_]\w*)*/.exec(name);
	return match && (match[0] == name);
};

// Throws an exception when name is not a valid field name.
TiddlyWiki.checkFieldName = function(name)
{
	if(!TiddlyWiki.isValidFieldName(name))
		throw config.messages.invalidFieldName.format([name]);
};

function StringFieldAccess(n,readOnly)
{
	this.set = readOnly ?
			function(t,v) {if(v != t[n]) throw config.messages.fieldCannotBeChanged.format([n]);} :
			function(t,v) {if(v != t[n]) {t[n] = v; return true;}};
	this.get = function(t) {return t[n];};
}

function DateFieldAccess(n)
{
	this.set = function(t,v) {
		var d = v instanceof Date ? v : Date.convertFromYYYYMMDDHHMM(v);
		if(d != t[n]) {
			t[n] = d; return true;
		}
	};
	this.get = function(t) {return t[n].convertToYYYYMMDDHHMM();};
}

function LinksFieldAccess(n)
{
	this.set = function(t,v) {
		var s = (typeof v == "string") ? v.readBracketedList() : v;
		if(s.toString() != t[n].toString()) {
			t[n] = s; return true;
		}
	};
	this.get = function(t) {return String.encodeTiddlyLinkList(t[n]);};
}

TiddlyWiki.standardFieldAccess = {
	// The set functions return true when setting the data has changed the value.
	"title":    new StringFieldAccess("title",true),
	// Handle the "tiddler" field name as the title
	"tiddler":  new StringFieldAccess("title",true),
	"text":     new StringFieldAccess("text"),
	"modifier": new StringFieldAccess("modifier"),
	"modified": new DateFieldAccess("modified"),
	"created":  new DateFieldAccess("created"),
	"tags":     new LinksFieldAccess("tags")
};

TiddlyWiki.isStandardField = function(name)
{
	return TiddlyWiki.standardFieldAccess[name] != undefined;
};

// Sets the value of the given field of the tiddler to the value.
// Setting an ExtendedField's value to null or undefined removes the field.
// Setting a namespace to undefined removes all fields of that namespace.
// The fieldName is case-insensitive.
// All values will be converted to a string value.
TiddlyWiki.prototype.setValue = function(tiddler,fieldName,value)
{
	TiddlyWiki.checkFieldName(fieldName);
	var t = this.resolveTiddler(tiddler);
	if(!t)
		return;
	fieldName = fieldName.toLowerCase();
	var isRemove = (value === undefined) || (value === null);
	var accessor = TiddlyWiki.standardFieldAccess[fieldName];
	if(accessor) {
		if(isRemove)
			// don't remove StandardFields
			return;
		var h = TiddlyWiki.standardFieldAccess[fieldName];
		if(!h.set(t,value))
			return;
	} else {
		var oldValue = t.fields[fieldName];
		if(isRemove) {
			if(oldValue !== undefined) {
				// deletes a single field
				delete t.fields[fieldName];
			} else {
				// no concrete value is defined for the fieldName
				// so we guess this is a namespace path.
				// delete all fields in a namespace
				var re = new RegExp("^"+fieldName+"\\.");
				var dirty = false;
				for(var n in t.fields) {
					if(n.match(re)) {
						delete t.fields[n];
						dirty = true;
					}
				}
				if(!dirty)
					return;
			}
		} else {
			// the "normal" set case. value is defined (not null/undefined)
			// For convenience provide a nicer conversion Date->String
			value = value instanceof Date ? value.convertToYYYYMMDDHHMMSSMMM() : String(value);
			if(oldValue == value)
				return;
			t.fields[fieldName] = value;
		}
	}
	// When we are here the tiddler/store really was changed.
	this.notify(t.title,true);
	if(!fieldName.match(/^temp\./))
		this.setDirty(true);
};

// Returns the value of the given field of the tiddler.
// The fieldName is case-insensitive.
// Will only return String values (or undefined).
TiddlyWiki.prototype.getValue = function(tiddler,fieldName)
{
	var t = this.resolveTiddler(tiddler);
	if(!t)
		return undefined;
	fieldName = fieldName.toLowerCase();
	var accessor = TiddlyWiki.standardFieldAccess[fieldName];
	if(accessor) {
		return accessor.get(t);
	}
	return t.fields[fieldName];
};

// Calls the callback function for every field in the tiddler.
// When callback function returns a non-false value the iteration stops
// and that value is returned.
// The order of the fields is not defined.
// @param callback a function(tiddler,fieldName,value).
TiddlyWiki.prototype.forEachField = function(tiddler,callback,onlyExtendedFields)
{
	var t = this.resolveTiddler(tiddler);
	if(!t)
		return undefined;
	var n,result;
	for(n in t.fields) {
		result = callback(t,n,t.fields[n]);
		if(result)
			return result;
		}
	if(onlyExtendedFields)
		return undefined;
	for(n in TiddlyWiki.standardFieldAccess) {
		if(n == "tiddler")
			// even though the "title" field can also be referenced through the name "tiddler"
			// we only visit this field once.
			continue;
		result = callback(t,n,TiddlyWiki.standardFieldAccess[n].get(t));
		if(result)
			return result;
	}
	return undefined;
};

//--
//-- Story functions
//--

function Story(containerId,idPrefix)
{
	this.container = containerId;
	this.idPrefix = idPrefix;
	this.highlightRegExp = null;
	this.tiddlerId = function(title) {
		var id = this.idPrefix + title;
		return id==this.container ? this.idPrefix + "_" + title : id;
	};
	this.containerId = function() {
		return this.container;
	};
}

Story.prototype.getTiddler = function(title)
{
	return document.getElementById(this.tiddlerId(title));
};

Story.prototype.getContainer = function()
{
	return document.getElementById(this.containerId());
};

Story.prototype.forEachTiddler = function(fn)
{
	var place = this.getContainer();
	if(!place)
		return;
	var e = place.firstChild;
	while(e) {
		var n = e.nextSibling;
		var title = e.getAttribute("tiddler");
		fn.call(this,title,e);
		e = n;
	}
};

Story.prototype.displayDefaultTiddlers = function()
{
	this.displayTiddlers(null,store.filterTiddlers(store.getTiddlerText("DefaultTiddlers")));
};

Story.prototype.displayTiddlers = function(srcElement,titles,template,animate,unused,customFields,toggle)
{
	for(var t = titles.length-1;t>=0;t--)
		this.displayTiddler(srcElement,titles[t],template,animate,unused,customFields);
};

Story.prototype.displayTiddler = function(srcElement,tiddler,template,animate,unused,customFields,toggle,animationSrc)
{
	var title = (tiddler instanceof Tiddler) ? tiddler.title : tiddler;
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem) {
		if(toggle)
			this.closeTiddler(title,true);
		else
			this.refreshTiddler(title,template,false,customFields);
	} else {
		var place = this.getContainer();
		var before = this.positionTiddler(srcElement);
		tiddlerElem = this.createTiddler(place,before,title,template,customFields);
	}
	if(animationSrc && typeof animationSrc !== "string") {
		srcElement = animationSrc;
	}
	if(srcElement && typeof srcElement !== "string") {
		if(config.options.chkAnimate && (animate == undefined || animate == true) && anim && typeof Zoomer == "function" && typeof Scroller == "function")
			anim.startAnimating(new Zoomer(title,srcElement,tiddlerElem),new Scroller(tiddlerElem));
		else
			window.scrollTo(0,ensureVisible(tiddlerElem));
	}
};

Story.prototype.positionTiddler = function(srcElement)
{
	var place = this.getContainer();
	var before = null;
	if(typeof srcElement == "string") {
		switch(srcElement) {
		case "top":
			before = place.firstChild;
			break;
		case "bottom":
			before = null;
			break;
		}
	} else {
		var after = this.findContainingTiddler(srcElement);
		if(after == null) {
			before = place.firstChild;
		} else if(after.nextSibling) {
			before = after.nextSibling;
			if(before.nodeType != 1)
				before = null;
		}
	}
	return before;
};

Story.prototype.createTiddler = function(place,before,title,template,customFields)
{
	var tiddlerElem = createTiddlyElement(null,"div",this.tiddlerId(title),"tiddler");
	tiddlerElem.setAttribute("refresh","tiddler");
	if(customFields)
		tiddlerElem.setAttribute("tiddlyFields",customFields);
	place.insertBefore(tiddlerElem,before);
	var defaultText = null;
	if(!store.tiddlerExists(title) && !store.isShadowTiddler(title))
		defaultText = this.loadMissingTiddler(title,customFields,tiddlerElem);
	this.refreshTiddler(title,template,false,customFields,defaultText);
	return tiddlerElem;
};

Story.prototype.loadMissingTiddler = function(title,fields,tiddlerElem)
{
	var getTiddlerCallback = function(context)
	{
		var tiddler = context.tiddler;
		if(tiddler && tiddler.text) {
			if(!tiddler.created)
				tiddler.created = new Date();
			if(!tiddler.modified)
				tiddler.modified = tiddler.created;
			store.saveTiddler(tiddler.title,tiddler.title,tiddler.text,tiddler.modifier,tiddler.modified,tiddler.tags,tiddler.fields,true,tiddler.created);
			autoSaveChanges();
		}
		context.adaptor.close();
		delete context.adpator;
	};

	var tiddler = new Tiddler(title);
	tiddler.fields = typeof fields == "string" ? fields.decodeHashMap() : fields||{};
	var context = {serverType:tiddler.getServerType()};
	if(!context.serverType)
		return;
	context.host = tiddler.fields['server.host'];
	context.workspace = tiddler.fields['server.workspace'];
	var adaptor = new config.adaptors[context.serverType];
	adaptor.getTiddler(title,context,null,getTiddlerCallback);
	return config.messages.loadingMissingTiddler.format([title,context.serverType,context.host,context.workspace]);
};

Story.prototype.chooseTemplateForTiddler = function(title,template)
{
	if(!template)
		template = DEFAULT_VIEW_TEMPLATE;
	if(template == DEFAULT_VIEW_TEMPLATE || template == DEFAULT_EDIT_TEMPLATE)
		template = config.tiddlerTemplates[template];
	return template;
};

Story.prototype.getTemplateForTiddler = function(title,template,tiddler)
{
	return store.getRecursiveTiddlerText(template,null,10);
};

Story.prototype.refreshTiddler = function(title,template,force,customFields,defaultText)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem) {
		if(tiddlerElem.getAttribute("dirty") == "true" && !force)
			return tiddlerElem;
		template = this.chooseTemplateForTiddler(title,template);
		var currTemplate = tiddlerElem.getAttribute("template");
		if((template != currTemplate) || force) {
			var tiddler = store.getTiddler(title);
			if(!tiddler) {
				tiddler = new Tiddler();
				if(store.isShadowTiddler(title)) {
					var tags = [];
					tiddler.set(title,store.getTiddlerText(title),config.views.wikified.shadowModifier,version.date,tags,version.date);
				} else {
					var text = template=="EditTemplate" ?
								config.views.editor.defaultText.format([title]) :
								config.views.wikified.defaultText.format([title]);
					text = defaultText || text;
					var fields = customFields ? customFields.decodeHashMap() : null;
					tiddler.set(title,text,config.views.wikified.defaultModifier,version.date,[],version.date,fields);
				}
			}
			tiddlerElem.setAttribute("tags",tiddler.tags.join(" "));
			tiddlerElem.setAttribute("tiddler",title);
			tiddlerElem.setAttribute("template",template);
			tiddlerElem.onmouseover = this.onTiddlerMouseOver;
			tiddlerElem.onmouseout = this.onTiddlerMouseOut;
			tiddlerElem.ondblclick = this.onTiddlerDblClick;
			tiddlerElem[window.event?"onkeydown":"onkeypress"] = this.onTiddlerKeyPress;
			tiddlerElem.innerHTML = this.getTemplateForTiddler(title,template,tiddler);
			applyHtmlMacros(tiddlerElem,tiddler);
			if(store.getTaggedTiddlers(title).length > 0)
				addClass(tiddlerElem,"isTag");
			else
				removeClass(tiddlerElem,"isTag");
			if(store.tiddlerExists(title)) {
				removeClass(tiddlerElem,"shadow");
				removeClass(tiddlerElem,"missing");
			} else {
				addClass(tiddlerElem, store.isShadowTiddler(title) ? "shadow" : "missing");
			}
			if(customFields)
				this.addCustomFields(tiddlerElem,customFields);
			forceReflow();
		}
	}
	return tiddlerElem;
};

Story.prototype.addCustomFields = function(place,customFields)
{
	var fields = customFields.decodeHashMap();
	var w = createTiddlyElement(place,"div",null,"customFields");
	w.style.display = "none";
	for(var t in fields) {
		var e = document.createElement("input");
		e.setAttribute("type","text");
		e.setAttribute("value",fields[t]);
		w.appendChild(e);
		e.setAttribute("edit",t);
	}
};

Story.prototype.refreshAllTiddlers = function(force)
{
	var e = this.getContainer().firstChild;
	while(e) {
		var template = e.getAttribute("template");
		if(template && e.getAttribute("dirty") != "true") {
			this.refreshTiddler(e.getAttribute("tiddler"),force ? null : template,true);
		}
		e = e.nextSibling;
	}
};

Story.prototype.onTiddlerMouseOver = function(e)
{
	addClass(this, "selected");
};

Story.prototype.onTiddlerMouseOut = function(e)
{
	removeClass(this,"selected");
};

Story.prototype.onTiddlerDblClick = function(ev)
{
	var e = ev || window.event;
	var target = resolveTarget(e);
	if(target && target.nodeName.toLowerCase() != "input" && target.nodeName.toLowerCase() != "textarea") {
		if(document.selection && document.selection.empty)
			document.selection.empty();
		config.macros.toolbar.invokeCommand(this,"defaultCommand",e);
		e.cancelBubble = true;
		if(e.stopPropagation) e.stopPropagation();
		return true;
	}
	return false;
};

Story.prototype.onTiddlerKeyPress = function(ev)
{
	var e = ev || window.event;
	clearMessage();
	var consume = false;
	var title = this.getAttribute("tiddler");
	var target = resolveTarget(e);
	switch(e.keyCode) {
	case 9: // Tab
		if(config.options.chkInsertTabs && target.tagName.toLowerCase() == "textarea") {
			replaceSelection(target,String.fromCharCode(9));
			consume = true;
		}
		if(config.isOpera) {
			target.onblur = function() {
				this.focus();
				this.onblur = null;
			};
		}
		break;
	case 13: // Ctrl-Enter
	case 10: // Ctrl-Enter on IE PC
	case 77: // Ctrl-Enter is "M" on some platforms
		if(e.ctrlKey) {
			blurElement(this);
			config.macros.toolbar.invokeCommand(this,"defaultCommand",e);
			consume = true;
		}
		break;
	case 27: // Escape
		blurElement(this);
		config.macros.toolbar.invokeCommand(this,"cancelCommand",e);
		consume = true;
		break;
	}
	e.cancelBubble = consume;
	if(consume) {
		if(e.stopPropagation) e.stopPropagation(); // Stop Propagation
		e.returnValue = true; // Cancel The Event in IE
		if(e.preventDefault ) e.preventDefault(); // Cancel The Event in Moz
	}
	return !consume;
};

Story.prototype.getTiddlerField = function(title,field)
{
	var tiddlerElem = this.getTiddler(title);
	var e = null;
	if(tiddlerElem ) {
		var children = tiddlerElem.getElementsByTagName("*");
		for(var t=0; t<children.length; t++) {
			var c = children[t];
			if(c.tagName.toLowerCase() == "input" || c.tagName.toLowerCase() == "textarea") {
				if(!e)
					e = c;
				if(c.getAttribute("edit") == field)
					e = c;
			}
		}
	}
	return e;
};

Story.prototype.focusTiddler = function(title,field)
{
	var e = this.getTiddlerField(title,field);
	if(e) {
		e.focus();
		e.select();
	}
};

Story.prototype.blurTiddler = function(title)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem && tiddlerElem.focus && tiddlerElem.blur) {
		tiddlerElem.focus();
		tiddlerElem.blur();
	}
};

Story.prototype.setTiddlerField = function(title,tag,mode,field)
{
	var c = this.getTiddlerField(title,field);
	var tags = c.value.readBracketedList();
	tags.setItem(tag,mode);
	c.value = String.encodeTiddlyLinkList(tags);
};

Story.prototype.setTiddlerTag = function(title,tag,mode)
{
	this.setTiddlerField(title,tag,mode,"tags");
};

Story.prototype.closeTiddler = function(title,animate,unused)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem) {
		clearMessage();
		this.scrubTiddler(tiddlerElem);
		if(config.options.chkAnimate && animate && anim && typeof Slider == "function")
			anim.startAnimating(new Slider(tiddlerElem,false,null,"all"));
		else {
			removeNode(tiddlerElem);
			forceReflow();
		}
	}
};

Story.prototype.scrubTiddler = function(tiddlerElem)
{
	tiddlerElem.id = null;
};

Story.prototype.setDirty = function(title,dirty)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem)
		tiddlerElem.setAttribute("dirty",dirty ? "true" : "false");
};

Story.prototype.isDirty = function(title)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem)
		return tiddlerElem.getAttribute("dirty") == "true";
	return null;
};

Story.prototype.areAnyDirty = function()
{
	var r = false;
	this.forEachTiddler(function(title,element) {
		if(this.isDirty(title))
			r = true;
	});
	return r;
};

Story.prototype.closeAllTiddlers = function(exclude)
{
	clearMessage();
	this.forEachTiddler(function(title,element) {
		if((title != exclude) && element.getAttribute("dirty") != "true")
			this.closeTiddler(title);
	});
	window.scrollTo(0,ensureVisible(this.container));
};

Story.prototype.isEmpty = function()
{
	var place = this.getContainer();
	return place && place.firstChild == null;
};

Story.prototype.search = function(text,useCaseSensitive,useRegExp)
{
	this.closeAllTiddlers();
	highlightHack = new RegExp(useRegExp ? text : text.escapeRegExp(),useCaseSensitive ? "mg" : "img");
	var matches = store.search(highlightHack,"title","excludeSearch");
	this.displayTiddlers(null,matches);
	highlightHack = null;
	var q = useRegExp ? "/" : "'";
	if(matches.length > 0)
		displayMessage(config.macros.search.successMsg.format([matches.length.toString(),q + text + q]));
	else
		displayMessage(config.macros.search.failureMsg.format([q + text + q]));
};

Story.prototype.findContainingTiddler = function(e)
{
	while(e && !hasClass(e,"tiddler"))
		e = e.parentNode;
	return e;
};

Story.prototype.gatherSaveFields = function(e,fields)
{
	if(e && e.getAttribute) {
		var f = e.getAttribute("edit");
		if(f)
			fields[f] = e.value.replace(/\r/mg,"");
		if(e.hasChildNodes()) {
			var c = e.childNodes;
			for(var t=0; t<c.length; t++)
				this.gatherSaveFields(c[t],fields);
		}
	}
};

Story.prototype.hasChanges = function(title)
{
	var e = this.getTiddler(title);
	if(e) {
		var fields = {};
		this.gatherSaveFields(e,fields);
		var tiddler = store.fetchTiddler(title);
		if(!tiddler)
			return false;
		for(var n in fields) {
			if(store.getValue(title,n) != fields[n])
				return true;
		}
	}
	return false;
};

Story.prototype.saveTiddler = function(title,minorUpdate)
{
	var tiddlerElem = this.getTiddler(title);
	if(tiddlerElem) {
		var fields = {};
		this.gatherSaveFields(tiddlerElem,fields);
		var newTitle = fields.title || title;
		if(!store.tiddlerExists(newTitle))
			newTitle = newTitle.trim();
		if(store.tiddlerExists(newTitle) && newTitle != title) {
			if(!confirm(config.messages.overwriteWarning.format([newTitle.toString()])))
				return null;
		}
		if(newTitle != title)
			this.closeTiddler(newTitle,false);
		tiddlerElem.id = this.tiddlerId(newTitle);
		tiddlerElem.setAttribute("tiddler",newTitle);
		tiddlerElem.setAttribute("template",DEFAULT_VIEW_TEMPLATE);
		tiddlerElem.setAttribute("dirty","false");
		if(config.options.chkForceMinorUpdate)
			minorUpdate = !minorUpdate;
		if(!store.tiddlerExists(newTitle))
			minorUpdate = false;
		var newDate = new Date();
		if(store.tiddlerExists(title)) {
			var extendedFields = store.fetchTiddler(title).fields;
		} else {
			extendedFields = merge({},config.defaultCustomFields);
		}
		for(var n in fields) {
			if(!TiddlyWiki.isStandardField(n))
				extendedFields[n] = fields[n];
		}
		var tiddler = store.saveTiddler(title,newTitle,fields.text,minorUpdate ? undefined : config.options.txtUserName,minorUpdate ? undefined : newDate,fields.tags,extendedFields);
		autoSaveChanges(null,[tiddler]);
		return newTitle;
	}
	return null;
};

Story.prototype.permaView = function()
{
	var links = [];
	this.forEachTiddler(function(title,element) {
		links.push(String.encodeTiddlyLink(title));
	});
	var t = encodeURIComponent(links.join(" "));
	if(t == "")
		t = "#";
	if(window.location.hash != t)
		window.location.hash = t;
};

Story.prototype.switchTheme = function(theme)
{
	if(safeMode)
		return;

	var isAvailable = function(title) {
		var s = title ? title.indexOf(config.textPrimitives.sectionSeparator) : -1;
		if(s!=-1)
			title = title.substr(0,s);
		return store.tiddlerExists(title) || store.isShadowTiddler(title);
	};

	var getSlice = function(theme,slice) {
		var r;
		if(readOnly)
			r = store.getTiddlerSlice(theme,slice+"ReadOnly") || store.getTiddlerSlice(theme,"Web"+slice);
		r = r || store.getTiddlerSlice(theme,slice);
		if(r && r.indexOf(config.textPrimitives.sectionSeparator)==0)
			r = theme + r;
		return isAvailable(r) ? r : slice;
	};

	var replaceNotification = function(i,name,theme,slice) {
		var newName = getSlice(theme,slice);
		if(name!=newName && store.namedNotifications[i].name==name) {
			store.namedNotifications[i].name = newName;
			return newName;
		}
		return name;
	};

	var pt = config.refresherData.pageTemplate;
	var vi = DEFAULT_VIEW_TEMPLATE;
	var vt = config.tiddlerTemplates[vi];
	var ei = DEFAULT_EDIT_TEMPLATE;
	var et = config.tiddlerTemplates[ei];

	for(var i=0; i<config.notifyTiddlers.length; i++) {
		var name = config.notifyTiddlers[i].name;
		switch(name) {
		case "PageTemplate":
			config.refresherData.pageTemplate = replaceNotification(i,config.refresherData.pageTemplate,theme,name);
			break;
		case "StyleSheet":
			removeStyleSheet(config.refresherData.styleSheet);
			config.refresherData.styleSheet = replaceNotification(i,config.refresherData.styleSheet,theme,name);
			break;
		case "ColorPalette":
			config.refresherData.colorPalette = replaceNotification(i,config.refresherData.colorPalette,theme,name);
			break;
		default:
			break;
		}
	}
	config.tiddlerTemplates[vi] = getSlice(theme,"ViewTemplate");
	config.tiddlerTemplates[ei] = getSlice(theme,"EditTemplate");
	if(!startingUp) {
		if(config.refresherData.pageTemplate!=pt || config.tiddlerTemplates[vi]!=vt || config.tiddlerTemplates[ei]!=et) {
			refreshAll();
			this.refreshAllTiddlers(true);
		} else {
			setStylesheet(store.getRecursiveTiddlerText(config.refresherData.styleSheet,"",10),config.refreshers.styleSheet);
		}
		config.options.txtTheme = theme;
		saveOptionCookie("txtTheme");
	}
};

//--
//-- Backstage
//--

var backstage = {
	area: null,
	toolbar: null,
	button: null,
	showButton: null,
	hideButton: null,
	cloak: null,
	panel: null,
	panelBody: null,
	panelFooter: null,
	currTabName: null,
	currTabElem: null,
	content: null,

	init: function() {
		var cmb = config.messages.backstage;
		this.area = document.getElementById("backstageArea");
		this.toolbar = document.getElementById("backstageToolbar");
		this.button = document.getElementById("backstageButton");
		this.button.style.display = "block";
		var t = cmb.open.text + " " + glyph("bentArrowLeft");
		this.showButton = createTiddlyButton(this.button,t,cmb.open.tooltip,
						function(e) {backstage.show(); return false;},null,"backstageShow");
		t = glyph("bentArrowRight") + " " + cmb.close.text;
		this.hideButton = createTiddlyButton(this.button,t,cmb.close.tooltip,
						function(e) {backstage.hide(); return false;},null,"backstageHide");
		this.cloak = document.getElementById("backstageCloak");
		this.panel = document.getElementById("backstagePanel");
		this.panelFooter = createTiddlyElement(this.panel,"div",null,"backstagePanelFooter");
		this.panelBody = createTiddlyElement(this.panel,"div",null,"backstagePanelBody");
		this.cloak.onmousedown = function(e) {backstage.switchTab(null);};
		createTiddlyText(this.toolbar,cmb.prompt);
		for(t=0; t<config.backstageTasks.length; t++) {
			var taskName = config.backstageTasks[t];
			var task = config.tasks[taskName];
			var handler = task.action ? this.onClickCommand : this.onClickTab;
			var text = task.text + (task.action ? "" : glyph("downTriangle"));
			var btn = createTiddlyButton(this.toolbar,text,task.tooltip,handler,"backstageTab");
			addClass(btn,task.action ? "backstageAction" : "backstageTask");
			btn.setAttribute("task", taskName);
			}
		this.content = document.getElementById("contentWrapper");
		if(config.options.chkBackstage)
			this.show();
		else
			this.hide();
	},

	isVisible: function() {
		return this.area ? this.area.style.display == "block" : false;
	},

	show: function() {
		this.area.style.display = "block";
		if(anim && config.options.chkAnimate) {
			backstage.toolbar.style.left = findWindowWidth() + "px";
			var p = [{style: "left", start: findWindowWidth(), end: 0, template: "%0px"}];
			anim.startAnimating(new Morpher(backstage.toolbar,config.animDuration,p));
		} else {
			backstage.area.style.left = "0px";
		}
		jQuery(this.showButton).hide();
		jQuery(this.hideButton).show();
		config.options.chkBackstage = true;
		saveOptionCookie("chkBackstage");
		addClass(this.content,"backstageVisible");
	},

	hide: function() {
		if(this.currTabElem) {
			this.switchTab(null);
		} else {
			backstage.toolbar.style.left = "0px";
			if(anim && config.options.chkAnimate) {
				var p = [{style: "left", start: 0, end: findWindowWidth(), template: "%0px"}];
				var c = function(element,properties) {backstage.area.style.display = "none";};
				anim.startAnimating(new Morpher(backstage.toolbar,config.animDuration,p,c));
			} else {
				this.area.style.display = "none";
			}
			this.showButton.style.display = "block";
			this.hideButton.style.display = "none";
			config.options.chkBackstage = false;
			saveOptionCookie("chkBackstage");
			removeClass(this.content, "backstageVisible");
		}
	},

	onClickCommand: function(e) {
		var task = config.tasks[this.getAttribute("task")];
		displayMessage(task);
		if(task.action) {
			backstage.switchTab(null);
			task.action();
		}
		return false;
	},

	onClickTab: function(e) {
		backstage.switchTab(this.getAttribute("task"));
		return false;
	},

	// Switch to a given tab, or none if null is passed
	switchTab: function(tabName) {
		var tabElem = null;
		var e = this.toolbar.firstChild;
		while(e)
			{
			if(e.getAttribute && e.getAttribute("task") == tabName)
				tabElem = e;
			e = e.nextSibling;
			}
		if(tabName == backstage.currTabName) {
			backstage.hidePanel();
			return;
		}
		if(backstage.currTabElem) {
			removeClass(this.currTabElem, "backstageSelTab");
		}
		if(tabElem && tabName) {
			backstage.preparePanel();
			addClass(tabElem,"backstageSelTab");
			var task = config.tasks[tabName];
			wikify(task.content,backstage.panelBody,null,null);
			backstage.showPanel();
		} else if(backstage.currTabElem) {
			backstage.hidePanel();
		}
		backstage.currTabName = tabName;
		backstage.currTabElem = tabElem;
	},

	isPanelVisible: function() {
		return backstage.panel ? backstage.panel.style.display == "block" : false;
	},

	preparePanel: function() {
		backstage.cloak.style.height = findWindowHeight() + "px";
		backstage.cloak.style.display = "block";
		removeChildren(backstage.panelBody);
		return backstage.panelBody;
	},

	showPanel: function() {
		backstage.panel.style.display = "block";
		if(anim && config.options.chkAnimate) {
			backstage.panel.style.top = (-backstage.panel.offsetHeight) + "px";
			var p = [{style: "top", start: -backstage.panel.offsetHeight, end: 0, template: "%0px"}];
			anim.startAnimating(new Morpher(backstage.panel,config.animDuration,p),new Scroller(backstage.panel,false));
		} else {
			backstage.panel.style.top = "0px";
		}
		return backstage.panelBody;
	},

	hidePanel: function() {
		if(backstage.currTabElem)
			removeClass(backstage.currTabElem, "backstageSelTab");
		backstage.currTabElem = null;
		backstage.currTabName = null;
		if(anim && config.options.chkAnimate) {
			var p = [
				{style: "top", start: 0, end: -(backstage.panel.offsetHeight), template: "%0px"},
				{style: "display", atEnd: "none"}
			];
			var c = function(element,properties) {backstage.cloak.style.display = "none";};
			anim.startAnimating(new Morpher(backstage.panel,config.animDuration,p,c));
		} else {
			jQuery([backstage.panel,backstage.cloak]).hide();
		}
	}
};

config.macros.backstage = {};

config.macros.backstage.handler = function(place,macroName,params)
{
	var backstageTask = config.tasks[params[0]];
	if(backstageTask)
		createTiddlyButton(place,backstageTask.text,backstageTask.tooltip,function(e) {backstage.switchTab(params[0]); return false;});
};

//--
//-- ImportTiddlers macro
//--

config.macros.importTiddlers.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if(readOnly) {
		createTiddlyElement(place,"div",null,"marked",this.readOnlyWarning);
		return;
	}
	var w = new Wizard();
	w.createWizard(place,this.wizardTitle);
	this.restart(w);
};

config.macros.importTiddlers.onCancel = function(e)
{
	var wizard = new Wizard(this);
	var place = wizard.clear();
	config.macros.importTiddlers.restart(wizard);
	return false;
};

config.macros.importTiddlers.onClose = function(e)
{
	backstage.hidePanel();
	return false;
};

config.macros.importTiddlers.restart = function(wizard)
{
	wizard.addStep(this.step1Title,this.step1Html);
	var s = wizard.getElement("selTypes");
	for(var t in config.adaptors) {
		var e = createTiddlyElement(s,"option",null,null,config.adaptors[t].serverLabel ? config.adaptors[t].serverLabel : t);
		e.value = t;
	}
	if(config.defaultAdaptor)
		s.value = config.defaultAdaptor;
	s = wizard.getElement("selFeeds");
	var feeds = this.getFeeds();
	for(t in feeds) {
		e = createTiddlyElement(s,"option",null,null,t);
		e.value = t;
	}
	wizard.setValue("feeds",feeds);
	s.onchange = config.macros.importTiddlers.onFeedChange;
	var fileInput = wizard.getElement("txtBrowse");
	fileInput.onchange = config.macros.importTiddlers.onBrowseChange;
	fileInput.onkeyup = config.macros.importTiddlers.onBrowseChange;
	wizard.setButtons([{caption: this.openLabel, tooltip: this.openPrompt, onClick: config.macros.importTiddlers.onOpen}]);
	wizard.formElem.action = "javascript:;";
	wizard.formElem.onsubmit = function() {
		if(!this.txtPath || this.txtPath.value.length) //# check for manually entered path in first step
			this.lastChild.firstChild.onclick();
	};
};

config.macros.importTiddlers.getFeeds = function()
{
	var feeds = {};
	var tagged = store.getTaggedTiddlers("systemServer","title");
	for(var t=0; t<tagged.length; t++) {
		var title = tagged[t].title;
		var serverType = store.getTiddlerSlice(title,"Type");
		if(!serverType)
			serverType = "file";
		feeds[title] = {title: title,
						url: store.getTiddlerSlice(title,"URL"),
						workspace: store.getTiddlerSlice(title,"Workspace"),
						workspaceList: store.getTiddlerSlice(title,"WorkspaceList"),
						tiddlerFilter: store.getTiddlerSlice(title,"TiddlerFilter"),
						serverType: serverType,
						description: store.getTiddlerSlice(title,"Description")};
	}
	return feeds;
};

config.macros.importTiddlers.onFeedChange = function(e)
{
	var wizard = new Wizard(this);
	var selTypes = wizard.getElement("selTypes");
	var fileInput = wizard.getElement("txtPath");
	var feeds = wizard.getValue("feeds");
	var f = feeds[this.value];
	if(f) {
		selTypes.value = f.serverType;
		fileInput.value = f.url;
		wizard.setValue("feedName",f.serverType);
		wizard.setValue("feedHost",f.url);
		wizard.setValue("feedWorkspace",f.workspace);
		wizard.setValue("feedWorkspaceList",f.workspaceList);
		wizard.setValue("feedTiddlerFilter",f.tiddlerFilter);
	}
	return false;
};

config.macros.importTiddlers.onBrowseChange = function(e)
{
	var wizard = new Wizard(this);
	var fileInput = wizard.getElement("txtPath");
	fileInput.value = config.macros.importTiddlers.getURLFromLocalPath(this.value);
	var serverType = wizard.getElement("selTypes");
	serverType.value = "file";
	return true;
};

config.macros.importTiddlers.getURLFromLocalPath = function(v)
{
	if(!v||!v.length)
		return v;
	v = v.replace(/\\/g,"/"); // use "/" for cross-platform consistency
	var u;
	var t = v.split(":");
	var p = t[1]||t[0]; // remove drive letter (if any)
	if (t[1] && (t[0]=="http"||t[0]=="https"||t[0]=="file")) {
		u = v;
	} else if(p.substr(0,1)=="/") {
		u = document.location.protocol + "//" + document.location.hostname + (t[1] ? "/" : "") + v;
	} else {
		var c = document.location.href.replace(/\\/g,"/");
		var pos = c.lastIndexOf("/");
		if (pos!=-1)
			c = c.substr(0,pos); // remove filename
		u = c + "/" + p;
	}
	return u;
};

config.macros.importTiddlers.onOpen = function(e)
{
	var wizard = new Wizard(this);
	var fileInput = wizard.getElement("txtPath");
	var url = fileInput.value;
	var serverType = wizard.getElement("selTypes").value || config.defaultAdaptor;
	var adaptor = new config.adaptors[serverType]();
	wizard.setValue("adaptor",adaptor);
	wizard.setValue("serverType",serverType);
	wizard.setValue("host",url);
	var ret = adaptor.openHost(url,null,wizard,config.macros.importTiddlers.onOpenHost);
	if(ret !== true)
		displayMessage(ret);
	wizard.setButtons([{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}],config.macros.importTiddlers.statusOpenHost);
	return false;
};

config.macros.importTiddlers.onOpenHost = function(context,wizard)
{
	var adaptor = wizard.getValue("adaptor");
	if(context.status !== true)
		displayMessage("Error in importTiddlers.onOpenHost: " + context.statusText);
	var ret = adaptor.getWorkspaceList(context,wizard,config.macros.importTiddlers.onGetWorkspaceList);
	if(ret !== true)
		displayMessage(ret);
	wizard.setButtons([{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}],config.macros.importTiddlers.statusGetWorkspaceList);
};

config.macros.importTiddlers.onGetWorkspaceList = function(context,wizard)
{
	if(context.status !== true)
		displayMessage("Error in importTiddlers.onGetWorkspaceList: " + context.statusText);
	wizard.setValue("context",context);
	var workspace = wizard.getValue("feedWorkspace");
	if(!workspace && context.workspaces.length==1)
		workspace = context.workspaces[0].title;
	if(workspace) {
		var ret = context.adaptor.openWorkspace(workspace,context,wizard,config.macros.importTiddlers.onOpenWorkspace);
		if(ret !== true)
			displayMessage(ret);
		wizard.setValue("workspace",workspace);
		wizard.setButtons([{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}],config.macros.importTiddlers.statusOpenWorkspace);
		return;
	}
	wizard.addStep(config.macros.importTiddlers.step2Title,config.macros.importTiddlers.step2Html);
	var s = wizard.getElement("selWorkspace");
	s.onchange = config.macros.importTiddlers.onWorkspaceChange;
	for(var t=0; t<context.workspaces.length; t++) {
		var e = createTiddlyElement(s,"option",null,null,context.workspaces[t].title);
		e.value = context.workspaces[t].title;
	}
	var workspaceList = wizard.getValue("feedWorkspaceList");
	if(workspaceList) {
		var list = workspaceList.parseParams("workspace",null,false,true);
		for(var n=1; n<list.length; n++) {
			if(context.workspaces.findByField("title",list[n].value) == null) {
				e = createTiddlyElement(s,"option",null,null,list[n].value);
				e.value = list[n].value;
			}
		}
	}
	if(workspace) {
		t = wizard.getElement("txtWorkspace");
		t.value = workspace;
	}
	wizard.setButtons([{caption: config.macros.importTiddlers.openLabel, tooltip: config.macros.importTiddlers.openPrompt, onClick: config.macros.importTiddlers.onChooseWorkspace}]);
};

config.macros.importTiddlers.onWorkspaceChange = function(e)
{
	var wizard = new Wizard(this);
	var t = wizard.getElement("txtWorkspace");
	t.value = this.value;
	this.selectedIndex = 0;
	return false;
};

config.macros.importTiddlers.onChooseWorkspace = function(e)
{
	var wizard = new Wizard(this);
	var adaptor = wizard.getValue("adaptor");
	var workspace = wizard.getElement("txtWorkspace").value;
	wizard.setValue("workspace",workspace);
	var context = wizard.getValue("context");
	var ret = adaptor.openWorkspace(workspace,context,wizard,config.macros.importTiddlers.onOpenWorkspace);
	if(ret !== true)
		displayMessage(ret);
	wizard.setButtons([{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}],config.macros.importTiddlers.statusOpenWorkspace);
	return false;
};

config.macros.importTiddlers.onOpenWorkspace = function(context,wizard)
{
	if(context.status !== true)
		displayMessage("Error in importTiddlers.onOpenWorkspace: " + context.statusText);
	var adaptor = wizard.getValue("adaptor");
	var ret = adaptor.getTiddlerList(context,wizard,config.macros.importTiddlers.onGetTiddlerList,wizard.getValue("feedTiddlerFilter"));
	if(ret !== true)
		displayMessage(ret);
	wizard.setButtons([{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}],config.macros.importTiddlers.statusGetTiddlerList);
};

config.macros.importTiddlers.onGetTiddlerList = function(context,wizard)
{
	if(context.status !== true) {
		wizard.setButtons([{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}],config.macros.importTiddlers.errorGettingTiddlerList);
		return;
	}
	// Extract data for the listview
	var listedTiddlers = [];
	if(context.tiddlers) {
		for(var n=0; n<context.tiddlers.length; n++) {
			var tiddler = context.tiddlers[n];
			listedTiddlers.push({
				title: tiddler.title,
				modified: tiddler.modified,
				modifier: tiddler.modifier,
				text: tiddler.text ? wikifyPlainText(tiddler.text,100) : "",
				tags: tiddler.tags,
				size: tiddler.text ? tiddler.text.length : 0,
				tiddler: tiddler
			});
		}
	}
	listedTiddlers.sort(function(a,b) {return a.title < b.title ? -1 : (a.title == b.title ? 0 : +1);});
	// Display the listview
	wizard.addStep(config.macros.importTiddlers.step3Title,config.macros.importTiddlers.step3Html);
	var markList = wizard.getElement("markList");
	var listWrapper = document.createElement("div");
	markList.parentNode.insertBefore(listWrapper,markList);
	var listView = ListView.create(listWrapper,listedTiddlers,config.macros.importTiddlers.listViewTemplate);
	wizard.setValue("listView",listView);
	wizard.setValue("context",context);
	var txtSaveTiddler = wizard.getElement("txtSaveTiddler");
	txtSaveTiddler.value = config.macros.importTiddlers.generateSystemServerName(wizard);
	wizard.setButtons([
			{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel},
			{caption: config.macros.importTiddlers.importLabel, tooltip: config.macros.importTiddlers.importPrompt, onClick: config.macros.importTiddlers.doImport}
		]);
};

config.macros.importTiddlers.generateSystemServerName = function(wizard)
{
	var serverType = wizard.getValue("serverType");
	var host = wizard.getValue("host");
	var workspace = wizard.getValue("workspace");
	var pattern = config.macros.importTiddlers[workspace ? "systemServerNamePattern" : "systemServerNamePatternNoWorkspace"];
	return pattern.format([serverType,host,workspace]);
};

config.macros.importTiddlers.saveServerTiddler = function(wizard)
{
	var txtSaveTiddler = wizard.getElement("txtSaveTiddler").value;
	if(store.tiddlerExists(txtSaveTiddler)) {
		if(!confirm(config.macros.importTiddlers.confirmOverwriteSaveTiddler.format([txtSaveTiddler])))
			return;
		store.suspendNotifications();
		store.removeTiddler(txtSaveTiddler);
		store.resumeNotifications();
	}
	var serverType = wizard.getValue("serverType");
	var host = wizard.getValue("host");
	var workspace = wizard.getValue("workspace");
	var text = config.macros.importTiddlers.serverSaveTemplate.format([serverType,host,workspace]);
	store.saveTiddler(txtSaveTiddler,txtSaveTiddler,text,config.macros.importTiddlers.serverSaveModifier,new Date(),["systemServer"]);
};

config.macros.importTiddlers.doImport = function(e)
{
	var wizard = new Wizard(this);
	if(wizard.getElement("chkSave").checked)
		config.macros.importTiddlers.saveServerTiddler(wizard);
	var chkSync = wizard.getElement("chkSync").checked;
	wizard.setValue("sync",chkSync);
	var listView = wizard.getValue("listView");
	var rowNames = ListView.getSelectedRows(listView);
	var adaptor = wizard.getValue("adaptor");
	var overwrite = [];
	var t;
	for(t=0; t<rowNames.length; t++) {
		if(store.tiddlerExists(rowNames[t]))
			overwrite.push(rowNames[t]);
	}
	if(overwrite.length > 0) {
		if(!confirm(config.macros.importTiddlers.confirmOverwriteText.format([overwrite.join(", ")])))
			return false;
	}
	wizard.addStep(config.macros.importTiddlers.step4Title.format([rowNames.length]),config.macros.importTiddlers.step4Html);
	for(t=0; t<rowNames.length; t++) {
		var link = document.createElement("div");
		createTiddlyLink(link,rowNames[t],true);
		var place = wizard.getElement("markReport");
		place.parentNode.insertBefore(link,place);
	}
	wizard.setValue("remainingImports",rowNames.length);
	wizard.setButtons([
			{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}
		],config.macros.importTiddlers.statusDoingImport);
	var wizardContext = wizard.getValue("context");
	var tiddlers = wizardContext ? wizardContext.tiddlers : [];
	for(t=0; t<rowNames.length; t++) {
		var context = {
			allowSynchronous:true,
			tiddler:tiddlers[tiddlers.findByField("title",rowNames[t])]
		};
		adaptor.getTiddler(rowNames[t],context,wizard,config.macros.importTiddlers.onGetTiddler);
	}
	return false;
};

config.macros.importTiddlers.onGetTiddler = function(context,wizard)
{
	if(!context.status)
		displayMessage("Error in importTiddlers.onGetTiddler: " + context.statusText);
	var tiddler = context.tiddler;
	store.suspendNotifications();
	store.saveTiddler(tiddler.title, tiddler.title, tiddler.text, tiddler.modifier, tiddler.modified, tiddler.tags, tiddler.fields, true, tiddler.created);
	if(!wizard.getValue("sync")) {
		store.setValue(tiddler.title,'server',null);
	}
	store.resumeNotifications();
	if(!context.isSynchronous)
		store.notify(tiddler.title,true);
	var remainingImports = wizard.getValue("remainingImports")-1;
	wizard.setValue("remainingImports",remainingImports);
	if(remainingImports == 0) {
		if(context.isSynchronous) {
			store.notifyAll();
			refreshDisplay();
		}
		wizard.setButtons([
				{caption: config.macros.importTiddlers.doneLabel, tooltip: config.macros.importTiddlers.donePrompt, onClick: config.macros.importTiddlers.onClose}
			],config.macros.importTiddlers.statusDoneImport);
		autoSaveChanges();
	}
};

//--
//-- Upgrade macro
//--

config.macros.upgrade.handler = function(place)
{
	var w = new Wizard();
	w.createWizard(place,this.wizardTitle);
	w.addStep(this.step1Title,this.step1Html.format([this.source,this.source]));
	w.setButtons([{caption: this.upgradeLabel, tooltip: this.upgradePrompt, onClick: this.onClickUpgrade}]);
};

config.macros.upgrade.onClickUpgrade = function(e)
{
	var me = config.macros.upgrade;
	var w = new Wizard(this);
	if(window.location.protocol != "file:") {
		alert(me.errorCantUpgrade);
		return false;
	}
	if(story.areAnyDirty() || store.isDirty()) {
		alert(me.errorNotSaved);
		return false;
	}
	var localPath = getLocalPath(document.location.toString());
	var backupPath = getBackupPath(localPath,me.backupExtension);
	w.setValue("backupPath",backupPath);
	w.setButtons([],me.statusPreparingBackup);
	var original = loadOriginal(localPath);
	w.setButtons([],me.statusSavingBackup);
	var backup = copyFile(backupPath,localPath);
	if(!backup)
		backup = saveFile(backupPath,original);
	if(!backup) {
		w.setButtons([],me.errorSavingBackup);
		alert(me.errorSavingBackup);
		return false;
	}
	w.setButtons([],me.statusLoadingCore);
	var load = loadRemoteFile(me.source,me.onLoadCore,w);
	if(typeof load == "string") {
		w.setButtons([],me.errorLoadingCore);
		alert(me.errorLoadingCore);
		return false;
	}
	return false;
};

config.macros.upgrade.onLoadCore = function(status,params,responseText,url,xhr)
{
	var me = config.macros.upgrade;
	var w = params;
	var errMsg;
	if(!status)
		errMsg = me.errorLoadingCore;
	var newVer = me.extractVersion(responseText);
	if(!newVer)
		errMsg = me.errorCoreFormat;
	if(errMsg) {
		w.setButtons([],errMsg);
		alert(errMsg);
		return;
	}
	var onStartUpgrade = function(e) {
		w.setButtons([],me.statusSavingCore);
		var localPath = getLocalPath(document.location.toString());
		saveFile(localPath,responseText);
		w.setButtons([],me.statusReloadingCore);
		var backupPath = w.getValue("backupPath");
		var newLoc = document.location.toString() + "?time=" + new Date().convertToYYYYMMDDHHMM() + "#upgrade:[[" + encodeURI(backupPath) + "]]";
		window.setTimeout(function () {window.location = newLoc;},10);
	};
	var step2 = [me.step2Html_downgrade,me.step2Html_restore,me.step2Html_upgrade][compareVersions(version,newVer) + 1];
	w.addStep(me.step2Title,step2.format([formatVersion(newVer),formatVersion(version)]));
	w.setButtons([{caption: me.startLabel, tooltip: me.startPrompt, onClick: onStartUpgrade},{caption: me.cancelLabel, tooltip: me.cancelPrompt, onClick: me.onCancel}]);
};

config.macros.upgrade.onCancel = function(e)
{
	var me = config.macros.upgrade;
	var w = new Wizard(this);
	w.addStep(me.step3Title,me.step3Html);
	w.setButtons([]);
	return false;
};

config.macros.upgrade.extractVersion = function(upgradeFile)
{
	var re = /^var version = \{title: "([^"]+)", major: (\d+), minor: (\d+), revision: (\d+)(, beta: (\d+)){0,1}, date: new Date\("([^"]+)"\)/mg;
	var m = re.exec(upgradeFile);
	return  m ? {title: m[1], major: m[2], minor: m[3], revision: m[4], beta: m[6], date: new Date(m[7])} : null;
};

function upgradeFrom(path)
{
	var importStore = new TiddlyWiki();
	var tw = loadFile(path);
	importStore.importTiddlyWiki(tw);
	importStore.forEachTiddler(function(title,tiddler) {
		if(!store.getTiddler(title)) {
			store.addTiddler(tiddler);
		}
	});
	refreshDisplay();
	saveChanges(); //# To create appropriate Markup* sections
	alert(config.messages.upgradeDone.format([formatVersion()]));
	window.location = window.location.toString().substr(0,window.location.toString().lastIndexOf("?"));
}

//--
//-- Sync macro
//--

// Synchronisation handlers
config.syncers = {};

// Sync state.
var currSync = null;

// sync macro
config.macros.sync.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if(!wikifier.isStatic)
		this.startSync(place);
};

config.macros.sync.cancelSync = function()
{
	currSync = null;
};

config.macros.sync.startSync = function(place)
{
	if(currSync)
		config.macros.sync.cancelSync();
	currSync = {};
	currSync.syncList = this.getSyncableTiddlers();
	currSync.syncTasks = this.createSyncTasks(currSync.syncList);
	this.preProcessSyncableTiddlers(currSync.syncList);
	var wizard = new Wizard();
	currSync.wizard = wizard;
	wizard.createWizard(place,this.wizardTitle);
	wizard.addStep(this.step1Title,this.step1Html);
	var markList = wizard.getElement("markList");
	var listWrapper = document.createElement("div");
	markList.parentNode.insertBefore(listWrapper,markList);
	currSync.listView = ListView.create(listWrapper,currSync.syncList,this.listViewTemplate);
	this.processSyncableTiddlers(currSync.syncList);
	wizard.setButtons([{caption: this.syncLabel, tooltip: this.syncPrompt, onClick: this.doSync}]);
};

config.macros.sync.getSyncableTiddlers = function()
{
	var list = [];
	store.forEachTiddler(function(title,tiddler) {
		var syncItem = {};
		syncItem.serverType = tiddler.getServerType();
		syncItem.serverHost = tiddler.fields['server.host'];
		if(syncItem.serverType && syncItem.serverHost) {
			syncItem.adaptor = new config.adaptors[syncItem.serverType];
			syncItem.serverWorkspace = tiddler.fields['server.workspace'];
			syncItem.tiddler = tiddler;
			syncItem.title = tiddler.title;
			syncItem.isTouched = tiddler.isTouched();
			syncItem.selected = syncItem.isTouched;
			syncItem.syncStatus = config.macros.sync.syncStatusList[syncItem.isTouched ? "changedLocally" : "none"];
			syncItem.status = syncItem.syncStatus.text;
			list.push(syncItem);
		}
		});
	list.sort(function(a,b) {return a.title < b.title ? -1 : (a.title == b.title ? 0 : +1);});
	return list;
};

config.macros.sync.preProcessSyncableTiddlers = function(syncList)
{
	for(var i=0; i<syncList.length; i++) {
		var si = syncList[i];
		si.serverUrl = si.adaptor.generateTiddlerInfo(si.tiddler).uri;
	}
};

config.macros.sync.processSyncableTiddlers = function(syncList)
{
	for(var i=0; i<syncList.length; i++) {
		var si = syncList[i];
		if(si.syncStatus.display)
			si.rowElement.style.display = si.syncStatus.display;
		if(si.syncStatus.className)
			si.rowElement.className = si.syncStatus.className;
	}
};

config.macros.sync.createSyncTasks = function(syncList)
{
	var syncTasks = [];
	for(var i=0; i<syncList.length; i++) {
		var si = syncList[i];
		var r = null;
		for(var j=0; j<syncTasks.length; j++) {
			var cst = syncTasks[j];
			if(si.serverType == cst.serverType && si.serverHost == cst.serverHost && si.serverWorkspace == cst.serverWorkspace)
				r = cst;
		}
		if(r) {
			si.syncTask = r;
			r.syncItems.push(si);
		} else {
			si.syncTask = this.createSyncTask(si);
			syncTasks.push(si.syncTask);
		}
	}
	return syncTasks;
};

config.macros.sync.createSyncTask = function(syncItem)
{
	var st = {};
	st.serverType = syncItem.serverType;
	st.serverHost = syncItem.serverHost;
	st.serverWorkspace = syncItem.serverWorkspace;
	st.syncItems = [syncItem];

	var openWorkspaceCallback = function(context,syncItems) {
		if(context.status) {
			context.adaptor.getTiddlerList(context,syncItems,getTiddlerListCallback);
			return true;
		}
		displayMessage(context.statusText);
		return false;
	};

	var getTiddlerListCallback = function(context,sycnItems) {
		if(!context.status) {
			displayMessage(context.statusText);
			return false;
		}
		syncItems = context.userParams;
		var tiddlers = context.tiddlers;
		for(var i=0; i<syncItems.length; i++) {
			var si = syncItems[i];
			var f = tiddlers.findByField("title",si.title);
			if(f !== null) {
				if(tiddlers[f].fields['server.page.revision'] > si.tiddler.fields['server.page.revision']) {
					si.syncStatus = config.macros.sync.syncStatusList[si.isTouched ? 'changedBoth' : 'changedServer'];
				}
			} else {
				si.syncStatus = config.macros.sync.syncStatusList.notFound;
			}
			config.macros.sync.updateSyncStatus(si);
		}
		return true;
	};
	var context = {host:st.serverHost,workspace:st.serverWorkspace};
	syncItem.adaptor.openHost(st.serverHost);
	syncItem.adaptor.openWorkspace(st.serverWorkspace,context,st.syncItems,openWorkspaceCallback);
	return st;
};

config.macros.sync.updateSyncStatus = function(syncItem)
{
	var e = syncItem.colElements["status"];
	removeChildren(e);
	createTiddlyText(e,syncItem.syncStatus.text);
	if(syncItem.syncStatus.display)
		syncItem.rowElement.style.display = syncItem.syncStatus.display;
	if(syncItem.syncStatus.className)
		syncItem.rowElement.className = syncItem.syncStatus.className;
};

config.macros.sync.doSync = function(e)
{
	var getTiddlerCallback = function(context,syncItem) {
		if(syncItem) {
			var tiddler = context.tiddler;
			store.saveTiddler(tiddler.title,tiddler.title,tiddler.text,tiddler.modifier,tiddler.modified,tiddler.tags,tiddler.fields,true,tiddler.created);
			syncItem.syncStatus = config.macros.sync.syncStatusList.gotFromServer;
			config.macros.sync.updateSyncStatus(syncItem);
		}
	};
	var putTiddlerCallback = function(context,syncItem) {
		if(syncItem) {
			store.resetTiddler(context.title);
			syncItem.syncStatus = config.macros.sync.syncStatusList.putToServer;
			config.macros.sync.updateSyncStatus(syncItem);
		}
	};

	var rowNames = ListView.getSelectedRows(currSync.listView);
	var sl = config.macros.sync.syncStatusList;
	for(var i=0; i<currSync.syncList.length; i++) {
		var si = currSync.syncList[i];
		if(rowNames.indexOf(si.title) != -1) {
			var r = true;
			switch(si.syncStatus) {
			case sl.changedServer:
				r = si.adaptor.getTiddler(syncItem.title,null,si,getTiddlerCallback);
				break;
			case sl.notFound:
			case sl.changedLocally:
			case sl.changedBoth:
				r = si.adaptor.putTiddler(si.tiddler,null,si,putTiddlerCallback);
				break;
			default:
				break;
			}
			if(!r)
				displayMessage("Error in doSync: " + r);
		}
	}
	return false;
};

//--
//-- Manager UI for groups of tiddlers
//--

config.macros.plugins.handler = function(place,macroName,params,wikifier,paramString)
{
	var wizard = new Wizard();
	wizard.createWizard(place,this.wizardTitle);
	wizard.addStep(this.step1Title,this.step1Html);
	var markList = wizard.getElement("markList");
	var listWrapper = document.createElement("div");
	markList.parentNode.insertBefore(listWrapper,markList);
	listWrapper.setAttribute("refresh","macro");
	listWrapper.setAttribute("macroName","plugins");
	listWrapper.setAttribute("params",paramString);
	this.refresh(listWrapper,paramString);
};

config.macros.plugins.refresh = function(listWrapper,params)
{
	var wizard = new Wizard(listWrapper);
	var selectedRows = [];
	ListView.forEachSelector(listWrapper,function(e,rowName) {
			if(e.checked)
				selectedRows.push(e.getAttribute("rowName"));
		});
	removeChildren(listWrapper);
	params = params.parseParams("anon");
	var plugins = installedPlugins.slice(0);
	var t,tiddler,p;
	var configTiddlers = store.getTaggedTiddlers("systemConfig");
	for(t=0; t<configTiddlers.length; t++) {
		tiddler = configTiddlers[t];
		if(plugins.findByField("title",tiddler.title) == null) {
			p = getPluginInfo(tiddler);
			p.executed = false;
			p.log.splice(0,0,this.skippedText);
			plugins.push(p);
		}
	}
	for(t=0; t<plugins.length; t++) {
		p = plugins[t];
		p.size = p.tiddler.text ? p.tiddler.text.length : 0;
		p.forced = p.tiddler.isTagged("systemConfigForce");
		p.disabled = p.tiddler.isTagged("systemConfigDisable");
		p.Selected = selectedRows.indexOf(plugins[t].title) != -1;
	}
	if(plugins.length == 0) {
		createTiddlyElement(listWrapper,"em",null,null,this.noPluginText);
		wizard.setButtons([]);
	} else {
		var listView = ListView.create(listWrapper,plugins,this.listViewTemplate,this.onSelectCommand);
		wizard.setValue("listView",listView);
		wizard.setButtons([
				{caption: config.macros.plugins.removeLabel, tooltip: config.macros.plugins.removePrompt, onClick: config.macros.plugins.doRemoveTag},
				{caption: config.macros.plugins.deleteLabel, tooltip: config.macros.plugins.deletePrompt, onClick: config.macros.plugins.doDelete}
			]);
	}
};

config.macros.plugins.doRemoveTag = function(e)
{
	var wizard = new Wizard(this);
	var listView = wizard.getValue("listView");
	var rowNames = ListView.getSelectedRows(listView);
	if(rowNames.length == 0) {
		alert(config.messages.nothingSelected);
	} else {
		for(var t=0; t<rowNames.length; t++)
			store.setTiddlerTag(rowNames[t],false,"systemConfig");
	}
};

config.macros.plugins.doDelete = function(e)
{
	var wizard = new Wizard(this);
	var listView = wizard.getValue("listView");
	var rowNames = ListView.getSelectedRows(listView);
	if(rowNames.length == 0) {
		alert(config.messages.nothingSelected);
	} else {
		if(confirm(config.macros.plugins.confirmDeleteText.format([rowNames.join(", ")]))) {
			for(var t=0; t<rowNames.length; t++) {
				store.removeTiddler(rowNames[t]);
				story.closeTiddler(rowNames[t],true);
			}
		}
	}
};

//--
//-- Message area
//--

function getMessageDiv()
{
	var msgArea = document.getElementById("messageArea");
	if(!msgArea)
		return null;
	if(!msgArea.hasChildNodes())
		createTiddlyButton(createTiddlyElement(msgArea,"div",null,"messageToolbar"),
			config.messages.messageClose.text,
			config.messages.messageClose.tooltip,
			clearMessage);
	msgArea.style.display = "block";
	return createTiddlyElement(msgArea,"div");
}

function displayMessage(text,linkText)
{
	var e = getMessageDiv();
	if(!e) {
		alert(text);
		return;
	}
	if(linkText) {
		var link = createTiddlyElement(e,"a",null,null,text);
		link.href = linkText;
		link.target = "_blank";
	} else {
		e.appendChild(document.createTextNode(text));
	}
}

function clearMessage()
{
	var msgArea = document.getElementById("messageArea");
	if(msgArea) {
		removeChildren(msgArea);
		msgArea.style.display = "none";
	}
	return false;
}

//--
//-- Refresh mechanism
//--

config.notifyTiddlers = [
	{name: "StyleSheetLayout", notify: refreshStyles},
	{name: "StyleSheetColors", notify: refreshStyles},
	{name: "StyleSheet", notify: refreshStyles},
	{name: "StyleSheetPrint", notify: refreshStyles},
	{name: "PageTemplate", notify: refreshPageTemplate},
	{name: "SiteTitle", notify: refreshPageTitle},
	{name: "SiteSubtitle", notify: refreshPageTitle},
	{name: "ColorPalette", notify: refreshColorPalette},
	{name: null, notify: refreshDisplay}
];

config.refreshers = {
	link: function(e,changeList)
		{
		var title = e.getAttribute("tiddlyLink");
		refreshTiddlyLink(e,title);
		return true;
		},

	tiddler: function(e,changeList)
		{
		var title = e.getAttribute("tiddler");
		var template = e.getAttribute("template");
		if(changeList && changeList.indexOf(title) != -1 && !story.isDirty(title))
			story.refreshTiddler(title,template,true);
		else
			refreshElements(e,changeList);
		return true;
		},

	content: function(e,changeList)
		{
		var title = e.getAttribute("tiddler");
		var force = e.getAttribute("force");
		if(force != null || changeList == null || changeList.indexOf(title) != -1) {
			removeChildren(e);
			wikify(store.getTiddlerText(title,""),e,null,store.fetchTiddler(title));
			return true;
		} else
			return false;
		},

	macro: function(e,changeList)
		{
		var macro = e.getAttribute("macroName");
		var params = e.getAttribute("params");
		if(macro)
			macro = config.macros[macro];
		if(macro && macro.refresh)
			macro.refresh(e,params);
		return true;
		}
};

config.refresherData = {
	styleSheet: "StyleSheet",
	defaultStyleSheet: "StyleSheet",
	pageTemplate: "PageTemplate",
	defaultPageTemplate: "PageTemplate",
	colorPalette: "ColorPalette",
	defaultColorPalette: "ColorPalette"
};

function refreshElements(root,changeList)
{
	var nodes = root.childNodes;
	for(var c=0; c<nodes.length; c++) {
		var e = nodes[c], type = null;
		if(e.getAttribute && (e.tagName ? e.tagName != "IFRAME" : true))
			type = e.getAttribute("refresh");
		var refresher = config.refreshers[type];
		var refreshed = false;
		if(refresher != undefined)
			refreshed = refresher(e,changeList);
		if(e.hasChildNodes() && !refreshed)
			refreshElements(e,changeList);
	}
}

function applyHtmlMacros(root,tiddler)
{
	var e = root.firstChild;
	while(e) {
		var nextChild = e.nextSibling;
		if(e.getAttribute) {
			var macro = e.getAttribute("macro");
			if(macro) {
				e.removeAttribute("macro");
				var params = "";
				var p = macro.indexOf(" ");
				if(p != -1) {
					params = macro.substr(p+1);
					macro = macro.substr(0,p);
				}
				invokeMacro(e,macro,params,null,tiddler);
			}
		}
		if(e.hasChildNodes())
			applyHtmlMacros(e,tiddler);
		e = nextChild;
	}
}

function refreshPageTemplate(title)
{
	var stash = jQuery("<div/>").appendTo("body").hide()[0];
	var display = story.getContainer();
	var nodes,t;
	if(display) {
		nodes = display.childNodes;
		for(t=nodes.length-1; t>=0; t--)
			stash.appendChild(nodes[t]);
	}
	var wrapper = document.getElementById("contentWrapper");

	var isAvailable = function(title) {
		var s = title ? title.indexOf(config.textPrimitives.sectionSeparator) : -1;
		if(s!=-1)
			title = title.substr(0,s);
		return store.tiddlerExists(title) || store.isShadowTiddler(title);
	};
	if(!title || !isAvailable(title))
		title = config.refresherData.pageTemplate;
	if(!isAvailable(title))
		title = config.refresherData.defaultPageTemplate; //# this one is always avaialable
	wrapper.innerHTML = store.getRecursiveTiddlerText(title,null,10);
	applyHtmlMacros(wrapper);
	refreshElements(wrapper);
	display = story.getContainer();
	removeChildren(display);
	if(!display)
		display = createTiddlyElement(wrapper,"div",story.containerId());
	nodes = stash.childNodes;
	for(t=nodes.length-1; t>=0; t--)
		display.appendChild(nodes[t]);
	removeNode(stash);
}

function refreshDisplay(hint)
{
	if(typeof hint == "string")
		hint = [hint];
	var e = document.getElementById("contentWrapper");
	refreshElements(e,hint);
	if(backstage.isPanelVisible()) {
		e = document.getElementById("backstage");
		refreshElements(e,hint);
	}
}

function refreshPageTitle()
{
	document.title = getPageTitle();
}

function getPageTitle()
{
	var st = wikifyPlain("SiteTitle");
	var ss = wikifyPlain("SiteSubtitle");
	return st + ((st == "" || ss == "") ? "" : " - ") + ss;
}

function refreshStyles(title,doc)
{
	setStylesheet(title == null ? "" : store.getRecursiveTiddlerText(title,"",10),title,doc || document);
}

function refreshColorPalette(title)
{
	if(!startingUp)
		refreshAll();
}

function refreshAll()
{
	refreshPageTemplate();
	refreshDisplay();
	refreshStyles("StyleSheetLayout");
	refreshStyles("StyleSheetColors");
	refreshStyles(config.refresherData.styleSheet);
	refreshStyles("StyleSheetPrint");
}

//--
//-- Options stuff
//--

config.optionHandlers = {
	'txt': {
		get: function(name) {return encodeCookie(config.options[name].toString());},
		set: function(name,value) {config.options[name] = decodeCookie(value);}
	},
	'chk': {
		get: function(name) {return config.options[name] ? "true" : "false";},
		set: function(name,value) {config.options[name] = value == "true";}
	}
};

function loadOptionsCookie()
{
	if(safeMode)
		return;
	var cookies = document.cookie.split(";");
	for(var c=0; c<cookies.length; c++) {
		var p = cookies[c].indexOf("=");
		if(p != -1) {
			var name = cookies[c].substr(0,p).trim();
			var value = cookies[c].substr(p+1).trim();
			var optType = name.substr(0,3);
			if(config.optionHandlers[optType] && config.optionHandlers[optType].set)
				config.optionHandlers[optType].set(name,value);
		}
	}
}

function saveOptionCookie(name)
{
	if(safeMode)
		return;
	var c = name + "=";
	var optType = name.substr(0,3);
	if(config.optionHandlers[optType] && config.optionHandlers[optType].get)
		c += config.optionHandlers[optType].get(name);
	c += "; expires=Fri, 1 Jan 2038 12:00:00 UTC; path=/";
	document.cookie = c;
}

function removeCookie(name)
{
	document.cookie = name + "=; expires=Thu, 01-Jan-1970 00:00:01 UTC; path=/;";
}

function encodeCookie(s)
{
	return escape(convertUnicodeToHtmlEntities(s));
}

function decodeCookie(s)
{
	s = unescape(s);
	var re = /&#[0-9]{1,5};/g;
	return s.replace(re,function($0) {return String.fromCharCode(eval($0.replace(/[&#;]/g,"")));});
}


config.macros.option.genericCreate = function(place,type,opt,className,desc)
{
	var typeInfo = config.macros.option.types[type];
	var c = document.createElement(typeInfo.elementType);
	if(typeInfo.typeValue)
		c.setAttribute("type",typeInfo.typeValue);
	c[typeInfo.eventName] = typeInfo.onChange;
	c.setAttribute("option",opt);
	c.className = className || typeInfo.className;
	if(config.optionsDesc[opt])
		c.setAttribute("title",config.optionsDesc[opt]);
	place.appendChild(c);
	if(desc != "no")
		createTiddlyText(place,config.optionsDesc[opt] || opt);
	c[typeInfo.valueField] = config.options[opt];
	return c;
};

config.macros.option.genericOnChange = function(e)
{
	var opt = this.getAttribute("option");
	if(opt) {
		var optType = opt.substr(0,3);
		var handler = config.macros.option.types[optType];
		if(handler.elementType && handler.valueField)
			config.macros.option.propagateOption(opt,handler.valueField,this[handler.valueField],handler.elementType,this);
	}
	return true;
};

config.macros.option.types = {
	'txt': {
		elementType: "input",
		valueField: "value",
		eventName: "onchange",
		className: "txtOptionInput",
		create: config.macros.option.genericCreate,
		onChange: config.macros.option.genericOnChange
	},
	'chk': {
		elementType: "input",
		valueField: "checked",
		eventName: "onclick",
		className: "chkOptionInput",
		typeValue: "checkbox",
		create: config.macros.option.genericCreate,
		onChange: config.macros.option.genericOnChange
	}
};

config.macros.option.propagateOption = function(opt,valueField,value,elementType,elem)
{
	config.options[opt] = value;
	saveOptionCookie(opt);
	var nodes = document.getElementsByTagName(elementType);
	for(var t=0; t<nodes.length; t++) {
		var optNode = nodes[t].getAttribute("option");
		if(opt == optNode && nodes[t]!=elem)
			nodes[t][valueField] = value;
	}
};

config.macros.option.handler = function(place,macroName,params,wikifier,paramString)
{
	params = paramString.parseParams("anon",null,true,false,false);
	var opt = (params[1] && params[1].name == "anon") ? params[1].value : getParam(params,"name",null);
	var className = (params[2] && params[2].name == "anon") ? params[2].value : getParam(params,"class",null);
	var desc = getParam(params,"desc","no");
	var type = opt.substr(0,3);
	var h = config.macros.option.types[type];
	if(h && h.create)
		h.create(place,type,opt,className,desc);
};

config.macros.options.handler = function(place,macroName,params,wikifier,paramString)
{
	params = paramString.parseParams("anon",null,true,false,false);
	var showUnknown = getParam(params,"showUnknown","no");
	var wizard = new Wizard();
	wizard.createWizard(place,this.wizardTitle);
	wizard.addStep(this.step1Title,this.step1Html);
	var markList = wizard.getElement("markList");
	var chkUnknown = wizard.getElement("chkUnknown");
	chkUnknown.checked = showUnknown == "yes";
	chkUnknown.onchange = this.onChangeUnknown;
	var listWrapper = document.createElement("div");
	markList.parentNode.insertBefore(listWrapper,markList);
	wizard.setValue("listWrapper",listWrapper);
	this.refreshOptions(listWrapper,showUnknown == "yes");
};

config.macros.options.refreshOptions = function(listWrapper,showUnknown)
{
	var opts = [];
	for(var n in config.options) {
		var opt = {};
		opt.option = "";
		opt.name = n;
		opt.lowlight = !config.optionsDesc[n];
		opt.description = opt.lowlight ? this.unknownDescription : config.optionsDesc[n];
		if(!opt.lowlight || showUnknown)
			opts.push(opt);
	}
	opts.sort(function(a,b) {return a.name.substr(3) < b.name.substr(3) ? -1 : (a.name.substr(3) == b.name.substr(3) ? 0 : +1);});
	var listview = ListView.create(listWrapper,opts,this.listViewTemplate);
	for(n=0; n<opts.length; n++) {
		var type = opts[n].name.substr(0,3);
		var h = config.macros.option.types[type];
		if(h && h.create) {
			h.create(opts[n].colElements['option'],type,opts[n].name,null,"no");
		}
	}
};

config.macros.options.onChangeUnknown = function(e)
{
	var wizard = new Wizard(this);
	var listWrapper = wizard.getValue("listWrapper");
	removeChildren(listWrapper);
	config.macros.options.refreshOptions(listWrapper,this.checked);
	return false;
};

//--
//-- Saving
//--

var saveUsingSafari = false;

var startSaveArea = '<div id="' + 'storeArea">'; // Split up into two so that indexOf() of this source doesn't find it
var endSaveArea = '</d' + 'iv>';

// If there are unsaved changes, force the user to confirm before exitting
function confirmExit()
{
	hadConfirmExit = true;
	if((store && store.isDirty && store.isDirty()) || (story && story.areAnyDirty && story.areAnyDirty()))
		return config.messages.confirmExit;
}

// Give the user a chance to save changes before exitting
function checkUnsavedChanges()
{
	if(store && store.isDirty && store.isDirty() && window.hadConfirmExit === false) {
		if(confirm(config.messages.unsavedChangesWarning))
			saveChanges();
	}
}

function updateLanguageAttribute(s)
{
	if(config.locale) {
		var mRE = /(<html(?:.*?)?)(?: xml:lang\="([a-z]+)")?(?: lang\="([a-z]+)")?>/;
		var m = mRE.exec(s);
		if(m) {
			var t = m[1];
			if(m[2])
				t += ' xml:lang="' + config.locale + '"';
			if(m[3])
				t += ' lang="' + config.locale + '"';
			t += ">";
			s = s.substr(0,m.index) + t + s.substr(m.index+m[0].length);
		}
	}
	return s;
}

function updateMarkupBlock(s,blockName,tiddlerName)
{
	return s.replaceChunk(
			"<!--%0-START-->".format([blockName]),
			"<!--%0-END-->".format([blockName]),
			"\n" + convertUnicodeToFileFormat(store.getRecursiveTiddlerText(tiddlerName,"")) + "\n");
}

function updateOriginal(original,posDiv,localPath)
{
	if(!posDiv)
		posDiv = locateStoreArea(original);
	if(!posDiv) {
		alert(config.messages.invalidFileError.format([localPath]));
		return null;
	}
	var revised = original.substr(0,posDiv[0] + startSaveArea.length) + "\n" +
				convertUnicodeToFileFormat(store.allTiddlersAsHtml()) + "\n" +
				original.substr(posDiv[1]);
	var newSiteTitle = convertUnicodeToFileFormat(getPageTitle()).htmlEncode();
	revised = revised.replaceChunk("<title"+">","</title"+">"," " + newSiteTitle + " ");
	revised = updateLanguageAttribute(revised);
	revised = updateMarkupBlock(revised,"PRE-HEAD","MarkupPreHead");
	revised = updateMarkupBlock(revised,"POST-HEAD","MarkupPostHead");
	revised = updateMarkupBlock(revised,"PRE-BODY","MarkupPreBody");
	revised = updateMarkupBlock(revised,"POST-SCRIPT","MarkupPostBody");
	return revised;
}

function locateStoreArea(original)
{
	// Locate the storeArea div's
	var posOpeningDiv = original.indexOf(startSaveArea);
	var limitClosingDiv = original.indexOf("<"+"!--POST-STOREAREA--"+">");
	if(limitClosingDiv == -1)
		limitClosingDiv = original.indexOf("<"+"!--POST-BODY-START--"+">");
	var posClosingDiv = original.lastIndexOf(endSaveArea,limitClosingDiv == -1 ? original.length : limitClosingDiv);
	return (posOpeningDiv != -1 && posClosingDiv != -1) ? [posOpeningDiv,posClosingDiv] : null;
}

function autoSaveChanges(onlyIfDirty,tiddlers)
{
	if(config.options.chkAutoSave)
		saveChanges(onlyIfDirty,tiddlers);
}

function loadOriginal(localPath)
{
	return loadFile(localPath);
}

// Save this tiddlywiki with the pending changes
function saveChanges(onlyIfDirty,tiddlers)
{
	if(onlyIfDirty && !store.isDirty())
		return;
	clearMessage();
	var t0 = new Date();
	var originalPath = document.location.toString();
	if(originalPath.substr(0,5) != "file:") {
		alert(config.messages.notFileUrlError);
		if(store.tiddlerExists(config.messages.saveInstructions))
			story.displayTiddler(null,config.messages.saveInstructions);
		return;
	}
	var localPath = getLocalPath(originalPath);
	var original = loadOriginal(localPath);
	if(original == null) {
		alert(config.messages.cantSaveError);
		if(store.tiddlerExists(config.messages.saveInstructions))
			story.displayTiddler(null,config.messages.saveInstructions);
		return;
	}
	var posDiv = locateStoreArea(original);
	if(!posDiv) {
		alert(config.messages.invalidFileError.format([localPath]));
		return;
	}
	saveMain(localPath,original,posDiv);
	if(config.options.chkSaveBackups)
		saveBackup(localPath,original);
	if(config.options.chkSaveEmptyTemplate)
		saveEmpty(localPath,original,posDiv);
	if(config.options.chkGenerateAnRssFeed && saveRss instanceof Function)
		saveRss(localPath);
	if(config.options.chkDisplayInstrumentation)
		displayMessage("saveChanges " + (new Date()-t0) + " ms");
}

function saveMain(localPath,original,posDiv)
{
	var save;
	try {
		var revised = updateOriginal(original,posDiv,localPath);
		save = saveFile(localPath,revised);
	} catch (ex) {
		showException(ex);
	}
	if(save) {
		displayMessage(config.messages.mainSaved,"file://" + localPath);
		store.setDirty(false);
	} else {
		alert(config.messages.mainFailed);
	}
}

function saveBackup(localPath,original)
{
	var backupPath = getBackupPath(localPath);
	var backup = copyFile(backupPath,localPath);
	if(!backup)
		backup = saveFile(backupPath,original);
	if(backup)
		displayMessage(config.messages.backupSaved,"file://" + backupPath);
	else
		alert(config.messages.backupFailed);
}

function saveEmpty(localPath,original,posDiv)
{
	var emptyPath,p;
	if((p = localPath.lastIndexOf("/")) != -1)
		emptyPath = localPath.substr(0,p) + "/";
	else if((p = localPath.lastIndexOf("\\")) != -1)
		emptyPath = localPath.substr(0,p) + "\\";
	else
		emptyPath = localPath + ".";
	emptyPath += "empty.html";
	var empty = original.substr(0,posDiv[0] + startSaveArea.length) + original.substr(posDiv[1]);
	var emptySave = saveFile(emptyPath,empty);
	if(emptySave)
		displayMessage(config.messages.emptySaved,"file://" + emptyPath);
	else
		alert(config.messages.emptyFailed);
}

function getLocalPath(origPath)
{
	var originalPath = convertUriToUTF8(origPath,config.options.txtFileSystemCharSet);
	// Remove any location or query part of the URL
	var argPos = originalPath.indexOf("?");
	if(argPos != -1)
		originalPath = originalPath.substr(0,argPos);
	var hashPos = originalPath.indexOf("#");
	if(hashPos != -1)
		originalPath = originalPath.substr(0,hashPos);
	// Convert file://localhost/ to file:///
	if(originalPath.indexOf("file://localhost/") == 0)
		originalPath = "file://" + originalPath.substr(16);
	// Convert to a native file format
	var localPath;
	if(originalPath.charAt(9) == ":") // pc local file
		localPath = unescape(originalPath.substr(8)).replace(new RegExp("/","g"),"\\");
	else if(originalPath.indexOf("file://///") == 0) // FireFox pc network file
		localPath = "\\\\" + unescape(originalPath.substr(10)).replace(new RegExp("/","g"),"\\");
	else if(originalPath.indexOf("file:///") == 0) // mac/unix local file
		localPath = unescape(originalPath.substr(7));
	else if(originalPath.indexOf("file:/") == 0) // mac/unix local file
		localPath = unescape(originalPath.substr(5));
	else // pc network file
		localPath = "\\\\" + unescape(originalPath.substr(7)).replace(new RegExp("/","g"),"\\");
	return localPath;
}

function getBackupPath(localPath,title,extension)
{
	var slash = "\\";
	var dirPathPos = localPath.lastIndexOf("\\");
	if(dirPathPos == -1) {
		dirPathPos = localPath.lastIndexOf("/");
		slash = "/";
	}
	var backupFolder = config.options.txtBackupFolder;
	if(!backupFolder || backupFolder == "")
		backupFolder = ".";
	var backupPath = localPath.substr(0,dirPathPos) + slash + backupFolder + localPath.substr(dirPathPos);
	backupPath = backupPath.substr(0,backupPath.lastIndexOf(".")) + ".";
	if(title)
		backupPath += title.replace(/[\\\/\*\?\":<> ]/g,"_") + ".";
	backupPath += (new Date()).convertToYYYYMMDDHHMMSSMMM() + "." + (extension || "html");
	return backupPath;
}

//--
//-- RSS Saving
//--

function saveRss(localPath)
{
	var rssPath = localPath.substr(0,localPath.lastIndexOf(".")) + ".xml";
	if(saveFile(rssPath,convertUnicodeToFileFormat(generateRss())))
		displayMessage(config.messages.rssSaved,"file://" + rssPath);
	else
		alert(config.messages.rssFailed);
}

tiddlerToRssItem = function(tiddler,uri)
{
	var s = "<title" + ">" + tiddler.title.htmlEncode() + "</title" + ">\n";
	s += "<description>" + wikifyStatic(tiddler.text,null,tiddler).htmlEncode() + "</description>\n";
	for(var i=0; i<tiddler.tags.length; i++)
		s += "<category>" + tiddler.tags[i] + "</category>\n";
	s += "<link>" + uri + "#" + encodeURIComponent(String.encodeTiddlyLink(tiddler.title)) + "</link>\n";
	s +="<pubDate>" + tiddler.modified.toGMTString() + "</pubDate>\n";
	return s;
};

function generateRss()
{
	var s = [];
	var d = new Date();
	var u = store.getTiddlerText("SiteUrl");
	// Assemble the header
	s.push("<" + "?xml version=\"1.0\"?" + ">");
	s.push("<rss version=\"2.0\">");
	s.push("<channel>");
	s.push("<title" + ">" + wikifyPlain("SiteTitle").htmlEncode() + "</title" + ">");
	if(u)
		s.push("<link>" + u.htmlEncode() + "</link>");
	s.push("<description>" + wikifyPlain("SiteSubtitle").htmlEncode() + "</description>");
	s.push("<language>" + config.locale + "</language>");
	s.push("<copyright>Copyright " + d.getFullYear() + " " + config.options.txtUserName.htmlEncode() + "</copyright>");
	s.push("<pubDate>" + d.toGMTString() + "</pubDate>");
	s.push("<lastBuildDate>" + d.toGMTString() + "</lastBuildDate>");
	s.push("<docs>http://blogs.law.harvard.edu/tech/rss</docs>");
	s.push("<generator>TiddlyWiki " + formatVersion() + "</generator>");
	// The body
	var tiddlers = store.getTiddlers("modified","excludeLists");
	var n = config.numRssItems > tiddlers.length ? 0 : tiddlers.length-config.numRssItems;
	for(var i=tiddlers.length-1; i>=n; i--) {
		s.push("<item>\n" + tiddlerToRssItem(tiddlers[i],u) + "\n</item>");
	}
	// And footer
	s.push("</channel>");
	s.push("</rss>");
	// Save it all
	return s.join("\n");
}

//--
//-- Filesystem code
//--

function convertUTF8ToUnicode(u)
{
	return config.browser.isOpera || !window.netscape ? manualConvertUTF8ToUnicode(u) : mozConvertUTF8ToUnicode(u);
}

function manualConvertUTF8ToUnicode(utf)
{
	var uni = utf;
	var src = 0;
	var dst = 0;
	var b1, b2, b3;
	var c;
	while(src < utf.length) {
		b1 = utf.charCodeAt(src++);
		if(b1 < 0x80) {
			dst++;
		} else if(b1 < 0xE0) {
			b2 = utf.charCodeAt(src++);
			c = String.fromCharCode(((b1 & 0x1F) << 6) | (b2 & 0x3F));
			uni = uni.substring(0,dst++).concat(c,utf.substr(src));
		} else {
			b2 = utf.charCodeAt(src++);
			b3 = utf.charCodeAt(src++);
			c = String.fromCharCode(((b1 & 0xF) << 12) | ((b2 & 0x3F) << 6) | (b3 & 0x3F));
			uni = uni.substring(0,dst++).concat(c,utf.substr(src));
		}
	}
	return uni;
}

function mozConvertUTF8ToUnicode(u)
{
	try {
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		var converter = Components.classes["@mozilla.org/intl/scriptableunicodeconverter"].createInstance(Components.interfaces.nsIScriptableUnicodeConverter);
		converter.charset = "UTF-8";
	} catch(ex) {
		return manualConvertUTF8ToUnicode(u);
	} // fallback
	var s = converter.ConvertToUnicode(u);
	var fin = converter.Finish();
	return fin.length > 0 ? s+fin : s;
}

function convertUnicodeToFileFormat(s)
{
	if(!config.browser.isIE)
		return s;
	else
		return convertUnicodeToHtmlEntities(s);
}

function convertUnicodeToHtmlEntities(s)
{
	var re = /[^\u0000-\u007F]/g;
	return s.replace(re,function($0) {return "&#" + $0.charCodeAt(0).toString() + ";";});
}

function convertUnicodeToUTF8(s)
{
// return convertUnicodeToFileFormat to allow plugin migration
	return convertUnicodeToFileFormat(s);
}

function manualConvertUnicodeToUTF8(s)
{
	return unescape(encodeURIComponent(s));
}

function mozConvertUnicodeToUTF8(s)
{
	try {
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		var converter = Components.classes["@mozilla.org/intl/scriptableunicodeconverter"].createInstance(Components.interfaces.nsIScriptableUnicodeConverter);
		converter.charset = "UTF-8";
	} catch(ex) {
		return manualConvertUnicodeToUTF8(s);
	} // fallback
	var u = converter.ConvertFromUnicode(s);
	var fin = converter.Finish();
	return fin.length > 0 ? u + fin : u;
}

function convertUriToUTF8(uri,charSet)
{
	if(window.netscape == undefined || charSet == undefined || charSet == "")
		return uri;
	try {
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		var converter = Components.classes["@mozilla.org/intl/utf8converterservice;1"].getService(Components.interfaces.nsIUTF8ConverterService);
	} catch(ex) {
		return uri;
	}
	return converter.convertURISpecToUTF8(uri,charSet);
}

//--
//-- Server adaptor base class
//--

function AdaptorBase()
{
	this.host = null;
	this.store = null;
	return this;
}

AdaptorBase.prototype.close = function()
{
	return true;
};

AdaptorBase.prototype.fullHostName = function(host)
{
	if(!host)
		return '';
	host = host.trim();
	if(!host.match(/:\/\//))
		host = 'http://' + host;
	if(host.substr(host.length-1) == '/')
		host = host.substr(0,host.length-1);
	return host;
};

AdaptorBase.minHostName = function(host)
{
	return host ? host.replace(/^http:\/\//,'').replace(/\/$/,'') : '';
};

AdaptorBase.prototype.setContext = function(context,userParams,callback)
{
	if(!context) context = {};
	context.userParams = userParams;
	if(callback) context.callback = callback;
	context.adaptor = this;
	if(!context.host)
		context.host = this.host;
	context.host = this.fullHostName(context.host);
	if(!context.workspace)
		context.workspace = this.workspace;
	return context;
};

// Open the specified host
AdaptorBase.prototype.openHost = function(host,context,userParams,callback)
{
	this.host = host;
	context = this.setContext(context,userParams,callback);
	context.status = true;
	if(callback)
		window.setTimeout(function() {context.callback(context,userParams);},10);
	return true;
};

// Open the specified workspace
AdaptorBase.prototype.openWorkspace = function(workspace,context,userParams,callback)
{
	this.workspace = workspace;
	context = this.setContext(context,userParams,callback);
	context.status = true;
	if(callback)
		window.setTimeout(function() {callback(context,userParams);},10);
	return true;
};

//--
//-- Server adaptor for talking to static TiddlyWiki files
//--

function FileAdaptor()
{
}

FileAdaptor.prototype = new AdaptorBase();

FileAdaptor.serverType = 'file';
FileAdaptor.serverLabel = 'TiddlyWiki';

FileAdaptor.loadTiddlyWikiCallback = function(status,context,responseText,url,xhr)
{
	context.status = status;
	if(!status) {
		context.statusText = "Error reading file";
	} else {
		context.adaptor.store = new TiddlyWiki();
		if(!context.adaptor.store.importTiddlyWiki(responseText)) {
			context.statusText = config.messages.invalidFileError.format([url]);
			context.status = false;
		}
	}
	context.complete(context,context.userParams);
};

// Get the list of workspaces on a given server
FileAdaptor.prototype.getWorkspaceList = function(context,userParams,callback)
{
	context = this.setContext(context,userParams,callback);
	context.workspaces = [{title:"(default)"}];
	context.status = true;
	if(callback)
		window.setTimeout(function() {callback(context,userParams);},10);
	return true;
};

// Gets the list of tiddlers within a given workspace
FileAdaptor.prototype.getTiddlerList = function(context,userParams,callback,filter)
{
	context = this.setContext(context,userParams,callback);
	if(!context.filter)
		context.filter = filter;
	context.complete = FileAdaptor.getTiddlerListComplete;
	if(this.store) {
		var ret = context.complete(context,context.userParams);
	} else {
		ret = loadRemoteFile(context.host,FileAdaptor.loadTiddlyWikiCallback,context);
		if(typeof ret != "string")
			ret = true;
	}
	return ret;
};

FileAdaptor.getTiddlerListComplete = function(context,userParams)
{
	if(context.status) {
		if(context.filter) {
			context.tiddlers = context.adaptor.store.filterTiddlers(context.filter);
		} else {
			context.tiddlers = [];
			context.adaptor.store.forEachTiddler(function(title,tiddler) {context.tiddlers.push(tiddler);});
		}
		for(var i=0; i<context.tiddlers.length; i++) {
			context.tiddlers[i].fields['server.type'] = FileAdaptor.serverType;
			context.tiddlers[i].fields['server.host'] = AdaptorBase.minHostName(context.host);
			context.tiddlers[i].fields['server.page.revision'] = context.tiddlers[i].modified.convertToYYYYMMDDHHMM();
		}
		context.status = true;
	}
	if(context.callback) {
		window.setTimeout(function() {context.callback(context,userParams);},10);
	}
	return true;
};

FileAdaptor.prototype.generateTiddlerInfo = function(tiddler)
{
	var info = {};
	info.uri = tiddler.fields['server.host'] + "#" + tiddler.title;
	return info;
};

// Retrieve a tiddler from a given workspace on a given server
FileAdaptor.prototype.getTiddler = function(title,context,userParams,callback)
{
	context = this.setContext(context,userParams,callback);
	context.title = title;
	context.complete = FileAdaptor.getTiddlerComplete;
	return context.adaptor.store ?
		context.complete(context,context.userParams) :
		loadRemoteFile(context.host,FileAdaptor.loadTiddlyWikiCallback,context);
};

FileAdaptor.getTiddlerComplete = function(context,userParams)
{
	var t = context.adaptor.store.fetchTiddler(context.title);
	t.fields['server.type'] = FileAdaptor.serverType;
	t.fields['server.host'] = AdaptorBase.minHostName(context.host);
	t.fields['server.page.revision'] = t.modified.convertToYYYYMMDDHHMM();
	context.tiddler = t;
	context.status = true;
	if(context.allowSynchronous) {
		context.isSynchronous = true;
		context.callback(context,userParams);
	} else {
		window.setTimeout(function() {context.callback(context,userParams);},10);
	}
	return true;
};

FileAdaptor.prototype.close = function()
{
	delete this.store;
	this.store = null;
};

config.adaptors[FileAdaptor.serverType] = FileAdaptor;

config.defaultAdaptor = FileAdaptor.serverType;

//--
//-- HTTP request code
//--

function ajaxReq(args)
{
	if(window.Components && window.netscape && window.netscape.security && document.location.protocol.indexOf("http") == -1)
		window.netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
	return jQuery.ajax(args);
}

//--
//-- TiddlyWiki-specific utility functions
//--

// Returns TiddlyWiki version string
function formatVersion(v)
{
	v = v || version;
	return v.major + "." + v.minor + "." + v.revision +
		(v.alpha ? " (alpha " + v.alpha + ")" : "") +
		(v.beta ? " (beta " + v.beta + ")" : "");
}

function compareVersions(v1,v2)
{
	var a = ["major","minor","revision"];
	for(var i = 0; i<a.length; i++) {
		var x1 = v1[a[i]] || 0;
		var x2 = v2[a[i]] || 0;
		if(x1<x2)
			return 1;
		if(x1>x2)
			return -1;
	}
	x1 = v1.beta || 9999;
	x2 = v2.beta || 9999;
	if(x1<x2)
		return 1;
	return x1 > x2 ? -1 : 0;
}

function createTiddlyButton(parent,text,tooltip,action,className,id,accessKey,attribs)
{
	var btn = document.createElement("a");
	if(action) {
		btn.onclick = action;
		btn.setAttribute("href","javascript:;");
	}
	if(tooltip)
		btn.setAttribute("title",tooltip);
	if(text)
		btn.appendChild(document.createTextNode(text));
	btn.className = className || "button";
	if(id)
		btn.id = id;
	if(attribs) {
		for(var i in attribs) {
			btn.setAttribute(i,attribs[i]);
		}
	}
	if(parent)
		parent.appendChild(btn);
	if(accessKey)
		btn.setAttribute("accessKey",accessKey);
	return btn;
}

function createTiddlyLink(place,title,includeText,className,isStatic,linkedFromTiddler,noToggle)
{
	var text = includeText ? title : null;
	var i = getTiddlyLinkInfo(title,className);
	var btn = isStatic ? createExternalLink(place,store.getTiddlerText("SiteUrl",null) + "#" + title) : createTiddlyButton(place,text,i.subTitle,onClickTiddlerLink,i.classes);
	if(isStatic)
		btn.className += ' ' + className;
	btn.setAttribute("refresh","link");
	btn.setAttribute("tiddlyLink",title);
	if(noToggle)
		btn.setAttribute("noToggle","true");
	if(linkedFromTiddler) {
		var fields = linkedFromTiddler.getInheritedFields();
		if(fields)
			btn.setAttribute("tiddlyFields",fields);
	}
	return btn;
}

function refreshTiddlyLink(e,title)
{
	var i = getTiddlyLinkInfo(title,e.className);
	e.className = i.classes;
	e.title = i.subTitle;
}

function getTiddlyLinkInfo(title,currClasses)
{
	var classes = currClasses ? currClasses.split(" ") : [];
	classes.pushUnique("tiddlyLink");
	var tiddler = store.fetchTiddler(title);
	var subTitle;
	if(tiddler) {
		subTitle = tiddler.getSubtitle();
		classes.pushUnique("tiddlyLinkExisting");
		classes.remove("tiddlyLinkNonExisting");
		classes.remove("shadow");
	} else {
		classes.remove("tiddlyLinkExisting");
		classes.pushUnique("tiddlyLinkNonExisting");
		if(store.isShadowTiddler(title)) {
			subTitle = config.messages.shadowedTiddlerToolTip.format([title]);
			classes.pushUnique("shadow");
		} else {
			subTitle = config.messages.undefinedTiddlerToolTip.format([title]);
			classes.remove("shadow");
		}
	}
	if(typeof config.annotations[title]=="string")
		subTitle = config.annotations[title];
	return {classes: classes.join(" "),subTitle: subTitle};
}

function createExternalLink(place,url)
{
	var link = document.createElement("a");
	link.className = "externalLink";
	link.href = url;
	link.title = config.messages.externalLinkTooltip.format([url]);
	if(config.options.chkOpenInNewWindow)
		link.target = "_blank";
	place.appendChild(link);
	return link;
}

// Event handler for clicking on a tiddly link
function onClickTiddlerLink(ev)
{
	var e = ev || window.event;
	var target = resolveTarget(e);
	var link = target;
	var title = null;
	var fields = null;
	var noToggle = null;
	do {
		title = link.getAttribute("tiddlyLink");
		fields = link.getAttribute("tiddlyFields");
		noToggle = link.getAttribute("noToggle");
		link = link.parentNode;
	} while(title == null && link != null);
	if(!store.isShadowTiddler(title)) {
		var f = fields ? fields.decodeHashMap() : {};
		fields = String.encodeHashMap(merge(f,config.defaultCustomFields,true));
	}
	if(title) {
		var toggling = e.metaKey || e.ctrlKey;
		if(config.options.chkToggleLinks)
			toggling = !toggling;
		if(noToggle)
			toggling = false;
		if(store.getTiddler(title))
			fields = null;
		story.displayTiddler(target,title,null,true,null,fields,toggling);
	}
	clearMessage();
	return false;
}

// Create a button for a tag with a popup listing all the tiddlers that it tags
function createTagButton(place,tag,excludeTiddler,title,tooltip)
{
	var btn = createTiddlyButton(place,title||tag,(tooltip||config.views.wikified.tag.tooltip).format([tag]),onClickTag);
	btn.setAttribute("tag",tag);
	if(excludeTiddler)
		btn.setAttribute("tiddler",excludeTiddler);
	return btn;
}

// Event handler for clicking on a tiddler tag
function onClickTag(ev)
{
	var e = ev || window.event;
	var popup = Popup.create(this);
	var tag = this.getAttribute("tag");
	var title = this.getAttribute("tiddler");
	if(popup && tag) {
		var tagged = store.getTaggedTiddlers(tag);
		var titles = [];
		var li,r;
		for(r=0;r<tagged.length;r++) {
			if(tagged[r].title != title)
				titles.push(tagged[r].title);
		}
		var lingo = config.views.wikified.tag;
		if(titles.length > 0) {
			var openAll = createTiddlyButton(createTiddlyElement(popup,"li"),lingo.openAllText.format([tag]),lingo.openAllTooltip,onClickTagOpenAll);
			openAll.setAttribute("tag",tag);
			createTiddlyElement(createTiddlyElement(popup,"li",null,"listBreak"),"div");
			for(r=0; r<titles.length; r++) {
				createTiddlyLink(createTiddlyElement(popup,"li"),titles[r],true);
			}
		} else {
			createTiddlyElement(popup,"li",null,"disabled",lingo.popupNone.format([tag]));
		}
		createTiddlyElement(createTiddlyElement(popup,"li",null,"listBreak"),"div");
		var h = createTiddlyLink(createTiddlyElement(popup,"li"),tag,false);
		createTiddlyText(h,lingo.openTag.format([tag]));
	}
	Popup.show();
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	return false;
}

// Event handler for 'open all' on a tiddler popup
function onClickTagOpenAll(ev)
{
	var tiddlers = store.getTaggedTiddlers(this.getAttribute("tag"));
	story.displayTiddlers(this,tiddlers);
	return false;
}

function onClickError(ev)
{
	var e = ev || window.event;
	var popup = Popup.create(this);
	var lines = this.getAttribute("errorText").split("\n");
	for(var t=0; t<lines.length; t++)
		createTiddlyElement(popup,"li",null,null,lines[t]);
	Popup.show();
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	return false;
}

function createTiddlyDropDown(place,onchange,options,defaultValue)
{
	var sel = createTiddlyElement(place,"select");
	sel.onchange = onchange;
	for(var t=0; t<options.length; t++) {
		var e = createTiddlyElement(sel,"option",null,null,options[t].caption);
		e.value = options[t].name;
		if(options[t].name == defaultValue)
			e.selected = true;
	}
	return sel;
}

function createTiddlyPopup(place,caption,tooltip,tiddler)
{
	if(tiddler.text) {
		createTiddlyLink(place,caption,true);
		var btn = createTiddlyButton(place,glyph("downArrow"),tooltip,onClickTiddlyPopup,"tiddlerPopupButton");
		btn.tiddler = tiddler;
	} else {
		createTiddlyText(place,caption);
	}
}

function onClickTiddlyPopup(ev)
{
	var e = ev || window.event;
	var tiddler = this.tiddler;
	if(tiddler.text) {
		var popup = Popup.create(this,"div","popupTiddler");
		wikify(tiddler.text,popup,null,tiddler);
		Popup.show();
	}
	if(e) e.cancelBubble = true;
	if(e && e.stopPropagation) e.stopPropagation();
	return false;
}

function createTiddlyError(place,title,text)
{
	var btn = createTiddlyButton(place,title,null,onClickError,"errorButton");
	if(text) btn.setAttribute("errorText",text);
}

function merge(dst,src,preserveExisting)
{
	for(var i in src) {
		if(!preserveExisting || dst[i] === undefined)
			dst[i] = src[i];
	}
	return dst;
}

// Returns a string containing the description of an exception, optionally prepended by a message
function exceptionText(e,message)
{
	var s = e.description || e.toString();
	return message ? "%0:\n%1".format([message,s]) : s;
}

// Displays an alert of an exception description with optional message
function showException(e,message)
{
	alert(exceptionText(e,message));
}

function alertAndThrow(m)
{
	alert(m);
	throw(m);
}

function glyph(name)
{
	var g = config.glyphs;
	var b = g.currBrowser;
	if(b == null) {
		b = 0;
		while(!g.browsers[b]() && b < g.browsers.length-1)
			b++;
		g.currBrowser = b;
	}
	if(!g.codes[name])
		return "";
	return g.codes[name][b];
}

if(!window.console) {
	console = {tiddlywiki:true,log:function(message) {displayMessage(message);}};
}

//-
//- Animation engine
//-

function Animator()
{
	this.running = 0; // Incremented at start of each animation, decremented afterwards. If zero, the interval timer is disabled
	this.timerID = 0; // ID of the timer used for animating
	this.animations = []; // List of animations in progress
	return this;
}

// Start animation engine
Animator.prototype.startAnimating = function() //# Variable number of arguments
{
	for(var t=0; t<arguments.length; t++)
		this.animations.push(arguments[t]);
	if(this.running == 0) {
		var me = this;
		this.timerID = window.setInterval(function() {me.doAnimate(me);},10);
	}
	this.running += arguments.length;
};

// Perform an animation engine tick, calling each of the known animation modules
Animator.prototype.doAnimate = function(me)
{
	var a = 0;
	while(a < me.animations.length) {
		var animation = me.animations[a];
		if(animation.tick()) {
			a++;
		} else {
			me.animations.splice(a,1);
			if(--me.running == 0)
				window.clearInterval(me.timerID);
		}
	}
};

Animator.slowInSlowOut = function(progress)
{
	return(1-((Math.cos(progress * Math.PI)+1)/2));
};

//--
//-- Morpher animation
//--

// Animate a set of properties of an element
function Morpher(element,duration,properties,callback)
{
	this.element = element;
	this.duration = duration;
	this.properties = properties;
	this.startTime = new Date();
	this.endTime = Number(this.startTime) + duration;
	this.callback = callback;
	this.tick();
	return this;
}

Morpher.prototype.assignStyle = function(element,style,value)
{
	switch(style) {
	case "-tw-vertScroll":
		window.scrollTo(findScrollX(),value);
		break;
	case "-tw-horizScroll":
		window.scrollTo(value,findScrollY());
		break;
	default:
		element.style[style] = value;
		break;
	}
};

Morpher.prototype.stop = function()
{
	for(var t=0; t<this.properties.length; t++) {
		var p = this.properties[t];
		if(p.atEnd !== undefined) {
			this.assignStyle(this.element,p.style,p.atEnd);
		}
	}
	if(this.callback)
		this.callback(this.element,this.properties);
};

Morpher.prototype.tick = function()
{
	var currTime = Number(new Date());
	var progress = Animator.slowInSlowOut(Math.min(1,(currTime-this.startTime)/this.duration));
	for(var t=0; t<this.properties.length; t++) {
		var p = this.properties[t];
		if(p.start !== undefined && p.end !== undefined) {
			var template = p.template || "%0";
			switch(p.format) {
			case undefined:
			case "style":
				var v = p.start + (p.end-p.start) * progress;
				this.assignStyle(this.element,p.style,template.format([v]));
				break;
			case "color":
				break;
			}
		}
	}
	if(currTime >= this.endTime) {
		this.stop();
		return false;
	}
	return true;
};

//--
//-- Zoomer animation
//--

function Zoomer(text,startElement,targetElement,unused)
{
	var e = createTiddlyElement(document.body,"div",null,"zoomer");
	createTiddlyElement(e,"div",null,null,text);
	var winWidth = findWindowWidth();
	var winHeight = findWindowHeight();
	var p = [
		{style: 'left', start: findPosX(startElement), end: findPosX(targetElement), template: '%0px'},
		{style: 'top', start: findPosY(startElement), end: findPosY(targetElement), template: '%0px'},
		{style: 'width', start: Math.min(startElement.scrollWidth,winWidth), end: Math.min(targetElement.scrollWidth,winWidth), template: '%0px', atEnd: 'auto'},
		{style: 'height', start: Math.min(startElement.scrollHeight,winHeight), end: Math.min(targetElement.scrollHeight,winHeight), template: '%0px', atEnd: 'auto'},
		{style: 'fontSize', start: 8, end: 24, template: '%0pt'}
	];
	var c = function(element,properties) {removeNode(element);};
	return new Morpher(e,config.animDuration,p,c);
}

//--
//-- Scroller animation
//--

function Scroller(targetElement)
{
	var p = [{style: '-tw-vertScroll', start: findScrollY(), end: ensureVisible(targetElement)}];
	return new Morpher(targetElement,config.animDuration,p);
}

//--
//-- Slider animation
//--

// deleteMode - "none", "all" [delete target element and it's children], [only] "children" [but not the target element]
function Slider(element,opening,unused,deleteMode)
{
	element.style.overflow = 'hidden';
	if(opening)
		element.style.height = '0px'; // Resolves a Firefox flashing bug
	element.style.display = 'block';
	var left = findPosX(element);
	var width = element.scrollWidth;
	var height = element.scrollHeight;
	var winWidth = findWindowWidth();
	var p = [];
	var c = null;
	if(opening) {
		p.push({style: 'height', start: 0, end: height, template: '%0px', atEnd: 'auto'});
		p.push({style: 'opacity', start: 0, end: 1, template: '%0'});
		p.push({style: 'filter', start: 0, end: 100, template: 'alpha(opacity:%0)'});
	} else {
		p.push({style: 'height', start: height, end: 0, template: '%0px'});
		p.push({style: 'display', atEnd: 'none'});
		p.push({style: 'opacity', start: 1, end: 0, template: '%0'});
		p.push({style: 'filter', start: 100, end: 0, template: 'alpha(opacity:%0)'});
		switch(deleteMode) {
		case "all":
			c = function(element,properties) {removeNode(element);};
			break;
		case "children":
			c = function(element,properties) {removeChildren(element);};
			break;
		}
	}
	return new Morpher(element,config.animDuration,p,c);
}

//--
//-- Popup menu
//--

var Popup = {
	stack: [] // Array of objects with members root: and popup:
	};

Popup.create = function(root,elem,className)
{
	var stackPosition = this.find(root,"popup");
	Popup.remove(stackPosition+1);
	var popup = createTiddlyElement(document.body,elem || "ol","popup",className || "popup");
	popup.stackPosition = stackPosition;
	Popup.stack.push({root: root, popup: popup});
	return popup;
};

Popup.onDocumentClick = function(ev)
{
	var e = ev || window.event;
	if(e.eventPhase == undefined)
		Popup.remove();
	else if(e.eventPhase == Event.BUBBLING_PHASE || e.eventPhase == Event.AT_TARGET)
		Popup.remove();
	return true;
};

Popup.show = function(valign,halign,offset)
{
	var curr = Popup.stack[Popup.stack.length-1];
	this.place(curr.root,curr.popup,valign,halign,offset);
	addClass(curr.root,"highlight");
	if(config.options.chkAnimate && anim && typeof Scroller == "function")
		anim.startAnimating(new Scroller(curr.popup));
	else
		window.scrollTo(0,ensureVisible(curr.popup));
};

Popup.place = function(root,popup,valign,halign,offset)
{
	if(!offset)
		var offset = {x:0,y:0};
	if(popup.stackPosition >= 0 && !valign && !halign) {
		offset.x = offset.x + root.offsetWidth;
	} else {
		offset.x = (halign == "right") ? offset.x + root.offsetWidth : offset.x;
		offset.y = (valign == "top") ? offset.y : offset.y + root.offsetHeight;
	}
	var rootLeft = findPosX(root);
	var rootTop = findPosY(root);
	var popupLeft = rootLeft + offset.x;
	var popupTop = rootTop + offset.y;
	var winWidth = findWindowWidth();
	if(popup.offsetWidth > winWidth*0.75)
		popup.style.width = winWidth*0.75 + "px";
	var popupWidth = popup.offsetWidth;
	var scrollWidth = winWidth - document.body.offsetWidth;
	if(popupLeft + popupWidth > winWidth - scrollWidth - 1) {
		if(halign == "right")
			popupLeft = popupLeft - root.offsetWidth - popupWidth;
		else
			popupLeft = winWidth - popupWidth - scrollWidth - 1;
	}
	popup.style.left = popupLeft + "px";
	popup.style.top = popupTop + "px";
	popup.style.display = "block";
};

Popup.find = function(e)
{
	var pos = -1;
	for (var t=this.stack.length-1; t>=0; t--) {
		if(isDescendant(e,this.stack[t].popup))
			pos = t;
	}
	return pos;
};

Popup.remove = function(pos)
{
	if(!pos) var pos = 0;
	if(Popup.stack.length > pos) {
		Popup.removeFrom(pos);
	}
};

Popup.removeFrom = function(from)
{
	for(var t=Popup.stack.length-1; t>=from; t--) {
		var p = Popup.stack[t];
		removeClass(p.root,"highlight");
		removeNode(p.popup);
	}
	Popup.stack = Popup.stack.slice(0,from);
};

//--
//-- Wizard support
//--

function Wizard(elem)
{
	if(elem) {
		this.formElem = findRelated(elem,"wizard","className");
		this.bodyElem = findRelated(this.formElem.firstChild,"wizardBody","className","nextSibling");
		this.footElem = findRelated(this.formElem.firstChild,"wizardFooter","className","nextSibling");
	} else {
		this.formElem = null;
		this.bodyElem = null;
		this.footElem = null;
	}
}

Wizard.prototype.setValue = function(name,value)
{
	if(this.formElem)
		this.formElem[name] = value;
};

Wizard.prototype.getValue = function(name)
{
	return this.formElem ? this.formElem[name] : null;
};

Wizard.prototype.createWizard = function(place,title)
{
	this.formElem = createTiddlyElement(place,"form",null,"wizard");
	createTiddlyElement(this.formElem,"h1",null,null,title);
	this.bodyElem = createTiddlyElement(this.formElem,"div",null,"wizardBody");
	this.footElem = createTiddlyElement(this.formElem,"div",null,"wizardFooter");
};

Wizard.prototype.clear = function()
{
	removeChildren(this.bodyElem);
};

Wizard.prototype.setButtons = function(buttonInfo,status)
{
	removeChildren(this.footElem);
	for(var t=0; t<buttonInfo.length; t++) {
		createTiddlyButton(this.footElem,buttonInfo[t].caption,buttonInfo[t].tooltip,buttonInfo[t].onClick);
		insertSpacer(this.footElem);
		}
	if(typeof status == "string") {
		createTiddlyElement(this.footElem,"span",null,"status",status);
	}
};

Wizard.prototype.addStep = function(stepTitle,html)
{
	removeChildren(this.bodyElem);
	var w = createTiddlyElement(this.bodyElem,"div");
	createTiddlyElement(w,"h2",null,null,stepTitle);
	var step = createTiddlyElement(w,"div",null,"wizardStep");
	step.innerHTML = html;
	applyHtmlMacros(step,tiddler);
};

Wizard.prototype.getElement = function(name)
{
	return this.formElem.elements[name];
};

//--
//-- ListView gadget
//--

var ListView = {};

// Create a listview
ListView.create = function(place,listObject,listTemplate,callback,className)
{
	var table = createTiddlyElement(place,"table",null,className || "listView twtable");
	var thead = createTiddlyElement(table,"thead");
	var r = createTiddlyElement(thead,"tr");
	for(var t=0; t<listTemplate.columns.length; t++) {
		var columnTemplate = listTemplate.columns[t];
		var c = createTiddlyElement(r,"th");
		var colType = ListView.columnTypes[columnTemplate.type];
		if(colType && colType.createHeader) {
			colType.createHeader(c,columnTemplate,t);
			if(columnTemplate.className)
				addClass(c,columnTemplate.className);
		}
	}
	var tbody = createTiddlyElement(table,"tbody");
	for(var rc=0; rc<listObject.length; rc++) {
		var rowObject = listObject[rc];
		r = createTiddlyElement(tbody,"tr");
		for(c=0; c<listTemplate.rowClasses.length; c++) {
			if(rowObject[listTemplate.rowClasses[c].field])
				addClass(r,listTemplate.rowClasses[c].className);
		}
		rowObject.rowElement = r;
		rowObject.colElements = {};
		for(var cc=0; cc<listTemplate.columns.length; cc++) {
			c = createTiddlyElement(r,"td");
			columnTemplate = listTemplate.columns[cc];
			var field = columnTemplate.field;
			colType = ListView.columnTypes[columnTemplate.type];
			if(colType && colType.createItem) {
				colType.createItem(c,rowObject,field,columnTemplate,cc,rc);
				if(columnTemplate.className)
					addClass(c,columnTemplate.className);
			}
			rowObject.colElements[field] = c;
		}
	}
	if(callback && listTemplate.actions)
		createTiddlyDropDown(place,ListView.getCommandHandler(callback),listTemplate.actions);
	if(callback && listTemplate.buttons) {
		for(t=0; t<listTemplate.buttons.length; t++) {
			var a = listTemplate.buttons[t];
			if(a && a.name != "")
				createTiddlyButton(place,a.caption,null,ListView.getCommandHandler(callback,a.name,a.allowEmptySelection));
		}
	}
	return table;
};

ListView.getCommandHandler = function(callback,name,allowEmptySelection)
{
	return function(e) {
		var view = findRelated(this,"TABLE",null,"previousSibling");
		var tiddlers = [];
		ListView.forEachSelector(view,function(e,rowName) {
					if(e.checked)
						tiddlers.push(rowName);
					});
		if(tiddlers.length == 0 && !allowEmptySelection) {
			alert(config.messages.nothingSelected);
		} else {
			if(this.nodeName.toLowerCase() == "select") {
				callback(view,this.value,tiddlers);
				this.selectedIndex = 0;
			} else {
				callback(view,name,tiddlers);
			}
		}
	};
};

// Invoke a callback for each selector checkbox in the listview
ListView.forEachSelector = function(view,callback)
{
	var checkboxes = view.getElementsByTagName("input");
	var hadOne = false;
	for(var t=0; t<checkboxes.length; t++) {
		var cb = checkboxes[t];
		if(cb.getAttribute("type") == "checkbox") {
			var rn = cb.getAttribute("rowName");
			if(rn) {
				callback(cb,rn);
				hadOne = true;
			}
		}
	}
	return hadOne;
};

ListView.getSelectedRows = function(view)
{
	var rowNames = [];
	ListView.forEachSelector(view,function(e,rowName) {
				if(e.checked)
					rowNames.push(rowName);
				});
	return rowNames;
};

ListView.columnTypes = {};

ListView.columnTypes.String = {
	createHeader: function(place,columnTemplate,col)
		{
			createTiddlyText(place,columnTemplate.title);
		},
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined)
				createTiddlyText(place,v);
		}
};

ListView.columnTypes.WikiText = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined)
				wikify(v,place,null,null);
		}
};

ListView.columnTypes.Tiddler = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined && v.title)
				createTiddlyPopup(place,v.title,config.messages.listView.tiddlerTooltip,v);
		}
};

ListView.columnTypes.Size = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined) {
				var t = 0;
				while(t<config.messages.sizeTemplates.length-1 && v<config.messages.sizeTemplates[t].unit)
					t++;
				createTiddlyText(place,config.messages.sizeTemplates[t].template.format([Math.round(v/config.messages.sizeTemplates[t].unit)]));
			}
		}
};

ListView.columnTypes.Link = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			var c = columnTemplate.text;
			if(v != undefined)
				createTiddlyText(createExternalLink(place,v),c || v);
		}
};

ListView.columnTypes.Date = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined)
				createTiddlyText(place,v.formatString(columnTemplate.dateFormat));
		}
};

ListView.columnTypes.StringList = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined) {
				for(var t=0; t<v.length; t++) {
					createTiddlyText(place,v[t]);
					createTiddlyElement(place,"br");
				}
			}
		}
};

ListView.columnTypes.Selector = {
	createHeader: function(place,columnTemplate,col)
		{
			createTiddlyCheckbox(place,null,false,this.onHeaderChange);
		},
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var e = createTiddlyCheckbox(place,null,listObject[field],null);
			e.setAttribute("rowName",listObject[columnTemplate.rowName]);
		},
	onHeaderChange: function(e)
		{
			var state = this.checked;
			var view = findRelated(this,"TABLE");
			if(!view)
				return;
			ListView.forEachSelector(view,function(e,rowName) {
								e.checked = state;
							});
		}
};

ListView.columnTypes.Tags = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var tags = listObject[field];
			createTiddlyText(place,String.encodeTiddlyLinkList(tags));
		}
};

ListView.columnTypes.Boolean = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			if(listObject[field] == true)
				createTiddlyText(place,columnTemplate.trueText);
			if(listObject[field] == false)
				createTiddlyText(place,columnTemplate.falseText);
		}
};

ListView.columnTypes.TagCheckbox = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var e = createTiddlyCheckbox(place,null,listObject[field],this.onChange);
			e.setAttribute("tiddler",listObject.title);
			e.setAttribute("tag",columnTemplate.tag);
		},
	onChange : function(e)
		{
			var tag = this.getAttribute("tag");
			var tiddler = this.getAttribute("tiddler");
			store.setTiddlerTag(tiddler,this.checked,tag);
		}
};

ListView.columnTypes.TiddlerLink = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined) {
				var link = createTiddlyLink(place,listObject[columnTemplate.tiddlerLink],false,null);
				createTiddlyText(link,listObject[field]);
			}
		}
};

//--
//-- Augmented methods for the JavaScript Number(), Array(), String() and Date() objects
//--

// Clamp a number to a range
Number.prototype.clamp = function(min,max)
{
	var c = this;
	if(c < min)
		c = min;
	if(c > max)
		c = max;
	return Number(c);
};

// Add indexOf function if browser does not support it
if(!Array.indexOf) {
Array.prototype.indexOf = function(item,from)
{
	if(!from)
		from = 0;
	for(var i=from; i<this.length; i++) {
		if(this[i] === item)
			return i;
	}
	return -1;
};}

// Find an entry in a given field of the members of an array
Array.prototype.findByField = function(field,value)
{
	for(var t=0; t<this.length; t++) {
		if(this[t][field] === value)
			return t;
	}
	return null;
};

// Return whether an entry exists in an array
Array.prototype.contains = function(item)
{
	return this.indexOf(item) != -1;
};

// Adds, removes or toggles a particular value within an array
//  value - value to add
//  mode - +1 to add value, -1 to remove value, 0 to toggle it
Array.prototype.setItem = function(value,mode)
{
	var p = this.indexOf(value);
	if(mode == 0)
		mode = (p == -1) ? +1 : -1;
	if(mode == +1) {
		if(p == -1)
			this.push(value);
	} else if(mode == -1) {
		if(p != -1)
			this.splice(p,1);
	}
};

// Return whether one of a list of values exists in an array
Array.prototype.containsAny = function(items)
{
	for(var i=0; i<items.length; i++) {
		if(this.indexOf(items[i]) != -1)
			return true;
	}
	return false;
};

// Return whether all of a list of values exists in an array
Array.prototype.containsAll = function(items)
{
	for(var i = 0; i<items.length; i++) {
		if(this.indexOf(items[i]) == -1)
			return false;
	}
	return true;
};

// Push a new value into an array only if it is not already present in the array. If the optional unique parameter is false, it reverts to a normal push
Array.prototype.pushUnique = function(item,unique)
{
	if(unique === false) {
		this.push(item);
	} else {
		if(this.indexOf(item) == -1)
			this.push(item);
	}
};

Array.prototype.remove = function(item)
{
	var p = this.indexOf(item);
	if(p != -1)
		this.splice(p,1);
};

if(!Array.prototype.map) {
Array.prototype.map = function(fn,thisObj)
{
	var scope = thisObj || window;
	var a = [];
	for(var i=0, j=this.length; i < j; ++i) {
		a.push(fn.call(scope,this[i],i,this));
	}
	return a;
};}

// Get characters from the right end of a string
String.prototype.right = function(n)
{
	return n < this.length ? this.slice(this.length-n) : this;
};

// Trim whitespace from both ends of a string
String.prototype.trim = function()
{
	return this.replace(/^\s*|\s*$/g,"");
};

// Convert a string from a CSS style property name to a JavaScript style name ("background-color" -> "backgroundColor")
String.prototype.unDash = function()
{
	var s = this.split("-");
	if(s.length > 1) {
		for(var t=1; t<s.length; t++)
			s[t] = s[t].substr(0,1).toUpperCase() + s[t].substr(1);
	}
	return s.join("");
};

// Substitute substrings from an array into a format string that includes '%1'-type specifiers
String.prototype.format = function(substrings)
{
	var subRegExp = /(?:%(\d+))/mg;
	var currPos = 0;
	var r = [];
	do {
		var match = subRegExp.exec(this);
		if(match && match[1]) {
			if(match.index > currPos)
				r.push(this.substring(currPos,match.index));
			r.push(substrings[parseInt(match[1])]);
			currPos = subRegExp.lastIndex;
		}
	} while(match);
	if(currPos < this.length)
		r.push(this.substring(currPos,this.length));
	return r.join("");
};

// Escape any special RegExp characters with that character preceded by a backslash
String.prototype.escapeRegExp = function()
{
	var s = "\\^$*+?()=!|,{}[].";
	var c = this;
	for(var t=0; t<s.length; t++)
		c = c.replace(new RegExp("\\" + s.substr(t,1),"g"),"\\" + s.substr(t,1));
	return c;
};

// Convert "\" to "\s", newlines to "\n" (and remove carriage returns)
String.prototype.escapeLineBreaks = function()
{
	return this.replace(/\\/mg,"\\s").replace(/\n/mg,"\\n").replace(/\r/mg,"");
};

// Convert "\n" to newlines, "\b" to " ", "\s" to "\" (and remove carriage returns)
String.prototype.unescapeLineBreaks = function()
{
	return this.replace(/\\n/mg,"\n").replace(/\\b/mg," ").replace(/\\s/mg,"\\").replace(/\r/mg,"");
};

// Convert & to "&amp;", < to "&lt;", > to "&gt;" and " to "&quot;"
String.prototype.htmlEncode = function()
{
	return this.replace(/&/mg,"&amp;").replace(/</mg,"&lt;").replace(/>/mg,"&gt;").replace(/\"/mg,"&quot;");
};

// Convert "&amp;" to &, "&lt;" to <, "&gt;" to > and "&quot;" to "
String.prototype.htmlDecode = function()
{
	return this.replace(/&lt;/mg,"<").replace(/&gt;/mg,">").replace(/&quot;/mg,"\"").replace(/&amp;/mg,"&");
};

// Convert a string to it's JSON representation by encoding control characters, double quotes and backslash. See json.org
String.prototype.toJSONString = function()
{
	var m = {
		'\b': '\\b',
		'\f': '\\f',
		'\n': '\\n',
		'\r': '\\r',
		'\t': '\\t',
		'"' : '\\"',
		'\\': '\\\\'
		};
	var replaceFn = function(a,b) {
		var c = m[b];
		if(c)
			return c;
		c = b.charCodeAt();
		return '\\u00' + Math.floor(c / 16).toString(16) + (c % 16).toString(16);
		};
	if(/["\\\x00-\x1f]/.test(this))
		return '"' + this.replace(/([\x00-\x1f\\"])/g,replaceFn) + '"';
	return '"' + this + '"';
};

// Parse a space-separated string of name:value parameters
// The result is an array of objects:
//   result[0] = object with a member for each parameter name, value of that member being an array of values
//   result[1..n] = one object for each parameter, with 'name' and 'value' members
String.prototype.parseParams = function(defaultName,defaultValue,allowEval,noNames,cascadeDefaults)
{
	var parseToken = function(match,p) {
		var n;
		if(match[p]) // Double quoted
			n = match[p];
		else if(match[p+1]) // Single quoted
			n = match[p+1];
		else if(match[p+2]) // Double-square-bracket quoted
			n = match[p+2];
		else if(match[p+3]) // Double-brace quoted
			try {
				n = match[p+3];
				if(allowEval)
					n = window.eval(n);
			} catch(ex) {
				throw "Unable to evaluate {{" + match[p+3] + "}}: " + exceptionText(ex);
			}
		else if(match[p+4]) // Unquoted
			n = match[p+4];
		else if(match[p+5]) // empty quote
			n = "";
		return n;
	};
	var r = [{}];
	var dblQuote = "(?:\"((?:(?:\\\\\")|[^\"])+)\")";
	var sngQuote = "(?:'((?:(?:\\\\\')|[^'])+)')";
	var dblSquare = "(?:\\[\\[((?:\\s|\\S)*?)\\]\\])";
	var dblBrace = "(?:\\{\\{((?:\\s|\\S)*?)\\}\\})";
	var unQuoted = noNames ? "([^\"'\\s]\\S*)" : "([^\"':\\s][^\\s:]*)";
	var emptyQuote = "((?:\"\")|(?:''))";
	var skipSpace = "(?:\\s*)";
	var token = "(?:" + dblQuote + "|" + sngQuote + "|" + dblSquare + "|" + dblBrace + "|" + unQuoted + "|" + emptyQuote + ")";
	var re = noNames ? new RegExp(token,"mg") : new RegExp(skipSpace + token + skipSpace + "(?:(\\:)" + skipSpace + token + ")?","mg");
	var params = [];
	do {
		var match = re.exec(this);
		if(match) {
			var n = parseToken(match,1);
			if(noNames) {
				r.push({name:"",value:n});
			} else {
				var v = parseToken(match,8);
				if(v == null && defaultName) {
					v = n;
					n = defaultName;
				} else if(v == null && defaultValue) {
					v = defaultValue;
				}
				r.push({name:n,value:v});
				if(cascadeDefaults) {
					defaultName = n;
					defaultValue = v;
				}
			}
		}
	} while(match);
	// Summarise parameters into first element
	for(var t=1; t<r.length; t++) {
		if(r[0][r[t].name])
			r[0][r[t].name].push(r[t].value);
		else
			r[0][r[t].name] = [r[t].value];
	}
	return r;
};

// Process a string list of macro parameters into an array. Parameters can be quoted with "", '',
// [[]], {{ }} or left unquoted (and therefore space-separated). Double-braces {{}} results in
// an *evaluated* parameter: e.g. {{config.options.txtUserName}} results in the current user's name.
String.prototype.readMacroParams = function()
{
	var p = this.parseParams("list",null,true,true);
	var n = [];
	for(var t=1; t<p.length; t++)
		n.push(p[t].value);
	return n;
};

// Process a string list of unique tiddler names into an array. Tiddler names that have spaces in them must be [[bracketed]]
String.prototype.readBracketedList = function(unique)
{
	var p = this.parseParams("list",null,false,true);
	var n = [];
	for(var t=1; t<p.length; t++) {
		if(p[t].value)
			n.pushUnique(p[t].value,unique);
	}
	return n;
};

// Returns array with start and end index of chunk between given start and end marker, or undefined.
String.prototype.getChunkRange = function(start,end)
{
	var s = this.indexOf(start);
	if(s != -1) {
		s += start.length;
		var e = this.indexOf(end,s);
		if(e != -1)
			return [s,e];
	}
};

// Replace a chunk of a string given start and end markers
String.prototype.replaceChunk = function(start,end,sub)
{
	var r = this.getChunkRange(start,end);
	return r ? this.substring(0,r[0]) + sub + this.substring(r[1]) : this;
};

// Returns a chunk of a string between start and end markers, or undefined
String.prototype.getChunk = function(start,end)
{
	var r = this.getChunkRange(start,end);
	if(r)
		return this.substring(r[0],r[1]);
};


// Static method to bracket a string with double square brackets if it contains a space
String.encodeTiddlyLink = function(title)
{
	return title.indexOf(" ") == -1 ? title : "[[" + title + "]]";
};

// Static method to encodeTiddlyLink for every item in an array and join them with spaces
String.encodeTiddlyLinkList = function(list)
{
	if(list) {
		var results = [];
		for(var t=0; t<list.length; t++)
			results.push(String.encodeTiddlyLink(list[t]));
		return results.join(" ");
	} else {
		return "";
	}
};

// Convert a string as a sequence of name:"value" pairs into a hashmap
String.prototype.decodeHashMap = function()
{
	var fields = this.parseParams("anon","",false);
	var r = {};
	for(var t=1; t<fields.length; t++)
		r[fields[t].name] = fields[t].value;
	return r;
};

// Static method to encode a hashmap into a name:"value"... string
String.encodeHashMap = function(hashmap)
{
	var r = [];
	for(var t in hashmap)
		r.push(t + ':"' + hashmap[t] + '"');
	return r.join(" ");
};

// Static method to left-pad a string with 0s to a certain width
String.zeroPad = function(n,d)
{
	var s = n.toString();
	if(s.length < d)
		s = "000000000000000000000000000".substr(0,d-s.length) + s;
	return s;
};

String.prototype.startsWith = function(prefix)
{
	return !prefix || this.substring(0,prefix.length) == prefix;
};

// Returns the first value of the given named parameter.
function getParam(params,name,defaultValue)
{
	if(!params)
		return defaultValue;
	var p = params[0][name];
	return p ? p[0] : defaultValue;
}

// Returns the first value of the given boolean named parameter.
function getFlag(params,name,defaultValue)
{
	return !!getParam(params,name,defaultValue);
}

// Substitute date components into a string
Date.prototype.formatString = function(template)
{
	var t = template.replace(/0hh12/g,String.zeroPad(this.getHours12(),2));
	t = t.replace(/hh12/g,this.getHours12());
	t = t.replace(/0hh/g,String.zeroPad(this.getHours(),2));
	t = t.replace(/hh/g,this.getHours());
	t = t.replace(/mmm/g,config.messages.dates.shortMonths[this.getMonth()]);
	t = t.replace(/0mm/g,String.zeroPad(this.getMinutes(),2));
	t = t.replace(/mm/g,this.getMinutes());
	t = t.replace(/0ss/g,String.zeroPad(this.getSeconds(),2));
	t = t.replace(/ss/g,this.getSeconds());
	t = t.replace(/[ap]m/g,this.getAmPm().toLowerCase());
	t = t.replace(/[AP]M/g,this.getAmPm().toUpperCase());
	t = t.replace(/wYYYY/g,this.getYearForWeekNo());
	t = t.replace(/wYY/g,String.zeroPad(this.getYearForWeekNo()-2000,2));
	t = t.replace(/YYYY/g,this.getFullYear());
	t = t.replace(/YY/g,String.zeroPad(this.getFullYear()-2000,2));
	t = t.replace(/MMM/g,config.messages.dates.months[this.getMonth()]);
	t = t.replace(/0MM/g,String.zeroPad(this.getMonth()+1,2));
	t = t.replace(/MM/g,this.getMonth()+1);
	t = t.replace(/0WW/g,String.zeroPad(this.getWeek(),2));
	t = t.replace(/WW/g,this.getWeek());
	t = t.replace(/DDD/g,config.messages.dates.days[this.getDay()]);
	t = t.replace(/ddd/g,config.messages.dates.shortDays[this.getDay()]);
	t = t.replace(/0DD/g,String.zeroPad(this.getDate(),2));
	t = t.replace(/DDth/g,this.getDate()+this.daySuffix());
	t = t.replace(/DD/g,this.getDate());
	var tz = this.getTimezoneOffset();
	var atz = Math.abs(tz);
	t = t.replace(/TZD/g,(tz < 0 ? '+' : '-') + String.zeroPad(Math.floor(atz / 60),2) + ':' + String.zeroPad(atz % 60,2));
	t = t.replace(/\\/g,"");
	return t;
};

Date.prototype.getWeek = function()
{
	var dt = new Date(this.getTime());
	var d = dt.getDay();
	if(d==0) d=7;// JavaScript Sun=0, ISO Sun=7
	dt.setTime(dt.getTime()+(4-d)*86400000);// shift day to Thurs of same week to calculate weekNo
	var n = Math.floor((dt.getTime()-new Date(dt.getFullYear(),0,1)+3600000)/86400000);
	return Math.floor(n/7)+1;
};

Date.prototype.getYearForWeekNo = function()
{
	var dt = new Date(this.getTime());
	var d = dt.getDay();
	if(d==0) d=7;// JavaScript Sun=0, ISO Sun=7
	dt.setTime(dt.getTime()+(4-d)*86400000);// shift day to Thurs of same week
	return dt.getFullYear();
};

Date.prototype.getHours12 = function()
{
	var h = this.getHours();
	return h > 12 ? h-12 : ( h > 0 ? h : 12 );
};

Date.prototype.getAmPm = function()
{
	return this.getHours() >= 12 ? config.messages.dates.pm : config.messages.dates.am;
};

Date.prototype.daySuffix = function()
{
	return config.messages.dates.daySuffixes[this.getDate()-1];
};

// Convert a date to local YYYYMMDDHHMM string format
Date.prototype.convertToLocalYYYYMMDDHHMM = function()
{
	return this.getFullYear() + String.zeroPad(this.getMonth()+1,2) + String.zeroPad(this.getDate(),2) + String.zeroPad(this.getHours(),2) + String.zeroPad(this.getMinutes(),2);
};

// Convert a date to UTC YYYYMMDDHHMM string format
Date.prototype.convertToYYYYMMDDHHMM = function()
{
	return this.getUTCFullYear() + String.zeroPad(this.getUTCMonth()+1,2) + String.zeroPad(this.getUTCDate(),2) + String.zeroPad(this.getUTCHours(),2) + String.zeroPad(this.getUTCMinutes(),2);
};

// Convert a date to UTC YYYYMMDD.HHMMSSMMM string format
Date.prototype.convertToYYYYMMDDHHMMSSMMM = function()
{
	return this.getUTCFullYear() + String.zeroPad(this.getUTCMonth()+1,2) + String.zeroPad(this.getUTCDate(),2) + "." + String.zeroPad(this.getUTCHours(),2) + String.zeroPad(this.getUTCMinutes(),2) + String.zeroPad(this.getUTCSeconds(),2) + String.zeroPad(this.getUTCMilliseconds(),4);
};

// Static method to create a date from a UTC YYYYMMDDHHMM format string
Date.convertFromYYYYMMDDHHMM = function(d)
{
	var hh = d.substr(8,2) || "00";
	var mm = d.substr(10,2) || "00";
	return new Date(Date.UTC(parseInt(d.substr(0,4),10),
			parseInt(d.substr(4,2),10)-1,
			parseInt(d.substr(6,2),10),
			parseInt(hh,10),
			parseInt(mm,10),0,0));
};

//--
//-- RGB colour object
//--

// Construct an RGB colour object from a '#rrggbb', '#rgb' or 'rgb(n,n,n)' string or from separate r,g,b values
function RGB(r,g,b)
{
	this.r = 0;
	this.g = 0;
	this.b = 0;
	if(typeof r == "string") {
		if(r.substr(0,1) == "#") {
			if(r.length == 7) {
				this.r = parseInt(r.substr(1,2),16)/255;
				this.g = parseInt(r.substr(3,2),16)/255;
				this.b = parseInt(r.substr(5,2),16)/255;
			} else {
				this.r = parseInt(r.substr(1,1),16)/15;
				this.g = parseInt(r.substr(2,1),16)/15;
				this.b = parseInt(r.substr(3,1),16)/15;
			}
		} else {
			var rgbPattern = /rgb\s*\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/;
			var c = r.match(rgbPattern);
			if(c) {
				this.r = parseInt(c[1],10)/255;
				this.g = parseInt(c[2],10)/255;
				this.b = parseInt(c[3],10)/255;
			}
		}
	} else {
		this.r = r;
		this.g = g;
		this.b = b;
	}
	return this;
}

// Mixes this colour with another in a specified proportion
// c = other colour to mix
// f = 0..1 where 0 is this colour and 1 is the new colour
// Returns an RGB object
RGB.prototype.mix = function(c,f)
{
	return new RGB(this.r + (c.r-this.r) * f,this.g + (c.g-this.g) * f,this.b + (c.b-this.b) * f);
};

// Return an rgb colour as a #rrggbb format hex string
RGB.prototype.toString = function()
{
	return "#" + ("0" + Math.floor(this.r.clamp(0,1) * 255).toString(16)).right(2) +
				 ("0" + Math.floor(this.g.clamp(0,1) * 255).toString(16)).right(2) +
				 ("0" + Math.floor(this.b.clamp(0,1) * 255).toString(16)).right(2);
};

//--
//-- DOM utilities - many derived from www.quirksmode.org
//--

// Resolve the target object of an event
function resolveTarget(e)
{
	var obj;
	if(e.target)
		obj = e.target;
	else if(e.srcElement)
		obj = e.srcElement;
	if(obj.nodeType == 3) // defeat Safari bug
		obj = obj.parentNode;
	return obj;
}

function drawGradient(place,horiz,locolors,hicolors)
{
	if(!hicolors)
		hicolors = locolors;
	for(var t=0; t<= 100; t+=2) {
		var bar = document.createElement("div");
		place.appendChild(bar);
		bar.style.position = "absolute";
		bar.style.left = horiz ? t + "%" : 0;
		bar.style.top = horiz ? 0 : t + "%";
		bar.style.width = horiz ? (101-t) + "%" : "100%";
		bar.style.height = horiz ? "100%" : (101-t) + "%";
		bar.style.zIndex = -1;
		var p = t/100*(locolors.length-1);
		var hc = hicolors[Math.floor(p)];
		if(typeof hc == "string")
			hc = new RGB(hc);
		var lc = locolors[Math.ceil(p)];
		if(typeof lc == "string")
			lc = new RGB(lc);
		bar.style.backgroundColor = hc.mix(lc,p-Math.floor(p)).toString();
	}
}

function createTiddlyCheckbox(parent,caption,checked,onChange)
{
	var cb = document.createElement("input");
	cb.setAttribute("type","checkbox");
	cb.onclick = onChange;
	parent.appendChild(cb);
	cb.checked = checked;
	cb.className = "chkOptionInput";
	if(caption)
		wikify(caption,parent);
	return cb;
}

function createTiddlyElement(parent,element,id,className,text,attribs)
{
	var e = document.createElement(element);
	if(className != null)
		e.className = className;
	if(id != null)
		e.setAttribute("id",id);
	if(text != null)
		e.appendChild(document.createTextNode(text));
	if(attribs) {
		for(var n in attribs) {
			e.setAttribute(n,attribs[n]);
		}
	}
	if(parent != null)
		parent.appendChild(e);
	return e;
}

function addEvent(obj,type,fn)
{
	if(obj.attachEvent) {
		obj["e"+type+fn] = fn;
		obj[type+fn] = function(){obj["e"+type+fn](window.event);};
		obj.attachEvent("on"+type,obj[type+fn]);
	} else {
		obj.addEventListener(type,fn,false);
	}
}

function removeEvent(obj,type,fn)
{
	if(obj.detachEvent) {
		obj.detachEvent("on"+type,obj[type+fn]);
		obj[type+fn] = null;
	} else {
		obj.removeEventListener(type,fn,false);
	}
}


// Find the closest relative with a given property value (property defaults to tagName, relative defaults to parentNode)
function findRelated(e,value,name,relative)
{
	name = name || "tagName";
	relative = relative || "parentNode";
	if(name == "className") {
		while(e && !hasClass(e,value)) {
			e = e[relative];
		}
	} else {
		while(e && e[name] != value) {
			e = e[relative];
		}
	}
	return e;
}

// Get the scroll position for window.scrollTo necessary to scroll a given element into view
function ensureVisible(e)
{
	var posTop = findPosY(e);
	var posBot = posTop + e.offsetHeight;
	var winTop = findScrollY();
	var winHeight = findWindowHeight();
	var winBot = winTop + winHeight;
	if(posTop < winTop) {
		return posTop;
	} else if(posBot > winBot) {
		if(e.offsetHeight < winHeight)
			return posTop - (winHeight - e.offsetHeight);
		else
			return posTop;
	} else {
		return winTop;
	}
}

// Get the current width of the display window
function findWindowWidth()
{
	return window.innerWidth || document.documentElement.clientWidth;
}

// Get the current height of the display window
function findWindowHeight()
{
	return window.innerHeight || document.documentElement.clientHeight;
}

// Get the current horizontal page scroll position
function findScrollX()
{
	return window.scrollX || document.documentElement.scrollLeft;
}

// Get the current vertical page scroll position
function findScrollY()
{
	return window.scrollY || document.documentElement.scrollTop;
}

function findPosX(obj)
{
	var curleft = 0;
	while(obj.offsetParent) {
		curleft += obj.offsetLeft;
		obj = obj.offsetParent;
	}
	return curleft;
}

function findPosY(obj)
{
	var curtop = 0;
	while(obj.offsetParent) {
		curtop += obj.offsetTop;
		obj = obj.offsetParent;
	}
	return curtop;
}

// Blur a particular element
function blurElement(e)
{
	if(e && e.focus && e.blur) {
		e.focus();
		e.blur();
	}
}

// Create a non-breaking space
function insertSpacer(place)
{
	var e = document.createTextNode(String.fromCharCode(160));
	if(place)
		place.appendChild(e);
	return e;
}

// Force the browser to do a document reflow when needed to workaround browser bugs
function forceReflow()
{
	if(config.browser.isGecko) {
		setStylesheet("body {top:0px;margin-top:0px;}","forceReflow");
		setTimeout(function() {setStylesheet("","forceReflow");},1);
	}
}

// Replace the current selection of a textarea or text input and scroll it into view
function replaceSelection(e,text)
{
	if(e.setSelectionRange) {
		var oldpos = e.selectionStart;
		var isRange = e.selectionEnd > e.selectionStart;
		e.value = e.value.substr(0,e.selectionStart) + text + e.value.substr(e.selectionEnd);
		e.setSelectionRange(isRange ? oldpos : oldpos + text.length,oldpos + text.length);
		var linecount = e.value.split("\n").length;
		var thisline = e.value.substr(0,e.selectionStart).split("\n").length-1;
		e.scrollTop = Math.floor((thisline - e.rows / 2) * e.scrollHeight / linecount);
	} else if(document.selection) {
		var range = document.selection.createRange();
		if(range.parentElement() == e) {
			var isCollapsed = range.text == "";
			range.text = text;
			if(!isCollapsed) {
				range.moveStart("character", -text.length);
				range.select();
			}
		}
	}
}

// Returns the text of the given (text) node, possibly merging subsequent text nodes
function getNodeText(e)
{
	var t = "";
	while(e && e.nodeName == "#text") {
		t += e.nodeValue;
		e = e.nextSibling;
	}
	return t;
}

// Returns true if the element e has a given ancestor element
function isDescendant(e,ancestor)
{
	while(e) {
		if(e === ancestor)
			return true;
		e = e.parentNode;
	}
	return false;
}


// deprecate the following...

// Prevent an event from bubbling
function stopEvent(e)
{
	var ev = e || window.event;
	ev.cancelBubble = true;
	if(ev.stopPropagation) ev.stopPropagation();
	return false;
}

// Remove any event handlers or non-primitve custom attributes
function scrubNode(e)
{
	if(!config.browser.isIE)
		return;
	var att = e.attributes;
	if(att) {
		for(var t=0; t<att.length; t++) {
			var n = att[t].name;
			if(n !== "style" && (typeof e[n] === "function" || (typeof e[n] === "object" && e[n] != null))) {
				try {
					e[n] = null;
				} catch(ex) {
				}
			}
		}
	}
	var c = e.firstChild;
	while(c) {
		scrubNode(c);
		c = c.nextSibling;
	}
}

function addClass(e,className)
{
	jQuery(e).addClass(className);
}

function removeClass(e,className)
{
	jQuery(e).removeClass(className);
}

function hasClass(e,className)
{
	return jQuery(e).hasClass(className);
}

// Remove all children of a node
function removeChildren(e)
{
	jQuery(e).empty();
}

function createTiddlyText(parent,text)
{
	return jQuery(parent).append(text);
}

// Return the content of an element as plain text with no formatting
function getPlainText(e)
{
	return jQuery(e).text();
}

// Remove a node and all it's children
function removeNode(e)
{
	jQuery(e).remove();
}

//--
//-- LoaderBase and SaverBase
//--

function LoaderBase() {}

LoaderBase.prototype.loadTiddler = function(store,node,tiddlers)
{
	var title = this.getTitle(store,node);
	if(safeMode && store.isShadowTiddler(title))
		return;
	if(title) {
		var tiddler = store.createTiddler(title);
		this.internalizeTiddler(store,tiddler,title,node);
		tiddlers.push(tiddler);
	}
};

LoaderBase.prototype.loadTiddlers = function(store,nodes)
{
	var tiddlers = [];
	for(var t = 0; t < nodes.length; t++) {
		try {
			this.loadTiddler(store,nodes[t],tiddlers);
		} catch(ex) {
			showException(ex,config.messages.tiddlerLoadError.format([this.getTitle(store,nodes[t])]));
		}
	}
	return tiddlers;
};

function SaverBase() {}

SaverBase.prototype.externalize = function(store)
{
	var results = [];
	var tiddlers = store.getTiddlers("title");
	for(var t = 0; t < tiddlers.length; t++) {
		if(!tiddlers[t].doNotSave())
			results.push(this.externalizeTiddler(store, tiddlers[t]));
	}
	return results.join("\n");
};

//--
//-- TW21Loader (inherits from LoaderBase)
//--

function TW21Loader() {}

TW21Loader.prototype = new LoaderBase();

TW21Loader.prototype.getTitle = function(store,node)
{
	var title = null;
	if(node.getAttribute) {
		title = node.getAttribute("title");
		if(!title)
			title = node.getAttribute("tiddler");
	}
	if(!title && node.id) {
		var lenPrefix = store.idPrefix.length;
		if(node.id.substr(0,lenPrefix) == store.idPrefix)
			title = node.id.substr(lenPrefix);
	}
	return title;
};

TW21Loader.prototype.internalizeTiddler = function(store,tiddler,title,node)
{
	var e = node.firstChild;
	var text = null;
	if(node.getAttribute("tiddler")) {
		text = getNodeText(e).unescapeLineBreaks();
	} else {
		while(e.nodeName!="PRE" && e.nodeName!="pre") {
			e = e.nextSibling;
		}
		text = e.innerHTML.replace(/\r/mg,"").htmlDecode();
	}
	var modifier = node.getAttribute("modifier");
	var c = node.getAttribute("created");
	var m = node.getAttribute("modified");
	var created = c ? Date.convertFromYYYYMMDDHHMM(c) : version.date;
	var modified = m ? Date.convertFromYYYYMMDDHHMM(m) : created;
	var tags = node.getAttribute("tags");
	var fields = {};
	var attrs = node.attributes;
	for(var i = attrs.length-1; i >= 0; i--) {
		var name = attrs[i].name;
		if(attrs[i].specified && !TiddlyWiki.isStandardField(name)) {
			fields[name] = attrs[i].value.unescapeLineBreaks();
		}
	}
	tiddler.assign(title,text,modifier,modified,tags,created,fields);
	return tiddler;
};

//--
//-- TW21Saver (inherits from SaverBase)
//--

function TW21Saver() {}

TW21Saver.prototype = new SaverBase();

TW21Saver.prototype.externalizeTiddler = function(store,tiddler)
{
	try {
		var extendedAttributes = "";
		var usePre = config.options.chkUsePreForStorage;
		store.forEachField(tiddler,
			function(tiddler,fieldName,value) {
				// don't store stuff from the temp namespace
				if(typeof value != "string")
					value = "";
				if(!fieldName.match(/^temp\./))
					extendedAttributes += ' %0="%1"'.format([fieldName,value.escapeLineBreaks().htmlEncode()]);
			},true);
		var created = tiddler.created;
		var modified = tiddler.modified;
		var attributes = tiddler.modifier ? ' modifier="' + tiddler.modifier.htmlEncode() + '"' : "";
		attributes += (usePre && created == version.date) ? "" :' created="' + created.convertToYYYYMMDDHHMM() + '"';
		attributes += (usePre && modified == created) ? "" : ' modified="' + modified.convertToYYYYMMDDHHMM() +'"';
		var tags = tiddler.getTags();
		if(!usePre || tags)
			attributes += ' tags="' + tags.htmlEncode() + '"';
		return ('<div %0="%1"%2%3>%4</'+'div>').format([
				usePre ? "title" : "tiddler",
				tiddler.title.htmlEncode(),
				attributes,
				extendedAttributes,
				usePre ? "\n<pre>" + tiddler.text.htmlEncode() + "</pre>\n" : tiddler.text.escapeLineBreaks().htmlEncode()
			]);
	} catch (ex) {
		throw exceptionText(ex,config.messages.tiddlerSaveError.format([tiddler.title]));
	}
};

//]]>
</script>
<script id="jsdeprecatedArea" type="text/javascript">
//<![CDATA[
//--
//-- Deprecated Crypto functions and associated conversion routines.
//-- Use the jQuery.encoding functions directly instead.
//--

// Crypto 'namespace'
function Crypto() {}

// Convert a string to an array of big-endian 32-bit words
Crypto.strToBe32s = function(str)
{
	return jQuery.encoding.strToBe32s(str);
};

// Convert an array of big-endian 32-bit words to a string
Crypto.be32sToStr = function(be)
{
	return jQuery.encoding.be32sToStr(be);
};

// Convert an array of big-endian 32-bit words to a hex string
Crypto.be32sToHex = function(be)
{
	return jQuery.encoding.be32sToHex(be);
};

// Return, in hex, the SHA-1 hash of a string
Crypto.hexSha1Str = function(str)
{
	return jQuery.encoding.digests.hexSha1Str(str);
};

// Return the SHA-1 hash of a string
Crypto.sha1Str = function(str)
{
	return jQuery.encoding.digests.sha1Str(str);
};

// Calculate the SHA-1 hash of an array of blen bytes of big-endian 32-bit words
Crypto.sha1 = function(x,blen)
{
	return jQuery.encoding.digests.sha1(x,blen);
};

//--
//-- Deprecated DOM utilities
//--

// @Deprecated: Use jQuery.stylesheet instead
function setStylesheet(s,id,doc)
{
	jQuery.twStylesheet(s,{ id: id, doc: doc });
}

// @Deprecated: Use jQuery.stylesheet.remove instead
function removeStyleSheet(id)
{
	jQuery.twStylesheet.remove({ id: id });
}
//--
//-- Deprecated Filesystem code
//-- Use the jQuery.file functions directly instead
//--

function saveFile(filePath,content)
{
	return jQuery.twFile.save(filePath,content);
}

function loadFile(filePath)
{
	return jQuery.twFile.load(filePath);
}

function copyFile(dest,source)
{
	return jQuery.twFile.copy(dest,source);
}

//--
//-- Deprecated HTTP request code
//-- Use the jQuery ajax functions directly instead
//--

function loadRemoteFile(url,callback,params)
{
	return httpReq("GET",url,callback,params);
}

function doHttp(type,url,data,contentType,username,password,callback,params,headers,allowCache)
{
	return httpReq(type,url,callback,params,headers,data,contentType,username,password,allowCache);
}

function httpReq(type,url,callback,params,headers,data,contentType,username,password,allowCache)
{
	var options = {
		type:type,
		url:url,
		processData:false,
		data:data,
		cache:allowCache ? false : true,
		beforeSend: function(xhr) {
			for(var i in headers)
				xhr.setRequestHeader(i,headers[i]);
			xhr.setRequestHeader("X-Requested-With", "TiddlyWiki " + formatVersion());
		}
	};

	if(callback) {
		options.complete = function(xhr,textStatus) {
			if(jQuery.httpSuccess(xhr))
				callback(true,params,xhr.responseText,url,xhr);
			else
				callback(false,params,null,url,xhr);
		};
	}
	if(contentType)
		options.contentType = contentType;
	if(username)
		options.username = username;
	if(password)
		options.password = password;
	if(window.Components && window.netscape && window.netscape.security && document.location.protocol.indexOf("http") == -1)
		window.netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
	jQuery.ajax(options);
}

//--
//-- Deprecated Tiddler code
//--

// @Deprecated: Use tiddlerToRssItem(tiddler,uri) instead
Tiddler.prototype.toRssItem = function(uri)
{
	return tiddlerToRssItem(this,uri);
};

// @Deprecated: Use "<item>\n" + tiddlerToRssItem(tiddler,uri)  + "\n</item>" instead
Tiddler.prototype.saveToRss = function(uri)
{
	return "<item>\n" + tiddlerToRssItem(this,uri) + "\n</item>";
};

// @Deprecated: Use jQuery.encoding.digests.hexSha1Str instead
Tiddler.prototype.generateFingerprint = function()
{
	return "0x" + Crypto.hexSha1Str(this.text);
};

//]]>
</script>
<script id="jslibArea" type="text/javascript">
//<![CDATA[
/*
 * jQuery JavaScript Library v1.3.2
 * http://jquery.com/
 *
 * Copyright (c) 2009 John Resig
 * Dual licensed under the MIT and GPL licenses.
 * http://docs.jquery.com/License
 *
 * Date: 2009-02-19 17:34:21 -0500 (Thu, 19 Feb 2009)
 * Revision: 6246
 */
(function(){var l=this,g,y=l.jQuery,p=l.$,o=l.jQuery=l.$=function(E,F){return new o.fn.init(E,F)},D=/^[^<]*(<(.|\s)+>)[^>]*$|^#([\w-]+)$/,f=/^.[^:#\[\.,]*$/;o.fn=o.prototype={init:function(E,H){E=E||document;if(E.nodeType){this[0]=E;this.length=1;this.context=E;return this}if(typeof E==="string"){var G=D.exec(E);if(G&&(G[1]||!H)){if(G[1]){E=o.clean([G[1]],H)}else{var I=document.getElementById(G[3]);if(I&&I.id!=G[3]){return o().find(E)}var F=o(I||[]);F.context=document;F.selector=E;return F}}else{return o(H).find(E)}}else{if(o.isFunction(E)){return o(document).ready(E)}}if(E.selector&&E.context){this.selector=E.selector;this.context=E.context}return this.setArray(o.isArray(E)?E:o.makeArray(E))},selector:"",jquery:"1.3.2",size:function(){return this.length},get:function(E){return E===g?Array.prototype.slice.call(this):this[E]},pushStack:function(F,H,E){var G=o(F);G.prevObject=this;G.context=this.context;if(H==="find"){G.selector=this.selector+(this.selector?" ":"")+E}else{if(H){G.selector=this.selector+"."+H+"("+E+")"}}return G},setArray:function(E){this.length=0;Array.prototype.push.apply(this,E);return this},each:function(F,E){return o.each(this,F,E)},index:function(E){return o.inArray(E&&E.jquery?E[0]:E,this)},attr:function(F,H,G){var E=F;if(typeof F==="string"){if(H===g){return this[0]&&o[G||"attr"](this[0],F)}else{E={};E[F]=H}}return this.each(function(I){for(F in E){o.attr(G?this.style:this,F,o.prop(this,E[F],G,I,F))}})},css:function(E,F){if((E=="width"||E=="height")&&parseFloat(F)<0){F=g}return this.attr(E,F,"curCSS")},text:function(F){if(typeof F!=="object"&&F!=null){return this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(F))}var E="";o.each(F||this,function(){o.each(this.childNodes,function(){if(this.nodeType!=8){E+=this.nodeType!=1?this.nodeValue:o.fn.text([this])}})});return E},wrapAll:function(E){if(this[0]){var F=o(E,this[0].ownerDocument).clone();if(this[0].parentNode){F.insertBefore(this[0])}F.map(function(){var G=this;while(G.firstChild){G=G.firstChild}return G}).append(this)}return this},wrapInner:function(E){return this.each(function(){o(this).contents().wrapAll(E)})},wrap:function(E){return this.each(function(){o(this).wrapAll(E)})},append:function(){return this.domManip(arguments,true,function(E){if(this.nodeType==1){this.appendChild(E)}})},prepend:function(){return this.domManip(arguments,true,function(E){if(this.nodeType==1){this.insertBefore(E,this.firstChild)}})},before:function(){return this.domManip(arguments,false,function(E){this.parentNode.insertBefore(E,this)})},after:function(){return this.domManip(arguments,false,function(E){this.parentNode.insertBefore(E,this.nextSibling)})},end:function(){return this.prevObject||o([])},push:[].push,sort:[].sort,splice:[].splice,find:function(E){if(this.length===1){var F=this.pushStack([],"find",E);F.length=0;o.find(E,this[0],F);return F}else{return this.pushStack(o.unique(o.map(this,function(G){return o.find(E,G)})),"find",E)}},clone:function(G){var E=this.map(function(){if(!o.support.noCloneEvent&&!o.isXMLDoc(this)){var I=this.outerHTML;if(!I){var J=this.ownerDocument.createElement("div");J.appendChild(this.cloneNode(true));I=J.innerHTML}return o.clean([I.replace(/ jQuery\d+="(?:\d+|null)"/g,"").replace(/^\s*/,"")])[0]}else{return this.cloneNode(true)}});if(G===true){var H=this.find("*").andSelf(),F=0;E.find("*").andSelf().each(function(){if(this.nodeName!==H[F].nodeName){return}var I=o.data(H[F],"events");for(var K in I){for(var J in I[K]){o.event.add(this,K,I[K][J],I[K][J].data)}}F++})}return E},filter:function(E){return this.pushStack(o.isFunction(E)&&o.grep(this,function(G,F){return E.call(G,F)})||o.multiFilter(E,o.grep(this,function(F){return F.nodeType===1})),"filter",E)},closest:function(E){var G=o.expr.match.POS.test(E)?o(E):null,F=0;return this.map(function(){var H=this;while(H&&H.ownerDocument){if(G?G.index(H)>-1:o(H).is(E)){o.data(H,"closest",F);return H}H=H.parentNode;F++}})},not:function(E){if(typeof E==="string"){if(f.test(E)){return this.pushStack(o.multiFilter(E,this,true),"not",E)}else{E=o.multiFilter(E,this)}}var F=E.length&&E[E.length-1]!==g&&!E.nodeType;return this.filter(function(){return F?o.inArray(this,E)<0:this!=E})},add:function(E){return this.pushStack(o.unique(o.merge(this.get(),typeof E==="string"?o(E):o.makeArray(E))))},is:function(E){return !!E&&o.multiFilter(E,this).length>0},hasClass:function(E){return !!E&&this.is("."+E)},val:function(K){if(K===g){var E=this[0];if(E){if(o.nodeName(E,"option")){return(E.attributes.value||{}).specified?E.value:E.text}if(o.nodeName(E,"select")){var I=E.selectedIndex,L=[],M=E.options,H=E.type=="select-one";if(I<0){return null}for(var F=H?I:0,J=H?I+1:M.length;F<J;F++){var G=M[F];if(G.selected){K=o(G).val();if(H){return K}L.push(K)}}return L}return(E.value||"").replace(/\r/g,"")}return g}if(typeof K==="number"){K+=""}return this.each(function(){if(this.nodeType!=1){return}if(o.isArray(K)&&/radio|checkbox/.test(this.type)){this.checked=(o.inArray(this.value,K)>=0||o.inArray(this.name,K)>=0)}else{if(o.nodeName(this,"select")){var N=o.makeArray(K);o("option",this).each(function(){this.selected=(o.inArray(this.value,N)>=0||o.inArray(this.text,N)>=0)});if(!N.length){this.selectedIndex=-1}}else{this.value=K}}})},html:function(E){return E===g?(this[0]?this[0].innerHTML.replace(/ jQuery\d+="(?:\d+|null)"/g,""):null):this.empty().append(E)},replaceWith:function(E){return this.after(E).remove()},eq:function(E){return this.slice(E,+E+1)},slice:function(){return this.pushStack(Array.prototype.slice.apply(this,arguments),"slice",Array.prototype.slice.call(arguments).join(","))},map:function(E){return this.pushStack(o.map(this,function(G,F){return E.call(G,F,G)}))},andSelf:function(){return this.add(this.prevObject)},domManip:function(J,M,L){if(this[0]){var I=(this[0].ownerDocument||this[0]).createDocumentFragment(),F=o.clean(J,(this[0].ownerDocument||this[0]),I),H=I.firstChild;if(H){for(var G=0,E=this.length;G<E;G++){L.call(K(this[G],H),this.length>1||G>0?I.cloneNode(true):I)}}if(F){o.each(F,z)}}return this;function K(N,O){return M&&o.nodeName(N,"table")&&o.nodeName(O,"tr")?(N.getElementsByTagName("tbody")[0]||N.appendChild(N.ownerDocument.createElement("tbody"))):N}}};o.fn.init.prototype=o.fn;function z(E,F){if(F.src){o.ajax({url:F.src,async:false,dataType:"script"})}else{o.globalEval(F.text||F.textContent||F.innerHTML||"")}if(F.parentNode){F.parentNode.removeChild(F)}}function e(){return +new Date}o.extend=o.fn.extend=function(){var J=arguments[0]||{},H=1,I=arguments.length,E=false,G;if(typeof J==="boolean"){E=J;J=arguments[1]||{};H=2}if(typeof J!=="object"&&!o.isFunction(J)){J={}}if(I==H){J=this;--H}for(;H<I;H++){if((G=arguments[H])!=null){for(var F in G){var K=J[F],L=G[F];if(J===L){continue}if(E&&L&&typeof L==="object"&&!L.nodeType){J[F]=o.extend(E,K||(L.length!=null?[]:{}),L)}else{if(L!==g){J[F]=L}}}}}return J};var b=/z-?index|font-?weight|opacity|zoom|line-?height/i,q=document.defaultView||{},s=Object.prototype.toString;o.extend({noConflict:function(E){l.$=p;if(E){l.jQuery=y}return o},isFunction:function(E){return s.call(E)==="[object Function]"},isArray:function(E){return s.call(E)==="[object Array]"},isXMLDoc:function(E){return E.nodeType===9&&E.documentElement.nodeName!=="HTML"||!!E.ownerDocument&&o.isXMLDoc(E.ownerDocument)},globalEval:function(G){if(G&&/\S/.test(G)){var F=document.getElementsByTagName("head")[0]||document.documentElement,E=document.createElement("script");E.type="text/javascript";if(o.support.scriptEval){E.appendChild(document.createTextNode(G))}else{E.text=G}F.insertBefore(E,F.firstChild);F.removeChild(E)}},nodeName:function(F,E){return F.nodeName&&F.nodeName.toUpperCase()==E.toUpperCase()},each:function(G,K,F){var E,H=0,I=G.length;if(F){if(I===g){for(E in G){if(K.apply(G[E],F)===false){break}}}else{for(;H<I;){if(K.apply(G[H++],F)===false){break}}}}else{if(I===g){for(E in G){if(K.call(G[E],E,G[E])===false){break}}}else{for(var J=G[0];H<I&&K.call(J,H,J)!==false;J=G[++H]){}}}return G},prop:function(H,I,G,F,E){if(o.isFunction(I)){I=I.call(H,F)}return typeof I==="number"&&G=="curCSS"&&!b.test(E)?I+"px":I},className:{add:function(E,F){o.each((F||"").split(/\s+/),function(G,H){if(E.nodeType==1&&!o.className.has(E.className,H)){E.className+=(E.className?" ":"")+H}})},remove:function(E,F){if(E.nodeType==1){E.className=F!==g?o.grep(E.className.split(/\s+/),function(G){return !o.className.has(F,G)}).join(" "):""}},has:function(F,E){return F&&o.inArray(E,(F.className||F).toString().split(/\s+/))>-1}},swap:function(H,G,I){var E={};for(var F in G){E[F]=H.style[F];H.style[F]=G[F]}I.call(H);for(var F in G){H.style[F]=E[F]}},css:function(H,F,J,E){if(F=="width"||F=="height"){var L,G={position:"absolute",visibility:"hidden",display:"block"},K=F=="width"?["Left","Right"]:["Top","Bottom"];function I(){L=F=="width"?H.offsetWidth:H.offsetHeight;if(E==="border"){return}o.each(K,function(){if(!E){L-=parseFloat(o.curCSS(H,"padding"+this,true))||0}if(E==="margin"){L+=parseFloat(o.curCSS(H,"margin"+this,true))||0}else{L-=parseFloat(o.curCSS(H,"border"+this+"Width",true))||0}})}if(H.offsetWidth!==0){I()}else{o.swap(H,G,I)}return Math.max(0,Math.round(L))}return o.curCSS(H,F,J)},curCSS:function(I,F,G){var L,E=I.style;if(F=="opacity"&&!o.support.opacity){L=o.attr(E,"opacity");return L==""?"1":L}if(F.match(/float/i)){F=w}if(!G&&E&&E[F]){L=E[F]}else{if(q.getComputedStyle){if(F.match(/float/i)){F="float"}F=F.replace(/([A-Z])/g,"-$1").toLowerCase();var M=q.getComputedStyle(I,null);if(M){L=M.getPropertyValue(F)}if(F=="opacity"&&L==""){L="1"}}else{if(I.currentStyle){var J=F.replace(/\-(\w)/g,function(N,O){return O.toUpperCase()});L=I.currentStyle[F]||I.currentStyle[J];if(!/^\d+(px)?$/i.test(L)&&/^\d/.test(L)){var H=E.left,K=I.runtimeStyle.left;I.runtimeStyle.left=I.currentStyle.left;E.left=L||0;L=E.pixelLeft+"px";E.left=H;I.runtimeStyle.left=K}}}}return L},clean:function(F,K,I){K=K||document;if(typeof K.createElement==="undefined"){K=K.ownerDocument||K[0]&&K[0].ownerDocument||document}if(!I&&F.length===1&&typeof F[0]==="string"){var H=/^<(\w+)\s*\/?>$/.exec(F[0]);if(H){return[K.createElement(H[1])]}}var G=[],E=[],L=K.createElement("div");o.each(F,function(P,S){if(typeof S==="number"){S+=""}if(!S){return}if(typeof S==="string"){S=S.replace(/(<(\w+)[^>]*?)\/>/g,function(U,V,T){return T.match(/^(abbr|br|col|img|input|link|meta|param|hr|area|embed)$/i)?U:V+"></"+T+">"});var O=S.replace(/^\s+/,"").substring(0,10).toLowerCase();var Q=!O.indexOf("<opt")&&[1,"<select multiple='multiple'>","</select>"]||!O.indexOf("<leg")&&[1,"<fieldset>","</fieldset>"]||O.match(/^<(thead|tbody|tfoot|colg|cap)/)&&[1,"<table>","</table>"]||!O.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!O.indexOf("<td")||!O.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||!O.indexOf("<col")&&[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"]||!o.support.htmlSerialize&&[1,"div<div>","</div>"]||[0,"",""];L.innerHTML=Q[1]+S+Q[2];while(Q[0]--){L=L.lastChild}if(!o.support.tbody){var R=/<tbody/i.test(S),N=!O.indexOf("<table")&&!R?L.firstChild&&L.firstChild.childNodes:Q[1]=="<table>"&&!R?L.childNodes:[];for(var M=N.length-1;M>=0;--M){if(o.nodeName(N[M],"tbody")&&!N[M].childNodes.length){N[M].parentNode.removeChild(N[M])}}}if(!o.support.leadingWhitespace&&/^\s/.test(S)){L.insertBefore(K.createTextNode(S.match(/^\s*/)[0]),L.firstChild)}S=o.makeArray(L.childNodes)}if(S.nodeType){G.push(S)}else{G=o.merge(G,S)}});if(I){for(var J=0;G[J];J++){if(o.nodeName(G[J],"script")&&(!G[J].type||G[J].type.toLowerCase()==="text/javascript")){E.push(G[J].parentNode?G[J].parentNode.removeChild(G[J]):G[J])}else{if(G[J].nodeType===1){G.splice.apply(G,[J+1,0].concat(o.makeArray(G[J].getElementsByTagName("script"))))}I.appendChild(G[J])}}return E}return G},attr:function(J,G,K){if(!J||J.nodeType==3||J.nodeType==8){return g}var H=!o.isXMLDoc(J),L=K!==g;G=H&&o.props[G]||G;if(J.tagName){var F=/href|src|style/.test(G);if(G=="selected"&&J.parentNode){J.parentNode.selectedIndex}if(G in J&&H&&!F){if(L){if(G=="type"&&o.nodeName(J,"input")&&J.parentNode){throw"type property can't be changed"}J[G]=K}if(o.nodeName(J,"form")&&J.getAttributeNode(G)){return J.getAttributeNode(G).nodeValue}if(G=="tabIndex"){var I=J.getAttributeNode("tabIndex");return I&&I.specified?I.value:J.nodeName.match(/(button|input|object|select|textarea)/i)?0:J.nodeName.match(/^(a|area)$/i)&&J.href?0:g}return J[G]}if(!o.support.style&&H&&G=="style"){return o.attr(J.style,"cssText",K)}if(L){J.setAttribute(G,""+K)}var E=!o.support.hrefNormalized&&H&&F?J.getAttribute(G,2):J.getAttribute(G);return E===null?g:E}if(!o.support.opacity&&G=="opacity"){if(L){J.zoom=1;J.filter=(J.filter||"").replace(/alpha\([^)]*\)/,"")+(parseInt(K)+""=="NaN"?"":"alpha(opacity="+K*100+")")}return J.filter&&J.filter.indexOf("opacity=")>=0?(parseFloat(J.filter.match(/opacity=([^)]*)/)[1])/100)+"":""}G=G.replace(/-([a-z])/ig,function(M,N){return N.toUpperCase()});if(L){J[G]=K}return J[G]},trim:function(E){return(E||"").replace(/^\s+|\s+$/g,"")},makeArray:function(G){var E=[];if(G!=null){var F=G.length;if(F==null||typeof G==="string"||o.isFunction(G)||G.setInterval){E[0]=G}else{while(F){E[--F]=G[F]}}}return E},inArray:function(G,H){for(var E=0,F=H.length;E<F;E++){if(H[E]===G){return E}}return -1},merge:function(H,E){var F=0,G,I=H.length;if(!o.support.getAll){while((G=E[F++])!=null){if(G.nodeType!=8){H[I++]=G}}}else{while((G=E[F++])!=null){H[I++]=G}}return H},unique:function(K){var F=[],E={};try{for(var G=0,H=K.length;G<H;G++){var J=o.data(K[G]);if(!E[J]){E[J]=true;F.push(K[G])}}}catch(I){F=K}return F},grep:function(F,J,E){var G=[];for(var H=0,I=F.length;H<I;H++){if(!E!=!J(F[H],H)){G.push(F[H])}}return G},map:function(E,J){var F=[];for(var G=0,H=E.length;G<H;G++){var I=J(E[G],G);if(I!=null){F[F.length]=I}}return F.concat.apply([],F)}});var C=navigator.userAgent.toLowerCase();o.browser={version:(C.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],safari:/webkit/.test(C),opera:/opera/.test(C),msie:/msie/.test(C)&&!/opera/.test(C),mozilla:/mozilla/.test(C)&&!/(compatible|webkit)/.test(C)};o.each({parent:function(E){return E.parentNode},parents:function(E){return o.dir(E,"parentNode")},next:function(E){return o.nth(E,2,"nextSibling")},prev:function(E){return o.nth(E,2,"previousSibling")},nextAll:function(E){return o.dir(E,"nextSibling")},prevAll:function(E){return o.dir(E,"previousSibling")},siblings:function(E){return o.sibling(E.parentNode.firstChild,E)},children:function(E){return o.sibling(E.firstChild)},contents:function(E){return o.nodeName(E,"iframe")?E.contentDocument||E.contentWindow.document:o.makeArray(E.childNodes)}},function(E,F){o.fn[E]=function(G){var H=o.map(this,F);if(G&&typeof G=="string"){H=o.multiFilter(G,H)}return this.pushStack(o.unique(H),E,G)}});o.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(E,F){o.fn[E]=function(G){var J=[],L=o(G);for(var K=0,H=L.length;K<H;K++){var I=(K>0?this.clone(true):this).get();o.fn[F].apply(o(L[K]),I);J=J.concat(I)}return this.pushStack(J,E,G)}});o.each({removeAttr:function(E){o.attr(this,E,"");if(this.nodeType==1){this.removeAttribute(E)}},addClass:function(E){o.className.add(this,E)},removeClass:function(E){o.className.remove(this,E)},toggleClass:function(F,E){if(typeof E!=="boolean"){E=!o.className.has(this,F)}o.className[E?"add":"remove"](this,F)},remove:function(E){if(!E||o.filter(E,[this]).length){o("*",this).add([this]).each(function(){o.event.remove(this);o.removeData(this)});if(this.parentNode){this.parentNode.removeChild(this)}}},empty:function(){o(this).children().remove();while(this.firstChild){this.removeChild(this.firstChild)}}},function(E,F){o.fn[E]=function(){return this.each(F,arguments)}});function j(E,F){return E[0]&&parseInt(o.curCSS(E[0],F,true),10)||0}var h="jQuery"+e(),v=0,A={};o.extend({cache:{},data:function(F,E,G){F=F==l?A:F;var H=F[h];if(!H){H=F[h]=++v}if(E&&!o.cache[H]){o.cache[H]={}}if(G!==g){o.cache[H][E]=G}return E?o.cache[H][E]:H},removeData:function(F,E){F=F==l?A:F;var H=F[h];if(E){if(o.cache[H]){delete o.cache[H][E];E="";for(E in o.cache[H]){break}if(!E){o.removeData(F)}}}else{try{delete F[h]}catch(G){if(F.removeAttribute){F.removeAttribute(h)}}delete o.cache[H]}},queue:function(F,E,H){if(F){E=(E||"fx")+"queue";var G=o.data(F,E);if(!G||o.isArray(H)){G=o.data(F,E,o.makeArray(H))}else{if(H){G.push(H)}}}return G},dequeue:function(H,G){var E=o.queue(H,G),F=E.shift();if(!G||G==="fx"){F=E[0]}if(F!==g){F.call(H)}}});o.fn.extend({data:function(E,G){var H=E.split(".");H[1]=H[1]?"."+H[1]:"";if(G===g){var F=this.triggerHandler("getData"+H[1]+"!",[H[0]]);if(F===g&&this.length){F=o.data(this[0],E)}return F===g&&H[1]?this.data(H[0]):F}else{return this.trigger("setData"+H[1]+"!",[H[0],G]).each(function(){o.data(this,E,G)})}},removeData:function(E){return this.each(function(){o.removeData(this,E)})},queue:function(E,F){if(typeof E!=="string"){F=E;E="fx"}if(F===g){return o.queue(this[0],E)}return this.each(function(){var G=o.queue(this,E,F);if(E=="fx"&&G.length==1){G[0].call(this)}})},dequeue:function(E){return this.each(function(){o.dequeue(this,E)})}});
/*
 * Sizzle CSS Selector Engine - v0.9.3
 *  Copyright 2009, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */
(function(){var R=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?/g,L=0,H=Object.prototype.toString;var F=function(Y,U,ab,ac){ab=ab||[];U=U||document;if(U.nodeType!==1&&U.nodeType!==9){return[]}if(!Y||typeof Y!=="string"){return ab}var Z=[],W,af,ai,T,ad,V,X=true;R.lastIndex=0;while((W=R.exec(Y))!==null){Z.push(W[1]);if(W[2]){V=RegExp.rightContext;break}}if(Z.length>1&&M.exec(Y)){if(Z.length===2&&I.relative[Z[0]]){af=J(Z[0]+Z[1],U)}else{af=I.relative[Z[0]]?[U]:F(Z.shift(),U);while(Z.length){Y=Z.shift();if(I.relative[Y]){Y+=Z.shift()}af=J(Y,af)}}}else{var ae=ac?{expr:Z.pop(),set:E(ac)}:F.find(Z.pop(),Z.length===1&&U.parentNode?U.parentNode:U,Q(U));af=F.filter(ae.expr,ae.set);if(Z.length>0){ai=E(af)}else{X=false}while(Z.length){var ah=Z.pop(),ag=ah;if(!I.relative[ah]){ah=""}else{ag=Z.pop()}if(ag==null){ag=U}I.relative[ah](ai,ag,Q(U))}}if(!ai){ai=af}if(!ai){throw"Syntax error, unrecognized expression: "+(ah||Y)}if(H.call(ai)==="[object Array]"){if(!X){ab.push.apply(ab,ai)}else{if(U.nodeType===1){for(var aa=0;ai[aa]!=null;aa++){if(ai[aa]&&(ai[aa]===true||ai[aa].nodeType===1&&K(U,ai[aa]))){ab.push(af[aa])}}}else{for(var aa=0;ai[aa]!=null;aa++){if(ai[aa]&&ai[aa].nodeType===1){ab.push(af[aa])}}}}}else{E(ai,ab)}if(V){F(V,U,ab,ac);if(G){hasDuplicate=false;ab.sort(G);if(hasDuplicate){for(var aa=1;aa<ab.length;aa++){if(ab[aa]===ab[aa-1]){ab.splice(aa--,1)}}}}}return ab};F.matches=function(T,U){return F(T,null,null,U)};F.find=function(aa,T,ab){var Z,X;if(!aa){return[]}for(var W=0,V=I.order.length;W<V;W++){var Y=I.order[W],X;if((X=I.match[Y].exec(aa))){var U=RegExp.leftContext;if(U.substr(U.length-1)!=="\\"){X[1]=(X[1]||"").replace(/\\/g,"");Z=I.find[Y](X,T,ab);if(Z!=null){aa=aa.replace(I.match[Y],"");break}}}}if(!Z){Z=T.getElementsByTagName("*")}return{set:Z,expr:aa}};F.filter=function(ad,ac,ag,W){var V=ad,ai=[],aa=ac,Y,T,Z=ac&&ac[0]&&Q(ac[0]);while(ad&&ac.length){for(var ab in I.filter){if((Y=I.match[ab].exec(ad))!=null){var U=I.filter[ab],ah,af;T=false;if(aa==ai){ai=[]}if(I.preFilter[ab]){Y=I.preFilter[ab](Y,aa,ag,ai,W,Z);if(!Y){T=ah=true}else{if(Y===true){continue}}}if(Y){for(var X=0;(af=aa[X])!=null;X++){if(af){ah=U(af,Y,X,aa);var ae=W^!!ah;if(ag&&ah!=null){if(ae){T=true}else{aa[X]=false}}else{if(ae){ai.push(af);T=true}}}}}if(ah!==g){if(!ag){aa=ai}ad=ad.replace(I.match[ab],"");if(!T){return[]}break}}}if(ad==V){if(T==null){throw"Syntax error, unrecognized expression: "+ad}else{break}}V=ad}return aa};var I=F.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF_-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF_-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF_-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF_-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*_-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF_-]|\\.)+)(?:\((['"]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(T){return T.getAttribute("href")}},relative:{"+":function(aa,T,Z){var X=typeof T==="string",ab=X&&!/\W/.test(T),Y=X&&!ab;if(ab&&!Z){T=T.toUpperCase()}for(var W=0,V=aa.length,U;W<V;W++){if((U=aa[W])){while((U=U.previousSibling)&&U.nodeType!==1){}aa[W]=Y||U&&U.nodeName===T?U||false:U===T}}if(Y){F.filter(T,aa,true)}},">":function(Z,U,aa){var X=typeof U==="string";if(X&&!/\W/.test(U)){U=aa?U:U.toUpperCase();for(var V=0,T=Z.length;V<T;V++){var Y=Z[V];if(Y){var W=Y.parentNode;Z[V]=W.nodeName===U?W:false}}}else{for(var V=0,T=Z.length;V<T;V++){var Y=Z[V];if(Y){Z[V]=X?Y.parentNode:Y.parentNode===U}}if(X){F.filter(U,Z,true)}}},"":function(W,U,Y){var V=L++,T=S;if(!U.match(/\W/)){var X=U=Y?U:U.toUpperCase();T=P}T("parentNode",U,V,W,X,Y)},"~":function(W,U,Y){var V=L++,T=S;if(typeof U==="string"&&!U.match(/\W/)){var X=U=Y?U:U.toUpperCase();T=P}T("previousSibling",U,V,W,X,Y)}},find:{ID:function(U,V,W){if(typeof V.getElementById!=="undefined"&&!W){var T=V.getElementById(U[1]);return T?[T]:[]}},NAME:function(V,Y,Z){if(typeof Y.getElementsByName!=="undefined"){var U=[],X=Y.getElementsByName(V[1]);for(var W=0,T=X.length;W<T;W++){if(X[W].getAttribute("name")===V[1]){U.push(X[W])}}return U.length===0?null:U}},TAG:function(T,U){return U.getElementsByTagName(T[1])}},preFilter:{CLASS:function(W,U,V,T,Z,aa){W=" "+W[1].replace(/\\/g,"")+" ";if(aa){return W}for(var X=0,Y;(Y=U[X])!=null;X++){if(Y){if(Z^(Y.className&&(" "+Y.className+" ").indexOf(W)>=0)){if(!V){T.push(Y)}}else{if(V){U[X]=false}}}}return false},ID:function(T){return T[1].replace(/\\/g,"")},TAG:function(U,T){for(var V=0;T[V]===false;V++){}return T[V]&&Q(T[V])?U[1]:U[1].toUpperCase()},CHILD:function(T){if(T[1]=="nth"){var U=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(T[2]=="even"&&"2n"||T[2]=="odd"&&"2n+1"||!/\D/.test(T[2])&&"0n+"+T[2]||T[2]);T[2]=(U[1]+(U[2]||1))-0;T[3]=U[3]-0}T[0]=L++;return T},ATTR:function(X,U,V,T,Y,Z){var W=X[1].replace(/\\/g,"");if(!Z&&I.attrMap[W]){X[1]=I.attrMap[W]}if(X[2]==="~="){X[4]=" "+X[4]+" "}return X},PSEUDO:function(X,U,V,T,Y){if(X[1]==="not"){if(X[3].match(R).length>1||/^\w/.test(X[3])){X[3]=F(X[3],null,null,U)}else{var W=F.filter(X[3],U,V,true^Y);if(!V){T.push.apply(T,W)}return false}}else{if(I.match.POS.test(X[0])||I.match.CHILD.test(X[0])){return true}}return X},POS:function(T){T.unshift(true);return T}},filters:{enabled:function(T){return T.disabled===false&&T.type!=="hidden"},disabled:function(T){return T.disabled===true},checked:function(T){return T.checked===true},selected:function(T){T.parentNode.selectedIndex;return T.selected===true},parent:function(T){return !!T.firstChild},empty:function(T){return !T.firstChild},has:function(V,U,T){return !!F(T[3],V).length},header:function(T){return/h\d/i.test(T.nodeName)},text:function(T){return"text"===T.type},radio:function(T){return"radio"===T.type},checkbox:function(T){return"checkbox"===T.type},file:function(T){return"file"===T.type},password:function(T){return"password"===T.type},submit:function(T){return"submit"===T.type},image:function(T){return"image"===T.type},reset:function(T){return"reset"===T.type},button:function(T){return"button"===T.type||T.nodeName.toUpperCase()==="BUTTON"},input:function(T){return/input|select|textarea|button/i.test(T.nodeName)}},setFilters:{first:function(U,T){return T===0},last:function(V,U,T,W){return U===W.length-1},even:function(U,T){return T%2===0},odd:function(U,T){return T%2===1},lt:function(V,U,T){return U<T[3]-0},gt:function(V,U,T){return U>T[3]-0},nth:function(V,U,T){return T[3]-0==U},eq:function(V,U,T){return T[3]-0==U}},filter:{PSEUDO:function(Z,V,W,aa){var U=V[1],X=I.filters[U];if(X){return X(Z,W,V,aa)}else{if(U==="contains"){return(Z.textContent||Z.innerText||"").indexOf(V[3])>=0}else{if(U==="not"){var Y=V[3];for(var W=0,T=Y.length;W<T;W++){if(Y[W]===Z){return false}}return true}}}},CHILD:function(T,W){var Z=W[1],U=T;switch(Z){case"only":case"first":while(U=U.previousSibling){if(U.nodeType===1){return false}}if(Z=="first"){return true}U=T;case"last":while(U=U.nextSibling){if(U.nodeType===1){return false}}return true;case"nth":var V=W[2],ac=W[3];if(V==1&&ac==0){return true}var Y=W[0],ab=T.parentNode;if(ab&&(ab.sizcache!==Y||!T.nodeIndex)){var X=0;for(U=ab.firstChild;U;U=U.nextSibling){if(U.nodeType===1){U.nodeIndex=++X}}ab.sizcache=Y}var aa=T.nodeIndex-ac;if(V==0){return aa==0}else{return(aa%V==0&&aa/V>=0)}}},ID:function(U,T){return U.nodeType===1&&U.getAttribute("id")===T},TAG:function(U,T){return(T==="*"&&U.nodeType===1)||U.nodeName===T},CLASS:function(U,T){return(" "+(U.className||U.getAttribute("class"))+" ").indexOf(T)>-1},ATTR:function(Y,W){var V=W[1],T=I.attrHandle[V]?I.attrHandle[V](Y):Y[V]!=null?Y[V]:Y.getAttribute(V),Z=T+"",X=W[2],U=W[4];return T==null?X==="!=":X==="="?Z===U:X==="*="?Z.indexOf(U)>=0:X==="~="?(" "+Z+" ").indexOf(U)>=0:!U?Z&&T!==false:X==="!="?Z!=U:X==="^="?Z.indexOf(U)===0:X==="$="?Z.substr(Z.length-U.length)===U:X==="|="?Z===U||Z.substr(0,U.length+1)===U+"-":false},POS:function(X,U,V,Y){var T=U[2],W=I.setFilters[T];if(W){return W(X,V,U,Y)}}}};var M=I.match.POS;for(var O in I.match){I.match[O]=RegExp(I.match[O].source+/(?![^\[]*\])(?![^\(]*\))/.source)}var E=function(U,T){U=Array.prototype.slice.call(U);if(T){T.push.apply(T,U);return T}return U};try{Array.prototype.slice.call(document.documentElement.childNodes)}catch(N){E=function(X,W){var U=W||[];if(H.call(X)==="[object Array]"){Array.prototype.push.apply(U,X)}else{if(typeof X.length==="number"){for(var V=0,T=X.length;V<T;V++){U.push(X[V])}}else{for(var V=0;X[V];V++){U.push(X[V])}}}return U}}var G;if(document.documentElement.compareDocumentPosition){G=function(U,T){var V=U.compareDocumentPosition(T)&4?-1:U===T?0:1;if(V===0){hasDuplicate=true}return V}}else{if("sourceIndex" in document.documentElement){G=function(U,T){var V=U.sourceIndex-T.sourceIndex;if(V===0){hasDuplicate=true}return V}}else{if(document.createRange){G=function(W,U){var V=W.ownerDocument.createRange(),T=U.ownerDocument.createRange();V.selectNode(W);V.collapse(true);T.selectNode(U);T.collapse(true);var X=V.compareBoundaryPoints(Range.START_TO_END,T);if(X===0){hasDuplicate=true}return X}}}}(function(){var U=document.createElement("form"),V="script"+(new Date).getTime();U.innerHTML="<input name='"+V+"'/>";var T=document.documentElement;T.insertBefore(U,T.firstChild);if(!!document.getElementById(V)){I.find.ID=function(X,Y,Z){if(typeof Y.getElementById!=="undefined"&&!Z){var W=Y.getElementById(X[1]);return W?W.id===X[1]||typeof W.getAttributeNode!=="undefined"&&W.getAttributeNode("id").nodeValue===X[1]?[W]:g:[]}};I.filter.ID=function(Y,W){var X=typeof Y.getAttributeNode!=="undefined"&&Y.getAttributeNode("id");return Y.nodeType===1&&X&&X.nodeValue===W}}T.removeChild(U)})();(function(){var T=document.createElement("div");T.appendChild(document.createComment(""));if(T.getElementsByTagName("*").length>0){I.find.TAG=function(U,Y){var X=Y.getElementsByTagName(U[1]);if(U[1]==="*"){var W=[];for(var V=0;X[V];V++){if(X[V].nodeType===1){W.push(X[V])}}X=W}return X}}T.innerHTML="<a href='#'></a>";if(T.firstChild&&typeof T.firstChild.getAttribute!=="undefined"&&T.firstChild.getAttribute("href")!=="#"){I.attrHandle.href=function(U){return U.getAttribute("href",2)}}})();if(document.querySelectorAll){(function(){var T=F,U=document.createElement("div");U.innerHTML="<p class='TEST'></p>";if(U.querySelectorAll&&U.querySelectorAll(".TEST").length===0){return}F=function(Y,X,V,W){X=X||document;if(!W&&X.nodeType===9&&!Q(X)){try{return E(X.querySelectorAll(Y),V)}catch(Z){}}return T(Y,X,V,W)};F.find=T.find;F.filter=T.filter;F.selectors=T.selectors;F.matches=T.matches})()}if(document.getElementsByClassName&&document.documentElement.getElementsByClassName){(function(){var T=document.createElement("div");T.innerHTML="<div class='test e'></div><div class='test'></div>";if(T.getElementsByClassName("e").length===0){return}T.lastChild.className="e";if(T.getElementsByClassName("e").length===1){return}I.order.splice(1,0,"CLASS");I.find.CLASS=function(U,V,W){if(typeof V.getElementsByClassName!=="undefined"&&!W){return V.getElementsByClassName(U[1])}}})()}function P(U,Z,Y,ad,aa,ac){var ab=U=="previousSibling"&&!ac;for(var W=0,V=ad.length;W<V;W++){var T=ad[W];if(T){if(ab&&T.nodeType===1){T.sizcache=Y;T.sizset=W}T=T[U];var X=false;while(T){if(T.sizcache===Y){X=ad[T.sizset];break}if(T.nodeType===1&&!ac){T.sizcache=Y;T.sizset=W}if(T.nodeName===Z){X=T;break}T=T[U]}ad[W]=X}}}function S(U,Z,Y,ad,aa,ac){var ab=U=="previousSibling"&&!ac;for(var W=0,V=ad.length;W<V;W++){var T=ad[W];if(T){if(ab&&T.nodeType===1){T.sizcache=Y;T.sizset=W}T=T[U];var X=false;while(T){if(T.sizcache===Y){X=ad[T.sizset];break}if(T.nodeType===1){if(!ac){T.sizcache=Y;T.sizset=W}if(typeof Z!=="string"){if(T===Z){X=true;break}}else{if(F.filter(Z,[T]).length>0){X=T;break}}}T=T[U]}ad[W]=X}}}var K=document.compareDocumentPosition?function(U,T){return U.compareDocumentPosition(T)&16}:function(U,T){return U!==T&&(U.contains?U.contains(T):true)};var Q=function(T){return T.nodeType===9&&T.documentElement.nodeName!=="HTML"||!!T.ownerDocument&&Q(T.ownerDocument)};var J=function(T,aa){var W=[],X="",Y,V=aa.nodeType?[aa]:aa;while((Y=I.match.PSEUDO.exec(T))){X+=Y[0];T=T.replace(I.match.PSEUDO,"")}T=I.relative[T]?T+"*":T;for(var Z=0,U=V.length;Z<U;Z++){F(T,V[Z],W)}return F.filter(X,W)};o.find=F;o.filter=F.filter;o.expr=F.selectors;o.expr[":"]=o.expr.filters;F.selectors.filters.hidden=function(T){return T.offsetWidth===0||T.offsetHeight===0};F.selectors.filters.visible=function(T){return T.offsetWidth>0||T.offsetHeight>0};F.selectors.filters.animated=function(T){return o.grep(o.timers,function(U){return T===U.elem}).length};o.multiFilter=function(V,T,U){if(U){V=":not("+V+")"}return F.matches(V,T)};o.dir=function(V,U){var T=[],W=V[U];while(W&&W!=document){if(W.nodeType==1){T.push(W)}W=W[U]}return T};o.nth=function(X,T,V,W){T=T||1;var U=0;for(;X;X=X[V]){if(X.nodeType==1&&++U==T){break}}return X};o.sibling=function(V,U){var T=[];for(;V;V=V.nextSibling){if(V.nodeType==1&&V!=U){T.push(V)}}return T};return;l.Sizzle=F})();o.event={add:function(I,F,H,K){if(I.nodeType==3||I.nodeType==8){return}if(I.setInterval&&I!=l){I=l}if(!H.guid){H.guid=this.guid++}if(K!==g){var G=H;H=this.proxy(G);H.data=K}var E=o.data(I,"events")||o.data(I,"events",{}),J=o.data(I,"handle")||o.data(I,"handle",function(){return typeof o!=="undefined"&&!o.event.triggered?o.event.handle.apply(arguments.callee.elem,arguments):g});J.elem=I;o.each(F.split(/\s+/),function(M,N){var O=N.split(".");N=O.shift();H.type=O.slice().sort().join(".");var L=E[N];if(o.event.specialAll[N]){o.event.specialAll[N].setup.call(I,K,O)}if(!L){L=E[N]={};if(!o.event.special[N]||o.event.special[N].setup.call(I,K,O)===false){if(I.addEventListener){I.addEventListener(N,J,false)}else{if(I.attachEvent){I.attachEvent("on"+N,J)}}}}L[H.guid]=H;o.event.global[N]=true});I=null},guid:1,global:{},remove:function(K,H,J){if(K.nodeType==3||K.nodeType==8){return}var G=o.data(K,"events"),F,E;if(G){if(H===g||(typeof H==="string"&&H.charAt(0)==".")){for(var I in G){this.remove(K,I+(H||""))}}else{if(H.type){J=H.handler;H=H.type}o.each(H.split(/\s+/),function(M,O){var Q=O.split(".");O=Q.shift();var N=RegExp("(^|\\.)"+Q.slice().sort().join(".*\\.")+"(\\.|$)");if(G[O]){if(J){delete G[O][J.guid]}else{for(var P in G[O]){if(N.test(G[O][P].type)){delete G[O][P]}}}if(o.event.specialAll[O]){o.event.specialAll[O].teardown.call(K,Q)}for(F in G[O]){break}if(!F){if(!o.event.special[O]||o.event.special[O].teardown.call(K,Q)===false){if(K.removeEventListener){K.removeEventListener(O,o.data(K,"handle"),false)}else{if(K.detachEvent){K.detachEvent("on"+O,o.data(K,"handle"))}}}F=null;delete G[O]}}})}for(F in G){break}if(!F){var L=o.data(K,"handle");if(L){L.elem=null}o.removeData(K,"events");o.removeData(K,"handle")}}},trigger:function(I,K,H,E){var G=I.type||I;if(!E){I=typeof I==="object"?I[h]?I:o.extend(o.Event(G),I):o.Event(G);if(G.indexOf("!")>=0){I.type=G=G.slice(0,-1);I.exclusive=true}if(!H){I.stopPropagation();if(this.global[G]){o.each(o.cache,function(){if(this.events&&this.events[G]){o.event.trigger(I,K,this.handle.elem)}})}}if(!H||H.nodeType==3||H.nodeType==8){return g}I.result=g;I.target=H;K=o.makeArray(K);K.unshift(I)}I.currentTarget=H;var J=o.data(H,"handle");if(J){J.apply(H,K)}if((!H[G]||(o.nodeName(H,"a")&&G=="click"))&&H["on"+G]&&H["on"+G].apply(H,K)===false){I.result=false}if(!E&&H[G]&&!I.isDefaultPrevented()&&!(o.nodeName(H,"a")&&G=="click")){this.triggered=true;try{H[G]()}catch(L){}}this.triggered=false;if(!I.isPropagationStopped()){var F=H.parentNode||H.ownerDocument;if(F){o.event.trigger(I,K,F,true)}}},handle:function(K){var J,E;K=arguments[0]=o.event.fix(K||l.event);K.currentTarget=this;var L=K.type.split(".");K.type=L.shift();J=!L.length&&!K.exclusive;var I=RegExp("(^|\\.)"+L.slice().sort().join(".*\\.")+"(\\.|$)");E=(o.data(this,"events")||{})[K.type];for(var G in E){var H=E[G];if(J||I.test(H.type)){K.handler=H;K.data=H.data;var F=H.apply(this,arguments);if(F!==g){K.result=F;if(F===false){K.preventDefault();K.stopPropagation()}}if(K.isImmediatePropagationStopped()){break}}}},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(H){if(H[h]){return H}var F=H;H=o.Event(F);for(var G=this.props.length,J;G;){J=this.props[--G];H[J]=F[J]}if(!H.target){H.target=H.srcElement||document}if(H.target.nodeType==3){H.target=H.target.parentNode}if(!H.relatedTarget&&H.fromElement){H.relatedTarget=H.fromElement==H.target?H.toElement:H.fromElement}if(H.pageX==null&&H.clientX!=null){var I=document.documentElement,E=document.body;H.pageX=H.clientX+(I&&I.scrollLeft||E&&E.scrollLeft||0)-(I.clientLeft||0);H.pageY=H.clientY+(I&&I.scrollTop||E&&E.scrollTop||0)-(I.clientTop||0)}if(!H.which&&((H.charCode||H.charCode===0)?H.charCode:H.keyCode)){H.which=H.charCode||H.keyCode}if(!H.metaKey&&H.ctrlKey){H.metaKey=H.ctrlKey}if(!H.which&&H.button){H.which=(H.button&1?1:(H.button&2?3:(H.button&4?2:0)))}return H},proxy:function(F,E){E=E||function(){return F.apply(this,arguments)};E.guid=F.guid=F.guid||E.guid||this.guid++;return E},special:{ready:{setup:B,teardown:function(){}}},specialAll:{live:{setup:function(E,F){o.event.add(this,F[0],c)},teardown:function(G){if(G.length){var E=0,F=RegExp("(^|\\.)"+G[0]+"(\\.|$)");o.each((o.data(this,"events").live||{}),function(){if(F.test(this.type)){E++}});if(E<1){o.event.remove(this,G[0],c)}}}}}};o.Event=function(E){if(!this.preventDefault){return new o.Event(E)}if(E&&E.type){this.originalEvent=E;this.type=E.type}else{this.type=E}this.timeStamp=e();this[h]=true};function k(){return false}function u(){return true}o.Event.prototype={preventDefault:function(){this.isDefaultPrevented=u;var E=this.originalEvent;if(!E){return}if(E.preventDefault){E.preventDefault()}E.returnValue=false},stopPropagation:function(){this.isPropagationStopped=u;var E=this.originalEvent;if(!E){return}if(E.stopPropagation){E.stopPropagation()}E.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=u;this.stopPropagation()},isDefaultPrevented:k,isPropagationStopped:k,isImmediatePropagationStopped:k};var a=function(F){var E=F.relatedTarget;while(E&&E!=this){try{E=E.parentNode}catch(G){E=this}}if(E!=this){F.type=F.data;o.event.handle.apply(this,arguments)}};o.each({mouseover:"mouseenter",mouseout:"mouseleave"},function(F,E){o.event.special[E]={setup:function(){o.event.add(this,F,a,E)},teardown:function(){o.event.remove(this,F,a)}}});o.fn.extend({bind:function(F,G,E){return F=="unload"?this.one(F,G,E):this.each(function(){o.event.add(this,F,E||G,E&&G)})},one:function(G,H,F){var E=o.event.proxy(F||H,function(I){o(this).unbind(I,E);return(F||H).apply(this,arguments)});return this.each(function(){o.event.add(this,G,E,F&&H)})},unbind:function(F,E){return this.each(function(){o.event.remove(this,F,E)})},trigger:function(E,F){return this.each(function(){o.event.trigger(E,F,this)})},triggerHandler:function(E,G){if(this[0]){var F=o.Event(E);F.preventDefault();F.stopPropagation();o.event.trigger(F,G,this[0]);return F.result}},toggle:function(G){var E=arguments,F=1;while(F<E.length){o.event.proxy(G,E[F++])}return this.click(o.event.proxy(G,function(H){this.lastToggle=(this.lastToggle||0)%F;H.preventDefault();return E[this.lastToggle++].apply(this,arguments)||false}))},hover:function(E,F){return this.mouseenter(E).mouseleave(F)},ready:function(E){B();if(o.isReady){E.call(document,o)}else{o.readyList.push(E)}return this},live:function(G,F){var E=o.event.proxy(F);E.guid+=this.selector+G;o(document).bind(i(G,this.selector),this.selector,E);return this},die:function(F,E){o(document).unbind(i(F,this.selector),E?{guid:E.guid+this.selector+F}:null);return this}});function c(H){var E=RegExp("(^|\\.)"+H.type+"(\\.|$)"),G=true,F=[];o.each(o.data(this,"events").live||[],function(I,J){if(E.test(J.type)){var K=o(H.target).closest(J.data)[0];if(K){F.push({elem:K,fn:J})}}});F.sort(function(J,I){return o.data(J.elem,"closest")-o.data(I.elem,"closest")});o.each(F,function(){if(this.fn.call(this.elem,H,this.fn.data)===false){return(G=false)}});return G}function i(F,E){return["live",F,E.replace(/\./g,"`").replace(/ /g,"|")].join(".")}o.extend({isReady:false,readyList:[],ready:function(){if(!o.isReady){o.isReady=true;if(o.readyList){o.each(o.readyList,function(){this.call(document,o)});o.readyList=null}o(document).triggerHandler("ready")}}});var x=false;function B(){if(x){return}x=true;if(document.addEventListener){document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,false);o.ready()},false)}else{if(document.attachEvent){document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",arguments.callee);o.ready()}});if(document.documentElement.doScroll&&l==l.top){(function(){if(o.isReady){return}try{document.documentElement.doScroll("left")}catch(E){setTimeout(arguments.callee,0);return}o.ready()})()}}}o.event.add(l,"load",o.ready)}o.each(("blur,focus,load,resize,scroll,unload,click,dblclick,mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,change,select,submit,keydown,keypress,keyup,error").split(","),function(F,E){o.fn[E]=function(G){return G?this.bind(E,G):this.trigger(E)}});o(l).bind("unload",function(){for(var E in o.cache){if(E!=1&&o.cache[E].handle){o.event.remove(o.cache[E].handle.elem)}}});(function(){o.support={};var F=document.documentElement,G=document.createElement("script"),K=document.createElement("div"),J="script"+(new Date).getTime();K.style.display="none";K.innerHTML='   <link/><table></table><a href="/a" style="color:red;float:left;opacity:.5;">a</a><select><option>text</option></select><object><param/></object>';var H=K.getElementsByTagName("*"),E=K.getElementsByTagName("a")[0];if(!H||!H.length||!E){return}o.support={leadingWhitespace:K.firstChild.nodeType==3,tbody:!K.getElementsByTagName("tbody").length,objectAll:!!K.getElementsByTagName("object")[0].getElementsByTagName("*").length,htmlSerialize:!!K.getElementsByTagName("link").length,style:/red/.test(E.getAttribute("style")),hrefNormalized:E.getAttribute("href")==="/a",opacity:E.style.opacity==="0.5",cssFloat:!!E.style.cssFloat,scriptEval:false,noCloneEvent:true,boxModel:null};G.type="text/javascript";try{G.appendChild(document.createTextNode("window."+J+"=1;"))}catch(I){}F.insertBefore(G,F.firstChild);if(l[J]){o.support.scriptEval=true;delete l[J]}F.removeChild(G);if(K.attachEvent&&K.fireEvent){K.attachEvent("onclick",function(){o.support.noCloneEvent=false;K.detachEvent("onclick",arguments.callee)});K.cloneNode(true).fireEvent("onclick")}o(function(){var L=document.createElement("div");L.style.width=L.style.paddingLeft="1px";document.body.appendChild(L);o.boxModel=o.support.boxModel=L.offsetWidth===2;document.body.removeChild(L).style.display="none"})})();var w=o.support.cssFloat?"cssFloat":"styleFloat";o.props={"for":"htmlFor","class":"className","float":w,cssFloat:w,styleFloat:w,readonly:"readOnly",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",tabindex:"tabIndex"};o.fn.extend({_load:o.fn.load,load:function(G,J,K){if(typeof G!=="string"){return this._load(G)}var I=G.indexOf(" ");if(I>=0){var E=G.slice(I,G.length);G=G.slice(0,I)}var H="GET";if(J){if(o.isFunction(J)){K=J;J=null}else{if(typeof J==="object"){J=o.param(J);H="POST"}}}var F=this;o.ajax({url:G,type:H,dataType:"html",data:J,complete:function(M,L){if(L=="success"||L=="notmodified"){F.html(E?o("<div/>").append(M.responseText.replace(/<script(.|\s)*?\/script>/g,"")).find(E):M.responseText)}if(K){F.each(K,[M.responseText,L,M])}}});return this},serialize:function(){return o.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?o.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||/select|textarea/i.test(this.nodeName)||/text|hidden|password|search/i.test(this.type))}).map(function(E,F){var G=o(this).val();return G==null?null:o.isArray(G)?o.map(G,function(I,H){return{name:F.name,value:I}}):{name:F.name,value:G}}).get()}});o.each("ajaxStart,ajaxStop,ajaxComplete,ajaxError,ajaxSuccess,ajaxSend".split(","),function(E,F){o.fn[F]=function(G){return this.bind(F,G)}});var r=e();o.extend({get:function(E,G,H,F){if(o.isFunction(G)){H=G;G=null}return o.ajax({type:"GET",url:E,data:G,success:H,dataType:F})},getScript:function(E,F){return o.get(E,null,F,"script")},getJSON:function(E,F,G){return o.get(E,F,G,"json")},post:function(E,G,H,F){if(o.isFunction(G)){H=G;G={}}return o.ajax({type:"POST",url:E,data:G,success:H,dataType:F})},ajaxSetup:function(E){o.extend(o.ajaxSettings,E)},ajaxSettings:{url:location.href,global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,xhr:function(){return l.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest()},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},lastModified:{},ajax:function(M){M=o.extend(true,M,o.extend(true,{},o.ajaxSettings,M));var W,F=/=\?(&|$)/g,R,V,G=M.type.toUpperCase();if(M.data&&M.processData&&typeof M.data!=="string"){M.data=o.param(M.data)}if(M.dataType=="jsonp"){if(G=="GET"){if(!M.url.match(F)){M.url+=(M.url.match(/\?/)?"&":"?")+(M.jsonp||"callback")+"=?"}}else{if(!M.data||!M.data.match(F)){M.data=(M.data?M.data+"&":"")+(M.jsonp||"callback")+"=?"}}M.dataType="json"}if(M.dataType=="json"&&(M.data&&M.data.match(F)||M.url.match(F))){W="jsonp"+r++;if(M.data){M.data=(M.data+"").replace(F,"="+W+"$1")}M.url=M.url.replace(F,"="+W+"$1");M.dataType="script";l[W]=function(X){V=X;I();L();l[W]=g;try{delete l[W]}catch(Y){}if(H){H.removeChild(T)}}}if(M.dataType=="script"&&M.cache==null){M.cache=false}if(M.cache===false&&G=="GET"){var E=e();var U=M.url.replace(/(\?|&)_=.*?(&|$)/,"$1_="+E+"$2");M.url=U+((U==M.url)?(M.url.match(/\?/)?"&":"?")+"_="+E:"")}if(M.data&&G=="GET"){M.url+=(M.url.match(/\?/)?"&":"?")+M.data;M.data=null}if(M.global&&!o.active++){o.event.trigger("ajaxStart")}var Q=/^(\w+:)?\/\/([^\/?#]+)/.exec(M.url);if(M.dataType=="script"&&G=="GET"&&Q&&(Q[1]&&Q[1]!=location.protocol||Q[2]!=location.host)){var H=document.getElementsByTagName("head")[0];var T=document.createElement("script");T.src=M.url;if(M.scriptCharset){T.charset=M.scriptCharset}if(!W){var O=false;T.onload=T.onreadystatechange=function(){if(!O&&(!this.readyState||this.readyState=="loaded"||this.readyState=="complete")){O=true;I();L();T.onload=T.onreadystatechange=null;H.removeChild(T)}}}H.appendChild(T);return g}var K=false;var J=M.xhr();if(M.username){J.open(G,M.url,M.async,M.username,M.password)}else{J.open(G,M.url,M.async)}try{if(M.data){J.setRequestHeader("Content-Type",M.contentType)}if(M.ifModified){J.setRequestHeader("If-Modified-Since",o.lastModified[M.url]||"Thu, 01 Jan 1970 00:00:00 GMT")}J.setRequestHeader("X-Requested-With","XMLHttpRequest");J.setRequestHeader("Accept",M.dataType&&M.accepts[M.dataType]?M.accepts[M.dataType]+", */*":M.accepts._default)}catch(S){}if(M.beforeSend&&M.beforeSend(J,M)===false){if(M.global&&!--o.active){o.event.trigger("ajaxStop")}J.abort();return false}if(M.global){o.event.trigger("ajaxSend",[J,M])}var N=function(X){if(J.readyState==0){if(P){clearInterval(P);P=null;if(M.global&&!--o.active){o.event.trigger("ajaxStop")}}}else{if(!K&&J&&(J.readyState==4||X=="timeout")){K=true;if(P){clearInterval(P);P=null}R=X=="timeout"?"timeout":!o.httpSuccess(J)?"error":M.ifModified&&o.httpNotModified(J,M.url)?"notmodified":"success";if(R=="success"){try{V=o.httpData(J,M.dataType,M)}catch(Z){R="parsererror"}}if(R=="success"){var Y;try{Y=J.getResponseHeader("Last-Modified")}catch(Z){}if(M.ifModified&&Y){o.lastModified[M.url]=Y}if(!W){I()}}else{o.handleError(M,J,R)}L();if(X){J.abort()}if(M.async){J=null}}}};if(M.async){var P=setInterval(N,13);if(M.timeout>0){setTimeout(function(){if(J&&!K){N("timeout")}},M.timeout)}}try{J.send(M.data)}catch(S){o.handleError(M,J,null,S)}if(!M.async){N()}function I(){if(M.success){M.success(V,R)}if(M.global){o.event.trigger("ajaxSuccess",[J,M])}}function L(){if(M.complete){M.complete(J,R)}if(M.global){o.event.trigger("ajaxComplete",[J,M])}if(M.global&&!--o.active){o.event.trigger("ajaxStop")}}return J},handleError:function(F,H,E,G){if(F.error){F.error(H,E,G)}if(F.global){o.event.trigger("ajaxError",[H,F,G])}},active:0,httpSuccess:function(F){try{return !F.status&&location.protocol=="file:"||(F.status>=200&&F.status<300)||F.status==304||F.status==1223}catch(E){}return false},httpNotModified:function(G,E){try{var H=G.getResponseHeader("Last-Modified");return G.status==304||H==o.lastModified[E]}catch(F){}return false},httpData:function(J,H,G){var F=J.getResponseHeader("content-type"),E=H=="xml"||!H&&F&&F.indexOf("xml")>=0,I=E?J.responseXML:J.responseText;if(E&&I.documentElement.tagName=="parsererror"){throw"parsererror"}if(G&&G.dataFilter){I=G.dataFilter(I,H)}if(typeof I==="string"){if(H=="script"){o.globalEval(I)}if(H=="json"){I=l["eval"]("("+I+")")}}return I},param:function(E){var G=[];function H(I,J){G[G.length]=encodeURIComponent(I)+"="+encodeURIComponent(J)}if(o.isArray(E)||E.jquery){o.each(E,function(){H(this.name,this.value)})}else{for(var F in E){if(o.isArray(E[F])){o.each(E[F],function(){H(F,this)})}else{H(F,o.isFunction(E[F])?E[F]():E[F])}}}return G.join("&").replace(/%20/g,"+")}});var m={},n,d=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];function t(F,E){var G={};o.each(d.concat.apply([],d.slice(0,E)),function(){G[this]=F});return G}o.fn.extend({show:function(J,L){if(J){return this.animate(t("show",3),J,L)}else{for(var H=0,F=this.length;H<F;H++){var E=o.data(this[H],"olddisplay");this[H].style.display=E||"";if(o.css(this[H],"display")==="none"){var G=this[H].tagName,K;if(m[G]){K=m[G]}else{var I=o("<"+G+" />").appendTo("body");K=I.css("display");if(K==="none"){K="block"}I.remove();m[G]=K}o.data(this[H],"olddisplay",K)}}for(var H=0,F=this.length;H<F;H++){this[H].style.display=o.data(this[H],"olddisplay")||""}return this}},hide:function(H,I){if(H){return this.animate(t("hide",3),H,I)}else{for(var G=0,F=this.length;G<F;G++){var E=o.data(this[G],"olddisplay");if(!E&&E!=="none"){o.data(this[G],"olddisplay",o.css(this[G],"display"))}}for(var G=0,F=this.length;G<F;G++){this[G].style.display="none"}return this}},_toggle:o.fn.toggle,toggle:function(G,F){var E=typeof G==="boolean";return o.isFunction(G)&&o.isFunction(F)?this._toggle.apply(this,arguments):G==null||E?this.each(function(){var H=E?G:o(this).is(":hidden");o(this)[H?"show":"hide"]()}):this.animate(t("toggle",3),G,F)},fadeTo:function(E,G,F){return this.animate({opacity:G},E,F)},animate:function(I,F,H,G){var E=o.speed(F,H,G);return this[E.queue===false?"each":"queue"](function(){var K=o.extend({},E),M,L=this.nodeType==1&&o(this).is(":hidden"),J=this;for(M in I){if(I[M]=="hide"&&L||I[M]=="show"&&!L){return K.complete.call(this)}if((M=="height"||M=="width")&&this.style){K.display=o.css(this,"display");K.overflow=this.style.overflow}}if(K.overflow!=null){this.style.overflow="hidden"}K.curAnim=o.extend({},I);o.each(I,function(O,S){var R=new o.fx(J,K,O);if(/toggle|show|hide/.test(S)){R[S=="toggle"?L?"show":"hide":S](I)}else{var Q=S.toString().match(/^([+-]=)?([\d+-.]+)(.*)$/),T=R.cur(true)||0;if(Q){var N=parseFloat(Q[2]),P=Q[3]||"px";if(P!="px"){J.style[O]=(N||1)+P;T=((N||1)/R.cur(true))*T;J.style[O]=T+P}if(Q[1]){N=((Q[1]=="-="?-1:1)*N)+T}R.custom(T,N,P)}else{R.custom(T,S,"")}}});return true})},stop:function(F,E){var G=o.timers;if(F){this.queue([])}this.each(function(){for(var H=G.length-1;H>=0;H--){if(G[H].elem==this){if(E){G[H](true)}G.splice(H,1)}}});if(!E){this.dequeue()}return this}});o.each({slideDown:t("show",1),slideUp:t("hide",1),slideToggle:t("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"}},function(E,F){o.fn[E]=function(G,H){return this.animate(F,G,H)}});o.extend({speed:function(G,H,F){var E=typeof G==="object"?G:{complete:F||!F&&H||o.isFunction(G)&&G,duration:G,easing:F&&H||H&&!o.isFunction(H)&&H};E.duration=o.fx.off?0:typeof E.duration==="number"?E.duration:o.fx.speeds[E.duration]||o.fx.speeds._default;E.old=E.complete;E.complete=function(){if(E.queue!==false){o(this).dequeue()}if(o.isFunction(E.old)){E.old.call(this)}};return E},easing:{linear:function(G,H,E,F){return E+F*G},swing:function(G,H,E,F){return((-Math.cos(G*Math.PI)/2)+0.5)*F+E}},timers:[],fx:function(F,E,G){this.options=E;this.elem=F;this.prop=G;if(!E.orig){E.orig={}}}});o.fx.prototype={update:function(){if(this.options.step){this.options.step.call(this.elem,this.now,this)}(o.fx.step[this.prop]||o.fx.step._default)(this);if((this.prop=="height"||this.prop=="width")&&this.elem.style){this.elem.style.display="block"}},cur:function(F){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null)){return this.elem[this.prop]}var E=parseFloat(o.css(this.elem,this.prop,F));return E&&E>-10000?E:parseFloat(o.curCSS(this.elem,this.prop))||0},custom:function(I,H,G){this.startTime=e();this.start=I;this.end=H;this.unit=G||this.unit||"px";this.now=this.start;this.pos=this.state=0;var E=this;function F(J){return E.step(J)}F.elem=this.elem;if(F()&&o.timers.push(F)&&!n){n=setInterval(function(){var K=o.timers;for(var J=0;J<K.length;J++){if(!K[J]()){K.splice(J--,1)}}if(!K.length){clearInterval(n);n=g}},13)}},show:function(){this.options.orig[this.prop]=o.attr(this.elem.style,this.prop);this.options.show=true;this.custom(this.prop=="width"||this.prop=="height"?1:0,this.cur());o(this.elem).show()},hide:function(){this.options.orig[this.prop]=o.attr(this.elem.style,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(H){var G=e();if(H||G>=this.options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();this.options.curAnim[this.prop]=true;var E=true;for(var F in this.options.curAnim){if(this.options.curAnim[F]!==true){E=false}}if(E){if(this.options.display!=null){this.elem.style.overflow=this.options.overflow;this.elem.style.display=this.options.display;if(o.css(this.elem,"display")=="none"){this.elem.style.display="block"}}if(this.options.hide){o(this.elem).hide()}if(this.options.hide||this.options.show){for(var I in this.options.curAnim){o.attr(this.elem.style,I,this.options.orig[I])}}this.options.complete.call(this.elem)}return false}else{var J=G-this.startTime;this.state=J/this.options.duration;this.pos=o.easing[this.options.easing||(o.easing.swing?"swing":"linear")](this.state,J,0,1,this.options.duration);this.now=this.start+((this.end-this.start)*this.pos);this.update()}return true}};o.extend(o.fx,{speeds:{slow:600,fast:200,_default:400},step:{opacity:function(E){o.attr(E.elem.style,"opacity",E.now)},_default:function(E){if(E.elem.style&&E.elem.style[E.prop]!=null){E.elem.style[E.prop]=E.now+E.unit}else{E.elem[E.prop]=E.now}}}});if(document.documentElement.getBoundingClientRect){o.fn.offset=function(){if(!this[0]){return{top:0,left:0}}if(this[0]===this[0].ownerDocument.body){return o.offset.bodyOffset(this[0])}var G=this[0].getBoundingClientRect(),J=this[0].ownerDocument,F=J.body,E=J.documentElement,L=E.clientTop||F.clientTop||0,K=E.clientLeft||F.clientLeft||0,I=G.top+(self.pageYOffset||o.boxModel&&E.scrollTop||F.scrollTop)-L,H=G.left+(self.pageXOffset||o.boxModel&&E.scrollLeft||F.scrollLeft)-K;return{top:I,left:H}}}else{o.fn.offset=function(){if(!this[0]){return{top:0,left:0}}if(this[0]===this[0].ownerDocument.body){return o.offset.bodyOffset(this[0])}o.offset.initialized||o.offset.initialize();var J=this[0],G=J.offsetParent,F=J,O=J.ownerDocument,M,H=O.documentElement,K=O.body,L=O.defaultView,E=L.getComputedStyle(J,null),N=J.offsetTop,I=J.offsetLeft;while((J=J.parentNode)&&J!==K&&J!==H){M=L.getComputedStyle(J,null);N-=J.scrollTop,I-=J.scrollLeft;if(J===G){N+=J.offsetTop,I+=J.offsetLeft;if(o.offset.doesNotAddBorder&&!(o.offset.doesAddBorderForTableAndCells&&/^t(able|d|h)$/i.test(J.tagName))){N+=parseInt(M.borderTopWidth,10)||0,I+=parseInt(M.borderLeftWidth,10)||0}F=G,G=J.offsetParent}if(o.offset.subtractsBorderForOverflowNotVisible&&M.overflow!=="visible"){N+=parseInt(M.borderTopWidth,10)||0,I+=parseInt(M.borderLeftWidth,10)||0}E=M}if(E.position==="relative"||E.position==="static"){N+=K.offsetTop,I+=K.offsetLeft}if(E.position==="fixed"){N+=Math.max(H.scrollTop,K.scrollTop),I+=Math.max(H.scrollLeft,K.scrollLeft)}return{top:N,left:I}}}o.offset={initialize:function(){if(this.initialized){return}var L=document.body,F=document.createElement("div"),H,G,N,I,M,E,J=L.style.marginTop,K='<div style="position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;"><div></div></div><table style="position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;" cellpadding="0" cellspacing="0"><tr><td></td></tr></table>';M={position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"};for(E in M){F.style[E]=M[E]}F.innerHTML=K;L.insertBefore(F,L.firstChild);H=F.firstChild,G=H.firstChild,I=H.nextSibling.firstChild.firstChild;this.doesNotAddBorder=(G.offsetTop!==5);this.doesAddBorderForTableAndCells=(I.offsetTop===5);H.style.overflow="hidden",H.style.position="relative";this.subtractsBorderForOverflowNotVisible=(G.offsetTop===-5);L.style.marginTop="1px";this.doesNotIncludeMarginInBodyOffset=(L.offsetTop===0);L.style.marginTop=J;L.removeChild(F);this.initialized=true},bodyOffset:function(E){o.offset.initialized||o.offset.initialize();var G=E.offsetTop,F=E.offsetLeft;if(o.offset.doesNotIncludeMarginInBodyOffset){G+=parseInt(o.curCSS(E,"marginTop",true),10)||0,F+=parseInt(o.curCSS(E,"marginLeft",true),10)||0}return{top:G,left:F}}};o.fn.extend({position:function(){var I=0,H=0,F;if(this[0]){var G=this.offsetParent(),J=this.offset(),E=/^body|html$/i.test(G[0].tagName)?{top:0,left:0}:G.offset();J.top-=j(this,"marginTop");J.left-=j(this,"marginLeft");E.top+=j(G,"borderTopWidth");E.left+=j(G,"borderLeftWidth");F={top:J.top-E.top,left:J.left-E.left}}return F},offsetParent:function(){var E=this[0].offsetParent||document.body;while(E&&(!/^body|html$/i.test(E.tagName)&&o.css(E,"position")=="static")){E=E.offsetParent}return o(E)}});o.each(["Left","Top"],function(F,E){var G="scroll"+E;o.fn[G]=function(H){if(!this[0]){return null}return H!==g?this.each(function(){this==l||this==document?l.scrollTo(!F?H:o(l).scrollLeft(),F?H:o(l).scrollTop()):this[G]=H}):this[0]==l||this[0]==document?self[F?"pageYOffset":"pageXOffset"]||o.boxModel&&document.documentElement[G]||document.body[G]:this[0][G]}});o.each(["Height","Width"],function(I,G){var E=I?"Left":"Top",H=I?"Right":"Bottom",F=G.toLowerCase();o.fn["inner"+G]=function(){return this[0]?o.css(this[0],F,false,"padding"):null};o.fn["outer"+G]=function(K){return this[0]?o.css(this[0],F,false,K?"margin":"border"):null};var J=G.toLowerCase();o.fn[J]=function(K){return this[0]==l?document.compatMode=="CSS1Compat"&&document.documentElement["client"+G]||document.body["client"+G]:this[0]==document?Math.max(document.documentElement["client"+G],document.body["scroll"+G],document.documentElement["scroll"+G],document.body["offset"+G],document.documentElement["offset"+G]):K===g?(this.length?o.css(this[0],J):null):this.css(J,typeof K==="string"?K:K+"px")}})})();
//]]>
</script>
<script id="jqueryArea" type="text/javascript">
//<![CDATA[
/*
jQuery.encoding.digests.sha1.js

SHA-1 digest and associated utility functions

Copyright (c) UnaMesa Association 2009

Dual licensed under the MIT and GPL licenses:
  http://www.opensource.org/licenses/mit-license.php
  http://www.gnu.org/licenses/gpl.html
*/

(function($) {

if(!$.encoding)
	$.encoding = {};
	$.extend($.encoding,{
		strToBe32s: function(str) {
			// Convert a string to an array of big-endian 32-bit words
			var be=[];
			var len=Math.floor(str.length/4);
			var i, j;
			for(i=0, j=0; i<len; i++, j+=4) {
				be[i]=((str.charCodeAt(j)&0xff) << 24)|((str.charCodeAt(j+1)&0xff) << 16)|((str.charCodeAt(j+2)&0xff) << 8)|(str.charCodeAt(j+3)&0xff);
			}
			while(j<str.length) {
				be[j>>2] |= (str.charCodeAt(j)&0xff)<<(24-(j*8)%32);
				j++;
			}
			return be;
		},
		be32sToStr: function(be) {
			// Convert an array of big-endian 32-bit words to a string
			var str='';
			for(var i=0;i<be.length*32;i+=8) {
				str += String.fromCharCode((be[i>>5]>>>(24-i%32)) & 0xff);
			}
			return str;
		},
		be32sToHex: function(be) {
			// Convert an array of big-endian 32-bit words to a hex string
			var hex='0123456789ABCDEF';
			var str='';
			for(var i=0;i<be.length*4;i++) {
				str += hex.charAt((be[i>>2]>>((3-i%4)*8+4))&0xF) + hex.charAt((be[i>>2]>>((3-i%4)*8))&0xF);
			}
			return str;
		}
	});
})(jQuery);


(function($) {

if(!$.encoding.digests)
	$.encoding.digests = {};
	$.extend($.encoding.digests,{
		hexSha1Str: function(str) {
			// Return, in hex, the SHA-1 hash of a string
			return $.encoding.be32sToHex($.encoding.digests.sha1Str(str));
		},
		sha1Str: function(str) {
			// Return the SHA-1 hash of a string
			return sha1($.encoding.strToBe32s(str),str.length);
		},
		sha1: function(x,blen) {
			// Calculate the SHA-1 hash of an array of blen bytes of big-endian 32-bit words
			return sha1($.encoding.strToBe32s(str),str.length);
		}
	});

	// Private functions.
	function sha1(x,blen) {
		// Calculate the SHA-1 hash of an array of blen bytes of big-endian 32-bit words
		function add32(a,b) {
			// Add 32-bit integers, wrapping at 32 bits
			// Uses 16-bit operations internally to work around bugs in some JavaScript interpreters.
			var lsw=(a&0xFFFF)+(b&0xFFFF);
			var msw=(a>>16)+(b>>16)+(lsw>>16);
			return (msw<<16)|(lsw&0xFFFF);
		}
		function AA(a,b,c,d,e) {
			// Cryptographic round helper function. Add five 32-bit integers, wrapping at 32 bits, second parameter is rotated left 5 bits before the addition
			// Uses 16-bit operations internally to work around bugs in some JavaScript interpreters.
			b=(b>>>27)|(b<<5);
			var lsw=(a&0xFFFF)+(b&0xFFFF)+(c&0xFFFF)+(d&0xFFFF)+(e&0xFFFF);
			var msw=(a>>16)+(b>>16)+(c>>16)+(d>>16)+(e>>16)+(lsw>>16);
			return (msw<<16)|(lsw&0xFFFF);
		}
		function RR(w,j) {
			// Cryptographic round helper function.
			var n=w[j-3]^w[j-8]^w[j-14]^w[j-16];
			return (n>>>31)|(n<<1);
		}

		var len=blen*8;
		x[len>>5] |= 0x80 << (24-len%32);
		x[((len+64>>9)<<4)+15]=len;
		var w=new Array(80);

		var k1=0x5A827999;
		var k2=0x6ED9EBA1;
		var k3=0x8F1BBCDC;
		var k4=0xCA62C1D6;

		var h0=0x67452301;
		var h1=0xEFCDAB89;
		var h2=0x98BADCFE;
		var h3=0x10325476;
		var h4=0xC3D2E1F0;

		for(var i=0;i<x.length;i+=16) {
			var j=0;
			var t;
			var a=h0;
			var b=h1;
			var c=h2;
			var d=h3;
			var e=h4;
			while(j<16) {
				w[j]=x[i+j];
				t=AA(e,a,d^(b&(c^d)),w[j],k1);
				e=d; d=c; c=(b>>>2)|(b<<30); b=a; a=t; j++;
			}
			while(j<20) {
				w[j]=RR(w,j);
				t=AA(e,a,d^(b&(c^d)),w[j],k1);
				e=d; d=c; c=(b>>>2)|(b<<30); b=a; a=t; j++;
			}
			while(j<40) {
				w[j]=RR(w,j);
				t=AA(e,a,b^c^d,w[j],k2);
				e=d; d=c; c=(b>>>2)|(b<<30); b=a; a=t; j++;
			}
			while(j<60) {
				w[j]=RR(w,j);
				t=AA(e,a,(b&c)|(d&(b|c)),w[j],k3);
				e=d; d=c; c=(b>>>2)|(b<<30); b=a; a=t; j++;
			}
			while(j<80) {
				w[j]=RR(w,j);
				t=AA(e,a,b^c^d,w[j],k4);
				e=d; d=c; c=(b>>>2)|(b<<30); b=a; a=t; j++;
			}
			h0=add32(h0,a);
			h1=add32(h1,b);
			h2=add32(h2,c);
			h3=add32(h3,d);
			h4=add32(h4,e);
		}
		return [h0,h1,h2,h3,h4];
	}
})(jQuery);
/*
jQuery.twFile.js

jQuery plugin for loading a file and saving data to a file

Copyright (c) UnaMesa Association 2009

Triple licensed under the BSD, MIT and GPL licenses:
  http://www.opensource.org/licenses/bsd-license.php
  http://www.opensource.org/licenses/mit-license.php
  http://www.gnu.org/licenses/gpl.html
*/

(function($) {
	if(!$.twFile) {
		$.twFile = {};
	}

	$.extend($.twFile,{
		currentDriver: null,
		driverList: ["activeX", "mozilla", "tiddlySaver", "javaLiveConnect"],

		getDriver: function() {
			if(this.currentDriver === null) {
				for(var t=0; t<this.driverList.length; t++) {
					if(this.currentDriver === null && drivers[this.driverList[t]].isAvailable && drivers[this.driverList[t]].isAvailable())
						this.currentDriver = drivers[this.driverList[t]];
				}
			}
			return this.currentDriver;
		},
		init: function() {
			this.getDriver();
		},
		load: function(filePath) {
			return this.getDriver().loadFile(filePath);
		},
		save: function(filePath,content) {
			return this.getDriver().saveFile(filePath,content);
		},
		copy: function(dest,source) {
			if(this.getDriver().copyFile)
				return this.currentDriver.copyFile(dest,source);
			else
				return false;
		}
	});

	// Deferred initialisation for any drivers that need it
	$(function() {
		for(var t in drivers) {
			if(drivers[t].deferredInit)
				drivers[t].deferredInit();
		}
	});

	// Private driver implementations for each browser

	var drivers = {};

	// Internet Explorer driver

	drivers.activeX = {
		name: "activeX",
		isAvailable: function() {
			try {
				var fso = new ActiveXObject("Scripting.FileSystemObject");
			} catch(ex) {
				return false;
			}
			return true;
		},
		loadFile: function(filePath) {
			// Returns null if it can't do it, false if there's an error, or a string of the content if successful
			try {
				var fso = new ActiveXObject("Scripting.FileSystemObject");
				var file = fso.OpenTextFile(filePath,1);
				var content = file.ReadAll();
				file.Close();
			} catch(ex) {
				return null;
			}
			return content;
		},
		createPath: function(path) {
			var pos = path.lastIndexOf("\\");
			if(pos!=-1)
				path = path.substring(0,pos+1);
			var scan = [path];
			try {
				var fso = new ActiveXObject("Scripting.FileSystemObject");
				var parent = fso.GetParentFolderName(path);
				while(parent && !fso.FolderExists(parent)) {
					scan.push(parent);
					parent = fso.GetParentFolderName(parent);
				}
				for(i=scan.length-1;i>=0;i--) {
					if(!fso.FolderExists(scan[i])) {
						fso.CreateFolder(scan[i]);
					}
				}
				return true;
			} catch(ex) {
			}
			return false;
		},
		copyFile: function(dest,source) {
			drivers.activeX.createPath(dest);
			try {
				var fso = new ActiveXObject("Scripting.FileSystemObject");
				fso.GetFile(source).Copy(dest);
			} catch(ex) {
				return false;
			}
			return true;
		},
		saveFile: function(filePath,content) {
			// Returns null if it can't do it, false if there's an error, true if it saved OK
			drivers.activeX.createPath(filePath);
			try {
				var fso = new ActiveXObject("Scripting.FileSystemObject");
				var file = fso.OpenTextFile(filePath,2,-1,0);
				file.Write(content);
				file.Close();
			} catch (ex) {
				return null;
			}
			return true;
		}
	};

	// Mozilla driver

	drivers.mozilla = {
		name: "mozilla",
		isAvailable: function() {
			return !!window.Components;
		},
		loadFile: function(filePath) {
			// Returns null if it can't do it, false if there's an error, or a string of the content if successful
			if(window.Components) {
				try {
					netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
					var file = Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);
					file.initWithPath(filePath);
					if(!file.exists())
						return null;
					var inputStream = Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(Components.interfaces.nsIFileInputStream);
					inputStream.init(file,0x01,4,null);
					var converter = Components.classes["@mozilla.org/intl/converter-input-stream;1"].createInstance(Components.interfaces.nsIConverterInputStream);
					converter.init(inputStream, "UTF-8", 0, 0);
					var buffer = {};
					var result = [];
					while(converter.readString(-1,buffer) != 0) {
						result.push(buffer.value);
					}
					converter.close();
					inputStream.close();
					return result.join("");
				} catch(ex) {
					return false;
				}
			}
			return null;
		},
		saveFile: function(filePath,content) {
			// Returns null if it can't do it, false if there's an error, true if it saved OK
			if(window.Components) {
				try {
					netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
					var file = Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);
					file.initWithPath(filePath);
					if(!file.exists())
						file.create(0,0664);
					var out = Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(Components.interfaces.nsIFileOutputStream);
					out.init(file,0x22,4,null);
					var converter = Components.classes["@mozilla.org/intl/converter-output-stream;1"].createInstance(Components.interfaces.nsIConverterOutputStream);
					converter.init(out, "UTF-8", 0, 0);
					converter.writeString(content);
					converter.close();
					out.close();
					return true;
				} catch(ex) {
					alert("Exception while attempting to save\n\n" + ex);
					return false;
				}
			}
			return null;
		}
	};

	// TiddlySaver driver

	drivers.tiddlySaver = {
		name: "tiddlySaver",
		deferredInit: function() {
			if(!document.applets["TiddlySaver"] && !$.browser.mozilla && !$.browser.msie && document.location.toString().substr(0,5) == "file:") {
				$(document.body).append("<applet style='position:absolute;left:-1px' name='TiddlySaver' code='TiddlySaver.class' archive='TiddlySaver.jar' width='1'height='1'></applet>");
			}
		},
		isAvailable: function() {
			return !!document.applets["TiddlySaver"];
		},
		loadFile: function(filePath) {
			var r;
			try {
				if(document.applets["TiddlySaver"]) {
					r = document.applets["TiddlySaver"].loadFile(javaUrlToFilename(filePath),"UTF-8");
					return (r === undefined || r === null) ? null : String(r);
				}
			} catch(ex) {
			}
			return null;
		},
		saveFile: function(filePath,content) {
			try {
				if(document.applets["TiddlySaver"])
					return document.applets["TiddlySaver"].saveFile(javaUrlToFilename(filePath),"UTF-8",content);
			} catch(ex) {
			}
			return null;
		}
	}

	// Java LiveConnect driver

	drivers.javaLiveConnect = {
		name: "javaLiveConnect",
		isAvailable: function() {
			return !!window.java && !!window.java.io && !!window.java.io.FileReader;
		},
		loadFile: function(filePath) {
			var r;
			var content = [];
			try {
				r = new java.io.BufferedReader(new java.io.FileReader(javaUrlToFilename(filePath)));
				var line;
				while((line = r.readLine()) != null)
					content.push(new String(line));
				r.close();
			} catch(ex) {
				return null;
			}
			return content.join("\n") + "\n";
		},
		saveFile: function(filePath,content) {
			try {
				var s = new java.io.PrintStream(new java.io.FileOutputStream(javaUrlToFilename(filePath)));
				s.print(content);
				s.close();
			} catch(ex) {
				return null;
			}
			return true;
		}
	}

	// Private utilities

	function javaUrlToFilename(url) {
		var f = "//localhost";
		if(url.indexOf(f) == 0)
			return url.substring(f.length);
		var i = url.indexOf(":");
		return i > 0 ? url.substring(i-1) : url;
	}

})(jQuery);
/*
jQuery.twStylesheet.js

jQuery plugin to dynamically insert CSS rules into a document

Usage:
  jQuery.twStylesheet applies style definitions
  jQuery.twStylesheet.remove neutralizes style definitions

Copyright (c) UnaMesa Association 2009

Triple licensed under the BSD, MIT and GPL licenses:
  http://www.opensource.org/licenses/bsd-license.php
  http://www.opensource.org/licenses/mit-license.php
  http://www.gnu.org/licenses/gpl.html
*/

(function($) {

var defaultId = "customStyleSheet"; // XXX: rename to dynamicStyleSheet?

// Add or replace a style sheet
// css argument is a string of CSS rule sets
// options.id is an optional name identifying the style sheet
// options.doc is an optional document reference
// N.B.: Uses DOM methods instead of jQuery to ensure cross-browser comaptibility.
$.twStylesheet = function(css, options) {
	options = options || {};
	var id = options.id || defaultId;
	var doc = options.doc || document;
	var el = doc.getElementById(id);
	if(doc.createStyleSheet) { // IE-specific handling
		if(el) {
			el.parentNode.removeChild(el);
		}
		doc.getElementsByTagName("head")[0].insertAdjacentHTML("beforeEnd",
			"&nbsp;<style id='" + id + "'>" + css + "</style>"); // fails without &nbsp;
	} else { // modern browsers
		if(el) {
			el.replaceChild(doc.createTextNode(css), el.firstChild);
		} else {
			el = doc.createElement("style");
			el.type = "text/css";
			el.id = id;
			el.appendChild(doc.createTextNode(css));
			doc.getElementsByTagName("head")[0].appendChild(el);
		}
	}
};

// Remove existing style sheet
// options.id is an optional name identifying the style sheet
// options.doc is an optional document reference
$.twStylesheet.remove = function(options) {
	options = options || {};
	var id = options.id || defaultId;
	var doc = options.doc || document;
	var el = doc.getElementById(id);
	if(el) {
		el.parentNode.removeChild(el);
	}
};

})(jQuery);
//]]>
</script>
<!--POST-SCRIPT-START-->

<!--POST-SCRIPT-END-->
</body>
</html>
